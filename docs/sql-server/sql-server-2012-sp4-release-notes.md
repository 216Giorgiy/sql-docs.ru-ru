---
title: "Заметки о выпуске SQL Server 2012 с пакетом обновления 4 (SP4) | Microsoft Docs"
ms.prod: sql-non-specified
ms.prod_service: sql-non-specified
ms.service: 
ms.component: sql-non-specified
ms.technology: server-general
ms.custom: 
ms.date: 10/05/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 67cb8b3e-3d82-47f4-840d-0f12a3bff565
caps.latest.revision: "0"
author: craigg-msft
ms.author: craigg
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 7aed12a3e687ab4c8b42b8f07c29d252e0d6acad
ms.sourcegitcommit: b2d8a2d95ffbb6f2f98692d7760cc5523151f99d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2017
---
# <a name="sql-server-2012-sp4-release-notes"></a>Заметки о выпуске SQL Server 2012 с пакетом обновления 4 (SP4)
[!INCLUDE[tsql-appliesto-ss2012-xxxx-xxxx-xxx-md](../includes/tsql-appliesto-ss2012-xxxx-xxxx-xxx-md.md)] Этот раздел приводит общую информацию об улучшениях в SQL Server 2012 с пакетом обновления 4 (SP4). В разделах также описываются проблемы, которые следует просмотреть перед установкой пакета обновления 4 (SP4) или устранением неполадок с ней. Заметки о выпуске доступны только в сети Интернет, а не на установочном носителе. Этот раздел периодически обновляется при обнаружении новых проблем. Подробный список исправлений в пакете обновления 4 (SP4) см. в разделе [Выпуск SQL Server 2012 с пакетом обновления 4 (SP4)](https://go.microsoft.com/fwlink/?linkid=846937).  

> Пакет обновления 4 (SP4) включает все накопительные обновления SQL Server 2012 с пакетом обновления 3 (SP3).
  
##<a name="download-pages"></a>Страницы скачивания
Ниже приводятся ссылки на скачивание основных пакетов для SQL Server 2012 с пакетом обновления 3 (SP3). Страницы загрузки содержат требования к системе и основные инструкции по установке.
- [Установка SQL Server 2012 с пакетом обновления 4 (SP4)](https://go.microsoft.com/fwlink/?linkid=846829)
- [SQL Server 2012 Express с пакетом обновления 4 (SP4)](https://go.microsoft.com/fwlink/?linkid=846905)
- [Пакет дополнительных компонентов Microsoft SQL Server 2012 с пакетом обновления 4 (SP4)](https://go.microsoft.com/fwlink/?linkid=846907)

##  <a name="sp4-performance-and-scale-improvements"></a>Улучшения производительности и масштабируемости пакета обновления 4 (SP4)

- **Улучшена процедура очистки агента распространителя**. Слишком большая база данных распространителя приводила к блокировке или взаимоблокировке. Улучшенная процедура очистки позволит исключить некоторые из этих сценариев. 
- **Динамическое масштабирование объектов памяти**. Динамическое секционирование объектов памяти в зависимости от количества узлов и ядер обеспечивает масштабирование среды на современном оборудовании. Динамическое повышение уровней этих объектов позволяет предотвращать возможные проблемы и автоматически назначать секцию для потокобезопасного объекта памяти. Для несекционированных объектов памяти динамическое повышение уровней позволяет секционировать их по узлам. Число секций совпадает с числом узлов NUMA. Для объектов памяти, секционированных по узлам, возможно дальнейшее повышение уровня. В этом случае они секционируются по ЦП и число секций совпадает с числом ЦП.
- **Поддержка буферного пула размером свыше 8 ТБ**. Поддерживаемый размер виртуального адресного пространства, потребляемого буферным пулом, теперь составляет 128 ТБ
- **Очистка отслеживания изменений**. Усовершенствована и сделана более эффективной очистка в функции отслеживания изменений при работе с ее таблицами. 

## <a name="sp4-supportability-and-diagnostics-improvements"></a>Расширение поддерживаемых функций и диагностических возможностей пакета обновления 4 (SP4)

- **Поддержка полных дампов для агентов репликации**. Сейчас если агенты репликации сталкиваются с необработанным исключением, они по умолчанию создают мини-дамп симптомов исключения. Поведение по умолчанию требует сложных действий по устранению неполадок для необработанных исключений. Пакет обновления 4 (SP4) представляет новый раздел реестра, который поддерживает создание полного дампа для агентов репликации.
- **Расширенная диагностика для XML-файлов showplan**. XML-файлы showplan теперь предоставляют сведения о включенных флагах трассировки, долях памяти для оптимизированного соединения вложенными циклами, о времени ЦП и затраченном времени. 
- **Улучшенная корреляция между XE-событиями и динамическими административными представлениями диагностики**. Поля Query_hash и query_plan_hash используются в качестве уникальных идентификаторов запроса. Динамическое административное представление определяет их как varbinary(8), а XEvent определяет их как UINT64. Так как в SQL Server не используется тип "unsigned bigint" (большое целое число без знака), приведение иногда не работает. Данное улучшение представляет новые столбцы действий и фильтров XEvent, эквивалентные query_hash и query_plan_hash, но определяемые как INT64. Это может помочь в корреляции запросов между событиями XE и динамическими административными представлениями. 
- **Улучшенная диагностика временно предоставляемого буфера памяти и использования памяти**. Доступно новое XEvent-событие query_memory_grant_usage (обратное портирование из Server 2016 с пакетом обновления 1 (SP1)).
- **Добавление трассировки протоколов в шаги согласования SSL**. Добавлены данные битовой трассировки для выполненного и невыполненного согласования, включая данные по протоколу и т. д. Это может быть полезно при устранении неполадок со сценариями подключения, например при развертывании TLS 1.2
- **Задание корректного уровня совместимости для базы данных распространителя**. После установки пакета обновления уровень совместимости базы данных распространителя меняется на 90. Изменение уровня происходило из-за проблемы в хранимой процедуре sp_vupgrade_replication. Теперь пакет обновления задает корректный уровень совместимости для базы данных распространителя. 
- **Новая команда DBCC для клонирования базы данных**. Клонирование базы данных — это новая команда DBCC, которая позволяет опытным пользователям, например работающим с CSS, устранять неполадки с рабочими базами путем клонирования только схемы и метаданных, а не самих данных. Эта команда DBCC вызывается как clonedatabase (<имя_исходной_базы>, <имя_базы-клона>). Клонированные базы данных не следует использовать в рабочих средах. Чтобы проверить, создана ли база данных в результате вызова клонированной базы, используйте следующую команду: select DATABASEPROPERTYEX('clonedb', 'isClone'). Возвращаемое значение 1 означает "истина", а 0 — "ложь". 
- **Сведения о файлах TempDB и об их размере в журнале ошибок SQL**. Если размер и автоматическое увеличение для файлов данных TempDB во время запуска отличаются, выводится количество файлов и выдается предупреждение.
- **Сообщения поддержки IFI в журнале ошибок SQL Server**. В журнале ошибок теперь указывается, включена ли мгновенная инициализация файлов базы данных
- **Новая функция динамического управления для замены DBCC-команды INPUTBUFFER**. Представлена новая функция динамического управления sys.dm_input_buffer, принимающая в качестве параметра session_id, которая приходит на замену DBCC-команде INPUTBUFFER
- **Улучшение работы событий XEvent при ошибках маршрутизации чтения для группы доступности**. XEvent-событие read_only_rout_fail сейчас срабатывает, только когда имеется список маршрутов, но ни один из серверов в списке не доступен для подключения. С пакетом обновления вы будете получать дополнительную информацию для более эффективного устранения неполадок, а также развернутые сведения о кодовых точках, где срабатывает XEvent. 
- **Улучшенное взаимодействие с Service Broker при отработке отказа группы доступности**. В прошлом, если Service Broker был включен для баз данных группы доступности, во время отработки отказа группы доступности все подключения Service Broker, созданные в первичной реплике, оставались открытыми. Теперь во время отработки отказа группы доступности такие открытые подключения будут закрыты.
- **[Автоматическое секционирование soft-NUMA](https://msdn.microsoft.com/library/ms345357(SQL.120).aspx)**. В SQL 2014 с пакетом обновления 2 (SP2) при включении флага трассировки 8079 на уровне сервера программная архитектура NUMA (soft-NUMA) реализуется автоматически. Если флаг трассировки 8079 включен во время запуска, SQL Server 2014 с пакетом обновления 2 (SP2) опрашивает структуру оборудования и автоматически настраивает soft-NUMA на системах, сообщивших о наличии о восьми или более ЦП на узел NUMA. Автоматическая реализация soft-NUMA учитывает многопоточность (потоки/логические процессоры). Секционирование и создание дополнительных узлов позволяет масштабировать фоновую обработку за счет увеличения числа прослушивателей и масштаба вычислений, а также расширения возможностей сети и шифрования. Рекомендуется использовать автоматическое секционирование soft-NUMA для предварительного тестирования производительности рабочих нагрузок перед их активацией в рабочей среде.

## <a name="see-also"></a>См. также:
- [Установка обновлений для обслуживания SQL Server 2012](https://msdn.microsoft.com/library/hh479746(v=sql.110).aspx)
- [Как определить версию и выпуск установленного SQL Server](https://support.microsoft.com/en-us/help/321185)

[!INCLUDE[get-help-options](../includes/paragraph-content/get-help-options.md)]
