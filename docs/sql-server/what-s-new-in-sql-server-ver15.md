---
title: Новые возможности в SQL Server 2019 | Документация Майкрософт
ms.date: 01/09/2019
ms.prod: sql-server-2018
ms.reviewer: ''
ms.technology: release-landing
ms.topic: article
author: MikeRayMSFT
ms.author: mikeray
manager: craigg
monikerRange: '>=sql-server-ver15||=sqlallproducts-allversions'
ms.openlocfilehash: e0a5dab4eeccc5c4e31a151ec9611d7ed8367a78
ms.sourcegitcommit: 96032813f6bf1cba680b5e46d82ae1f0f2da3d11
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2019
ms.locfileid: "54300181"
---
# <a name="whats-new-in-sql-server-2019"></a>Новые возможности в SQL Server 2019

[!INCLUDE[tsql-appliesto-ssver15-xxxx-xxxx-xxx](../includes/tsql-appliesto-ssver15-xxxx-xxxx-xxx.md)]

  > [!div class="nextstepaction"]
  > [Поделитесь своим мнением о содержании документации по SQL.](https://aka.ms/sqldocsurvey)

[!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] основывается на предыдущих выпусках для расширения SQL Server как платформы, которая поддерживает ряд языков разработки, типов данных, операционных систем, а также работает в локальной и облачной средах. В этой статье перечислены новые возможности SQL Server 2019. Дополнительные сведения и известные проблемы см. в статье с [заметками о выпуске предварительной версии SQL Server 2019](sql-server-ver15-release-notes.md).

**Попробуйте SQL Server 2019!**
- [![Скачайте из Центра оценки](../includes/media/download2.png)](https://go.microsoft.com/fwlink/?LinkID=862101) [Скачать SQL Server 2019 для установки на компьютерах с Windows](https://go.microsoft.com/fwlink/?LinkID=862101)
- Установите на компьютерах с Linux для [Red Hat Enterprise Server](../linux/quickstart-install-connect-red-hat.md), [SUSE Linux Enterprise Server](../linux/quickstart-install-connect-suse.md) и [Ubuntu](../linux/quickstart-install-connect-ubuntu.md).
- [Работайте с SQL Server 2019 в Docker](../linux/quickstart-install-connect-docker.md).

## <a name="ctp-22"></a>CTP 2.2

Ознакомительная версия для сообщества (CTP) 2.2 является последним общедоступным выпуском [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)]. Этот выпуск включает усовершенствования предыдущих выпусков CTP для исправления ошибок, повышения безопасности и оптимизации производительности. Кроме того, в [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] версии CTP 2.2 добавлены или улучшены следующие функции.

- [Кластеры больших данных](#bigdatacluster)
  - Использование SparkR из Azure Data Studio в кластерах больших данных

- [Ядро СУБД](#databaseengine)
  - Использование кодировки UTF-8 с репликацией SQL Server.

## <a name="previous-ctps"></a>Предыдущие выпуски CTP

В предыдущих выпусках CTP добавлены или улучшены следующие функции для [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)].

- [Кластеры больших данных](#bigdatacluster) 
  - Развертывание кластера больших данных с использованием контейнеров SQL и Spark на платформе Linux в Kubernetes (CTP 2.0)
  - Доступ к большим данным из HDFS (CTP 2.0)
  - Запуск операций расширенной аналитики и машинного обучения с помощью Spark (CTP 2.0)
  - Использование потоковой передачи данных Spark в пулы данных SQL (CTP 2.0)
  - Использование Azure Data Studio для запуска книг запросов, обеспечивающих условия работы с записной книжкой (CTP 2.0)
  - Развертывание приложений Python и R (CTP 2.1)

- [Ядро СУБД](#databaseengine)
  - Поддержка UTF-8 (CTP 2.0)
  - Возобновляемое создание индекса в подключенном режиме позволяет возобновить процесс создания индекса после сбоя (CTP 2.0)
  - Сборка и перестройка кластеризованного индекса columnstore в подключенном режиме (CTP 2.0)
  - Always Encrypted с безопасными анклавами (CTP 2.0)
  - Интеллектуальная обработка запросов (CTP 2.0)
  - Расширение программирования языка Java (CTP 2.0)
  - Функции графа SQL (CTP 2.0)
  - Параметр конфигурации на уровне базы данных для возобновляемых операций DDL и операций DDL в подключенном режиме (CTP 2.0)
  - Группы доступности AlwaysOn — перенаправление подключения вторичной реплики (CTP 2.0)
  - Классификация и обнаружение данных — функции, встроенные в SQL Server (CTP 2.0)
  - Расширенная поддержка устройств с постоянной памятью (CTP 2.0)
  - Поддержка статистики columnstore в `DBCC CLONEDATABASE` (CTP 2.0)
  - Новые возможности, добавленные в `sp_estimate_data_compression_savings` (CTP 2.0)
  - Отказоустойчивые кластеры Служб машинного обучения SQL Server (CTP 2.0)
  - Упрощенная инфраструктура профилирования запросов включена по умолчанию (CTP 2.0)
  - Новые соединители PolyBase (CTP 2.0)
  - Новая системная функция `sys.dm_db_page_info` возвращает сведения о странице (CTP 2.0)
  - Интеллектуальная обработка запросов и скалярное встраивание определяемых пользователем функций (CTP 2.1)
  - Улучшенное сообщение об ошибке усечения, которое включает имена таблицы и столбца, а также усеченное значение (CTP 2.1)
  - Поддержка параметров сортировки UTF-8 при настройке [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] (CTP 2.1)
  - Использование псевдонимов производной таблицы или представления для графовых запросов MATCH (CTP 2.1)
  - Улучшенные данные диагностики для блокирующих операций получения статистики (CTP 2.1)
  - Гибридный буферный пул (CTP 2.1)
  - Статическое маскирование данных (CTP 2.1)

- [SQL Server в Linux](#sqllinux)
  - Поддержка репликации (CTP 2.0)
  - Поддержка координатора распределенных транзакций Майкрософт (MSDTC) (CTP 2.0)
  - Группа доступности AlwaysOn в контейнерах Docker с Kubernetes (CTP 2.0)
  - Поддержка OpenLDAP для сторонних поставщиков Active Directory (CTP 2.0)
  - Машинное обучение в Linux (CTP 2.0)
  - Новый реестр контейнеров (CTP 2.0)
  - Новые образы контейнеров на основе RHEL (CTP 2.0)
  - Уведомление о нехватке памяти (CTP 2.0)

- [Службы Master Data Services](#mds)
  - Заменены элементы управления Silverlight (CTP 2.0)

- [безопасность](#security)
  - Управление сертификатами в диспетчере конфигурации SQL Server (CTP 2.0)

- [Инструменты](#tools)
  - SQL Server Management Studio (SSMS) 18.0 (предварительная версия) (CTP 2.0)
  - Azure Data Studio (CTP 2.0)
  - Azure Data Studio (CTP 2.1)

Ознакомьтесь с дополнительными сведениями об этих функциях.

## <a id="bigdatacluster"></a>Кластеры больших данных

[Кластеры больших данных](../big-data-cluster/big-data-cluster-overview.md) ([!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)]) позволяют реализовать новые сценарии, включая следующие:

- Использование SparkR из Azure Data Studio в кластерах больших данных. (CTP 2.2)
- [Развертывание приложений Python и R](../big-data-cluster/big-data-cluster-create-apps.md). (CTP 2.1)
- Развертывание кластера больших данных с контейнерами [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] и Spark на базе Linux в Kubernetes (CTP 2.0)
- Доступ к большим данным из HDFS (CTP 2.0)
- Запуск операций расширенной аналитики и машинного обучения с помощью Spark (CTP 2.0)
- Использование потоковой передачи данных Spark в пулы данных SQL (CTP 2.0)
- Запуск книг запросов, обеспечивающих условия работы с записной книжкой в [**Azure Data Studio**](../sql-operations-studio/what-is.md). (CTP 2.0)
 
[!INCLUDE [Big data clusters preview](../includes/big-data-cluster-preview-note.md)]

## <a id="databaseengine"></a> Ядро СУБД

[!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] обеспечивает реализацию или оптимизацию следующих новых функций для [!INCLUDE[ssDEnoversion](../includes/ssdenoversion-md.md)]

### <a name="scalar-udf-inlining-ctp-21"></a>Масштабируемое встраивание определяемых пользователем функций (CTP 2.1)

Функция масштабируемого встраивания определяемых пользователем функций автоматически преобразует скалярные функции, определяемые пользователем (UDF), в реляционные выражения и внедряет их в вызывающий SQL-запрос. Это повышает производительность рабочих нагрузок, использующих скалярные функции, определяемые пользователем. Скалярное встраивание определяемых пользователем функций упрощает оптимизацию на основе коэффициентов стоимости в этих функциях. Это позволяет создать эффективные планы с использованием наборов и параллельного выполнения вместо неэффективных планов с последовательным итеративным выполнением. Эта функция включена по умолчанию на уровне совместимости базы данных 150.

Дополнительные сведения см. в разделе [Встраивание скалярных функций, определяемых пользователем](../relational-databases/user-defined-functions/scalar-udf-inlining.md).

### <a name="truncation-error-message-improved-to-include-table-and-column-names-and-truncated-value-ctp-21"></a>Улучшенное сообщение об ошибке усечения, которое включает имена таблицы и столбца, а также усеченное значение (CTP 2.1)

Сообщение об ошибке с идентификатором 8152 `String or binary data would be truncated` знакомо многим разработчикам и администраторам [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], которые разрабатывают или поддерживают рабочие нагрузки по перемещению данных. Эта ошибка возникает при передаче данных между исходной и целевой таблицами с различными схемами, когда размер исходных данных превышает размер целевого типа данных. Устранение подобных ошибок может занимать много времени. В [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] добавлено новое, более конкретное сообщение об ошибке (2628) для подобного сценария:  

`String or binary data would be truncated in table '%.*ls', column '%.*ls'. Truncated value: '%.*ls'.`

Новое сообщение об ошибке 2628 содержит больше сведений о проблеме с усечением данных, что упрощает процесс устранения ошибки. В CTP 2.1 и CTP 2.2 это сообщение об ошибке активируется явным образом и требует включения [флага трассировки](../t-sql/database-console-commands/dbcc-traceon-trace-flags-transact-sql.md) 460.

### <a name="improved-diagnostic-data-for-stats-blocking-ctp-21"></a>Улучшенные данные диагностики для блокирующих операций получения статистики (CTP 2.1)

[!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] предоставляет улучшенные данные диагностики для длительных запросов, которые ожидают завершения синхронных операций обновления статистики. В динамическом административном представлении `sys.dm_exec_requests` столбец `command` отображает `SELECT (STATMAN)`, если `SELECT` ожидает завершения синхронной операции обновления статистики, прежде чем продолжить выполнение запроса.  Дополнительно отображается новый тип ожидания `WAIT_ON_SYNC_STATISTICS_REFRESH` в динамическом административном представлении `sys.dm_os_wait_stats`. Он отображает суммарное время на уровне экземпляра, затраченное на синхронные операции обновления статистики.

### <a name="static-data-masking-ctp-21"></a>Статическое маскирование данных (CTP 2.1)

В [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] вводится статическое маскирование данных. Статическое маскирование данных используется для очистки конфиденциальных данных в копиях баз данных SQL Server. Статическое маскирование данных позволяет создать очищенную копию базы данных, в которой все конфиденциальные сведения изменены таким образом, чтобы к этой копии можно было предоставить совместный доступ пользователям вне рабочей среды. Статическое маскирование данных можно использовать для разработки, тестирования, аналитики, бизнес-отчетности, соблюдения нормативных требований, устранения неполадок и других сценариев, при которых определенные данные нельзя копировать в другие среды.

Статическое маскирование данных применяется на уровне столбцов. Выберите столбцы для маскирования и для каждого выбранного столбца укажите функцию маскирования. Операция статического маскирования создает копию базы данных, а затем применяет указанные функции маскирования к столбцам.

#### <a name="static-data-masking-vs-dynamic-data-masking"></a>Отличие статического маскирования данных от динамического

Маскирование данных — это процесс применения маски к базе данных, чтобы скрыть конфиденциальные сведения либо заменить их новыми или очищенными данными. В продуктах Майкрософт поддерживаются две операции маскирования — статическое и динамическое маскирование данных. Динамическое маскирование данных было добавлено в [!INCLUDE[ssSQL17](../includes/sssql17-md.md)]. В следующей таблице сравниваются два решения:

|Статическое маскирование данных |Динамическое маскирование данных|
|:----|:----|
|Выполняется с копией базы данных. <br/><br/>Исходные данные не извлекаются.<br/><br/>Маскирование выполняется на уровне хранилища.<br/><br/>Все пользователи имеют доступ к тем же маскированным данным.<br/><br/>Предназначено для непрерывного доступа для всех членов команды.|Выполняется с исходной базой данных.<br/><br/>Исходные данные не затрагиваются.<br/><br/>Маскирование выполняется оперативно во время исполнения запроса.<br/><br/>Маска зависит от разрешений пользователя. <br/><br/>Предназначено для точного соблюдения прав доступа определенных пользователей.|

### <a name="database-compatibility-level-ctp-20"></a>Уровень совместимости базы данных (CTP 2.0)

Добавлен **уровень совместимости 150** для базы данных. Чтобы включить этот уровень совместимости для отдельной пользовательской базы данных, выполните команду ниже:

   ```sql
   ALTER DATABASE database_name SET COMPATIBILITY_LEVEL =  150;
   ```

### <a name="utf-8-support-ctp-22"></a>Поддержка UTF-8 (CTP 2.2)

Полная поддержка широко используемой кодировки символов UTF-8 как кодировки импорта или экспорта или как параметров сортировки на уровне столбцов и базы данных для текстовых данных. Кодировка символов UTF-8 допускается в типах данных `CHAR` и `VARCHAR`. Она активируется при создании параметров сортировки с суффиксом `UTF8` или изменении существующих параметров на такие. 

Например, `LATIN1_GENERAL_100_CI_AS_SC` меняется на `LATIN1_GENERAL_100_CI_AS_SC_UTF8`. UTF-8 доступна только для параметров сортировки Windows, которые поддерживают дополнительные символы, представленные в [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]. `NCHAR` и `NVARCHAR` допускают только кодирование UTF-16 и остаются неизменными.

Эта функция может обеспечить значительную экономию места в хранилище в зависимости от используемой кодировки. Например, изменение имеющегося типа данных столбца со строками в кодировке Latin с `NCHAR(10)` на `CHAR(10)` с использованием параметров сортировки для UTF-8 на 50 % снижает требования к хранению. Это снижение связано с тем, что `NCHAR(10)` требует для хранения 20 байт, тогда как `CHAR(10)` требует 10 байт для той же строки Юникод.

Дополнительные сведения см. в статье [Collation and Unicode Support](../relational-databases/collations/collation-and-unicode-support.md).

В CTP 2.1 добавлена возможность выбора параметров сортировки UTF-8 по умолчанию во время настройки [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)].

В CTP 2.2 добавлена поддержка использования кодировки UTF-8 с репликацией SQL Server.

### <a name="resumable-online-index-create-ctp-20"></a>Возобновляемое создание индексов в подключенном режиме (CTP 2.0)

- **Благодаря возобновляемому созданию индексов в подключенном режиме** операцию создания можно остановить и возобновить позже из той точки, где она была приостановлена или завершилась сбоем, а не перезапускать.

  Возобновляемое создание индексов в подключенном режиме поддерживает следующие сценарии:
  - Возобновление операции создания индекса после сбоя, например после отработки отказа базы данных или заполнения дискового пространства.
  - Остановка текущей операции создания индекса и последующее ее восстановление, позволяющее временно освободить системные ресурсы по мере необходимости, а затем восстановить операцию.
  - Создание больших индексов без использования большого пространства журнала и длительных транзакций, из-за которых блокируются другие действия по обслуживанию и допускается усечение журнала.

  В случае сбоя создания индекса без функции возобновляемости операцию создания индекса в подключенном режиме нужно снова выполнить и полностью перезапустить.

В этом выпуске мы расширим возобновляемые функции, добавив эту функцию в доступную [перестройку возобновляемого индекса в подключенном режиме](https://azure.microsoft.com/blog/modernize-index-maintenance-with-resumable-online-index-rebuild/).

Кроме того, эту функцию можно установить по умолчанию для конкретной базы данных с помощью [стандартного параметра на уровне базы данных для возобновляемых операций DDL и операций DDL в подключенном режиме](../t-sql/statements/alter-database-scoped-configuration-transact-sql.md).

Дополнительные сведения см. в разделе о [возобновляемых операциях создания индекса в подключенном режиме](../t-sql/statements/create-index-transact-sql.md#resumable-indexes).

### <a name="build-and-rebuild-clustered-columnstore-indexes-online-ctp-20"></a>Сборка и перестройка кластерных индексов columnstore в подключенном режиме (CTP 2.0)

Преобразуйте таблицы rowstore в формат columnstore. Создание кластеризованных индексов columnstore (CCI) было автономным процессом в предыдущих версиях [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], что требовало приостановки всех изменений во время создания CCI. [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] и [!INCLUDE[ssSDSfull](../includes/sssdsfull-md.md)] позволяют создать или повторно создать CCI в Интернете. Рабочая нагрузка не будет заблокирована, и все изменения, реализованные в базовых данных, будут прозрачно добавлены в целевую таблицу columnstore. Примеры новых инструкций [!INCLUDE[tsql](../includes/tsql-md.md)], которые можно использовать, приведены ниже.

  ```sql
  CREATE CLUSTERED COLUMNSTORE INDEX cci
    ON <tableName>
    WITH (ONLINE = ON);
  ```

  ```sql
  ALTER INDEX cci
    ON <tableName>
    REBUILD WITH (ONLINE = ON);
  ```

### <a name="always-encrypted-with-secure-enclaves-ctp-20"></a>Always Encrypted с безопасными анклавами (CTP 2.0)

К Always Encrypted добавляется функция шифрования на месте и полнофункциональные вычисления. Эти расширения связаны с активацией выполнения вычислений с данными в виде открытого текста внутри безопасного анклава на стороне сервера.

Криптографические операции включают шифрование столбцов и смену ключей шифрования столбцов. Эти операции теперь можно запустить с помощью [!INCLUDE[tsql](../includes/tsql-md.md)], и они не требуют перемещения данных из базы данных. Безопасные анклавы обеспечивают шифрование Always Encrypted для более широкого набора сценариев, которые включают следующие требования:  

- Требование защитить конфиденциальные данные от неавторизованных пользователей с привилегиями высокого уровня, включая администраторов баз данных, системных администраторов и операторов облаков, или вредоносных программ.
- Требование того, чтобы в системе базы данных для защищенных данных поддерживались полнофункциональные вычисления.

Дополнительные сведения см. в статье [Always Encrypted с безопасными анклавами](../relational-databases/security/encryption/always-encrypted-enclaves.md).

> [!NOTE]
> Шифрование Always Encrypted с безопасными анклавами доступно только в ОС Windows.

### <a name="intelligent-query-processing-ctp-20"></a>Интеллектуальная обработка запросов (CTP 2.0)

- **Обратная связь с временно предоставляемым буфером памяти в строковом режиме** — это расширение функции обратной связи с временно предоставляемым буфером памяти, реализованное в [!INCLUDE[ssSQL17](../includes/sssql17-md.md)] путем настройки размеров временно предоставляемого буфера памяти для операторов пакетного и строкового режимов.  Для чрезмерных временно предоставляемых буферов памяти, когда предоставленный объем памяти больше чем в два раза превышает объем фактической используемой памяти, функция обратной связи пересчитывает временно предоставляемый буфер памяти. Последовательные выполнения затем будут запрашивать меньше памяти. Для недостаточных временно предоставляемых буферов памяти, которые приводят к временной записи на диск, обратная связь по временно предоставляемому буферу памяти активирует пересчет буфера. Последовательные выполнения затем будут запрашивать больше памяти. Эта функция включена по умолчанию на уровне совместимости базы данных 150.

- Функция **приблизительного COUNT DISTINCT** возвращает приблизительное количество уникальных ненулевых значений в группе. Эта функция предназначена для использования в сценариях больших данных. Она оптимизирована для запросов, если выполняются все приведенные ниже условия:
   - Доступ к наборам данных, содержащим не менее миллиона строк.
   - Агрегирование столбца или столбцов с большим количеством различных значений.
   - Скорость реагирования более важна, чем абсолютная точность.
      - Функция `APPROX_COUNT_DISTINCT` возвращает результаты, которые обычно отклоняются от точного ответа где-то на 2 %.
      - Также эта функция возвращает приблизительный ответ за небольшую часть времени, необходимую для точного ответа.

- **Пакетный режим для данных rowstore** больше не требует индекса columnstore для обработки запроса в пакетном режиме. Пакетный режим позволяет операторам запросов работать с набором строк, а не одной строкой за раз. Эта функция включена по умолчанию на уровне совместимости базы данных 150. Пакетный режим улучшает скорость запросов, обращающихся к таблицам rowstore, если выполняются все приведенные ниже условия:
   - В запросе используются аналитические операторы, такие как соединения или агрегирования.
   - Запрос включает в себя 100 000 или более строк.
   - Запрос ограничен ресурсами ЦП, а не данными ввода и вывода.
   - Создание и использование индекса columnstore включает один из следующих недостатков:
      - Слишком большая нагрузка для запроса.
      - Или же действия не представляются возможными, потому что приложение зависит от функции, которая еще не поддерживается индексами columnstore.

- **Отложенная компиляция табличных переменных** позволяет оптимизировать план и повысить общую производительность для запросов, ссылающихся на табличные переменные. Во время оптимизации и первичной компиляции эта функция будет распространять оценки кратности, основанные на фактическом количестве строк табличной переменной.  Эти точные сведения о количестве строк будут использоваться для оптимизации нижестоящих операций планирования. Эта функция включена по умолчанию на уровне совместимости базы данных 150.

Чтобы использовать интеллектуальные функции обработки запросов, установите для базы данных уровень `COMPATIBILITY_LEVEL = 150`.

### <a id="programmability"></a> Расширения программирования для языка Java (CTP 2.0)

- **Расширение языка Java (предварительная версия)**: используйте расширение языка Java для выполнения кода Java в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. В [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] это расширение устанавливается при добавлении в экземпляр [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] функции "Службы машинного обучения (в базе данных)".

### <a id="sqlgraph"></a> Функции графа SQL

- **Использование псевдонимов производной таблицы или представления в uhfajds запросах MATCH (CTP 2.1)** Графовые запросы в SQL Server 2019 (предварительная версия) поддерживают использование псевдонимов для представления и производной таблицы в синтаксисе `MATCH`. Чтобы использовать псевдонимы в `MATCH`, представления и производные таблицы нужно создать в наборе узловых таблиц либо в наборе таблиц ребер при помощи оператора `UNION ALL`. Использование фильтров в узловых таблицах или таблицах ребер не имеет значения. Возможность использовать псевдонимы производных таблиц и представлений в запросах `MATCH` может оказаться полезной в сценариях, когда нужно выполнять запросы по разнородным сущностям или разнородным связям между двумя или несколькими сущностями в графе.

- **Поддержка MATCH в `MERGE` языка DML (CTP 2.0)** позволяет задавать взаимосвязи графа в одной инструкции вместо отдельных инструкций `INSERT`, `UPDATE` или `DELETE`. Объедините текущие данные графа из таблиц узлов или ребер с новыми данными с помощью предикатов `MATCH` в инструкции `MERGE`. Эта функция позволяет использовать сценарии `UPSERT` в таблицах ребер. Теперь пользователи могут использовать одну инструкцию слияния для вставки нового ребра или обновления имеющегося между двумя узлами.

- **Ограничения ребер (CTP 2.0)** добавлены для таблиц ребер в SQL Graph. Таблицы ребер могут соединять любой узел с любым другим узлом в базе данных. С введением ограничений ребер вы теперь можете применить некоторые ограничения для этого поведения. Новое ограничение `CONNECTION` можно использовать для указания типа узлов, которые таблица ребер сможет соединять в схеме.

### <a name="database-scoped-default-setting-for-online-and-resumable-ddl-operations--ctp-20"></a>Параметр по умолчанию на уровне базы данных для возобновляемых операций языка DDL и операций языка DDL в подключенном режиме (CTP 2.0)

- **Параметр по умолчанию на уровне базы данных для возобновляемых операций DDL и операций DDL в подключенном режиме** позволяет задать параметр поведения по умолчанию для операций индекса `ONLINE` и `RESUMABLE` на уровне базы данных, а не определять эти параметры для каждой отдельной инструкции языка DDL, например создания или перестройки индекса.

- Установите эти значения по умолчанию с помощью параметров конфигурации на уровне базы данных: `ELEVATE_ONLINE` и `ELEVATE_RESUMABLE`. Оба параметра предписывают ядру автоматически перевести поддерживаемые операции в режим выполнения индекса "в сети" или режим возобновляемого выполнения. Вы можете включить следующие варианты поведения, используя эти параметры:

  - Параметр `FAIL_UNSUPPORTED` позволяет выполнить все операции с индексом (в подключенном режиме или возобновляемые), а операции, которые не поддерживают эти возможности, завершаются сбоем.
  - Параметр `WHEN_SUPPPORTED` позволяет выполнить поддерживаемые операции (в подключенном режиме или возобновляемые), а также запустить операции, которые не поддерживают эти возможности.
  - Параметр `OFF` разрешает текущее поведение выполнения всех операций индекса в автономном режиме и невозобновляемых операций, если в инструкции языка DDL явно не указано другое.

Чтобы переопределить параметр по умолчанию, включите параметр `ONLINE` или `RESUMABLE` в командах создания и перестройки индекса.  

Без этой функции вам необходимо указывать параметры возобновляемых операций и операций в подключенном режиме непосредственно в операторе индекса DDL (например, создание и перестроение индекса).

Дополнительные сведения о возобновляемых операциях с индексами см. в разделе [Возобновляемое создание индексов в подключенном режиме](https://azure.microsoft.com/blog/resumable-online-index-create-is-in-public-preview-for-azure-sql-db/).

### <a id="ha"></a>Группы доступности AlwaysOn — больше синхронных реплик (CTP 2.0)

- **До пяти синхронных реплик.** В [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] увеличено максимальное количество синхронных реплик до 5, по сравнению с 3 в [!INCLUDE[ssSQL17](../includes/sssql17-md.md)]. Вы можете настроить эту группу из 5 реплик для автоматического перехода на другой ресурс. Предоставляется 1 первичная реплика и 4 синхронные вторичные реплики.

- **Перенаправление подключения от вторичной реплики к первичной**: Позволяет направлять подключения клиентских приложений к первичной реплике независимо от целевого сервера, указанного в строке подключения. Эта возможность обеспечивает перенаправление подключения без прослушивателя. Перенаправление подключения от вторичной реплики к первичной можно использовать в следующих случаях:

  - Кластерная технология не предоставляет функцию прослушивателя.
  - Выполняется конфигурация нескольких подсетей, в рамках которой процесс перенаправления усложняется.
  - Сценарии аварийного восстановления или горизонтального масштабирования для чтения с типом кластера `NONE`.

Дополнительные сведения см. в статье [Перенаправление подключения с правами на чтение и запись с вторичной на первичную реплику (группы доступности AlwaysOn)](../database-engine/availability-groups/windows/secondary-replica-connection-redirection-always-on-availability-groups.md).

### <a name="data-discovery-and-classification-ctp-20"></a>Обнаружение и классификация данных (CTP 2.0)

Обнаружение и классификация данных предоставляют расширенные возможности, изначально встроенные в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Возможность классификации самых важных конфиденциальных данных и присваивания для них меток предоставляет следующие преимущества.
- Позволяет соблюдать стандарты в сфере конфиденциальности данных и нормативных требований.
- Поддерживает сценарии безопасности, такие как мониторинг (аудит) и оповещение о необычном доступе к конфиденциальным данным.
- Упрощает определение размещения конфиденциальных данных в организации, благодаря чему администраторы могут предпринимать необходимые меры для защиты базы данных.

Дополнительные сведения см. в статье [Обнаружения и классификация данных SQL](../relational-databases/security/sql-data-discovery-and-classification.md).

[Возможности аудита](../relational-databases/security/auditing/sql-server-audit-database-engine.md) также были расширены. Теперь в журнал аудита добавлено новое поле под названием `data_sensitivity_information`, в котором указывается классификация конфиденциальности (метки) фактических данных, возвращенных запросом. Дополнительные сведения и примеры см. в статье о [добавлении классификации конфиденциальности](../t-sql/statements/add-sensitivity-classification-transact-sql.md).

>[!NOTE]
>Условия включения аудита не изменились. К записям аудита добавлено новое поле (`data_sensitivity_information`), в котором указывается классификация конфиденциальности (метки) фактических данных, возвращенных запросом. Дополнительные сведения см. в разделе, [посвященном контролю за доступом к конфиденциальным данным](https://docs.microsoft.com/azure/sql-database/sql-database-data-discovery-and-classification#subheading-3).

### <a name="expanded-support-for-persistent-memory-devices-ctp-20"></a>Расширенная поддержка устройств с постоянной памятью (CTP 2.0)

Любой файл [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], размещенный в постоянной памяти устройства, теперь может работать в режиме *паравиртуализации*. [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] напрямую получает доступ к устройству путем обхода стека хранилища операционной системы с помощью эффективных операций memcpy. Этот режим повышает производительность, так как при его использовании сокращается задержка операций ввода-вывода на таких устройствах.
    - Примеры файлов [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:
        - Файлы баз данных
        - Файлы журнала транзакций
        - Файлы контрольных точек OLTP, выполняющейся в памяти.
    - Постоянная память также называется памятью класса хранилища.
    - На некоторых веб-сайтах сторонних производителей постоянную память иногда неформально называют *pmem*.

> [!NOTE]
> В этой предварительной версии компонент паравиртуализации файлов в постоянной памяти доступен только для Linux. [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] в Windows поддерживает устройства постоянной памяти начиная с [!INCLUDE[ssSQL15](../includes/sssql15-md.md)].

### <a name="hybrid-buffer-pool-ctp-21"></a>Гибридный буферный пул (CTP 2.1)

Гибридный буферный пул — это новая возможность ядра СУБД SQL Server, когда доступ к страницам базы данных, хранящимся в файлах базы данных и помещенным в устройство постоянной памяти (PMEM), осуществляется напрямую при необходимости. Поскольку устройства PMEM обеспечивают очень низкую задержку при доступе к данным, ядро может не создавать копию данных в области "чистых таблиц" буферного пула, а просто обращаться к странице напрямую в PMEM. Доступ осуществляется с использованием операций ввода-вывода с привязкой в памяти, подобно компоненту паравиртуализации. Это увеличивает производительность за счет исключения операции копирования страницы в динамическую память и обращения к стеку ввода-вывода операционной системы при доступе к странице в постоянном хранилище. Эта возможность доступна в SQL Server на Windows и Linux.

Дополнительные сведения см. в статье о [гибридном буферном пуле](../database-engine/configure-windows/hybrid-buffer-pool.md).

### <a name="support-for-columnstore-statistics-in-dbcc-clonedatabase-ctp-20"></a>Поддержка статистики columnstore в DBCC CLONEDATABASE (CTP 2.0)

`DBCC CLONEDATABASE` позволяет создать копию только схемы базы данных, содержащую все элементы, необходимые для устранения проблем с производительностью запросов без копирования данных.  В предыдущих версиях [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] эта команда не копировала данные статистики, необходимые для точного устранения неполадок с запросами индекса columnstore, и для получения этих сведений требовалось выполнять некоторые действия вручную. В этой версии [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] `DBCC CLONEDATABASE` автоматически собирает большие двоичные объекты статистики индексов columnstore, что позволяет не выполнять дополнительные действия вручную.

### <a name="new-options-added-to-spestimatedatacompressionsavings-ctp-20"></a>К sp_estimate_data_compression_savings добавлены новые параметры (CTP 2.0)

`sp_estimate_data_compression_savings` возвращает текущий размер запрошенного объекта и оценивает размер объекта для запрошенного состояния сжатия.  Сейчас эта процедура поддерживает три параметра: `NONE`, `ROW` и `PAGE`. В [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] представлены два новых параметра: `COLUMNSTORE` и `COLUMNSTORE_ARCHIVE`. Эти новые параметры позволят оценить экономию места при создании индекса columnstore в таблице, для которой применяется стандартное или архивное сжатие данных columnstore.

### <a id="ml"></a>Отказоустойчивые кластеры Служб машинного обучения SQL Server и моделирование на основе разделов (CTP 2.0)

- **Моделирование на основе разделов**. Обработка внешних сценариев на каждый раздел данных с использованием новых параметров, добавленных в `sp_execute_external_script`. Эта функция поддерживает обучение нескольких небольших моделей (одна модель на раздел данных) вместо одной большой.

- **Отказоустойчивый кластер Windows Server**: Настройка высокого уровня доступности для Служб машинного обучения в отказоустойчивом кластере Windows Server.

Дополнительные сведения см. в статье [Новые возможности служб машинного обучения SQL Server](../advanced-analytics/what-s-new-in-sql-server-machine-learning-services.md).

### <a name="lightweight-query-profiling-infrastructure-enabled-by-default-ctp-20"></a>Упрощенная инфраструктура профилирования запросов включена по умолчанию (CTP 2.0)

Упрощенная инфраструктура профилирования запросов (LWP) предоставляет более эффективные данные производительности запросов по сравнению со стандартными механизмами профилирования. Сейчас упрощенное профилирование включено по умолчанию. Эта возможность представлена в [!INCLUDE[ssSQL15](../includes/sssql15-md.md)] с пакетом обновления 1. Упрощенное профилирование предоставляет механизм сбора статистики выполнения запросов с ожидаемыми издержками ресурсов ЦП 2 %, по сравнению с издержками ЦП до 75 % для стандартного механизма профилирования запросов. В предыдущих версиях эта функция была выключена по умолчанию. Администраторы баз данных могут включить ее с помощью [флага трассировки 7412](../t-sql/database-console-commands/dbcc-traceon-trace-flags-transact-sql.md). 

Дополнительные сведения об облегченном профилировании см. в разделе [Инфраструктура профилирования запросов](../relational-databases/performance/query-profiling-infrastructure.md).

### <a id="polybase"></a>Новые соединители PolyBase

- **Новые соединители для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], Oracle, Teradata и MongoDB.** В [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] вводятся новые соединители с внешними данными для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], Oracle, Teradata и MongoDB.

### <a name="new-sysdmdbpageinfo-system-function-returns-page-information-ctp-20"></a>Новая системная функция sys.dm_db_page_info возвращает сведения о странице (CTP 2.0)

`sys.dm_db_page_info(database_id, file_id, page_id, mode)` возвращает сведения о странице в базе данных. Эта функция возвращает строку, содержащую данные заголовка страницы, включая `object_id`, `index_id` и `partition_id`. В большинстве случаев эта функция заменяет потребность в использовании `DBCC PAGE`.  

Чтобы упростить устранение задержек, связанных со страницей, к `sys.dm_exec_requests` и `sys.sysprocesses` также добавлен новый столбец с именем page_resource. Этот новый столбец позволяет объединить `sys.dm_db_page_info` с этими представлениями с помощью другой новой системной функции — `sys.fn_PageResCracker`. Рассмотрите следующий сценарий в качестве примера:

```sql
SELECT page_info.* 
FROM sys.dm_exec_requests AS d 
  CROSS APPLY sys.fn_PageResCracker(d.page_resource) AS r
  CROSS APPLY sys.dm_db_page_info(r.db_id, r.file_id, r.page_id,'DETAILED')
    AS page_info;
```

## <a id="sqllinux"></a>SQL Server на Linux

- **Поддержка репликации (CTP 2.0)**: [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] поддерживает репликацию SQL Server на платформе Linux. Виртуальная машина Linux с установленным агентом SQL может быть издателем, распространителем или подписчиком. 

  Создайте следующие типы публикаций:
  - Транзакционная
  - Моментальный снимок
  - Объединить

  Настройте репликацию [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)] или используйте [хранимые процедуры репликации](../relational-databases/system-stored-procedures/replication-stored-procedures-transact-sql.md).

- **Поддержка координатора распределенных транзакций Майкрософт (MSDTC) (CTP 2.0)**: SQL Server 2019 в Linux поддерживает координатор распределенных транзакций Майкрософт (MSDTC). Дополнительные сведения см. в статье о [настройке MSDTC на платформе Linux](../linux/sql-server-linux-configure-msdtc.md).

- **Группа доступности AlwaysOn в контейнерах Docker с Kubernetes (CTP 2.2)**: Kubernetes позволяет управлять контейнерами, в которых запущены экземпляры [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], для обеспечения высокой доступности набора баз данных с помощью групп доступности SQL Server AlwaysOn. Оператор Kubernetes развертывает набор с отслеживанием состояния, включая контейнер с **контейнером mssql-server** и монитор работоспособности.

- **Поддержка OpenLDAP для сторонних поставщиков AD (CTP 2.0)**: [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] в Linux поддерживает OpenLDAP, что позволяет сторонним поставщикам использовать Active Directory.

- **Машинное обучение в Linux (CTP 2.0)**. Теперь Службы машинного обучения SQL Server 2019 (в базе данных) поддерживаются в Linux. Предусмотрена также поддержка хранимой процедуры `sp_execute_external_script`. Инструкции по установке Служб машинного обучения на платформе Linux см. в статье [Install SQL Server 2019 Machine Learning Services (R, Python, Java) on Linux](../linux/sql-server-linux-setup-machine-learning.md) (Установка Служб машинного обучения (R, Python и Java) с SQL Server 2019 на платформе Linux).

- **Новый реестр контейнеров (CTP 2.1)**: Все образы контейнеров для [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)], а также [!INCLUDE[ssSQL17](../includes/sssql17-md.md)] теперь находятся в реестре контейнеров Майкрософт. Реестр контейнеров Майкрософт — это официальный реестр контейнеров для распределения контейнеров продукта корпорации Майкрософт. Кроме того, теперь опубликованы сертифицированные образы на основе Red Hat Enterprise Linux (RHEL).

  - Реестр контейнеров Майкрософт: `mcr.microsoft.com/mssql/server:vNext-CTP2.0`
  - Сертифицированные образы контейнеров на основе RHEL: `mcr.microsoft.com/mssql/rhel/server:vNext-CTP2.0`

## <a id="mds"></a>Master Data Services (CTP 2.0) 

- **Элементы управления Silverlight заменены элементами HTML**: Теперь портал Master Data Services (MDS) не зависит от Silverlight. Все прежние компоненты Silverlight заменены элементами управления HTML.

## <a id="security"></a>Безопасность (CTP 2.0)

- **Управление сертификатами в диспетчере конфигурации SQL Server**: Сертификаты SSL/TLS широко используются для обеспечения безопасного доступа к экземплярам SQL Server. Управление сертификатами интегрировано в диспетчер конфигурации SQL Server, что упрощает выполнение таких распространенных задач:

  - Просмотр и проверка сертификатов, установленных в экземпляре [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. 
  - Просмотр сертификатов, срок действия которых истекает.
  - Развертывание сертификатов на компьютерах, участвующих в группах доступности AlwaysOn (из узла, содержащего первичную реплику).
  - Развертывание сертификатов на компьютерах, участвующих в экземпляре отказоустойчивого кластера (из активного узла).

  > [!NOTE]
  > Пользователю необходимо предоставить разрешения администратора на всех узлах кластера.

## <a id="tools"></a>Инструменты

- [**Azure Data Studio**](../azure-data-studio/what-is.md): Ранее выпущенное в режиме предварительной версии под названием SQL Operations Studio средство Azure Data Studio представляет собой современный упрощенный кроссплатформенный рабочий стол с открытым исходным кодом для выполнения самых распространенных задач в области разработки и администрирования данных. С помощью Azure Data Studio можно подключиться к SQL Server в локальной среде и в облаке на платформе Windows, macOS и Linux. Azure Data Studio позволяет:

  - Обновление до [расширения SQL Server 2019 (предварительная версия)](../azure-data-studio/sql-server-2019-extension.md). (CTP 2.1)
  - Редактировать и выполнять запросы в современной среде разработки с помощью невероятно быстрой функции Intellisense, фрагментов кода и путем интеграции управления исходным кодом. (CTP 2.0) 
  - Быстро визуализировать данные с помощью встроенных диаграмм результирующих наборов. (CTP 2.0)
  - Создавать настраиваемые панели мониторинга для серверов и баз данных с помощью настраиваемых мини-приложений. (CTP 2.0)  
  - Легко управлять более широкими средами с помощью встроенного терминала. (CTP 2.0)
  - Анализировать данные, работая с записной книжкой, интегрированной в Jupyter. (CTP 2.0)
  - Улучшить работу с пользовательскими расширениями и темами (CTP 2.0).
  - Изучить ресурсы Azure с помощью встроенных подписки и обозревателя ресурсов. (CTP 2.0)
  - Поддерживать сценарии, в которых используется кластер больших данных SQL Server. (CTP 2.0)

- [**SQL Server Management Studio (SSMS) 18.0 (предварительная версия)**](../ssms/sql-server-management-studio-ssms.md)

  - Поддержка [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)]. (CTP 2.0)
  - Поддержка функции Always Encrypted с безопасными анклавами. (CTP 2.0)
  - Более компактный файл для скачивания. (CTP 2.0)
  - Теперь работает на основе изолированной оболочки Visual Studio 2017. (CTP 2.0)
  - Полный список см. в разделе, посвященном [изменениям SSMS](../ssms/sql-server-management-studio-changelog-ssms.md). (CTP 2.0)

## <a name="other-services"></a>Другие службы

Начиная с CTP 2.2 в [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)] не были добавлены новые возможности для следующих служб:

- [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Analysis Services (SSAS);
- [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] (SSIS);
- [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] (SSRS).

## <a name="next-steps"></a>Следующие шаги

- [Заметки о выпуске SQL Server 2019](sql-server-ver15-release-notes.md)

- [Microsoft SQL Server 2019. Технический документ](https://info.microsoft.com/rs/157-GQE-382/images/EN-US-CNTNT-white-paper-DBMod-Microsoft-SQL-Server-2019-Technical-white-paper.pdf)<br />Опубликовано в сентябре 2018 г. Применяется к Microsoft SQL Server 2019 CTP-версии 2.0 для контейнеров Windows, Linux и Docker.


[!INCLUDE[get-help-options](../includes/paragraph-content/get-help-options.md)]
