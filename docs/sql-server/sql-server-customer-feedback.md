---
title: Настройка SQL Server для отправки отзывов в корпорацию Майкрософт | Документация Майкрософт
description: ''
author: annashres
ms.author: anshrest
manager: craigg
ms.date: 07/12/2017
ms.topic: conceptual
ms.prod: sql
ms.prod_service: sql
ms.component: sql-non-specified
ms.suite: sql
ms.custom: ''
ms.technology: configuration
ms.openlocfilehash: 6684d58710b8be2cf96e06029792836cab9c69a3
ms.sourcegitcommit: df382099ef1562b5f2d1cd506c1170d1db64de41
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/12/2018
ms.locfileid: "34074307"
---
# <a name="configure-sql-server-to-send-feedback-to-microsoft"></a>Настройка SQL Server для отправки отзывов в корпорацию Майкрософт
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]

## <a name="summary"></a>Сводка
По умолчанию Microsoft SQL Server собирает сведения о том, как пользователи используют приложение. В частности, SQL Server собирает сведения об установке, использовании и производительности. Эти сведения помогают корпорации Майкрософт улучшать продукты и удовлетворять ожидания клиентов. Например, корпорация Майкрософт собирает сведения о кодах ошибок, с которыми сталкиваются пользователи. Это помогает нам исправлять вызвавшие их проблемы, улучшать качество документации об использовании SQL Server и определять, нужно ли добавить в продукт новые возможности, которые будут полезны нашим клиентам.

При этом, используя этот механизм, корпорация Майкрософт не собирает следующие данные:
- любые значения из пользовательских таблиц;
- любые учетные данные или другие параметры аутентификации;
- личные сведения (PII).

В примере ниже показано, какие именно сведения об использовании компонентов помогают нам улучшить продукт.

SQL Server 2017 поддерживает индексы ColumnStore для сценариев быстрого анализа. Индексы ColumnStore сочетают традиционную для индексов структуру сбалансированного дерева для новых данных с особым алгоритмом сжатия на основе характеристик столбцов, который позволяет успешно сжимать данные и ускорять выполнение запросов. Продукт выполняет эвристический анализ для переноса в фоновом режиме данных из структуры сбалансированного дерева в сжатую структуру, чтобы ускорить выполнение последующих запросов.

Если механизм фоновой обработки не успевает обрабатывать данные с той скоростью, с которой добавляются новые данные, производительность запросов может оказаться медленнее ожидаемой. Чтобы повысить производительность продукта, корпорация Майкрософт собирает сведения о том, насколько хорошо SQL Server справляется с процессом автоматического сжатия данных. Команда разработчиков использует эти сведения для точной настройки частоты выполнения и параллелизма в коде, который выполняет сжатие. Время от времени выполняется запрос для сбора этой информации, который позволяет корпорации Майкрософт оценить скорость перемещения данных. Это помогает оптимизировать эвристические возможности продукта.  

```sql
SELECT object_id, type_desc, data_space_id, db_id() AS database_id FROM sys.indexes WITH(nolock) WHERE type = 5 or type = 6 
```

```sql
SELECT cntr_value as merge_policy_evaluation
FROM sys.dm_os_performance_counters WITH(nolock)
WHERE object_name LIKE '%columnstore%' 
AND counter_name ='Total Merge Policy Evaluations' 
AND instance_name = '_Total'
```

Не забывайте, что этот процесс контролирует механизмы, предоставляющие важную для клиентов функциональность. Команда разработчиков не просматривает данные, содержащиеся в индексе, и не отправляет эти данные в корпорацию Майкрософт. SQL Server 2017 всегда собирает и отправляет сведения о ходе установки. Это помогает нам быстро обнаруживать и исправлять любые проблемы, которые возникают у клиентов при установке. Можно настроить SQL Server 2017 так, чтобы он не отправлял в корпорацию Майкрософт какие-либо сведения. Такое поведение настраивается отдельно для каждого экземпляра сервера следующим образом.
- С помощью приложения отчетов об ошибках и использовании.
- С помощью настройки определенных разделов реестра на сервере.

См. дополнительные сведения об [отзывах клиентов SQL Server в Linux](https://docs.microsoft.com/sql/linux/sql-server-linux-customer-feedback).

> [!NOTE]
> Вы можете отключить отправку данных в корпорацию Майкрософт только в платной версии SQL Server.

## <a name="error-and-usage-reporting-application"></a>Приложение отчетов об ошибках и использовании 

После завершения установки вы можете изменить параметры сбора данных об использовании для компонентов и экземпляров SQL Server с помощью приложения отчетов об ошибках и использовании. Это приложение доступно как часть установки SQL Server. Это средство позволяет настроить параметры использования данных отдельно для каждого экземпляра SQL Server.

> [!NOTE]
> Приложение отчетов об ошибках и использовании размещается в списке средств настройки SQL Server. Это средство можно использовать для управления настройками, а также сбора отчетов об ошибках и сведений об использовании точно также, как в SQL Server 2017. Отчеты об ошибках создаются отдельно от сбора сведений об использовании, что позволяет включать и отключать эти механизмы отдельно. С отчетом об ошибках в корпорацию Майкрософт отправляются аварийные дампы, которые могут содержать конфиденциальные сведения, как описано в заявлении о конфиденциальности.

Чтобы открыть средство отчетов об ошибках и использовании SQL Server, выберите действие **Запустить** и выполните поиск по слову "ошибка". Вы увидите элемент отчетов об ошибках и использовании SQL Server. Запустив это средство, вы сможете управлять сведениями об использовании и серьезных ошибках, которые собираются для экземпляров и компонентов, установленных на соответствующем компьютере.

В платной версии вы можете использовать флажки "Отчеты об использовании", чтобы управлять отправкой сведений в корпорацию Майкрософт.

Как в платной, так и в бесплатной версиях можно использовать флажки "Отчеты об ошибках", чтобы управлять отправкой сведений о серьезных ошибках и аварийных дампов в корпорацию Майкрософт.

## <a name="set-registry-subkeys-on-the-server"></a>Изменение разделов реестра на сервере

Корпоративные клиенты могут настроить параметры групповой политики, чтобы участвовать или не участвовать в сборе сведений об использовании. Для этого нужно создать политику на основе реестра. Ниже приведены соответствующие подразделы и параметры реестра:

- Для настройки экземпляра SQL Server:
    
    подраздел = HKEY_LOCAL_MACHINE\Software\Microsoft\Microsoft SQL Server\{InstanceID}\CPE;
    
    Имя записи = CustomerFeedback
    
    тип записи DWORD: 0 — не участвовать; 1 — участвовать.
    
    {InstanceID} указывает тип экземпляра и сам экземпляр, как показано в следующих примерах:

    - MSSQL14.CANBERRA обозначает ядро СУБД SQL Server 2017 и имя экземпляра CANBERRA;
    - MSAS14.CANBERRA обозначает ядро СУБД SQL Server 2017 Analysis Services и имя экземпляра CANBERRA;
    - MSRS14.CANBERRA обозначает ядро СУБД SQL Server 2017 Reporting Services и имя экземпляра CANBERRA.

- Для всех общих компонентов:
    
    подраздел = HKEY_LOCAL_MACHINE\Software\Microsoft\Microsoft SQL Server\{Major Version};
    
    Имя записи = CustomerFeedback
    
    тип записи DWORD: 0 — не участвовать; 1 — участвовать.

> [!NOTE]
> {Major Version} обозначает основную версию SQL Server, например 140 для SQL Server 2017.

- Для среды SQL Server Management Studio:
  
    Подраздел = HKEY_CURRENT_USER\Software\Microsoft\Microsoft SQL Server\140;

    Имя записи = CustomerFeedback

    тип записи DWORD: 0 — не участвовать; 1 — участвовать.

    Кроме того, среда SSMS 17.x основана на оболочке Visual Studio 2015, а в экземпляре Visual Studio функция сбора отзывов пользователей включена по умолчанию.  

    Чтобы отключить сбор отзывов пользователей в Visual Studio на отдельных компьютерах, измените значение следующего подраздела реестра на строку "0":  
    HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\VisualStudio\SQM OptIn

    Например, измените подраздел следующим образом:  
    HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\VisualStudio\SQM OptIn="0")

    Групповая политика на базе реестра с этими подразделами будет соблюдаться системой сбора данных об использовании SQL Server 2017.

## <a name="set-registry-subkeys-for-crash-dump-collection"></a>Настройка подразделов реестра для сбора аварийных дампов

Как и в более ранней версии SQL Server, корпоративные клиенты SQL Server 2017 могут настроить параметры групповой политики на сервере, чтобы участвовать или не участвовать в сборе аварийных дампов. Для этого нужно создать политику на основе реестра. Ниже приведены соответствующие подразделы и параметры реестра: 

- Для настройки экземпляра SQL Server:

    подраздел = HKEY_LOCAL_MACHINE\Software\Microsoft\Microsoft SQL Server\{InstanceID}\CPE;

    имя RegEntry = EnableErrorReporting;

    тип записи DWORD: 0 — не участвовать; 1 — участвовать.
 
    {InstanceID} указывает тип экземпляра и сам экземпляр, как показано в следующих примерах: 

    - MSSQL14.CANBERRA обозначает ядро СУБД SQL Server 2017 и имя экземпляра CANBERRA;
    - MSAS14.CANBERRA обозначает ядро СУБД SQL Server 2017 Analysis Services и имя экземпляра CANBERRA;
    - MSRS14.CANBERRA обозначает ядро СУБД SQL Server 2017 Reporting Services и имя экземпляра CANBERRA.
 

- Для всех общих компонентов:
    
    подраздел = HKEY_LOCAL_MACHINE\Software\Microsoft\Microsoft SQL Server\{Major Version};

    имя RegEntry = EnableErrorReporting;

    тип записи DWORD: 0 — не участвовать; 1 — участвовать.

> [!NOTE]
> {Major Version} обозначает основную версию SQL Server. Например, 140 соответствует версии SQL Server 2017.

Групповая политика на базе реестра с этими подразделами будет соблюдаться системой сбора аварийных дампов SQL Server 2017. 

## <a name="crash-dump-collection-for-ssms"></a>Сбор аварийных дампов для SSMS
Среда SSMS не собирает отдельные аварийные дампы. Все аварийные дампы, связанные с SSMS, собираются единой системой сбора отчетов об ошибках Windows.

Процедура, позволяющая включить или отключить эту функцию, будет разной в разных версиях операционной системы. Чтобы включить или отключить эту функцию, выполните инструкции, соответствующие вашей версии Windows.
 
- Windows Server 2016 и Windows 10

    [Configure Windows telemetry in your organization](https://technet.microsoft.com/en-us/itpro/windows/manage/configure-windows-telemetry-in-your-organization) (Настройка телеметрии Windows в вашей организации)
- Windows Server 2008 R2 и Windows 7

    [WER Settings](https://msdn.microsoft.com/en-us/library/windows/desktop/bb513638(v=vs.85).aspx) (Параметры отчетов об ошибках Windows)
 
## <a name="feedback-for-analysis-services"></a>Сбор информации для Analysis Services

Во время установки SQL Server 2016 Analysis Services добавляет в экземпляр служб Analysis Services специальную учетную запись. Эта учетная запись является членом роли администратора на сервере Analysis Services. Она используется для сбора сведений от экземпляра служб Analysis Services.  

В настройках службы можно отказаться от отправки сведений об использовании, как описано в инструкциях по изменению разделов реестра на сервере. При этом учетная запись службы не удаляется. 
 
[!INCLUDE[get-help-options](../includes/paragraph-content/get-help-options.md)]
