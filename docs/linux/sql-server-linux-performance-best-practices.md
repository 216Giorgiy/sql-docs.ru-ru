---
title: "Рекомендации по производительности для SQL Server для Linux | Документы Microsoft"
description: "В этом разделе предоставляют рекомендации по производительности и рекомендации по запуску 2017 г. SQL Server в Linux."
author: rgward
ms.author: bobward
manager: jhubbard
ms.date: 09/14/2017
ms.topic: article
ms.prod: sql-non-specified
ms.prod_service: database-engine
ms.service: 
ms.component: linux
ms.suite: sql
ms.custom: 
ms.technology: database-engine
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: 834bba08c90262fd72881ab2890abaaf7b8f7678
ms.openlocfilehash: 18d40800ee74783b0ce3df4d9d4e0458fbb72ebb
ms.contentlocale: ru-ru
ms.lasthandoff: 10/02/2017

---

# <a name="performance-best-practices-and-configuration-guidelines-for-sql-server-2017-on-linux"></a>Рекомендации по производительности и рекомендации по конфигурации для 2017 г. SQL Server в Linux

В этом разделе содержатся советы и рекомендации для повышения производительности для приложений баз данных, которые подключаются к SQL Server в Linux. Эти рекомендации относятся к работе на платформе Linux. Все обычные рекомендации по SQL Server, такие как Проектирование индекса, продолжают действовать.

Следующие правила содержат рекомендации по настройке SQL Server и операционной системы Linux.

## <a name="sql-server-configuration"></a>Конфигурация SQL Server

Рекомендуется выполнить следующие задачи настройки после установки SQL Server в Linux для достижения наилучшей производительности для вашего приложения.

### <a name="best-practices"></a>Рекомендации

- **Используйте СХОДСТВО ПРОЦЕССОВ для узел и/или процессоров**

   Рекомендуется использовать `ALTER SERVER CONFIGURATION` для задания `PROCESS AFFINITY` для всех **NUMANODEs** и/или процессоров вы используете для SQL Server (как правило для всех узлов и ЦП) в операционной системе Linux. Соответствие процессоров позволяет обеспечить эффективное поведение Linux и планирования SQL. С помощью **NUMANODE** параметр — самый простой метод. Обратите внимание, что следует использовать **СХОДСТВО ПРОЦЕССОВ** даже при наличии только на одном узле NUMA на компьютере.  В разделе [ALTER SERVER CONFIGURATION](../t-sql/statements/alter-server-configuration-transact-sql.md) документации Дополнительные сведения о том, как задать **СХОДСТВО ПРОЦЕССОВ**.

- **Настройка нескольких файлов данных tempdb**

   SQL Server в Linux установки не предлагает параметр, чтобы настроить несколько файлов tempdb, поэтому рекомендуется рассмотреть создание файлов данных tempdb несколько после установки. Дополнительные сведения см. в разделе инструкции из статьи [рекомендации, чтобы уменьшить число конфликтов выделения в базе данных tempdb SQL Server](https://support.microsoft.com/en-us/help/2154845/recommendations-to-reduce-allocation-contention-in-sql-server-tempdb-d).

### <a name="advanced-configuration"></a>Расширенная конфигурация

Следующие рекомендации, дополнительные параметры конфигурации, нужно выполнить после установки SQL Server в Linux. Эти параметры основаны на требования рабочей нагрузки и конфигурации вашей операционной системы Linux.

- **Задать ограничение памяти с mssql conf**

   Чтобы убедиться, что имеется достаточно свободной физической памяти для операционной системы Linux, процесс SQL Server по умолчанию использует только 80% физической памяти. Для некоторых систем, в которой большой объем физической памяти может быть 20% со значительным числом. Например в системе с 1 ТБ ОЗУ по умолчанию останется примерно 200 ГБ ОЗУ неиспользуемые. В этом случае может потребоваться настроить предел памяти, более высокое значение. См. в документации на **mssql conf** средства и [memory.memorylimitmb](sql-server-linux-configure-mssql-conf.md#memorylimit) Настройка, управляет видимым для SQL Server (в единицах МБ) памяти.

   При изменении этого параметра нужно не это значение слишком велико. Если вы не оставляют достаточно памяти, могут возникнуть проблемы с ОС Linux и другие приложения Linux.

## <a name="linux-os-configuration"></a>Конфигурация операционной системы Linux

Рекомендуется использовать следующие параметры конфигурации операционной системы Linux в работе Наилучшая производительность для установки SQL Server.

### <a name="kernel-settings-for-high-performance"></a>Параметры ядра для повышения производительности

Это рекомендуемый операционной системы Linux настройки для высокого уровня производительности и пропускной способности для установки SQL Server. Обратитесь к документации операционной системы Linux процесс настройки этих параметров.



> [!Note]
> Для пользователей, Red Hat Enterprise Linux (RHEL) производительность и пропускную способность профиль будет настроить эти параметры автоматически (за исключением C-состояния).

В следующей таблице приведены рекомендации по установке параметров ЦП:

| Настройка | Значение | Дополнительные сведения |
|---|---|---|
| Регулятор частота ЦП | производительность | В разделе **cpupower** команды |
| ENERGY_PERF_BIAS | производительность | В разделе **x86_energy_perf_policy** команды |
| min_perf_pct | 100 | Обратитесь к документации intel p-состояния |
| C-состояния | Только C1 | Обратитесь к документации Linux или системе о том, как обеспечить C-состояния имеет значение C1 только |

В следующей таблице приведены рекомендации для настройки диска:

| Настройка | Значение | Дополнительные сведения |
|---|---|---|
| предварительно считанных с диска | 4096 | В разделе **blockdev** команды |
| Параметры sysctl | kernel.sched_min_granularity_ns = 10000000<br/>kernel.sched_wakeup_granularity_ns = 15000000<br/>VM.dirty_ratio = 40<br/>VM.dirty_background_ratio = 10<br/>VM.swappiness=10 | В разделе **sysctl** команды |

### <a name="kernel-setting-auto-numa-balancing-for-multi-node-numa-systems"></a>Ядра параметр auto numa балансировки для систем несколькими узлами NUMA

При установке SQL Server на многоузловой **NUMA** систем, следующие **kernel.numa_balancing** ядра включен по умолчанию. Чтобы разрешить SQL Server для работы с максимальной эффективностью на **NUMA** системы балансировки в системе NUMA несколькими узлами numa автоматически отключить:

```bash
sysctl -w kernel.numa_balancing=0
```

### <a name="kernel-settings-for-virtual-address-space"></a>Параметры ядра для виртуального адресного пространства

Значение по умолчанию **vm.max_map_count** (то есть 65536) не может быть достаточным для установки SQL Server. Измените это значение, (который верхний предел) до 256 КБ.

```bash
sysctl -w vm.max_map_count 262144
```

### <a name="disable-last-accessed-datetime-on-file-systems-for-sql-server-data-and-log-files"></a>Отключить доступ к которым осуществляется Дата и время последнего в файловых системах для файлов данных и журналов SQL Server

Используйте **noatime** атрибута с какой файловой системы, который используется для хранения данных SQL Server и файлов журнала. Обратитесь к документации Linux о том, как присвоить этому атрибуту.

### <a name="leave-transparent-huge-pages-thp-enabled"></a>Оставьте прозрачный огромный страниц (THP) включена

В большинстве установок Linux должен использовать этот параметр на по умолчанию. Мы рекомендуем для более согласованной работы оставить этот параметр конфигурации включен.

### <a name="swapfile"></a>файла подкачки

Убедитесь, что у вас есть правильно настроенного файла подкачки во избежание проблем нехватки памяти. Обратитесь к документации Linux для создания и правильно задать размер файла подкачки.

### <a name="virtual-machines-and-dynamic-memory"></a>Виртуальные машины и динамическая память

Если вы используете SQL Server в Linux на виртуальной машине, убедитесь, что выбор варианта устранения объем памяти, зарезервированных для виртуальной машины. Не используйте средства, как динамическая память Hyper-V.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о возможностях SQL Server, которые повышают производительность см. в разделе [приступить к работе с функциями производительности](sql-server-linux-performance-get-started.md).

Дополнительные сведения о SQL Server в Linux см. в разделе [Обзор SQL Server в Linux](sql-server-linux-overview.md).

