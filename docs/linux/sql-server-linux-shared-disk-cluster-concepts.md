---
title: "Экземпляры отказоустойчивого кластера — SQL Server для Linux | Документы Microsoft"
description: 
author: MikeRayMSFT
ms.author: mikeray
manager: jhubbard
ms.date: 08/28/2017
ms.topic: article
ms.prod: sql-non-specified
ms.prod_service: database-engine
ms.service: 
ms.component: linux
ms.suite: sql
ms.custom: 
ms.technology: database-engine
ms.assetid: 
ms.workload: Inactive
ms.openlocfilehash: 36c5b7ccd0cc8c3a56dca700469fb4fd05fa2871
ms.sourcegitcommit: 7f8aebc72e7d0c8cff3990865c9f1316996a67d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2017
---
# <a name="failover-cluster-instances---sql-server-on-linux"></a>Экземпляры отказоустойчивого кластера — SQL Server в Linux

В этой статье объясняется понятия, связанные с SQL Server экземпляры отказоустойчивого кластера (FCI) в Linux. 

Для создания отказоустойчивого Кластера SQL Server в Linux см [Настройка FCI SQL Server в Linux](sql-server-linux-shared-disk-cluster-configure.md)

## <a name="the-clustering-layer"></a>Уровень кластеризации

* В RHEL, уровень кластеризации основана на Red Hat Enterprise Linux (RHEL) [высокого уровня ДОСТУПНОСТИ надстройки](https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/pdf/High_Availability_Add-On_Overview/Red_Hat_Enterprise_Linux-6-High_Availability_Add-On_Overview-en-US.pdf). 

    > [!NOTE] 
    > Доступ к Red Hat HA надстройки и документации требует подписку. 

* В SLES, уровень кластеризации зависит SUSE Linux Enterprise [высокий уровень доступности расширения (для которых Имеется)](https://www.suse.com/products/highavailability).

    Дополнительные сведения о конфигурации кластера, параметры агента ресурсов, управления, советы и рекомендации см. в разделе [SUSE Linux Enterprise высокого уровня доступности расширения 12 SP2](https://www.suse.com/documentation/sle-ha-12/index.html).

Надстройка RHEL высокой ДОСТУПНОСТИ и для которых Имеется SUSE построены на [Pacemaker](http://clusterlabs.org/).

В диаграмме ниже показан хранилище представляется двумя серверами. Кластерные компоненты - Corosync и Pacemaker - координировать связи и управление ресурсами. Один из серверов имеет активное подключение к ресурсам хранилища и SQL Server. Когда Pacemaker обнаруживает сбой кластеризации компоненты управления перемещения ресурсов на другой узел.  

![Red Hat Enterprise Linux 7 общий диск кластера SQL](./media/sql-server-linux-shared-disk-cluster-red-hat-7-configure/LinuxCluster.png) 


> [!NOTE]
> На этом этапе интеграции SQL Server с Pacemaker в Linux не, а также как WSFC в Windows. Из в SQL, неизвестно о наличии кластера, все orchestration находится за пределами в и служба управляется как отдельный экземпляр Pacemaker. Кроме того имя виртуальной сети доступен только в WSFC, не имеет эквивалента в одной и той же в Pacemaker. Ожидается, что @@servername и sys.servers для возврата имени узла, а sys.dm_os_cluster_nodes кластера динамических административных представлений и sys.dm_os_cluster_properties нет записей. Чтобы использовать строку подключения, указывающая на строку имя сервера и не используйте IP-адрес, они будут иметь для регистрации в своих DNS-сервера IP-адрес, используемый для создания виртуального IP-ресурс (как описано ниже) с именем выбранного сервера.

## <a name="number-of-instances-and-nodes"></a>Количество экземпляров и узлы

С SQL Server в Linux ключа отличие заключается в том, что может существовать только одна установка SQL Server на сервер Linux. Установки называется экземпляр. Это означает, что в отличие от Windows Server, который поддерживает до 25 FCI на один отказоустойчивый кластер Windows Server (WSFC), отказоустойчивого Кластера под управлением Linux будет иметь только один экземпляр. Это один экземпляр также является экземпляром по умолчанию; отсутствует понятие именованного экземпляра в Linux. 

Pacemaker кластера может иметь только до 16 узлов при Corosync участвует, поэтому одного отказоустойчивого Кластера может занимать до 16 серверов. FCI реализуется с помощью стандартный выпуск SQL Server поддерживает до двух узлах кластера, даже если у кластера Pacemaker максимум 16 узлов.

В отказоустойчивого Кластера SQL Server экземпляр SQL Server активен на одном узле или другой.

## <a name="ip-address-and-name"></a>IP-адрес и имя
В кластере Linux Pacemaker каждого SQL Server FCI потребуется свой собственный уникальный IP-адрес и имя. Если в конфигурацию FCI распространяется на несколько подсетей, один IP-адрес требуется каждой подсети. Уникальное имя и IP-адреса используются для доступа к FCI, поэтому приложений и пользователей не требуется знать, какой базовый сервер Pacemaker кластера.

Имя отказоустойчивого Кластера, в DNS должны совпадать с имя ресурса отказоустойчивого Кластера, который создается в кластере Pacemaker.
Имя и IP-адреса должны регистрироваться в DNS.

## <a name="shared-storage"></a>Общее хранилище
Все экземпляры отказоустойчивого кластера, являются ли они в Linux или Windows Server требуются некоторые формы общего хранилища. Для всех серверов, которые можно разместить возможно FCI выводится это хранилище, но только один сервер можно использовать хранилище для FCI в любой момент времени. Доступны следующие параметры, доступные в качестве общего хранилища в Linux.

- iSCSI
- Сетевой файловой системы (NFS)
- Server Message Block (SMB) в Windows Server, существует несколько различных параметров. Один из вариантов не поддерживается для отказоустойчивые кластеры под управлением Linux — возможность использовать диск, который является локальным для узла для базы данных TempDB, являющийся временную рабочую область SQL Server.

В конфигурации, которая охватывает несколько расположений сохраняемые в одном центре обработки данных должны быть синхронизированы с другими. При отработке отказа FCI смогут подключится к сети и хранилища отображается должны совпадать. Для этого потребуются некоторые внешнего метода для репликацию хранилища ли он выполняется через аппаратным обеспечением хранилища или некоторые служебная программа на основе программного обеспечения. 

>[!NOTE]
>Для SQL Server 2017 г развертывания на основе Linux с помощью представлены непосредственно на сервере таких дисков должен быть отформатирован XFS или EXT4. В настоящее время не поддерживается других файловых систем. Любые изменения будут отражены здесь.

Для предоставления общего хранилища выполняется одинаково для различных поддерживаемых методов.

- Настройка общего хранилища
- Подключить хранилище в качестве папки для серверов, которые будет использовать в качестве узлов кластера Pacemaker FCI
- Если требуется, переместите системные базы данных SQL Server в общее хранилище
- Тест, который SQL Server работает на каждом сервере, подключенной к общему хранилищу

— Одно из основных отличий с SQL Server в Linux, хотя можно настроить расположение файла данных и журналов пользователя по умолчанию, системные базы данных всегда должна существовать в `/var/opt/mssql/data`. В Windows Server имеется возможность перемещение системных баз данных, включая базы данных TempDB. Этот факт играет в том, как общее хранилище, настроенного для экземпляра отказоустойчивого Кластера.

Путь по умолчанию для несистемных базах данных можно изменить с помощью `mssql-conf` программы. Сведения о том, как изменить значения по умолчанию [изменить расположение каталога данных или журнала по умолчанию](sql-server-linux-configure-mssql-conf.md#datadir). Можно также хранить данные SQL Server и транзакции в других расположениях, при условии, что они имеют соответствующие безопасности, даже если он не находится в расположении по умолчанию; необходимо указать расположение.

В следующих разделах Настройка поддерживаемые типы хранилища для отказоустойчивого Кластера SQL Server, на основе Linux:

- [Настройка экземпляра отказоустойчивого кластера — iSCSI - SQL Server в Linux](sql-server-linux-shared-disk-cluster-configure-iscsi.md)
- [Настроить экземпляр отказоустойчивого кластера — NFS - SQL Server в Linux](sql-server-linux-shared-disk-cluster-configure-nfs.md)
- [Настройте экземпляр отказоустойчивого кластера — SMB - SQL Server в Linux](sql-server-linux-shared-disk-cluster-configure-smb.md)
