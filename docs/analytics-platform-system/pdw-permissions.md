---
title: Разрешения в параллельное хранилище данных | Документы Microsoft
description: В этой статье описываются требования и возможности для управления разрешений базы данных для параллельного хранилища данных.
author: mzaman1
manager: craigg
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: 16ed81d3349cd1e641a66a95d9993e2a86ca4098
ms.sourcegitcommit: 056ce753c2d6b85cd78be4fc6a29c2b4daaaf26c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/19/2018
---
# <a name="managing-permissions-in-parallel-data-warehouse"></a>Управление разрешениями в Parallel Data Warehouse
В этой статье описываются требования и возможности управления для SQL Server PDW разрешения базы данных.  
  
## <a name="BackupRestoreBasics"></a>Основы разрешение ядра базы данных  
Разрешениями Database Engine в SQL Server PDW управляются на уровне сервера с помощью имен входа, а также на уровне базы данных с помощью пользователей и ролей базы данных, определяемых пользователем.  
  
**Имена входа**  
Имена входа будут отдельных учетных записей пользователей для входа в систему SQL Server PDW. SQL Server PDW поддерживает имена входа с использованием проверки подлинности SQL Server и проверка подлинности Windows.  Имена входа для проверки подлинности Windows может быть пользователей Windows или группы Windows из любого домена, который является доверенным для SQL Server PDW. Определенные имена входа SQL Server и проверку подлинности SQL Server PDW и должны создаваться, указав пароль.  
  
Члены **sysadmin** предопределенной роли сервера (таких как **sa** входа) можно подключиться к базе данных без необходимости, сопоставленного с пользователем базы данных. Они сопоставляются с **dbo** пользователя. Владелец базы данных также сопоставлен как **dbo** пользователя.  
  
**Роли сервера**  
Есть четыре роли специальной серверной набор предварительно настроенных ролей, представляет собой удобную группу разрешений на уровне сервера. **Sysadmin**, **MediumRC**, **LargeRC**, и **XLargeRCfixed** роли, сервер только роли, действующие в настоящее время в SQL Server PDW. **Sa** входа является единственным членом **sysadmin** предопределенной роли сервера и дополнительные учетные данные невозможно добавить **sysadmin** роли. Имена входа могут быть предоставлены **CONTROL SERVER** разрешение, которое выполняется аналогично, если не идентичны, **sysadmin** предопределенной роли сервера. Используйте [ALTER SERVER ROLE](../t-sql/statements/alter-server-role-transact-sql.md) на добавление членов в других ролей сервера. SQL Server PDW не поддерживает определяемых пользователем ролей сервера.  
  
**Пользователи базы данных**  
Именам входа доступ к базе данных предоставляется путем создания пользователя базы данных в базе данных и сопоставления этого пользователя базы данных с именем входа. Как правило, имя пользователя базы данных совпадает с именем входа, хотя это и необязательно. Один пользователь базы данных сопоставляется с одним именем входа. Имя входа может быть сопоставлено только с одним пользователем в базе данных, однако может сопоставляться как пользователь базы данных в нескольких базах данных.  
  
**Предопределенные роли базы данных**  
Предопределенные роли базы данных — это набор предварительно настроенных ролей, которые представляет собой удобную группу разрешений на уровне базы данных. Пользователям и ролям базы данных определяемого пользователем можно добавить предопределенные роли базы данных с помощью [sp_addrolemember](../relational-databases/system-stored-procedures/sp-addrolemember-transact-sql.md) процедуры. Дополнительные сведения о предопределенных ролей базы данных см. в разделе [фиксированной роли базы данных](#fixed-database-roles).  
  
**Роли базы данных, определяемых пользователем**  
Пользователи с **CREATE ROLE** разрешений можно создать новые пользовательские базы данных роли для представления групп пользователей с общими разрешениями. Обычно разрешения предоставляются или отклоняются для всей роли, что упрощает управление разрешениями и мониторинг.  
  
Разрешения предоставляются субъектам безопасности (имена входа, пользователей и ролей) с помощью **GRANT** инструкции. Разрешения явно отклоняются с помощью **DENY** команды. С помощью удаления ранее предоставленного или отклоненного разрешения **ОТОЗВАТЬ** инструкции. Разрешения накапливаются, то есть пользователь получает все разрешения, предоставленные пользователю, имени входа и любой группе, членом которой он является. При этом отклонение разрешения отменяет все предоставленные ранее разрешения. <!-- MISSING LINKS (For information, syntax, and available permissions with these commands, see [Permissions: GRANT, DENY, REVOKE &#40;SQL Server PDW&#41;](../sqlpdw/permissions-grant-deny-revoke-sql-server-pdw.md)).  -->  
  
В следующем примере представлен типичный и рекомендуемый способ настройки разрешений.  
  
1.  При использовании проверки подлинности Windows, создайте имя входа для каждого пользователя Windows или группы Windows, который будет подключаться к SQL Server PDW. Если используется проверка подлинности SQL Server, создайте имя входа для всех пользователей, которые будут подключаться к SQL Server PDW.  
  
2.  Создание пользователя базы данных для каждого имени входа в все необходимые базы данных.  
  
3.  Создайте одну или несколько ролей базы данных, определяемых пользователем, представляющих аналогичные функции. Например, финансовый аналитик и аналитик продаж.  
  
4.  Добавьте пользователей базы данных в одну или несколько ролей базы данных, определяемых пользователем.  
  
5.  Предоставьте разрешения для определяемых пользователем ролей базы данных.  
  
Имена входа являются объектами уровня сервера и могут быть перечислены, просмотрев [sys.server_principals](../relational-databases/system-catalog-views/sys-server-principals-transact-sql.md). Только разрешения уровня сервера могут предоставляться для участников на уровне сервера.  
  
Пользователи и роли базы данных являются объектами уровня базы данных и могут быть перечислены, просмотрев [sys.database_principals](../relational-databases/system-catalog-views/sys-database-principals-transact-sql.md). Разрешения уровня базы данных могут предоставляться, только для участников базы данных.  
  
## <a name="BackupTypes"></a>Разрешения по умолчанию  
Разрешения по умолчанию приведены в следующем списке:  
  
-   При создании имени входа с директивами using **CREATE LOGIN** инструкция, имя входа получает **CONNECT SQL** разрешение имени входа разрешение на подключение к SQL Server PDW.  
  
-   При создании пользователя базы данных с помощью **CREATE USER** инструкции, пользователь получает **CONNECT ON DATABASE:: *** < имя_базы_данных >* разрешений, что имя входа для подключения к базе данных как пользователь.  
  
-   Всех участников, включая роль PUBLIC, не имеют явных и неявных разрешений по умолчанию, так как неявные разрешения, унаследованные от явных разрешений. Таким образом при наличии нет явных разрешений, может существовать без неявные разрешения.  
  
-   Если имя входа, становится владельцем объекта или базы данных, имя входа всегда имеет все разрешения на объект или базы данных. Разрешения владельца не отображаются как явные разрешения. **GRANT**, **ОТОЗВАТЬ**, и **DENY** инструкции не оказывают влияния на разрешения на владение. Владение можно изменить с помощью [ALTER AUTHORIZATION](../t-sql/statements/alter-authorization-transact-sql.md) инструкции.  
  
-   Имя входа sa имеет все разрешения на устройстве. Подобно разрешения владельца, разрешения sa не может быть изменено и не отображаются как явные разрешения. **GRANT**, **ОТОЗВАТЬ**, и **DENY** инструкции не оказывают влияния на разрешения системного администратора.  
  
-   Роли сервера PUBLIC получает никаких разрешений по умолчанию и не наследует разрешения от других ролей сервера. Роли сервера PUBLIC можно предоставить явные разрешения с **GRANT**, **ОТОЗВАТЬ**, и **DENY** инструкции.  
  
-   Транзакции не требуют разрешения. Можно запустить всех участников **BEGIN TRANSACTION**, **ЗАФИКСИРОВАТЬ**, и **ОТКАТА** команды транзакций. Однако участник должен иметь соответствующие разрешения для выполнения каждой инструкции в рамках транзакции.  
  
-   Для использования инструкции **USE** не требуются разрешения. Всем участникам можно запустить **используйте** инструкции в любой базе данных, однако для доступа к базе данных они должны иметь участника-пользователя в базе данных или пользователь-Гость необходимо включить.  
  
### <a name="the-public-role"></a>Роли PUBLIC  
Всех новых имен входа устройства автоматически принадлежит роли PUBLIC. Роли сервера PUBLIC имеет следующие характеристики:  
  
-   Роли сервера PUBLIC не имеет разрешений по умолчанию.  
  
-   Все участники являются членами роли сервера PUBLIC и роли сервера PUBLIC не является членом другой роли сервера.  
  
-   Роли сервера PUBLIC не может наследовать неявные разрешения. Должны явно предоставлены все разрешения, предоставляемые роли PUBLIC.  
  
## <a name="BackupProc"></a>Определение разрешений  
Ли имя входа имеет разрешение на выполнение определенного действия зависит от разрешения предоставлены или запрещены для имени входа, пользователей и роли, в которой находится пользователь. Разрешения уровня сервера (таких как **CREATE LOGIN** и **VIEW SERVER STATE**) доступны для участников уровня сервера (имена входа). Разрешения на уровне базы данных (таких как **ВЫБЕРИТЕ** из таблицы или **EXECUTE** на процедуру) доступны для участников уровня базы данных (пользователи и роли базы данных).  
  
### <a name="implicit-and-explicit-permissions"></a>Явные и неявные разрешения  
*Явное разрешение* — это разрешение **GRANT** или **DENY**, предоставляемое субъекту с помощью инструкции **GRANT** или **DENY**. Разрешения уровня базы данных, перечислены в [sys.database_permissions](../relational-databases/system-catalog-views/sys-database-permissions-transact-sql.md) представления. Разрешения уровня сервера перечислены в [sys.server_permissions](../relational-databases/system-catalog-views/sys-server-permissions-transact-sql.md) представления.  
  
*Неявное разрешение* — **GRANT** или **DENY** разрешение, которое унаследовали субъекта (имя входа или роль сервера). Разрешения могут быть унаследованы одним из следующих способов.  
  
-   Участник может наследовать разрешения из роли, если участник является членом роли, даже если участник не имеет явно **GRANT** или **DENY** разрешение.  
  
-   Участник может наследовать разрешения на объект более низкого уровня (например, таблицы), если участник имеет разрешение на одной из областей родительские объекты (например, схема таблицы либо разрешение для всей базы данных).  
  
-   Участник может наследовать разрешения наличием разрешение, которое включает подчиненного разрешение. Например **ALTER ANY USER** разрешение включает в себя **CREATE USER** и **ALTER ON USER:: ***<name>*  разрешения.  
  
### <a name="determining-permissions-when-performing-actions"></a>При выполнении действий, определение разрешений  
В процессе определения разрешений для назначения участника является сложным. Сложность возникает при определении неявные разрешения, потому что участники могут входить несколько ролей и разрешений могут передаваться через несколько уровней в иерархии роли.  
  
Ниже описаны общие правила для определения разрешений.  
  
-   Владение предполагает разрешение.  
  
    Владелец объекта имеет все разрешения на объект. Аналогичным образом владелец базы данных имеет все разрешения в базе данных и все разрешения на объекты в базе данных. Эти разрешения нельзя изменить.  
  
-   Разрешения могут наследоваться по нескольким уровням в иерархии членство в роли сервера.  
  
    Например предположим, что у вас есть следующие ситуации:  
  
    -   Дэвид имя входа является членом роли базы данных PerfAnalysts.  
  
    -   PerfAnalysts является членом роли базы данных рабочей среде.  
  
    -   Дэвид и PerfAnalysts не имеют **ВЫБЕРИТЕ** разрешения для таблицы Customer. Разрешение была отозван или явно не предоставлено.  
  
    -   Производство имеет **ВЫБЕРИТЕ** разрешения для таблицы Customer.  
  
    В этом случае будет наследовать PerfAnalysts **GRANT** будет наследовать разрешения для таблицы Customer из производства и Дэвид **GRANT** разрешения для таблицы Customer из рабочей среды.  
  
-   **Запретить** переопределяет **GRANT** при разрешения конфликтов.  
  
    Предположим, например, Дэвид имя входа не имеет разрешений для таблицы Customer и входит в две роли базы данных — dbgroup1, имеющая **DENY** разрешений для таблицы Customer и dbgroup2, имеющая **GRANT** разрешение для таблицы Customer. В этом случае будет наследовать Дэвид **DENY** разрешения для таблицы Customer. Это так ли роли приобретенные их разрешения, явно или неявно.  
  
### <a name="auditing-permissions"></a>Аудит разрешения  
Для изучения разрешения пользователя, проверьте следующее.  
  
-   Выполните следующий запрос, чтобы определить, какие имена входа являются системными администраторами.  
  
    ```sql  
    SELECT SPLogins.name, 'is a member of ', SPRoles.name   
    FROM sys.server_role_members AS SRM   
    JOIN sys.server_principals AS SPRoles   
        ON SRM.role_principal_id = SPRoles.principal_id   
    JOIN sys.server_principals AS SPLogins   
        ON SRM.member_principal_id = SPLogins.principal_id;  
    ```  
  
-   Выполните следующий запрос, чтобы определить, какие имена входа предоставлены явные разрешения.  
  
    ```sql  
    SELECT name, 'has the ', state_desc , permission_name, ' permission'  
    FROM sys.server_permissions AS SP  
    JOIN sys.server_principals AS SPRoles   
        ON SP.grantee_principal_id = SPRoles.principal_id;  
    ```  
  
-   Выполните следующий запрос в базе данных пользователя для определения пользователей базы данных, которые являются членами роли базы данных.  
  
    ```sql  
    SELECT DPUsers.name, 'is a member of ', DPRoles.name    
    FROM sys.database_role_members AS DRM  
    JOIN sys.database_principals AS DPRoles   
        ON DRM.role_principal_id = DPRoles.principal_id  
    JOIN sys.database_principals AS DPUsers  
        ON DRM.member_principal_id = DPUsers.principal_id;  
    ```  
  
-   Выполните следующий запрос в пользовательской базе данных, чтобы определить, какие пользователи базы данных и ролей были предоставлены или запрещены особые разрешения. Необходимо будет дополнительные представления запроса, таких как sys.objects и sys.schemas, чтобы определить элементы, описанные с major_id.  
  
    ```sql  
    SELECT DPUsers.name, 'has the ', permission_name,   
    'permission on the item described as class = ', class, 'id = ', major_id  
    FROM sys.database_permissions AS DP  
    JOIN sys.database_principals AS DPUsers  
        ON DP.grantee_principal_id = DPUsers.principal_id;  
    ```  
  
## <a name="RestoreProc"></a>Рекомендации по разрешения базы данных  
  
-   Предоставьте разрешения на самом детальном уровне, который является удобным. Предоставление разрешений на таблицу или разрешения на уровне представления могут оказаться неудобными. Однако предоставление разрешения на уровне базы данных может быть слишком строгие. Если базы данных с помощью схем для определения границ рабочих, возможно, предоставление разрешения на схему является соответствующие баланс на уровне таблицы и уровень базы данных.  
  
-   Предоставление разрешений ролям, а не для пользователей или имена входа. Управление правами с помощью ролей, а не пользователям позволяет легко быстро предоставить или отозвать набор разрешений для пользователя или имени входа, перемещая их в или из роли. Когда функция передает от одного лица, разрешения можно остаются неизменными во время изменения членства в роли на уровне роли.  
  
-   Предоставьте разрешения для ролей на основе функцию задания и более высокого уровня группы ролей, объединяйте роли функция задания, на основе группы компании, выполнив действия.  
  
-   Каждый конечный пользователь должен иметь уникальное имя входа. Не предоставляйте пользователям для совместного использования имен входа. Предоставление имени входа для каждого пользователя гарантирует след аудита и упрощает управление разрешениями.  
  
## <a name="fixed-database-roles"></a>Предопределенные роли базы данных
SQL Server предоставляет предварительно настроенных ролей уровня базы данных (фиксированного), для управления разрешениями на сервере. Предварительно настроенных ролей, исправлены в том, что разрешения, назначенные им изменить нельзя. Также можно создать определяемую пользователем базу данных ролей. Можно изменить разрешения, назначенные ролям базы данных, определяемых пользователем.  
  
Роли являются субъектами безопасности, группирующими других участников. Роли базы данных распространяются от базы данных в своей области разрешений. Пользователи базы данных и других ролей базы данных можно добавить как члены ролей базы данных. Предопределенные роли базы данных невозможно добавить друг с другом. (*Роли* похожи на *группы* в операционной системе Windows.)  
  
Существуют 9 предопределенных ролей базы данных.  
  
-   **db_owner**  
  
-   **db_securityadmin**  
  
-   **db_accessadmin**  
  
-   **db_backupoperator**  
  
-   **db_ddladmin**  
  
-   **db_datawriter**  
  
-   **db_datareader**  
  
-   **db_denydatawriter**  
  
-   **db_denydatareader**  
  
### <a name="permissions-of-the-fixed-database-roles"></a>Разрешения предопределенных ролей базы данных  
Система предопределенных ролей сервера и предопределенные роли базы данных находится устаревших систем, формируемые в 1980's. Предопределенные роли по-прежнему поддерживаются и могут использоваться в средах, где несколько пользователей и требования к безопасности являются простыми. Начиная с SQL Server 2005, был создан более подробные системы предоставления разрешений. Это новая система более детализированные, предоставляя множество дополнительных возможностей для предоставление и запрет разрешений. Дополнительная сложность системы более детального затрудняет для получения сведений, но большинство систем предприятия следует предоставить разрешения, а не с помощью предопределенных ролей. <!-- MISSING LINKS The permissions are discussed and listed in the topic [Permissions: GRANT, DENY, REVOKE &#40;SQL Server PDW&#41;](../sqlpdw/permissions-grant-deny-revoke-sql-server-pdw.md). -->В следующей таблице представлены разрешения, которые связаны с каждой предопределенной роли базы данных. Все разрешения на этом графике SQL Server не доступен (или необходимо) в точках доступа.  
  
![Фиксированные роли базы данных безопасности](./media/pdw-permissions/APS_security_fixed_db_roles.png "APS_security_fixed_db_roles")  
  
### <a name="related-content"></a>См. также  
  
-   Для создания определяемых пользователем ролях см. [CREATE ROLE](../t-sql/statements/create-role-transact-sql.md).  
  
  
## <a name="fixed-server-roles"></a>Предопределенные роли сервера
Предопределенные роли сервера автоматически создаются сервером SQL Server. SQL Server PDW имеет ограниченная реализация предопределенных ролей сервера SQL Server. Только **sysadmin** и **открытый** имеют имена входа пользователей в качестве членов. **Setupadmin** и **dbcreator** ролей используются внутри SQL Server PDW. Невозможно добавить или удалить из любой роли дополнительные члены.  
  
### <a name="sysadmin-fixed-server-role"></a>sysadmin предопределенной роли сервера  
Члены предопределенной роли сервера **sysadmin** могут выполнять любые действия на сервере. **Sa** входа является единственным членом **sysadmin** предопределенной роли сервера. Не удается добавить дополнительные учетные данные **sysadmin** предопределенной роли сервера. Для предоставления разрешения **CONTROL SERVER** требуется членство в предопределенной роли сервера **sysadmin**. В следующем примере предоставляется **CONTROL SERVER** разрешения для имени входа с именем Fay.  
  
```sql  
USE master;  
GO  
GRANT CONTROL SERVER TO Fay;  
```  
  
> [!IMPORTANT]  
> **CONTROL SERVER** разрешение предоставляет практически полный контроль над SQL Server PDW. По возможности предоставьте более детализированные разрешения с именами входа. Например, рассмотрите возможность предоставления **VIEW SERVER STATE**, **ALTER ANY LOGIN**, **VIEW ANY DATABASE**, или **CREATE ANY DATABASE** разрешения.  
  
### <a name="public-server-role"></a>Роли сервера Public  
Все имена входа, можно подключиться к SQL Server PDW является членом **открытый** роли сервера. Все имена входа наследуют разрешения, предоставленные **открытый** любого объекта. Назначать только **открытый** разрешений на объект, если объект должен быть доступен для всех пользователей. Нельзя изменить членство в **открытый** роли.  
  
> [!NOTE]  
> **открытый** реализована не так, как другие роли. Так как все участники сервера являются членами public, членство **открытый** роли не имеют **sys.server_role_members** динамического административного Представления.  
  
### <a name="fixed-server-roles-vs-granting-permissions"></a>Vs предопределенной роли сервера. Предоставление разрешений  
Система предопределенных ролей сервера и предопределенные роли базы данных находится устаревших систем, формируемые в 1980's. Предопределенные роли по-прежнему поддерживаются и могут использоваться в средах, где несколько пользователей и требования к безопасности являются простыми. Начиная с SQL Server 2005, был создан более подробные системы предоставления разрешений. Это новая система более детализированные, предоставляя множество дополнительных возможностей для предоставление и запрет разрешений. Дополнительная сложность системы более детального затрудняет для получения сведений, но большинство систем предприятия следует предоставить разрешения, а не с помощью предопределенных ролей. <!-- MISSING LINKS The permissions are discussed and listed in the topic [Permissions: GRANT, DENY, REVOKE &#40;SQL Server PDW&#41;](../sqlpdw/permissions-grant-deny-revoke-sql-server-pdw.md).  -->  
  
## <a name="related-topics"></a>См. также  
  
- [Предоставление разрешений](grant-permissions.md)

<!-- MISSING LINKS
## See Also  
[Common Metadata Query Examples &#40;SQL Server PDW&#41;](../sqlpdw/common-metadata-query-examples-sql-server-pdw.md)  
-->

