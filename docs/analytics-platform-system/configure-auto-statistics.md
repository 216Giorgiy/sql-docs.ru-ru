---
title: Auto статистики (система платформы аналитики)
description: Описывает статистику автоматически впервые появилось в AU7 системы платформы аналитики.
author: mzaman1
manager: craigg
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/24/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: 1c0f4623adad35ab874330b42aa54f6e1b91d961
ms.sourcegitcommit: fc3cd23685c6b9b6972d6a7bab2cc2fc5ebab5f2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2018
---
# <a name="configure-auto-statistics"></a>Настройка автоматической статистики

Подробные сведения о настройке параллельного хранилища данных для использования автоматической статистики для создания и автоматическое обновление статистики.  Эту возможность можно использовать для усовершенствования планов запросов и таким образом повысить производительность запросов.

**Применяется к:** APS (начиная с AU7)

## <a name="what-are-statistics"></a>Что такое Статистика?
Статистика для оптимизации запросов — это объекты, содержащие статистические сведения о распределении значений в один или несколько столбцов таблицы. Оптимизатор запросов использует статистику для оценки количества элементов или к числу строк в запросе. Эти оценки количества элементов позволяет оптимизатору запросов для создания плана запроса высокого качества. Например, в точках доступа использует оптимизатор запросов MPP, оценки количества элементов для выбора или в случайном порядке реплицировать меньшее из двух таблиц, используемых в предложении join и благодаря этому повысить производительность запросов.  Дополнительные сведения см. в разделе [статистики](../relational-databases/statistics/statistics.md) и [DBCC SHOW_STATISTICS](../t-sql/database-console-commands/dbcc-show-statistics-transact-sql.md)

## <a name="what-are-auto-statistics"></a>Что такое статистика автоматически?
Автоматическое статистики входит статистика, оптимизатор запросов создает и обновляет автоматически, чтобы улучшить план запроса. Статистика становится устаревшей после загрузки, вставляет, обновляет и удаляет операции. Без автоматического статистики нужно собственного анализа, чтобы понять, какие столбцы требуются статистические данные и когда необходимо обновить статистику.

Статистика автоматически включает в себя следующие три параметра: 

### <a name="autocreatestatistics"></a>AUTO_CREATE_STATISTICS
Если автоматическое создание статистики, AUTO_CREATE_STATISTICS равен ON, оптимизатор запросов создает статистику по отдельным столбцам в предикате запроса, при необходимости улучшить оценку количества элементов для плана запроса. Такая статистика по отдельным столбцам создается для столбцов, у которых отсутствует гистограмма в существующем объекте статистики.

### <a name="autoupdatestatistics"></a>AUTO_UPDATE_STATISTICS 
Если включен параметр AUTO_UPDATE_STATISTICS (автоматическое обновление статистики), то оптимизатор запросов определяет, когда статистика может оказаться устаревшей, и обновляет ее, если она используется в запросе. Статистика становится устаревшей, после операций вставки, обновления, удаления или слияния изменяют распределение данных в таблице или индексированном представлении. Оптимизатор запросов определяет, когда статистика может оказаться устаревшей, подсчитывая операции изменения данных с момента последнего обновления статистики и сравнивая количество изменений с пороговым значением. Пороговое значение основано на количестве строк в таблице или индексированном представлении.

### <a name="autoupdatestatisticsasync"></a>AUTO_UPDATE_STATISTICS_ASYNC
Параметр AUTO_UPDATE_STATISTICS_ASYNC, который управляет асинхронным обновлением статистики, определяет, какой режим обновления статистики (синхронный или асинхронный) использует оптимизатор запросов. Параметр обновления статистики асинхронной включено по умолчанию для точек доступа, и оптимизатор запросов обновляет статистику асинхронно. Параметр AUTO_UPDATE_STATISTICS_ASYNC применяется к объектам статистики, создаваемым для индексов, отдельных столбцов в предикатах запросов и статистики, созданные с помощью инструкции CREATE STATISTICS.

## <a name="configuration-settings-for-system-administrators"></a>Параметры конфигурации для системных администраторов
После обновления до APS AU7, автоматическое статистики включено по умолчанию. Системный администратор можно включить или отключить автоматическое статистики с [переключение функции](appliance-feature-switch.md) параметр устройства Configuration Manager.  После включения, пользователи могут изменять параметры Статистика на каждую базу данных.
При изменении любого значения коммутатора компонента необходимо перезапустить службы на точках доступа.

## <a name="change-auto-statistics-settings-on-a-database"></a>Изменить параметры автоматической статистики для базы данных
При включении автоматической статистики системным администратором, можно использовать [инструкции ALTER DATABASE (Parallel Data Warehouse)](/sql/t-sql/statements/alter-database-parallel-data-warehouse) для изменения параметров статистики в базе данных. Если автоматическое переключение функции статистики включено системным администратором, все новые базы данных, созданные после обновления до AU7 будет включено автоматическое статистики. Все базы данных, которые существовали до обновления до AU7 имеют автоматическое статистики отключен. В следующем примере включается автоматическое статистики в существующих myPDW базы данных.

```sql
ALTER DATABASE myPDW SET AUTO_CREATE_STATISTICS ON
ALTER DATABASE myPDW SET AUTO_UPDATE_STATISTICS ON 
ALTER DATABASE myPDW SET AUTO_UPDATE_STATISTICS_ASYNC ON
```
 
Параметр AUTO_UPDATE STATISTICS_ASYNC работает только в том случае, если параметр AUTO_UPDATE_STATISTICS равен ON.  Таким образом, статистика не обновляется при включенном параметре AUTO_UPDATE_STATISTICS OFF и AUTO_UPDATE_STATISTICS_ASYNC имеет значение ON. 

### <a name="error-messages"></a>Сообщения об ошибках
«Этот параметр не поддерживается в PDW», может получать сообщение об ошибке.  Эта ошибка возникает, когда системный администратор не включил автоматическое статистики и попытке задайте автоматического параметров статистики в инструкции ALTER DATABASE. 

### <a name="limitations-and-restrictions"></a>Ограничения
Автоматическое статистики работает не во внешних таблицах. 

### <a name="check-the-current-values"></a>Проверьте текущие значения
Следующий запрос возвращает текущие значения параметров автоматической статистики для всех баз данных.

```sql
SELECT NAME
    , IS_AUTO_CREATE_STATS_ON 
    , IS_AUTO_UPDATE_STATS_ON
    , IS_AUTO_UPDATE_STATS_ASYNC_ON
FROM
    sys.databases;
```

Возвращаемое значение 1 означает со значением параметра находится на, а 0 означает, что параметр выключен. 

## <a name="next-steps"></a>Следующие шаги
Чтобы узнать, как выполняются запросы, см [мониторинга активных запросов](monitoring-active-queries.md)
