---
title: С помощью промежуточной базы данных - Parallel Data Warehouse | Документы Microsoft
description: SQL Server Parallel данных хранилища (PDW) использует промежуточной базы данных для хранения данных временно во время процесса загрузки.
author: mzaman1
manager: craigg
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: 73822c1495fa5f83d9a8ba37325a025999f94530
ms.sourcegitcommit: 056ce753c2d6b85cd78be4fc6a29c2b4daaaf26c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/19/2018
---
# <a name="using-a-staging-database-in-parallel-data-warehouse-pdw"></a>С помощью промежуточной базы данных в хранилище параллельных данных (PDW)
SQL Server Parallel данных хранилища (PDW) использует промежуточной базы данных для хранения данных временно во время процесса загрузки. По умолчанию SQL Server PDW использует целевой базы данных в промежуточной базе данных, что может привести к фрагментации таблицы. Для снижения фрагментации таблицы, можно создать пользовательские промежуточной базы данных. Или, если откат после сбоя загрузки не имеет значения, fastappend, в режиме загрузки позволяют повысить производительность, пропуская временной таблицы и загрузки непосредственно в целевую таблицу.  
  
## <a name="StagingDatabase"></a>Основы баз данных промежуточного хранения  
Объект *промежуточной базы данных* — это созданные пользователем PDW база данных, хранящий данные временно при его загрузке в устройстве. Если для загрузки промежуточной базы данных, устройства сначала копирует данные в промежуточной базе данных и затем копирует данные из временных таблиц в базе данных промежуточной постоянных таблиц в целевой базе данных.  
  
Когда для загрузки промежуточной базы данных не указано, SQL ServerPDW создает временные таблицы в целевой базе данных и использует их для хранения загруженных данных, прежде чем он вставляет загруженных данных в постоянное целевых таблиц.  
  
Если используется нагрузки *режиме fastappend*, SQL ServerPDW пропускает полностью использования временных таблиц и добавляет данные в целевой таблице. В режиме fastappend повышает производительность нагрузки ELT сценариях, где данные загружаются в таблицу, которая является временная таблица с точки зрения приложения. Например ELT процесс может загрузить данные во временную таблицу, обработки данных, очистки и отмене duping и затем вставьте данные в целевую таблицу фактов. В этом случае необязательно для PDW для первой загрузки данных во внутреннюю таблицу временные перед вставкой данных в приложения временную таблицу. В режиме fastappend позволяет избежать шаг дополнительной нагрузки, что значительно повышает производительность нагрузки. Для использования режима fastappend должен использовать режим множественных транзакций, это означает восстановление после сбоя или прерванный нагрузки, обрабатываемых собственного процесса загрузки.  
  
**Преимущества промежуточной базы данных**  
  
Чтобы снизить уровень фрагментации таблицы является основным преимуществом промежуточной базы данных. Если промежуточной базы данных не используется, данные загружаются в временные таблицы в целевой базе данных. Временные таблицы получить создаются и удаляются в целевой базе данных, страницы для временных таблиц и постоянных таблиц становятся с чередованием. Со временем фрагментация таблицы происходит и приводит к снижению производительности. Напротив промежуточной базы данных гарантирует, что временные таблицы создаются и удаляются в отдельные места, чем постоянных таблиц.  
  
**Структуры таблиц базы данных промежуточного хранения**  
  
Структуры хранения для каждой таблицы базы данных зависит от целевой таблицы.  
  
-   Для загрузки на кучу или кластеризованный индекс Промежуточная таблица является кучей.  
  
-   Для загрузки в кластеризованный индекс rowstore Промежуточная таблица имеет кластеризованный индекс rowstore.  
  
## <a name="Permissions"></a>Permissions  
Требуется разрешение CREATE (для создания временной таблицы) в промежуточной базе данных. 

<!-- MISSING LINKS

For more information, see [Grant Permissions to load data](grant-permissions-to-load-data.md).  

-->
  
## <a name="CreatingStagingDatabase"></a>Рекомендации по созданию промежуточной базы данных  
  
1.  Должен быть только один промежуточной базы данных на устройство. Промежуточной базы данных могут совместно использоваться все задания нагрузки по всем базам данных назначения.  
  
2.  Размер промежуточной базы данных зависит от конкретного клиента. Изначально при первом заполнении устройства, промежуточной базы данных должно быть достаточно большим, чтобы вместить заданий начальной загрузки. Эти загрузить задания, как правило, должен быть большим, так как несколько загрузок могут выполняться параллельно. После завершения выполнения заданий начальной загрузки, и система находится в рабочей среде, скорее всего, будут меньше, размер каждого задания нагрузки. Когда загружает малы, можно уменьшить размер промежуточной базы данных для размещения меньшего размера нагрузки. Чтобы уменьшить размер, можно удалить промежуточную базу данных и создайте его заново с сокращенным объемом распределений размер, или можно использовать [инструкции ALTER DATABASE](../t-sql/statements/alter-database-parallel-data-warehouse.md) инструкции.  
  
    При создании в промежуточной базе данных, следуйте приведенным ниже рекомендациям.  
  
    -   Размер реплицируемой таблицы должен быть предполагаемый размер на вычислительном узле, реплицируемых таблиц, которые будут загружаться одновременно. Размер обычно составляет 25 – 30 ГБ.  
  
    -   Таблица распространения размер должен быть предполагаемый размер на устройство, распределенных таблиц, которые будут загружаться одновременно.  
  
    -   Размер журнала является обычно сильно отличается от размера реплицируемой таблицы.  
  
## <a name="Examples"></a>Примеры  
  
### <a name="a-create-a-staging-database"></a>A. Создание промежуточной базы данных 
В следующем примере создается промежуточной базы данных Stagedb, для использования с всех нагрузок на устройстве. Предположим, что оценка, что в пять реплицированных таблицах размера 5 ГБ будет загружаться одновременно. Это параллелизма приводит выделение для реплицированных размер не менее 25 ГБ. Предположим, что можно оценить, что шесть распространять таблицы размеров 100, 200, 400, 500, 500 и 550 ГБ будет загружаться одновременно. Это параллелизма приводит выделения по крайней мере 2250 ГБ для размера распределенные таблицы.  
  
```sql  
CREATE DATABASE Stagedb  
WITH (  
  
    AUTOGROW = ON,  
  
    REPLICATED_SIZE = 25 GB,  
  
    DISTRIBUTED_SIZE = 2250 GB,  
  
    LOG_SIZE = 25 GB  
  
);  
```  

<!-- MISSING LINKS
 
## See Also  
[Common metadata query examples](metadata-query-examples.md)  

-->
  
