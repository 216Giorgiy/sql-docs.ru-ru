---
title: "Режим блокировки (SQL Server PDW)"
author: barbkess
ms.author: barbkess
manager: jhubbard
ms.prod: analytics-platform-system
ms.prod_service: mpp-data-warehouse
ms.service: 
ms.component: 
ms.technology: mpp-data-warehouse
ms.custom: 
ms.date: 01/13/2017
ms.reviewer: na
ms.suite: sql
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: c55c636e-b767-4a0c-8184-be991a10801f
caps.latest.revision: "27"
ms.openlocfilehash: c1cb1b0ec346ff18d40a3ac03e7ba45b37666c98
ms.sourcegitcommit: cc71f1027884462c359effb898390c8d97eaa414
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="locking-behavior"></a>Режим блокировки
SQL Server PDW использует блокировки для обеспечения целостности транзакций и поддержания согласованности баз данных, когда несколько пользователей имеют доступ к данным, в то же время.  
  
## <a name="Basics"></a>Основы блокировки  
**Режимы**  
  
SQL Server PDW поддерживает четыре режима блокировки:  
  
Монопольно  
Монопольная блокировка запрещает запись или чтение из заблокированного объекта до транзакции, удерживающий завершения монопольная блокировка. Без блокировки, любые режима разрешены, пока действует монопольную блокировку. Например DROP TABLE или CREATE DATABASE использовать монопольную блокировку.  
  
Shared  
Совмещаемой блокировки запрещает запуск монопольную блокировку того или иного объекта, но позволяет любыми другими режимами блокировки. Например инструкцию SELECT инициирует совмещаемой блокировки и таким образом позволяет несколько запросов одновременно обращаются к выбранные данные, но запрещает обновление записей, чтение, до завершения выполнения инструкции SELECT.  
  
ExclusiveUpdate  
Блокировка ExclusiveUpdate запрещает запись в объект с блокировкой, но разрешить чтение через совмещаемой блокировки. Другие блокировки не разрешены, пока действует блокировка ExclusiveUpdate. Например резервное копирование и ВОССТАНОВЛЕНИЕ базы данных используйте блокировки монопольного обновления.  
  
SharedUpdate  
Блокировка SharedUpdate запрещает эксклюзивным и ExclusiveUpdate режимов блокировки и позволяет Shared и SharedUpdate режимов блокировки на объект. SharedUpdate изменяет объект, но не ограничивает доступ для чтения к его во время изменения. Например, INSERT и UPDATE использовать блокировка SharedUpdate.  
  
**Классы ресурсов**  
  
Блокировки выдаются на следующие классы объектов: базы данных, СХЕМЫ, ОБЪЕКТА (таблицы, представления или процедуры), приложения (для внутреннего использования), EXTERNALDATASOURCE, EXTERNALFILEFORMAT и SCHEMARESOLUTION (уровень базы данных заблокировать сделанной во время создания, изменения, или Удаление объектов схемы или базы данных пользователей). Эти классы объектов может отображаться в столбце object_type [sys.dm_pdw_waits](../relational-databases/system-dynamic-management-views/sys-dm-pdw-waits-transact-sql.md).  
  
## <a name="Remarks"></a>Общие замечания  
Блокировки могут применяться для баз данных, таблиц или представлений.  
  
SQL Server PDW не реализует все уровни изоляции можно настроить. Он поддерживает уровень изоляции READ_UNCOMMITTED в соответствии с определением стандартом ANSI. Тем не менее, с момента считывания операции выполняются под READ_UNCOMMITTED, очень мало блокирующих операций фактически происходят или привести к конкуренции в системе.  
  
SQL Server PDW зависит от базовой ядра SQL Server для реализации элемента управления блокировок и параллелизма. Если операций определяют базовые взаимоблокировки SQL Server, в том же узле, SQL Server PDW использует возможности обнаружения взаимоблокировок SQL Server и завершается одной из инструкций блокировки.  
  
> [!NOTE]  
> SQL Server не допускает инструкций, ожидающих блокировки, блокировка, новые запросы на блокировку. SQL Server PDW не полностью реализован этот процесс. В SQL Server PDW непрерывного запрашивает новый совмещаемые блокировки иногда может блокировать предыдущего (но ожидающих) запрашивает монопольную блокировку. Например **обновление** (для которой требуются монопольную блокировку) может быть заблокирован совмещаемые блокировки, которые предоставляются для ряда **ВЫБЕРИТЕ** инструкции. Чтобы устранить заблокированного процесса (определить, просмотрев [sys.dm_pdw_waits](../relational-databases/system-dynamic-management-views/sys-dm-pdw-waits-transact-sql.md) динамическому административному Представлению), остановите Отправка новые запросы, пока выполняется монопольная блокировка.  
  
## <a name="lock-definition-table"></a>Таблица определения блокировки  
SQL Server поддерживает следующие типы блокировок. Не все типы блокировки доступны на узле управления, но может произойти на вычислительных узлах.  
  
-   Sch-S (стабильность схемы). Заверяет, что элемент схемы, такой как таблица или индекс, не будет удален до тех пор, пока сеанс связи удерживает блокировку стабильности схемы на данный элемент схемы.  
  
-   Sch-M (изменение схемы). Должен поддерживаться любым сеансом связи, во время которого предполагается изменить схему данного ресурса. Заверяет, что другие сеансы не имеют ссылок на обозначенный объект.  
  
-   S (общая). Удерживающему сеансу предоставлен коллективный доступ к ресурсу.  
  
-   U (обновления). Указывает блокировку обновления, полученную на ресурсы, которые со временем могут быть обновлены. Используется для предотвращения распространенной формы взаимоблокировки, которая происходит, если несколько сеансов блокируют ресурсы для возможного обновления в будущем.  
  
-   X (монопольная). Удерживающему сеансу предоставлен исключительный доступ к ресурсу.  
  
-   (С намерением совмещаемого доступа). Указывает намерение поместить блокировки типа S на некоторые подчиненные ресурсы в иерархии блокировок.  
  
-   IU (с намерением обновления). Указывает намерение поместить блокировки типа U на некоторые подчиненные ресурсы в иерархии блокировок.  
  
-   IX (с намерением монопольного доступа). Указывает намерение поместить блокировки типа X на некоторые подчиненные ресурсы в иерархии блокировок.  
  
-   SIU (общий блокировка с намерением обновления). Указывает коллективный доступ к ресурсу с намерением получения блокировок обновления на подчиненные ресурсы в иерархии блокировок.  
  
-   ШЕСТЬ (коллективная, с намерением монопольного доступа). Указывает коллективный доступ к ресурсу с намерением получения монопольных блокировок на подчиненные ресурсы в иерархии блокировок.  
  
-   UIX (обновления с намерением монопольного доступа). Указывает блокировку обновления ресурса с намерением получения монопольных блокировок на подчиненные ресурсы в иерархии блокировок.  
  
-   BU. Используется для массовых операций.  
  
-   RangeS_S (общий ключевой диапазон и общих блокировка ресурса). Указывает на последовательный просмотр диапазона.  
  
-   RangeS_U (Блокировка разделяемого диапазона ключей и обновляемых ресурсов). Указывает на последовательное сканирование обновления.  
  
-   RangeI_N (Блокировка вставляемого диапазона ключей и Null-ресурсов). Используется для проверки диапазонов, перед тем как вставить новый ключ в индекс.  
  
-   RangeI_S. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и S.  
  
-   RangeI_U. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и U.  
  
-   RangeI_X. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и X.  
  
-   RangeX_S. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и RangeS_S.  
  
-   RangeX_U. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и RangeS_U.  
  
-   RangeX_X (исключающий ключевой диапазон и монопольная блокировка ресурса). Блокировка диалога, используемая во время обновления ключа в диапазоне.  
  
## <a name="see-also"></a>См. также:  
<!-- MISSING LINKS 
[Common Metadata Query Examples &#40;SQL Server PDW&#41;](../sqlpdw/common-metadata-query-examples-sql-server-pdw.md)  
-->
[sys.dm_pdw_waits](../relational-databases/system-dynamic-management-views/sys-dm-pdw-waits-transact-sql.md)  
  
