---
title: "Справочник (Power Pivot для SharePoint) правил работоспособности | Документы Microsoft"
ms.custom: 
ms.date: 03/14/2017
ms.prod: sql-non-specified
ms.prod_service: analysis-services
ms.service: 
ms.component: power-pivot-sharepoint
ms.reviewer: 
ms.suite: sql
ms.technology:
- analysis-services
- analysis-services/multidimensional-tabular
- analysis-services/data-mining
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 47ae04ce-7b9d-49c2-8dbc-bafcb73d4603
caps.latest.revision: "19"
author: Minewiskan
ms.author: owend
manager: kfile
ms.workload: Inactive
ms.openlocfilehash: da1a6f30d5a94efd5aaf9a5fecc5bd4435a49bfd
ms.sourcegitcommit: 44cd5c651488b5296fb679f6d43f50d068339a27
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2017
---
# <a name="health-rules-reference-power-pivot-for-sharepoint"></a>Справочник по правилам для определения работоспособности (Power Pivot для SharePoint)
  Этот справочный раздел описывает правила определения работоспособности SharePoint, которые добавляются приложением [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint. Эти правила служат для сообщения о проблемах с работоспособностью сервера, доступностью или конфигурацией приложения службы [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] или связанного с ним экземпляра служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
 В следующей таблице правила перечислены в порядке, соответствующем порядку правил на странице «Определения правил анализатора исправности» в центре администрирования SharePoint. Настраиваемыми называются правила, для которых можно изменять пороговые значения, вызывающие срабатывание правила. Дополнительные сведения см. в разделе [Настройка правил определения работоспособности PowerPivot](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md). В столбце «Автоматическое восстановление» показано, существует ли встроенное решение проблемы, доступное со страницы «Отчеты о проблемах».  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint &#2013;124; SharePoint 2010|  
  
 **Примечание** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] устанавливает разные наборы правил определения работоспособности для разных версий SharePoint. См. столбец «Версия» в приведенной далее таблице. Также для отображения списка установленных правил можно выполнить следующую команду Windows PowerShell.  
  
```  
Get-SPHealthAnalysisRule | select name, enabled, summary | where {$_.summary -like “*power*”}  | format-table -property * -autosize | out-default  
```  
  
|Правило|Настраиваемый|Автоматическое восстановление|Версия|Description|  
|----------|------------------|-----------------|-------------|-----------------|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: на этом компьютере не установлен поставщик OLE DB для служб Analysis Services.|Нет|Нет|SharePoint 2010|Поставщик OLE DB для служб Analysis Services не установлен на сервере или имеет неправильную версию. Это правило появляется, если в ферму SharePoint входят экземпляры служб Excel, установленные на серверах приложений без [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint. Это правило предупреждает о том, что не установлен поставщик OLE DB для служб Analysis Services, который используется службами Excel для подключения к данным [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] . Чтобы устранить эту проблему, установите поставщик OLE DB на каждом сервере служб Excel, где не установлен поставщик OLE DB для служб Analysis Services. Поставщик OLE DB для служб Analysis Services можно загрузить и установить из Центра загрузки Майкрософт. Дополнительную информацию см. в статье [Установка поставщика OLE DB служб Analysis Services на серверах SharePoint](http://msdn.microsoft.com/en-us/2c62daf9-1f2d-4508-a497-af62360ee859).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: параметры реестра для Microsoft.AnalysisServices.ChannelTransport.dll недопустимы после установки версии SQL Server 2008 R2 поставщика MSOLAP на этом компьютере.|Нет|Да|SharePoint 2010|Это проблема конфигурации сервера. Скорее всего, файл ChannelTransport.dll не зарегистрирован в глобальной сборке. Запустите автоматическое восстановление для данного правила, которое зарегистрирует DLL-файл на каждом сервере, где установлен экземпляр [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint. Также можно вручную запустить программу regasm.exe, чтобы зарегистрировать этот файл. Если служба таймера SharePoint не запущена от имени локального администратора, может понадобиться регистрация вручную. Если не выполнить обновление параметров реестра, связь между службами Excel и системной службой [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] будет медленной, а в некоторых конфигурациях безопасности соединение будет завершаться ошибкой.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: приложение службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] не имеет разрешения на выполнение операции.|Нет|Нет|SharePoint 2010|Это правило проверяет, является ли удостоверение приложения службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] владельцем базы данных приложений на сервере [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] и имеет ли оно права администратора в локальном экземпляре служб SQL Server Analysis Services. Эти разрешения автоматически предоставляются во время установки и развертывания, но если этот шаг не был выполнен, то срабатывает данное правило исправности.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: удостоверение приложения службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] не должно входить в локальную группу "Администраторы".|Нет|Нет|SharePoint 2010|Выполнение этой рекомендации повышает общую безопасность среды. Если приложение службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] запускается под учетной записью, входящей в локальную группу администраторов, следует заменить ее на другую учетную запись, не входящую в эту группу. Рекомендуется использовать для каждой службы выделенную учетную запись, обладающую минимально необходимыми разрешениями. Это обеспечивает изоляцию служб и упрощает аудит входа. Дополнительные сведения об изменении учетной записи службы см. в разделе [Configure Power Pivot Service Accounts](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-service-accounts.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: экземпляр служб Analysis Services работает в табличном режиме, но параметр конфигурации, задающий этот режим, отключен.|Нет|Нет|SharePoint 2010|Это правило проверяет, имеет ли свойство [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] DeploymentMode **экземпляра служб SQL Server Analysis Services в установке** для SharePoint значение 1. Если это свойство имеет другое значение или у службы таймера SharePoint, которая запускает средство проверки правил, отсутствует разрешение на открытие файла, то правило дает отрицательный результат. Дополнительные сведения о свойстве режима развертывания см. в разделе [Определение режима работы сервера экземпляра служб Analysis Services](../../analysis-services/instances/determine-the-server-mode-of-an-analysis-services-instance.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: задание таймера обновления данных [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] отключено.|Нет|Нет|SharePoint 2013<br /><br /> SharePoint 2010|Проверьте параметры задания таймера и убедитесь, что оно включено. Если функция обновления данных [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] не используется, то это правило можно пропустить. Дополнительные сведения см. в разделе [Обновление данных PowerPivot с SharePoint 2010](http://msdn.microsoft.com/en-us/01b54e6f-66e5-485c-acaa-3f9aa53119c9).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: сведения об учетной записи служб SQL Server Analysis Services ([!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]), управляемой в диспетчере конфигурации SQL Server, отличаются от сведений об учетной записи, управляемой в центре администрирования.|Нет|Нет|SharePoint 2010|Это правило проверяет, совпадают ли данные учетной записи службы в диспетчере конфигурации SQL Server с данными управляемой учетной записи в центре администрирования для того же экземпляра служб Analysis Services. Если эти учетные записи различаются, то в отчет о проблемах и разрешении добавляется запись, которая позволяет поменять учетную запись службы в диспетчере конфигурации SQL Server на учетную запись, указанную в центре администрирования. Диспетчер конфигурации SQL Server не поддерживается в качестве средства для изменения имени пользователя и пароля учетной записи службы в экземпляре [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint. Центр администрирования позволяет использовать управляемые учетные записи в SharePoint. Более того, если в ферму входит несколько серверов [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint, то несогласованность параметров учетной записи службы может препятствовать операциям обработки и операциям запросов на том сервере, где неправильно заданы сведения о службе.<br /><br /> В случае срабатывания этого правила на одиночном сервере книги [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] временно продолжат работу, однако рекомендуется как можно скорее устранить проблему. Разрешения в базе данных и в файловой системе обновляются с учетом данных учетной записи, указанной в центре администрирования.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: развернутое решение фермы устарело.|Нет|Да|SharePoint 2010|Для установки компонентов [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint используется решение на уровне фермы и решение на уровне веб-приложения. Это правило показывает, что решение на уровне фермы имеет более раннюю версию, чем версия сервера или версия веб-решения. Скорее всего, проблема связана с развертыванием сервера. Для устранения этой проблемы рекомендуется запустить программу установки SQL Server, чтобы исправить один из экземпляров [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint, входящих в ферму. Дополнительные сведения о решениях в экземпляре [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint см. в статье [Развертывание решений PowerPivot в SharePoint](../../analysis-services/power-pivot-sharepoint/deploy-power-pivot-solutions-to-sharepoint.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: общая загрузка ЦП слишком велика.|Да|Нет|SharePoint 2010|Данное правило сообщает о загрузке ЦП на уровне системы. Загрузка ЦП отслеживается на общем уровне, так как системная служба [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] оценивает по уровню загрузки степень работоспособности сервера и производит в соответствии с этой оценкой балансировку загрузки между несколькими серверами [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint в ферме. Рекомендуется добавить в ферму дополнительный сервер приложений и перенести на него приложения, интенсивно загружающие процессор.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: службам Analysis Services не хватает ресурсов ЦП для выполнения запрошенных операций.|Да|Нет|SharePoint 2010|Объема ресурсов ЦП, доступных процессу служб Analysis Services (msmdsrv.exe), недостаточно для обеспечения текущего уровня активности этого сервера. Следует добавить в ферму дополнительный сервер [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint. Дополнительные сведения см. в разделе [Масштабное развертывание путем добавления серверов PowerPivot в ферму SharePoint 2010](http://msdn.microsoft.com/library/2dbddcc7-427a-4537-a8e2-56d99b9d967d).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: службам Analysis Services не хватает памяти для выполнения запрошенных операций.|Нет|Нет|SharePoint 2010|Это правило срабатывает, если для служб Analysis Services остается только 5 % доступного объема памяти. На сервере приложений SharePoint для экземпляра служб SQL Server Analysis Services должен быть всегда зарезервирован небольшой объем памяти, который никогда не используется. Так как большая часть операций на сервере связана с использованием памяти, сервер работает лучше, если загружен не полностью.<br /><br /> По умолчанию предупреждения о нехватке памяти создаются, когда объем доступной памяти опускается до 5 %. Это значение можно изменять в любую сторону, задав параметры в экземпляре служб Analysis Services. Дополнительные сведения см. в разделе [Настройка правил определения работоспособности PowerPivot](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md).<br /><br /> Величина 5 % от неиспользуемой памяти вычисляется относительно объема, выделенного службам Analysis Services. Например, если общий объем памяти составляет 200 ГБ и службам Analysis Services выделено 80 % (или 160 ГБ), то 5 % неиспользуемой памяти — это 5 % от 160 ГБ (или 8 ГБ).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: большое число соединений свидетельствует о том, что, чтобы справиться с текущей нагрузкой, необходимо развернуть больше серверов.|Да|Нет|SharePoint 2010|По умолчанию это правило исправности срабатывает, когда число уникальных соединений пользователей превышает 100. Это значение по умолчанию задается произвольно (не зависит от характеристик оборудования сервера и от активности пользователей), и его можно изменять в любую сторону в зависимости от объема ресурсов сервера и типичных показателей активности пользователей в среде. Дополнительные сведения см. в разделе [Настройка правил определения работоспособности PowerPivot](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: отношение числа событий загрузки к числу соединений слишком велико.|Да|Нет|SharePoint 2013<br /><br /> SharePoint 2010|По умолчанию это правило исправности срабатывает, когда отношение числа событий загрузки к числу событий соединения за весь период сбора данных (по умолчанию — 4 часа) превышает 50 %. Столь высокое отношение означает, что активно очень большое число соединений с уникальными книгами или заданы слишком жесткие параметры сокращения объема кэша (и книги быстро выгружаются и удаляются из системы, хотя еще остаются активные запросы к этим данным). Чтобы исключить ложные положительные результаты, для вычисления отношения необходимо, чтобы за 4-часовой период было установлено не менее 20 соединений. Это правило работоспособности можно поставить в зависимость от другого соотношения. Дополнительные сведения см. в разделе [Настройка правил определения работоспособности PowerPivot](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md). Дополнительные сведения о настройке кэша см. в разделе [Настройка использования места на диске (PowerPivot для SharePoint)](../../analysis-services/power-pivot-sharepoint/configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: в каталоге журналов имеются файлы минидампа, что свидетельствует о сбое программы.|Нет|Нет|SharePoint 2013<br /><br /> SharePoint 2010|Файлы минидампа создаются во время сбоя программы для сохранения данных о состоянии приложения службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] непосредственно перед сбоем. Эти данные можно отправить в корпорацию Майкрософт и использовать для устранения неполадок. Это правило срабатывает, когда на сервере обнаруживаются DMP-файлы. Правило предоставляет ссылку на файл, который находится в папке \OLAP\Log экземпляра [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint. Учтите, что содержимое такого файла нельзя просмотреть в текстовом редакторе. Для просмотра файлов минидампа необходимо загрузить и установить отдельное средство отладки. Дополнительные сведения см. в разделе [Debugging Tools for Windows (на английском языке)](http://go.microsoft.com/fwlink/?linkID=208266).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: недостаточно места на диске, на котором кэшируются данные [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] .|Да|Нет|SharePoint 2010|По умолчанию это правило определения исправности срабатывает, когда объем свободного места на диске становится меньше 5 % объема диска, на котором расположена папка резервного копирования. Дополнительные сведения о задании этого процентного значения см. в разделе [Настройка правил определения работоспособности PowerPivot](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md). Дополнительные сведения об использовании диска см. в разделе [Настройка использования места на диске (PowerPivot для SharePoint)](../../analysis-services/power-pivot-sharepoint/configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: данные об использовании не обновляются с ожидаемой частотой.|Да|Нет|SharePoint 2013<br /><br /> SharePoint 2010|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint использует встроенную систему сбора данных, чтобы собирать метрики о подключениях, обновлении данных и времени откликов на запросы. Эти данные об использовании хранятся в базе данных приложения службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] , которая, в свою очередь, обновляет книгу [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] ([!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] Management Data.xlsx), а оттуда данные попадают в отчеты на панели мониторинга управления [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] . Это правило указывает, что данные не поступают в файл [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] Management Data.xlsx с достаточной частотой. Факт обновления XLSX-файла устанавливается по метке времени. Если в системе сбора данных об использовании имеются другие проблемы, понижающие точность данных, то это правило не обнаружит их. Чтобы устранить эту ошибку, убедитесь, что запущены задания таймера. Дополнительные сведения о сборе данных об использовании см. в разделе [Настройка сбора данных об использовании с PowerPivot для SharePoint](../../analysis-services/power-pivot-sharepoint/configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: учетная запись процесса MidTier должна иметь разрешение "Полный доступ для чтения" для всех связанных приложений SPWebApplication.|Нет|Да|SharePoint 2013<br /><br /> SharePoint 2010|Удостоверение приложения службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] должно иметь разрешения **Полный доступ для чтения** для доступа к базам данных содержимого SharePoint от имени пользователей, обладающих разрешениями "Только просмотр" для документа.<br /><br /> Чтобы определить, какая учетная запись служит удостоверением приложения службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] , откройте страницу **Настройка учетных записей служб** в центре администрирования. Скорее всего, приложение службы работает либо в пуле приложений службы **Система веб-служб SharePoint** , либо в выделенном пуле приложений.<br /><br /> Это правило предоставляет вариант **Автоматическое исправление** , но предоставление разрешений вручную позволит добиться лучших результатов:<br /><br /> <br /><br /> 1) откройте страницу **Управление веб-приложениями**в центре администрирования;<br /><br /> 2) выберите веб-сайт и нажмите кнопку **Политика пользователя**;<br /><br /> 3) нажмите кнопку **Добавить пользователей**;<br /><br /> 4) выберите пункт "Все зоны" и нажмите кнопку **Далее**;<br /><br /> 5) в разделе "Пользователи" введите удостоверение приложения службы [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] , установите флажок **Полный доступ для чтения** и щелкните **6) Готово**.<br /><br /> 6) убедитесь, что проблема устранена. В разделе «Наблюдение» щелкните ссылку **Пересмотр определений правил**. Найдите и откройте правило [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] . Нажмите кнопку **Выполнить**. Вернитесь к окну **Обзор проблем и решений** и убедитесь, что правило больше не появляется.|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: служба вторичного входа в систему (seclogon) отключена.|Нет|Нет|SharePoint 2013<br /><br /> SharePoint 2010|Служба вторичного входа используется для создания эскизов книг [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] в коллекции [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] . По умолчанию служба вторичного входа должна запускаться вручную. Если служба отключена, создание эскизов невозможно. Кроме того, в журналах ULS может появиться следующая ошибка: "Ошибка 1058 может быть вызвана тем, что служба вторичного входа Windows отключена".<br /><br /> Для проверки конфигурации службы используйте консольное приложение «Службы», чтобы найти вторичное имя входа и изменить **Тип запуска** на **Ручной**. Если включить службу невозможно, это означает, что она отключена в соответствии с групповой политикой организации. Выясните у администратора, так ли это.<br /><br /> После включения службы изображения эскиза или моментального снимка будут периодически обновляться. Кроме того, возможно принудительное обновление. Для этого нужно перезапустить службу, а затем открыть и сохранить заново страницы свойств конкретного отчета. Дополнительные сведения см. в статье [Использование коллекции PowerPivot](http://go.microsoft.com/fwlink/?LinkId=246462).|  
|[!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)]: ADOMD.NET не устанавливается на автономный клиентский веб-интерфейс (WFE), настроенный для центра администрирования.|Нет|Нет|SharePoint 2013<br /><br /> SharePoint 2010|ADOMD.NET — это клиентская библиотека служб Analysis Services, которая поддерживает соединение с базой данных служб Analysis Services. В развертывании [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] для SharePoint компонент ADOMD.NET обеспечивает доступ к встроенным отчетам на панели мониторинга управления [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] в центре администрирования. Фактически встроенные отчеты — это книги [!INCLUDE[ssGemini_md](../../includes/ssgemini-md.md)] , которые содержат внедренные данные служб Analysis Services. Панель управления использует ADOMD.NET для отправки запроса на соединение с сервером, который загружает данные, содержащиеся в книге.<br /><br /> В топологиях, где центр администрирования работает на автономном сервере клиентского веб-интерфейса, необходимо вручную установить ADOMD.NET, чтобы просматривать эти отчеты на панели управления. Дополнительные сведения можно найти в статье [Установка ADOMD.NET на веб-серверах, обслуживающих клиентские запросы, под управлением центра администрирования](http://msdn.microsoft.com/en-us/c2372180-e847-4cdb-b267-4befac3faf7e).|  
  
  
