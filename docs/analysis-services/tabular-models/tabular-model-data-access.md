---
title: Доступ к данным табличной модели | Документы Microsoft
ms.date: 05/07/2018
ms.prod: sql
ms.technology: analysis-services
ms.component: tabular-models
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: 7453bb7b72625327b92a1a4624ce19f5cccc86db
ms.sourcegitcommit: 38f8824abb6760a9dc6953f10a6c91f97fa48432
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2018
---
# <a name="tabular-model-data-access"></a>Доступ к данным табличной модели
[!INCLUDE[ssas-appliesto-sqlas-aas](../../includes/ssas-appliesto-sqlas-aas.md)]
  К табличным шаблонам базы данных в службах Analysis Services можно получить доступ с помощью большинства тех же клиентов, интерфейсов и языков, которые используются для извлечения данных или метаданных из многомерной модели. Дополнительные сведения см. в разделе [Доступ к данным многомерной модели (службы Analysis Services — многомерные данные)](../../analysis-services/multidimensional-models/mdx/multidimensional-model-data-access-analysis-services-multidimensional-data.md).  
  
 В этой статье описываются клиенты, языки запросов и программные интерфейсы, работающие с табличными моделями.  
  
## <a name="clients"></a>Клиенты  
 Следующие клиентские приложения Майкрософт поддерживают собственные соединения с базами данных табличной модели служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .  
  
### <a name="power-bi"></a>Power BI
К локальной базе данных табличной модели служб Analysis Services можно подключиться из [Power BI](https://powerbi.microsoft.com/). Power BI — это набор средств бизнес-аналитики для анализа данных и обмена ценными сведениями. 

### <a name="excel"></a>Excel  
 К базам данных табличной модели можно подключаться из Excel, используя функции визуализации и анализа данных в Excel для работы с данными. Для доступа к данным необходимо определить соединение с данными служб Analysis Services, указать сервер, работающий в табличном режиме, и выбрать нужную базу данных. Дополнительные сведения см. в разделе [Подключение к службам SQL Server Analysis Services или импорт данных из них](http://go.microsoft.com/fwlink/?linkID=215150).  
  
 Excel также является рекомендуемым приложением для просмотра табличных моделей в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]. Это средство включает команду **Анализ в Excel** , которая запускает новый экземпляр Excel, создает книгу Excel и устанавливает подключение к данным между книгой и базой данных рабочей области модели. При просмотре данных табличной модели в Excel следует учитывать, что Excel направляет запросы к модели через клиент сводных таблиц Excel. Соответственно, операции внутри книги Excel приводят к отправке запросов многомерных выражений к базе данных рабочей области, а не запросов DAX. Если для отслеживания запросов используется приложение SQL Profiler или другое средство наблюдения, в трассировке профайлера могут появляться многомерные выражения (MDX), а не выражения DAX. Дополнительные сведения о «анализ в Excel» см. в разделе [анализ в Excel](../../analysis-services/tabular-models/analyze-in-excel-ssas-tabular.md).  
  
### <a name="power-view"></a>Power View  
 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] — это клиентское приложение для создания отчетов служб Reporting Services, которое выполняется в среде SharePoint 2010. В нем в интегрированной среде нерегламентированных отчетов сочетаются возможности исследования данных, конструктора запросов и создания презентаций. [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] может использовать в качестве источников данных табличные модели, вне зависимости от того, размещена ли модель на экземпляре служб Analysis Services, работающем в табличном режиме, или же данные модели извлекаются из реляционного хранилища данных с использованием режима DirectQuery. Для подключения к табличной модели в [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)]необходимо создать файл соединения, содержащий расположение сервера и имя базы данных. В SharePoint можно создать общий источник данных служб Reporting Services или соединение с семантической моделью бизнес-аналитики. Дополнительные сведения о соединениях с семантическими моделями бизнес-аналитики см. в разделе [Соединение семантической модели бизнес-аналитики PowerPivot (BISM-файлы)](../../analysis-services/power-pivot-sharepoint/power-pivot-bi-semantic-model-connection-bism.md).  
  
 Клиент [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] определяет структуру указанной модели, отправляя запрос к указанному источнику данных, возвращающему схему, которая может использоваться клиентом для создания запросов к модели как к источнику данных и выполнения операций на основе этих данных. Последующими операциями в пользовательском интерфейсе [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] для фильтрации данных, выполнения расчетов или агрегатных функций и отображения связанных данных управляет клиент, и программно манипулировать ими нельзя.  
  
 Запросы, отправляемые клиентом [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] к модели, выдаются в виде инструкций DAX, которые можно отслеживать, установив трассировку для модели.  Клиент также выдает запрос серверу на первоначальное определение схемы, которое представляется согласно языку определения концептуальной схемы (CSDL). Дополнительные сведения см. в разделе [Заметки языка CSDL для бизнес-аналитики (CSDLBI)](../../analysis-services/tabular-model-programming-compatibility-levels-1050-1103/csdl-annotations-for-business-intelligence-csdlbi.md)  
  
### <a name="sql-server-management-studio"></a>Среда SQL Server Management Studio  
 С помощью среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] можно управлять экземплярами, в которых размещаются табличные модели, а также запрашивать из них метаданные и данные. Можно обрабатывать модели или объекты в модели, создавать секции и управлять ими, а также устанавливать параметры безопасности для управления доступом к данным. Дополнительные сведения см. в следующих разделах:  
  
-   [Определение режима работы сервера экземпляра служб Analysis Services](../../analysis-services/instances/determine-the-server-mode-of-an-analysis-services-instance.md)  
  
-   [Подключение к службам Analysis Services](../../analysis-services/instances/connect-to-analysis-services.md)  
  
-   [Мониторинг экземпляра служб Analysis Services](../../analysis-services/instances/monitor-an-analysis-services-instance.md)  
  
 В среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] для извлечения данных и метаданных из табличного шаблона базы данных можно использовать как многомерные выражения, так и окна запросов XMLA. Однако обратите внимание на следующие ограничения.  
  
-   Инструкции с использованием многомерных выражений и расширений интеллектуального анализа данных не поддерживаются для моделей, развернутых в режиме DirectQuery; поэтому, если необходимо создать запрос к табличной модели в режиме DirectQuery, следует использовать вместо этого окно **Запрос XMLA** .  
  
-   Изменить контекст базы данных для окна «Запрос XMLA» после открытия окна **Запрос** нельзя. Поэтому, если необходимо отправить запрос к другой базе данных или другому экземпляру, необходимо открыть эту базу данных или экземпляр в среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] , а затем открыть новое окно **Запрос XMLA** внутри соответствующего контекста.  
  
 Можно создавать трассировки по табличной модели [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] так же, как и в многомерном решении. В данном выпуске службы [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] содержат множество новых событий, с помощью которых можно отслеживать использование памяти, операции запроса и обработки, а также использование файлов. Дополнительные сведения см. в разделе [События трассировки служб Analysis Services](../../analysis-services/trace-events/analysis-services-trace-events.md).  
  
> [!WARNING]  
>  Если установить трассировку для базы данных табличной модели, могут отображаться некоторые события, причисляемые к категории запросов расширений интеллектуального анализа данных. Однако интеллектуальный анализ данных не поддерживается для данных табличной модели, и запросы расширений интеллектуального анализа данных, выполняемые в базе данных, ограничиваются инструкциями SELECT для метаданных модели. События причисляются к категории расширений интеллектуального анализа данных только потому, что такая же платформа средства синтаксического анализа используется для многомерных выражений.  
  
## <a name="query-languages"></a>Языки запросов  
 Табличные модели служб Analysis Services поддерживают большинство тех же языков запросов, которые предоставляются для доступа к многомерным моделям. Исключением являются табличные модели, развернутые в режиме DirectQuery, которые не извлекают данные из хранилища данных служб Analysis Services, а получают их непосредственно из источника данных SQL Server. Отправлять запросы к этим моделям с применением многомерных выражений нельзя. Необходимо использовать клиент, который поддерживает преобразование выражений DAX в инструкции Transact-SQL, например клиент [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] .  
  
### <a name="dax"></a>DAX  
 С помощью DAX можно создавать выражения и формулы во всех видах табличных моделей, независимо от того, хранится ли модель в SharePoint в виде книги Excel с поддержкой [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]или в экземпляре служб Analysis Services.  
  
 Кроме того, выражения DAX можно использовать внутри контекста инструкции команды XMLA EXECUTE для отправки запросов к табличной модели, развернутой в режиме DirectQuery.  
  
 Примеры запросов к табличной модели с использованием DAX см. в статье [Справочник по синтаксису запроса DAX](http://msdn.microsoft.com/en-us/4dd0cf0e-191d-411d-987c-f606813fc39e).  
  
### <a name="mdx"></a>Многомерное выражение  
 С помощью многомерных выражений можно создавать запросы к табличным моделям, использующим кэш памяти в качестве предпочтительного метода запроса (то есть к моделям, не развернутым в режиме DirectQuery). Клиенты, например [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] , используют DAX как для создания агрегатов, так и для выполнения запросов к модели как к источнику данных, однако если вы знакомы с многомерными выражениями, задачу может упростить создание примеров запросов в виде многомерных выражений — см. раздел [Построение мер в многомерных выражениях](../../analysis-services/multidimensional-models/mdx/mdx-building-measures.md).  
  
### <a name="csdl"></a>Язык CSDL  
 Язык определения концептуальной схемы (CSDL) сам по себе не является языком запросов, но может использоваться для извлечения сведений о модели и метаданных модели, на основе которых в дальнейшем можно создавать отчеты или запросы к модели.  
  
 Для получения сведений о том, как CSDL используется в табличных моделях, см. раздел [Заметки языка CSDL для бизнес-аналитики (CSDLBI)](../../analysis-services/tabular-model-programming-compatibility-levels-1050-1103/csdl-annotations-for-business-intelligence-csdlbi.md).  
  
## <a name="programmatic-interfaces"></a>Программные интерфейсы  
 Интерфейсами участников, используемыми для взаимодействия с табличными моделями служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , являются наборы строк схемы, XMLA, а также клиенты запросов и средства запросов, предоставляемые средами [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] и [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)].  
  
### <a name="data-and-metadata"></a>Данные и метаданные  
 Можно извлекать данные и метаданные из табличных моделей в управляемых приложениях с помощью ADOMD.NET. 
  
-   [Используйте динамические административные представления & #40; динамических административных представлений & #41; для мониторинга служб Analysis Services](../../analysis-services/instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services.md)  
  
 Для поддержки доступа в OLE DB к табличным моделям в неуправляемых клиентских приложениях можно использовать поставщик OLE DB для служб Analysis Services версии 9.0. Для включения доступа к табличной модели требуется обновленная версия поставщика OLE DB для служб Analysis Services. Дополнительные сведения о поставщиках, используемых с табличными моделями, см. в статье [Установка поставщика OLE DB служб Analysis Services на серверах SharePoint](http://msdn.microsoft.com/en-us/2c62daf9-1f2d-4508-a497-af62360ee859) .  
  
 Также можно извлечь данные напрямую из экземпляра служб Analysis Services в формате на основе XML. Можно извлечь схему табличной модели с помощью набора строк DISCOVER_CSDL_METADATA или использовать команду EXECUTE либо DISCOVER с существующими элементами ASSL, объектами или свойствами. Для получения дополнительных сведений см. следующие ресурсы:  
  
-   [Заметки языка CSDL для бизнес-аналитики (CSDLBI)](../../analysis-services/tabular-model-programming-compatibility-levels-1050-1103/csdl-annotations-for-business-intelligence-csdlbi.md)  
  
### <a name="manipulate-analysis-services-objects"></a>Управление объектами служб Analysis Services  
 Можно создавать, изменять, удалять и обрабатывать табличные модели и объекты в них, в том числе таблицы, столбцы, перспективы, меры и секции, с помощью команд XMLA или с помощью объектов AMO. Как объекты AMO, так и XMLA обновлены для поддержки дополнительных свойств, используемых в табличных моделях для усовершенствованной отчетности и моделирования.  
  
  
### <a name="schema-rowsets"></a>Наборы строк схемы  
 Клиентские приложения могут использовать наборы строк схемы для изучения метаданных табличных моделей и для извлечения сведений в целях поддержки и мониторинга с сервера служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] . В данном выпуске SQL Server добавлены новые наборы строк схемы, а существующие расширены для поддержки функций, связанных с табличными моделями, и для усовершенствования мониторинга и анализа производительности по всем службам [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].  
  
-   [Набор строк DISCOVER_CALC_DEPENDENCY](../../analysis-services/schema-rowsets/xml/discover-calc-dependency-rowset.md)  
  
     Новый набор строк схемы для отслеживания зависимостей между столбцами и ссылками в табличной модели  
  
-   [Набор строк DISCOVER_CSDL_METADATA](../../analysis-services/schema-rowsets/xml/discover-csdl-metadata-rowset.md)  
  
     Новый набор строк схемы для получения представления языка CSDL табличной модели  
  
-   [Набор строк DISCOVER_XEVENT_TRACE_DEFINITION](http://msdn.microsoft.com/library/e1ce2d2d-f994-4318-801a-ee0385aecd84)  
  
     Новый набор строк схемы для мониторинга расширенных событий SQL Server. Дополнительные сведения см. в разделе [Мониторинг служб Analysis Services с помощью расширенных событий SQL Server](../../analysis-services/instances/monitor-analysis-services-with-sql-server-extended-events.md).  
  
-   [Набор строк DISCOVER_TRACES](../../analysis-services/schema-rowsets/xml/discover-traces-rowset.md)  
  
     Новый столбец **Type** позволяет фильтровать трассировки по категориям. Дополнительные сведения см. в разделе [Создание трассировки приложения Profiler для воспроизведения (службы Analysis Services)](../../analysis-services/instances/create-profiler-traces-for-replay-analysis-services.md).  
  
-   [Набор строк MDSCHEMA_HIERARCHIES](../../analysis-services/schema-rowsets/ole-db-olap/mdschema-hierarchies-rowset.md)  
  
     Новое перечисление **STRUCTURE_TYPE** поддерживает идентификацию определяемых пользователем иерархий, создаваемых в табличных моделях. Дополнительные сведения см. в разделе [иерархий](../../analysis-services/tabular-models/hierarchies-ssas-tabular.md).  
  
 В данном выпуске нет обновлений для наборов строк схемы OLE DB для интеллектуального анализа данных.  
  
> [!WARNING]  
>  Использовать запросы многомерных выражений или расширений интеллектуального анализа данных в базе данных, развернутой в режиме DirectQuery, нельзя; поэтому, если необходимо выполнить запрос к модели DirectQuery с использованием наборов строк схемы, следует использовать XMLA, а не связанное динамическое административное представление. Для динамических административных представлений, которые возвращают результаты для сервера в виде единого целого, например SELECT * from $system.DBSCHEMA_CATALOGS or DISCOVER_TRACES, можно выполнить запрос в содержимом базы данных, развернутой в режиме кэширования.  
  
## <a name="see-also"></a>См. также  
 [Соединиться с базой данных табличной модели ](../../analysis-services/tabular-models/connect-to-a-tabular-model-database-ssas.md)   
 [Доступ к данным PowerPivot](../../analysis-services/power-pivot-sharepoint/power-pivot-data-access.md)   
 [Подключение к службам Analysis Services](../../analysis-services/instances/connect-to-analysis-services.md)  
  
  
