---
title: "Занятие 7. Создание мер | Microsoft Docs"
ms.custom: ""
ms.date: "02/27/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "analysis-services"
ms.tgt_pltfrm: ""
ms.topic: "get-started-article"
applies_to: 
  - "SQL Server 2016"
ms.assetid: 01bd2ad7-09b7-49ae-ad80-83f25da301aa
caps.latest.revision: 29
author: "Minewiskan"
ms.author: "owend"
manager: "erikre"
---
# Занятие 7. Создание мер
На этом занятии мы создадим меры, которые можно будет добавить в модель. Как и вычисляемые столбцы, созданные на предыдущем занятии, мера — это вычисление, создаваемое с помощью DAX-формулы. Однако в отличие от вычисляемых столбцов меры вычисляются на основе выбранного пользователем *фильтра*, например на основе выбора пользователя, определенного столбца или среза, добавленного в поле «Метки строк» в сводной таблице.   Значение для каждой ячейки в фильтре вычисляется с помощью меры. Меры — это мощные гибкие вычисления, которые могут быть включены практически во все табличные модели для выполнения динамических вычислений с числовыми данными. Дополнительные сведения см. в разделе [Меры (табличные службы SSAS)](../analysis-services/tabular-models/measures-ssas-tabular.md).  
  
Создание мер производится в сетке мер. По умолчанию каждая таблица имеет пустую сетку мер. Однако обычно меры для каждой таблицы не создаются. Сетка мер появляется внизу таблицы в конструкторе моделей, когда открыто представление данных. Чтобы скрыть или отобразить сетку мер таблицы, в меню **Таблица** выберите команду **Показать сетку мер**.  
  
Меру можно создать, щелкнув по пустой ячейке в сетке мер и введя DAX-формулу в строке формул. Если после создания формулы нажать клавишу ВВОД, мера появится в ячейке. Меры также можно создавать с помощью стандартной агрегатной функции, щелкнув столбец, а затем кнопку автосуммирования (**∑**) на панели инструментов. Меры, созданные с помощью кнопки автосуммирования, будут всегда отображаться в сетке мер под столбцом, но при необходимости их можно переместить.  
  
На этом занятии меры будут созданы как с помощью ввода DAX-формулы в строке формул, так и с помощью функции автосуммирования.  
  
Предполагаемое время выполнения данного занятия: **30 минут**  
  
## Предварительные требования  
Этот раздел является частью учебника по табличному моделированию, который необходимо изучать по порядку. Прежде чем выполнять задания в этом занятии, необходимо завершить предыдущее занятие: [Занятие 6. Создание вычисляемых столбцов](../analysis-services/lesson-6-create-calculated-columns.md).  
  
## Создание мер  
  
#### Создание меры «Дней в текущем квартале до даты» в таблице дат  
  
1.  В конструкторе моделей щелкните таблицу **Дата** .  
  
2.  Если пустая сетка мер не отображена под таблицей, в меню **Таблица** выберите команду **Показать сетку мер**.  
  
3.  В сетке мер щелкните верхнюю левую пустую ячейку.  
  
4.  В строке формул над таблицей введите следующую формулу:  
  
    **=COUNTROWS( DATESQTD( 'Date'[Date]))**  
  
    Завершив построение формулы, нажмите клавишу ВВОД.  
  
    Обратите внимание на то, что верхняя левая ячейка теперь содержит имя меры **Мера 1** и результат **92**. Имя меры также стоит перед формулой в строке формул.  
  
5.  Чтобы переименовать меру, в строке формул выделите имя **Мера 1**, введите **Дней текущего квартала до даты**и нажмите клавишу ВВОД.  
  
    > [!TIP]  
    > Во время ввода формулы в строке формул можно также сначала ввести имя меры, поставить двоеточие (:), а затем вписать формулу. При использовании этого метода не нужно переименовывать меру.  
  
#### Создание меры «Дней в текущем квартале до даты» в таблице дат  
  
1.  В сетке мер щелкните пустую ячейку под только что созданной мерой, при этом таблица **Дата** должна быть все еще активна в конструкторе моделей.  
  
2.  В строке формул введите следующую формулу:  
  
    **Дни в текущем квартале :=COUNTROWS( DATESBETWEEN( 'Date'[Date], STARTOFQUARTER( LASTDATE('Date'[Date])), ENDOFQUARTER('Date'[Date])))**  
  
    Обратите внимание, что в эту формулу сначала включено имя меры, за которым следует двоеточие (:).  
  
    Завершив построение формулы, нажмите клавишу ВВОД.  
  
Во время создания пропорции сравнения между одним неполным периодом и предыдущим периодом формула должна учитывать пропорцию периода, который истек, и сравнивать ее с той же пропорцией в предыдущем периоде. В этом случае деление [Дней текущего квартала до даты] / [Дней в текущем квартале] дает пропорцию, прошедшую в текущем периоде.  
  
#### Создание меры «Отдельный счетчик заказов на продажу в Интернет» в таблице «Интернет-продажи»  
  
1.  В конструкторе моделей щелкните таблицу (вкладку) **Интернет-продажи**.  
  
    Если сетка мер не отображается, щелкните правой кнопкой мыши таблицу (вкладку) **Интернет-продажи** и выберите пункт **Показать сетку мер**.  
  
2.  Щелкните заголовок столбца **Номер заказа продаж** .  
  
3.  Щелкните стрелку вниз рядом с кнопкой автосуммирования (**∑**) на панели инструментов и выберите формулу **DistinctCount**.  
  
    Функция автосуммирования автоматически создаст меру для выбранного столбца, используя стандартную статистическую формулу DistinctCount.  
  
    Обратите внимание, что верхняя ячейка внизу столбца в сетке мер теперь содержит имя меры **Отдельный счетчик заказов на продажу**. Меры, созданные с помощью автосуммирования, размещаются автоматически в самой верхней ячейке в сетке мер под связанным столбцом.  
  
4.  В сетке мер щелкните новую меру, затем в окне **Свойства** с помощью поля **Имя меры**переименуйте меру на **Отдельный счетчик заказов на продажу в Интернет**.  
  
#### Создание дополнительных мер в таблице «Интернет-продажи»  
  
1.  Создайте и назовите следующие меры, используя функцию автосуммирования.  
  
    |Имя меры|Столбец|Автосуммирование (∑)|Формула|  
    |----------------|----------|-----------------|-----------|  
    |Число строк интернет-заказов|Число линий заказов на продажу|Count|=COUNT([Число линий заказов на продажу])|  
    |Всего единиц на продажу в Интернете|заказанное количество|Sum|=SUM([заказанное количество])|  
    |Общая сумма скидки для заказов в Интернет|сумма скидки|Sum|=SUM([сумма скидки])|  
    |Общая себестоимость продукции для заказов в Интернете|общая себестоимость продукции|Sum|=SUM([общая себестоимость продукции])|  
    |общие продажи в Интернете|Объем продаж|Sum|=SUM([объем продаж])|  
    |Общая маржа для заказов в Интернете|Маржа|Sum|=SUM([маржа])|  
    |Общая сумма налогов для заказов в Интернете|сумма налогов|Sum|=SUM([сумма налогов])|  
    |Общая стоимость фрахта для заказов в Интернете|фрахт|Sum|=SUM([фрахт])|  
  
2.  Щелкая по пустой ячейке в сетке мер и используя строку формул, создайте и назовите следующие меры.  
  
    > [!IMPORTANT]  
    > Необходимо создать следующие меры в правильном порядке. Формулы в более поздних мерах ссылаются на более ранние меры.  
  
    |Имя меры|Формула|  
    |----------------|-----------|  
    |Маржа предыдущего квартала для заказов в Интернете|=CALCULATE([общая маржа для заказов в Интернете],PREVIOUSQUARTER('Date'[Date]))|  
    |Маржа текущего квартала для заказов в Интернете|=TOTALQTD([общая маржа для заказов в Интернете],'Date'[Date])|  
    |Пропорция маржи предыдущего квартала для заказов в Интернете к текущему кварталу|=[маржа предыдущего квартала для заказов в Интернете]*([дней текущего квартала до даты]/[дней в текущем квартале])|  
    |Интернет-продажи предыдущего квартала|=CALCULATE([общие продажи в Интернете],PREVIOUSQUARTER('Date'[Date]))|  
    |Интернет-продажи текущего квартала|=TOTALQTD([общие продажи в Интернете],'Date'[Date])|  
    |Пропорция продаж предыдущего квартала в Интернете к текущему кварталу|=[Интернет-продажи предыдущего квартала]*([дней текущего квартала до даты]/[дней в текущем квартале])|  
  
Меры, созданные для таблицы «Интернет-продажи», могут быть использованы для анализа критических финансовых данных, таких как продажи, издержки и маржа прибыли для элементов, определенных фильтром, выбранным пользователем.  
  
## Следующий шаг  
Чтобы продолжить изучение этого учебника, перейдите к следующему занятию: [Занятие 8. Создание ключевых показателей эффективности](../analysis-services/lesson-8-create-key-performance-indicators.md).  
  
  
  
