---
title: "Объекты AMO другие классы и методы | Документы Microsoft"
ms.custom: 
ms.date: 03/14/2017
ms.prod: sql-non-specified
ms.prod_service: analysis-services
ms.service: 
ms.component: multidimensional-models
ms.reviewer: 
ms.suite: sql
ms.technology:
- analysis-services
- docset-sql-devref
ms.tgt_pltfrm: 
ms.topic: reference
applies_to: SQL Server 2016 Preview
helpviewer_keywords:
- restores [AMO]
- AMO, backup and restore
- capture logs [AMO]
- AmoException class [AMO]
- Analysis Management Objects, backup and restore
- assembly objects [AMO]
- traces [AMO]
- backups [AMO]
ms.assetid: 60ed5cfa-3a03-4161-8271-0a71a3ae363b
caps.latest.revision: "28"
author: Minewiskan
ms.author: owend
manager: kfile
ms.workload: Inactive
ms.openlocfilehash: d201ea38ed360b35b5b19daf945cc11ffe45f849
ms.sourcegitcommit: 44cd5c651488b5296fb679f6d43f50d068339a27
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2017
---
# <a name="amo-other-classes-and-methods"></a>Другие классы и методы объектов AMO
  Этот раздел содержит общие классы, которые не относятся к OLAP и интеллектуального анализа данных, и которые являются удобны для администрирования и управления объектами в [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]. Эти классы охватывают работу с хранимыми процедурами, трассировкой, исключениями, а также резервированием и восстановлением.  
  
 Этот раздел состоит из следующих подразделов.  
  
-   [Объекты Assembly](#Assembly)  
  
-   [Методы BACKUP и Restore](#Backup)  
  
-   [Объекты трассировки](#Traces)  
  
-   [Класс CaptureLog и атрибут CaptureXML](#CaptureLog)  
  
-   [Класс исключений AMOException](#AMO)  
  
 На следующем рисунке показана связь между классами, описываемыми в этом разделе.  
  
 ![Прочие классы AMO](../../../analysis-services/multidimensional-models/analysis-management-objects/media/amo-otherclasses.gif "прочие классы AMO")  
  
##  <a name="Assembly"></a>Объекты Assembly  
 Объект <xref:Microsoft.AnalysisServices.Assembly> создается путем добавления его в коллекцию сборок сервера и обновления объекта <xref:Microsoft.AnalysisServices.Assembly> на сервере при помощи метода Update.  
  
 Чтобы удалить объект <xref:Microsoft.AnalysisServices.Assembly>, к нему необходимо применить метод Drop объекта <xref:Microsoft.AnalysisServices.Assembly>. При удалении объекта <xref:Microsoft.AnalysisServices.Assembly> из коллекции сборок базы данных сама сборка не удаляется, она просто будет недоступна в приложении до следующего запуска.  
  
 Дополнительные сведения о доступных методах и свойствах см. в разделе <xref:Microsoft.AnalysisServices.Assembly> в <xref:Microsoft.AnalysisServices> .  
  
> [!IMPORTANT]  
>  Использование сборок COM может представлять угрозу безопасности. По этой причине, а также по ряду других сборки COM в службах [!INCLUDE[ssASversion10](../../../includes/ssasversion10-md.md)]являются устаревшими. Поддержка сборок COM в последующих версиях может быть прекращена.  
  
##  <a name="Backup"></a>Методы BACKUP и Restore  
 Методы Backup и Restore предназначены для создания резервной копии базы данных и восстановления служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]. Метод Backup принадлежит к объекту <xref:Microsoft.AnalysisServices.Database>, а метод Restore — к объекту <xref:Microsoft.AnalysisServices.Server>.  
  
 Резервное копирование базы данных могут выполнять только администраторы сервера и базы данных. Восстановить базу данных на сервере, отличном от того, с которого была создана ее резервная копия, могут только администраторы сервера. Администратор баз данных может восстановить базу данных путем перезаписи существующей базы данных только в том случае, если он является ее владельцем. Администратор баз данных может потерять доступ к восстановленной базе данных после ее восстановления, если она восстановлена с первоначальными определениями безопасности.  
  
 Файлы резервных копий баз данных должны иметь расширение ABF.  
  
### <a name="backup-method"></a>Метод Backup  
 Чтобы создать резервную копию базы данных, вызовите метод Backup объекта базы данных, передав ему в качестве параметра имя файла резервной копии.  
  
##### <a name="default-values"></a>Значения по умолчанию:  
 AllowOverwrite =**false**  
  
 BackupRemotePartitions =**false**  
  
 Безопасность =**CopyAll**  
  
 ApplyCompression =**true**  
  
### <a name="restore-method"></a>Метод Restore  
 Чтобы восстановить базу данных на сервере, вызовите метод Restore сервера, передав ему в качестве параметра имя файла резервной копии.  
  
##### <a name="default-values"></a>Значения по умолчанию:  
 AllowOverwrite =**false**  
  
 DataSourceType =**удаленного**  
  
 Безопасность =**CopyAll**  
  
##### <a name="restrictions"></a>Ограничения  
  
1.  Локальную секцию невозможно восстановить как удаленную.  
  
2.  Удаленную секцию невозможно восстановить как локальную, однако удаленную секцию можно восстановить на сервере, отличном от того, с которого была создана ее резервная копия.  
  
### <a name="common-parameters-and-properties-for-backup-and-restore-methods"></a>Общие параметры и свойства методов Backup и Restore  
  
-   **Файл** является имя файла резервной копии (UNC-имя) в/из.  
  
-   **Расположение** указывает сведения о резервном копировании конкретного сервера, такие как **BackupFile**. Это позволяет задать отдельный файл резервной копии для удаленной базы данных.  
  
-   **DatasourceID** указывает идентификатор подчиненной базы данных на удаленном сервере.  
  
-   **ConnectionString** позволяет настроить удаленный источник данных в случае изменения удаленного сервера. При наличии свойства ConnectionString обязательно должно быть задано свойство DatasourceID.  
  
-   **Папка** позволяет повторно сопоставить папки для секций на локальный жесткий диск  
  
-   **Исходный** — первоначальная папка для локальных секций.  
  
-   **Новый** — новое местоположение для локальных секций, находилось в соответствующей старой папке «Original».  
  
-   **Пароль**, если непустое значение, указывающее, что сервер зашифрует файл резервной копии.  
  
##  <a name="Traces"></a>Объекты трассировки  
 Трассировка — это платформа, предназначенная для наблюдения, воспроизведения и управления экземпляром служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]. Клиентское приложение, например [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)], подписывается на трассировку, после чего сервер в соответствии с ее определением будет отправлять ему определения трассировки.  
  
 Каждое событие описывается классом событий. Класс событий описывает тип сформированного события. Внутри класса событий более глубокое разделение событий на категории обеспечивают подклассы. Каждое событие описывается несколькими столбцами. Столбцы, описывающие событие трассировки, согласованы для всех событий, которые соответствуют структуре трассировки SQL. Записываемые в каждый из столбцов сведения могут различаться в зависимости от класса события. Другими словами, стандартный набор столбцов определен для каждой трассировки, но их значения могут различаться в зависимости от классов событий. Например, столбец TextData используется для записи исходного языка ASSL для всех событий инструкций.  
  
 В определении трассировки может содержаться один или несколько классов событий, трассировка которых выполняется параллельно. В определение трассировки можно добавить один или несколько столбцов данных для каждого класса событий, при этом использовать все столбцы трассировки необязательно. Администратор базы данных может решить, какие столбцы из имеющихся должны быть включены в трассировку. Далее можно выполнять выборочную трассировку классов событий согласно условиям фильтра, наложенного на любой из столбцов трассировки.  
  
 Трассировки можно запускать и удалять. Несколько трассировок можно запустить одновременно. События трассировки могут захватываться в реальном времени или направляться в файл для анализа или воспроизведения в будущем. Средство [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)] предназначено для анализа и воспроизведения событий трассировки служб [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]. Несколько соединений могут получать события из одной трассировки.  
  
 Трассировки можно разделить на две группы: трассировки сервера и трассировки сеанса. Трассировки сервера сообщают обо всех событиях на этом сервере, а трассировки сеанса сообщают только о событиях, происходящих в рамках текущего сеанса.  
  
 Трассировки из коллекции трассировок сервера определяются следующим образом.  
  
1.  Создайте объект <xref:Microsoft.AnalysisServices.Trace> и заполните его основные данные. Помимо прочего укажите идентификатор трассировки, имя, имя файла журнала, режим добавления-перезаписи и др.  
  
2.  В коллекцию событий объекта трассировки добавьте события для наблюдения. Для каждого из событий будут добавлены столбцы данных.  
  
3.  Задайте фильтры для исключения ненужных строк данных путем добавления их в коллекцию фильтров.  
  
4.  Запустите трассировку. После создания трассировки сбор данных начинается не сразу.  
  
5.  Остановите трассировку.  
  
6.  Просмотрите файл трассировки с помощью средства [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].  
  
 Трассировки из объекта сеанса создаются следующим образом.  
  
1.  Определите функции для обработки событий трассировки, формируемых в приложении объектом SessionTrace. Возможны следующие события: OnEvent и Stopped.  
  
2.  Добавьте определенные функции в обработчик события.  
  
3.  Запустите трассировку сеанса.  
  
4.  Выполните необходимые действия, при этом обработчики функций должны выполнить регистрацию событий.  
  
5.  Остановите трассировку сеанса.  
  
6.  Продолжите работу с приложением.  
  
##  <a name="CaptureLog"></a>Класс CaptureLog и атрибут CaptureXML  
 Все действия, которые должны выполняться объектами AMO, отправляются на сервер в виде сообщений XML для аналитики. Объекты AMO предоставляют средства захвата всех этих событий без заголовков SOAP. Дополнительные сведения см. в разделе [Знакомство с классами объектов AMO](../../../analysis-services/multidimensional-models/analysis-management-objects/amo-classes-introduction.md). CaptureLog — это реализованный в объектах AMO механизм для включения объектов и операций в сценарии. Объекты и операции будут включены в сценарии в XML для аналитики.  
  
 Чтобы начать захват XML, необходимо задать свойства объекта сервера CaptureXML **true**. После этого все действия, которые должны отправляться на сервер, будут захватываться классом CaptureLog. CaptureLog считается классом, поскольку у него есть метод Clear, предназначенный для очистки журнала захвата.  
  
 Чтобы прочитать журнал, необходимо получить коллекцию строк и выполнить ее перебор. Кроме того, можно объединить все журналы в строку при помощи метода ConcatenateCaptureLog объекта сервера. Метод ConcatenateCaptureLog принимает три параметра, два из которых являются обязательными. Требуются следующие параметры *транзакций*, логического типа, и *параллельных*, логический тип. Если *транзакций* равно **true**, это означает, что XML-файл пакета будет создана, поскольку в одной транзакции, а каждая команда будет рассматриваться как отдельная транзакция. Если *параллельных* равно **true**, это означает, что все команды в пакетном файле будут записаны для параллельного выполнения, а не последовательно, как они были записаны.  
  
##  <a name="AMO"></a>Класс исключений AMOException  
 Класс исключения AMOException позволяет приложению легко перехватывать исключения, создаваемые объектами AMO.  
  
 При возникновении различных проблем объекты AMO формируют исключения. В следующей таблице приведены типы исключений, обрабатываемые объектами AMO. Исключения наследуются от класса <xref:Microsoft.AnalysisServices.AmoException>.  
  
|Exception|Место возникновения|Description|  
|---------------|------------|-----------------|  
|<xref:Microsoft.AnalysisServices.AmoException>|Базовый класс|Приложение принимает это исключение при отсутствии обязательного родительского объекта, либо когда требуемый элемент не удается найти в коллекции.|  
|<xref:Microsoft.AnalysisServices.OutOfSyncException>|Наследует AMOException|Приложение принимает это исключение в том случае, когда объекты AMO не синхронизированы с подсистемой, а подсистема вернула ссылку на объект, о котором объектам AMO неизвестно.|  
|<xref:Microsoft.AnalysisServices.OperationException>|Наследует AMOException|Это важное исключение, которое часто получают приложения. Оно содержит описание ошибки, поступившей с сервера, которая, возможно, стала результатом сбоя операции объектов AMO, например Update, Process или Drop.|  
|<xref:Microsoft.AnalysisServices.ResponseFormatException>|Наследует AMOException|Это исключение возникает в том случае, когда подсистема вернула сообщение в формате, который непонятен объектам AMO.|  
|<xref:Microsoft.AnalysisServices.ConnectionException>|Наследует AMOException|Это исключение возникает в том случае, когда невозможно установить соединение (методом Server.Connect), либо когда соединение потеряно при обмене данными между объектами AMO и подсистемой (например, во время операций Update, Process или Drop).|  
  
## <a name="see-also"></a>См. также:  
 <xref:Microsoft.AnalysisServices>   
 [Знакомство с классами объектов AMO](../../../analysis-services/multidimensional-models/analysis-management-objects/amo-classes-introduction.md)   
 [Логическая архитектура &#40; Analysis Services — многомерные данные &#41;](../../../analysis-services/multidimensional-models/olap-logical/understanding-microsoft-olap-logical-architecture.md)   
 [Объекты базы данных &#40; Analysis Services — многомерные данные &#41;](../../../analysis-services/multidimensional-models/olap-logical/database-objects-analysis-services-multidimensional-data.md)  
  
  
