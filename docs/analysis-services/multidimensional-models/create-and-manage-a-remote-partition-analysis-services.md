---
title: "Создание удаленной секции и управление ей (Analysis Services) | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "analysis-services"
  - "analysis-services/multidimensional-tabular"
  - "analysis-services/data-mining"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "секции [службы Analysis Services], удаленные"
  - "удаленные секции [службы Analysis Services]"
ms.assetid: 4322b5cb-af07-4e79-8ecb-59e1121a9eb8
caps.latest.revision: 30
author: "Minewiskan"
ms.author: "owend"
manager: "erikre"
caps.handback.revision: 30
---
# Создание удаленной секции и управление ей (Analysis Services)
  При секционировании группы мер можно указать в качестве хранилища секции базу данных-получатель на удаленном экземпляре [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].  
  
 Удаленные секции куба (база данных master) хранятся в выделенной базе данных [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] на удаленном экземпляре [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] (база данных-получатель).  
  
 Выделенная база данных-получатель может хранить удаленные секции только для одной базы данных master. База данных master может использовать несколько баз данных-получателей, если все они размещаются на одном удаленном экземпляре [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Измерения в базе данных, выделенной для удаленных секций, создаются как связанные измерения.  
  
## Предварительные требования  
 Перед созданием удаленной секции необходимо выполнить следующие условия.  
  
-   Для хранения секций необходим второй экземпляр [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] и выделенная база данных. База данных-получатель служит одной цели — предоставлять хранилище для удаленных секций базы данных master.  
  
-   Оба экземпляра серверов должны иметь одну и ту же версию. Обе базы данных должны иметь один и тот же функциональный уровень.  
  
-   Оба экземпляра должны быть настроены на поддержку TCP-соединений. [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] не поддерживают создание удаленных секций с помощью протокола HTTP.  
  
-   Параметры брандмауэра на обоих компьютерах должны быть настроены на прием внешних подключений. Дополнительные сведения о настройке порта см. в разделе [Настройка брандмауэра Windows для доступа к службам Analysis Services](../../analysis-services/instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).  
  
-   Учетная запись службы для экземпляра, где выполняется база данных master, должна иметь административный доступ к удаленному экземпляру [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Если учетная запись службы изменится, нужно обновить разрешения на сервере и базе данных.  
  
-   Вы должны быть администратором [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] на обоих компьютерах.  
  
-   Следует убедиться, что ваш план аварийного восстановления учитывает резервное копирование и восстановление удаленных секций. Использование удаленных секций может усложнить операции по резервному копированию и восстановлению данных. Тщательно протестируйте план, чтобы подтвердить возможность восстановления необходимых данных.  
  
## Настройка удаленных секций  
 Два разных компьютера, на которых выполняется экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], должны иметь соглашение об удаленных секциях, которое обозначает один компьютер главным сервером, а другой подчиненным.  
  
 В приведенной ниже процедуре предполагается, что имеется два экземпляра сервера, а база данных куба развернута на главном сервере. Для упрощения база данных куба далее именуется db-master. База данных хранения, содержащая удаленные секции, именуется db-storage.  
  
 Чтобы выполнить эту процедуру, можно использовать и [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], и [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].  
  
> [!NOTE]  
>  Удаленные секции можно объединять только с другими удаленными секциями. Если используется сочетание локальных и удаленных секций, альтернативой будет создание новых секций, в которых содержатся объединенные данные и удалены более неиспользуемые секции.  
  
#### Укажите действительные имена серверов для развертывания куба (в SSDT)  
  
1.  На главном сервере в обозревателе решений щелкните правой кнопкой мыши имя решения и выберите пункт **Свойства**. В диалоговом окне **Свойства** щелкните **Свойства конфигурации**, **Развертывание**, **Сервер** и укажите имя главного сервера.  
  
2.  На подчиненном сервере в обозревателе решений щелкните правой кнопкой мыши имя решения и выберите пункт **Свойства**. В диалоговом окне **Свойства** щелкните **Свойства конфигурации**, **Развертывание**, **Сервер** и укажите имя подчиненного сервера.  
  
#### Создайте и разверните базу данных-получатель (в SSDT)  
  
1.  На подчиненном сервере создайте новый проект служб Analysis Services для базы данных хранилища.  
  
2.  На подчиненном сервере в обозревателе решений создайте новый источник данных, указывающий на базу данных куба db-master. Используйте **собственный поставщик OLE DB или поставщик Microsoft OLE DB для служб Analysis Services 11.0**.  
  
3.  Разверните решение на подчиненном сервере.  
  
#### Включите функции (в среде SSMS)  
  
1.  На подчиненном сервере в [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] щелкните правой кнопкой мыши подключенный экземпляр [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в обозревателе объектов и выберите пункт **Свойства**. Установите для параметров **Feature\LinkToOtherInstanceEnabled** и **Feature\LinkFromOtherInstanceEnabled** значение **True**.  
  
2.  Перезапустите подчиненный сервер, щелкнув правой кнопкой мыши имя сервера в обозревателе объектов и выбрав пункт **Перезапустить**.  
  
3.  На главном сервере в [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] щелкните правой кнопкой мыши подключенный экземпляр [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в обозревателе объектов и выберите пункт **Свойства**. Установите для параметров **Feature\LinkToOtherInstanceEnabled** и **Feature\LinkFromOtherInstanceEnabled** значение **True**.  
  
4.  Перезапустите главный сервер, щелкнув правой кнопкой мыши имя сервера в обозревателе объектов и выбрав пункт **Перезапустить**.  
  
#### Установите свойство MasterDataSourceID на удаленном сервере (в SSMS)  
  
1.  На подчиненном сервере щелкните правой кнопкой мыши базу данных хранилища db-storage, укажите пункты **Создать сценарий для базы данных** | **ALTER в** | **Новое окно редактора запросов**.  
  
2.  Добавьте **MasterDataSourceID** к XMLA-скрипту, затем укажите в качестве значения идентификатор базы данных куба db-master. Код XMLA должен выглядеть так, как в следующем примере.  
  
    ```  
    <Alter ObjectExpansion="ExpandFull" xmlns="http://schemas.microsoft.com/analysisservices/2003/engine">  
    <Object>  
       <DatabaseID>DB-Storage</DatabaseID>  
    </Object>  
    <ObjectDefinition>  
       <Database xmlns:xsd="http://www.w3.org/2001/XMLSchema" 400"   
          <ID>DB-Storage</ID>  
          <Name>DB-StorageB</Name>  
          <ddl200:CompatibilityLevel>1100</ddl200:CompatibilityLevel>  
          <Language>1033</Language>  
          <Collation>Latin1_General_CI_AS</Collation>  
          <DataSourceImpersonationInfo>  
    <ImpersonationMode>ImpersonateAccount</ImpersonationMode>  
             <Account>*********</Account>  
          </DataSourceImpersonationInfo>  
          <MasterDataSourceID>DB-Master</MasterDataSourceID>  
       </Database>  
    </ObjectDefinition>  
    </Alter>  
    ```  
  
3.  Нажмите клавишу F5, чтобы выполнить скрипт.  
  
#### Настройте удаленную секцию (в SSDT)  
  
1.  На главном сервере откройте куб в конструкторе кубов и щелкните вкладку **Секции**. Разверните группу мер. Нажмите кнопку **Создать секцию**, если группа мер уже настроена на работу с несколькими секциями, или нажмите кнопку обзора (. . ) в столбце Source, чтобы изменить текущую секцию.  
  
2.  В мастере секций на странице **Определение исходных сведений** выберите исходное представление данных и таблицу фактов.  
  
3.  При использовании привязки запроса укажите предложение WHERE, которое проведет сегментации данных для создаваемой секции.  
  
4.  На странице **Места обработки и хранения** на вкладке **Место обработки** выберите **Удаленный источник данных Analysis Services** и нажмите кнопку **Создать**, чтобы создать новый источник данных, указывающий на подчиненную базу данных db-storage.  
  
    > [!NOTE]  
    >  Если появится ошибка с указанием о том, что источника данных нет в коллекции, нужно открыть проект базы данных хранения db-storage и создать источник данных, указывающий на базу данных master db-master.  
  
5.  На главном сервере в обозревателе решений щелкните правой кнопкой мыши имя куба, выберите команду **Обработать** и проведите полную обработку куба.  
  
## Администрирование удаленных секций  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] поддерживают как параллельную, так и последовательную обработку удаленных секций. База данных master, где определены секции, координирует транзакции между всеми экземплярами, которые принимают участие в обработке секций куба. При обработке создаются отчеты, а затем отправляются на все экземпляры, которые обрабатывают секцию.  
  
 Куб, содержащий удаленные секции, можно администрировать вместе с его секциями на одном экземпляре служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]. Однако метаданные для удаленной секции можно просматривать и обновлять только на экземпляре служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], на котором секция и родительский куб были определены. Удаленную секцию нельзя просматривать и обновлять на удаленном экземпляре служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].  
  
> [!NOTE]  
>  Хотя базы данных, выделенные для хранения удаленных секций, не отображаются в наборе строк схемы, приложения, которые используют объекты АМО, могут обнаруживать выделенные базы данных с помощью команды «Discover» из XML для аналитики. Команды CREATE или DELETE передаются непосредственно в выделенную базу данных с помощью ТСР или НТТР-клиента, но сервер возвращает предупреждение о том, что это действие может повредить управляемую базу данных.  
  
## См. также  
 [Секции (службы Analysis Services — многомерные данные)](../../analysis-services/multidimensional-models-olap-logical-cube-objects/partitions-analysis-services-multidimensional-data.md)  
  
  