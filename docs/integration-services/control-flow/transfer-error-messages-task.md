---
title: "Задача &#171;Передача сообщений об ошибках&#187; | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "integration-services"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "sql13.dts.designer.transfererrormessagestask.f1"
helpviewer_keywords: 
  - "задача «Передача сообщений об ошибках» [службы Integration Services]"
ms.assetid: da702289-035a-4d14-bd74-04461fbfee1b
caps.latest.revision: 31
author: "douglaslMS"
ms.author: "douglasl"
manager: "jhubbard"
caps.handback.revision: 31
---
# Задача &#171;Передача сообщений об ошибках&#187;
  Задача "Передача сообщений об ошибках" передает одно или несколько пользовательских сообщений об ошибках [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] между экземплярами [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Пользовательские сообщения имеют идентификатор, больший или равный 50000. Сообщения с идентификаторами, меньшими 50000, являются системными и не могут передаваться с помощью задачи «Передача сообщений об ошибках».  
  
 Задачу «Передача сообщений об ошибках» можно настроить на передачу как всех сообщений об ошибках, так и только определенных. Пользовательские сообщения об ошибках могут быть на нескольких языках. Задача может быть настроена на передачу сообщений только на выбранных языках. Чтобы передавать на целевой сервер версии сообщения на других языках, на сервере должна существовать англоязычная версия сообщения (кодовая страница 1033, us_english).  
  
 Таблица sysmessages главной базы данных содержит все системные и пользовательские сообщения об ошибках, используемые в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
 Передаваемые пользовательские сообщения могут уже существовать в целевом объекте. Сообщение об ошибке определяется как повторяющееся, если его идентификатор и язык совпадают. Задача «Передача сообщений об ошибках» может быть настроена на работу с существующими сообщениями об ошибках следующим образом.  
  
-   Перезаписывать существующие сообщения об ошибках.  
  
-   При обнаружении повторяющегося сообщения завершать задачу сбоем.  
  
-   Пропускать повторяющиеся сообщения об ошибках.  
  
 Во время выполнения задача «Передача сообщений об ошибках» подключается к источнику и целевым серверам, используя один или два диспетчера соединений SMO. Диспетчер соединений SMO настраивается отдельно от задачи «Передача сообщений об ошибках», а затем используется этой задачей. Диспетчер соединений SMO определяет сервер и режим проверки подлинности, используемый для доступа к серверу. Дополнительные сведения см. в статье [SMO Connection Manager](../../integration-services/connection-manager/smo-connection-manager.md).  
  
 Задача «Передача сообщений об ошибках» поддерживает источники и целевые объекты [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Ограничений в отношении использования определенных версий источника или целевого объекта не существует.  
  
## События  
 Задача вызывает информационное событие, в котором сообщается о количестве переданных сообщений об ошибках.  
  
 В ходе выполнения задачи «Передача сообщений об ошибках» сведения о состоянии передачи не отображаются, появляются только сообщения о 0% и 100% выполнении.  
  
## Значение выполнения  
 Значение выполнения, определенное свойством задачи **ExecutionValue** , возвращает количество переданных сообщений об ошибках. С помощью выделения пользовательской переменной для свойства **ExecValueVariable** задачи "Передача сообщений об ошибках" сведения об ошибках передачи становятся доступными для других объектов пакета. Дополнительные сведения см. в разделах [Переменные в службах Integration Services (SSIS)](../../integration-services/integration-services-ssis-variables.md) и [Использование переменных в пакетах](../Topic/Use%20Variables%20in%20Packages.md).  
  
## Записи журнала  
 Задача «Передача сообщений об ошибках» включает в себя следующие пользовательские записи журнала.  
  
-   TransferErrorMessagesTaskStartTransferringObjects. Это запись журнала о начале передачи. В записях журнала указывается время запуска.  
  
-   TransferErrorMessagesTaskFinishedTransferringObjects. Это запись журнала об окончании передачи. В записях журнала указывается время завершения.  
  
 Также запись журнала о событии **OnInformation** содержит информацию о количестве переданных сообщений об ошибках. Запись журнала для **OnWarning event** сохраняется в обновляемом файле для каждого сообщения об ошибке.  
  
## Безопасность и разрешения  
 Чтобы создать новое сообщение об ошибке, пользователь, запускающий пакет, должен являться членом роли сервера sysadmin или serveradmin на целевом сервере.  
  
## Настройка задачи «Передача сообщений об ошибках»  
 Значения свойств можно задавать с помощью конструктора [!INCLUDE[ssIS](../../includes/ssis-md.md)] или программными средствами.  
  
 Дополнительные сведения о свойствах, которые можно задать в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] , см. в следующих разделах:  
  
-   [Редактор задачи "Передача сообщений об ошибках" (страница "Общие")](../../integration-services/control-flow/transfer-error-messages-task-editor-general-page.md)  
  
-   [Редактор задачи "Передача сообщений об ошибках" (страница "Сообщения")](../../integration-services/control-flow/transfer-error-messages-task-editor-messages-page.md)  
  
-   [Страница «Выражения»](../../integration-services/expressions/expressions-page.md)  
  
 Сведения о задании этих свойств программными средствами см. в следующем разделе:  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.TransferErrorMessagesTask.TransferErrorMessagesTask>  
  
## Связанные задачи  
 Дополнительные сведения об установке этих свойств в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] см. в следующем разделе:  
  
-   [Задание свойств задач или контейнеров](../Topic/Set%20the%20Properties%20of%20a%20Task%20or%20Container.md)  
  
## См. также  
 [Задачи служб Integration Services](../../integration-services/control-flow/integration-services-tasks.md)   
 [Поток управления](../../integration-services/control-flow/control-flow.md)  
  
  