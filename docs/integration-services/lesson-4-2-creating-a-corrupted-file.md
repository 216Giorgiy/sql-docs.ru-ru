---
title: Шаг 2. Создание поврежденного файла | Документы Майкрософт
ms.custom: ''
ms.date: 03/01/2017
ms.prod: sql
ms.prod_service: integration-services
ms.service: ''
ms.component: tutorial
ms.reviewer: ''
ms.suite: sql
ms.technology:
- integration-services
ms.tgt_pltfrm: ''
ms.topic: get-started-article
applies_to:
- SQL Server 2016
ms.assetid: cd0b18dc-66c3-4d88-86ef-8e40cb660fae
caps.latest.revision: 23
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: ce1119a0e1a73b485dc06483218fdc34e9755192
ms.sourcegitcommit: a85a46312acf8b5a59a8a900310cf088369c4150
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2018
---
# <a name="lesson-4-2---creating-a-corrupted-file"></a>Занятие 4–2. Создание поврежденного файла
Для демонстрации настройки и обработки ошибок преобразования необходимо создать образец неструктурированного файла, который при обработке вызовет сбой в работе компонента.  
  
В этой задаче предстоит скопировать существующий образец неструктурированного файла. Затем предстоит открыть его в приложении «Блокнот» и изменить столбец **CurrencyID** таким образом, чтобы при поиске совпадений во время преобразования произошел сбой. При обработке нового файла произойдет сбой в преобразовании «Уточняющий запрос» для CurrencyKey, что приведет к ошибке в работе всего пакета. После создания поврежденного образца файла предстоит выполнить пакет, чтобы просмотреть его поведение при сбое.  
  
### <a name="to-create-a-corrupted-sample-flat-file"></a>Создание поврежденного образца неструктурированного файла  
  
1.  В приложении «Блокнот» или другом текстовом редакторе откройте файл Currency_VEB.txt.  
  
    Образцы данных включаются в пакеты занятий по службам SSIS. Чтобы загрузить образцы данных и пакеты занятий выполните следующие действия.  
  
    1.  Перейдите к [образцам продуктов служб Integration Services](http://go.microsoft.com/fwlink/?LinkID=267527).  
  
    2.  Перейдите на вкладку **DOWNLOADS** .  
  
    3.  Щелкните файл SQL2012.Integration_Services.Create_Simple_ETL_Tutorial.Sample.zip.  
  
2.  Используя функции текстового редактора для поиска и замены, замените все вхождения строки **VEB** на **BAD**.  
  
3.  Сохраните измененный файл в той же папке, где находятся остальные файлы образцов данных, с именем **Currency_BAD.txt**.  
  
    > [!IMPORTANT]  
    > Убедитесь в том, что файл **Currency_BAD.txt** сохранен в той же папке, что и другие файлы образцов данных.  
  
4.  Закройте текстовый редактор.  
  
### <a name="to-verify-that-an-error-will-occur-during-run-time"></a>Проверка факта возникновения ошибки во время выполнения  
  
1.  В меню **Отладка** выберите команду **Начать отладку**.  
  
    При третьем проходе потока данных в преобразовании Lookup Currency Key будет предпринята попытка обработать файл Currency_BAD.txt, при этом произойдет ошибка преобразования. Ошибка преобразования вызовет отказ работы всего пакета.  
  
2.  В меню **Отладка** выберите команду **Остановить отладку**.  
  
3.  В области конструктора откройте вкладку **Результаты выполнения** .  
  
4.  Просмотрите журнал и убедитесь, что произошла следующая необработанная ошибка:  
  
    `[Lookup Currency Key[27]] Error: Row yielded no match during lookup.`  
  
    > [!NOTE]  
    > Число 27 представляет собой идентификатор компонента. Это значение присваивается при создании потока данных, так что в пакете оно может отличаться от приведенного в учебнике.  
  
## <a name="next-steps"></a>Next Steps  
[Шаг 3. Добавление перенаправления потока ошибок](../integration-services/lesson-4-3-adding-error-flow-redirection.md)  
  
  
  
