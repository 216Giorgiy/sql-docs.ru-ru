---
title: "Пошаговое руководство: Настройка SQL Server Integration Services для горизонтального масштабирования | Документы Microsoft"
ms.custom: 
ms.date: 07/18/2017
ms.prod: sql-server-2017
ms.reviewer: 
ms.suite: 
ms.technology:
- integration-services
ms.tgt_pltfrm: 
ms.topic: article
caps.latest.revision: 1
author: haoqian
ms.author: haoqian
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: 1419847dd47435cef775a2c55c0578ff4406cddc
ms.openlocfilehash: 9cc5c653fe454b45148583f2e17654657a85b0a5
ms.contentlocale: ru-ru
ms.lasthandoff: 08/03/2017

---
# <a name="walkthrough-set-up-integration-services-scale-out"></a>Пошаговое руководство. Настройка масштабного развертывания Integration Services
Настройка [!INCLUDE[ssISnoversion_md](../../includes/ssisnoversion-md.md)] масштабное развертывание, выполнив следующие задачи. 

> [!NOTE]
> При установке масштабное развертывание на одном компьютере, установите компоненты масштабирования Out главного и масштаб Out рабочих одновременно. При одновременной установке компонентов автоматически создается конечная точка для подключения к главной роли масштабного развертывания. 

* [Установка главной роли масштабного развертывания](#InstallMaster)

* [Установка рабочей роли масштабного развертывания](#InstallWorker)

* [Установка сертификата клиента рабочей роли масштабного развертывания](#InstallCert)

* [Открытие порта брандмауэра](#Firewall)

* [Запуск службы главной и рабочей роли масштабного развертывания](#Start)

* [Включение главной роли масштабного развертывания](#EnableMaster)

* [Включение режима проверки подлинности SQL Server](#EnableAuth)

* [Включение рабочей роли масштабного развертывания](#EnableWorker)

## <a name="InstallMaster"></a> Установка главной роли масштабного развертывания

Чтобы включить функциональные возможности масштабирования Out главный, необходимо установить службы компонента Database Engine, [!INCLUDE[ssISnoversion_md](../../includes/ssisnoversion-md.md)]и его функция масштабирования Out Master при настройке [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)]. 

Сведения о настройке служб ядра СУБД и [!INCLUDE[ssISnoversion_md](../../includes/ssisnoversion-md.md)] см. в разделах [Установка ядра СУБД SQL Server](../../database-engine/install-windows/install-sql-server-database-engine.md) и [Установка служб Integration Services](../install-windows/install-integration-services.md).
> [!NOTE]
> Чтобы использовать учетную запись проверки подлинности SQL по умолчанию для масштабное развертывание ведения журнала, выберите смешанного режима для режима проверки подлинности на странице настройки компонента Database Engine во время установки компонента Database Engine. В разделе [изменить учетную запись для ведения журнала масштабное развертывание](change-logdb-account.md) для получения дополнительной информации.

**Чтобы установить главную роль масштабного развертывания, используйте мастер установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] или командную строку.**

- Шаги для выполнения в мастере установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)]
  1.  На **Выбор компонентов** выберите **шкалы Out главного**, в разделе [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].   
  ![Выбор главной роли](media/feature-select-master.PNG)
  
  2.  На странице **Конфигурация сервера** выберите учетную запись для запуска **службы главной роли масштабного развертывания SQL Server Integration Services** и **Тип запуска**.  
  ![Конфигурация сервера](media/server-config.PNG)
  3.  На странице **Настройка мастера масштабирования служб Integration Services** укажите номер порта, который главная роль масштабного развертывания использует для связи с рабочей ролью. По умолчанию номер порта равен 8391.  
  ![Образец конфигурации](media/master-config.PNG "основной конфигурации")
  4.  Укажите SSL-сертификат, используемый для защиты связи между шкалы Out главного и масштаб ожидания рабочий, выполнив одно из следующих.
    * Запустите процесс установки создать самозаверяющий сертификат SSL, по умолчанию, щелкнув **создать новый сертификат SSL**.  Сертификат по умолчанию устанавливается в доверенных корневых центрах сертификации на локальном компьютере. Можно указать имена сертификатов в этот сертификат. Имя узла основной конечной точки должен включаться в общих имен. По умолчанию включены имя компьютера и IP-адрес главного узла.
    * Выберите существующий Certicate SSL на локальном компьютере, щелкнув **использовать существующий сертификат SSL** и выбрав **Обзор** для выбора сертификата. Отпечаток сертификата отображается в текстовом поле. При нажатии кнопки **Обзор** отображаются сертификаты, хранящиеся в доверенных корневых центрах сертификации на локальном компьютере. Выбранный вами сертификат должен храниться здесь.       
![Образец конфигурации 2](media/master-config-2.PNG "конфигурации Master 2")
  5.  Завершите работу мастера установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)].
- Шаги для выполнения в командной строке

    Следуйте инструкциям в разделе [Установка SQL Server из командной строки](../../database-engine/install-windows/install-sql-server-2016-from-the-command-prompt.md). Задайте параметры для главной роли масштабного развертывания, выполнив указанные ниже действия.
  1.  Добавьте IS_Master в параметр /FEATURES.
  2.  Настройка шкалы Out Master, указав следующие параметры и их значения: /ISMASTERSVCACCOUNT, /ISMASTERSVCPASSWORD, /ISMASTERSVCSTARTUPTYPE, /ISMASTERSVCPORT, /ISMasterSVCSSLCertCN(optional), /ISMASTERSVCTHUMBPRINT(optional).

> [!Note]
> Если масштаб Out Master не устанавливаются вместе с Database Engine и компонент Database Engine является именованным экземпляром, необходимо настроить SqlServerName в файле конфигурации службы шкалы Out Master после установки. В разделе [шкалы Out главного](integration-services-ssis-scale-out-master.md) подробные сведения.

## <a name="InstallWorker"></a> Установка рабочей роли масштабного развертывания
 
Чтобы включить возможности рабочей роли масштабного развертывания, следует установить [!INCLUDE[ssISnoversion_md](../../includes/ssisnoversion-md.md)] и компонент рабочей роли масштабного развертывания в программе установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)].

**Чтобы установить рабочую роль масштабного развертывания, используйте мастер установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] или командную строку.**

- Шаги для выполнения в мастере установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)]
  1.  На **Выбор компонентов** выберите **шкалы Out рабочих**, в разделе [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].   
  ![Выбор рабочей роли](media/feature-select-worker.PNG)
  2. На странице **Конфигурация сервера** выберите учетную запись для запуска **службы рабочей роли масштабного развертывания SQL Server Integration Services** и выберите **Тип запуска**.    
  ![Конфигурация сервера 2](media/server-config-2.PNG "конфигурации сервера 2")
  3. На странице **Настройка рабочей роли масштабирования служб Integration Services** укажите конечную точку для связи с главной ролью масштабного развертывания. 
      > [!Note]
      > Можно пропустить здесь рабочий узел конфигурации (шаг 3 и 4) и связать работника Out масштаб шкалы Out образец с [шкалы ожидания диспетчера](integration-services-ssis-scale-out-manager.md) после установки.

    - Для **на одном компьютере** среды конечной точки обновляется автоматически при шкалы Out главного и масштаб Out работника устанавливаются одновременно. 
    - Для **нескольких компьютеров** среды, конечная точка состоит из имя или IP-адрес компьютера с шкалы Out Master установлен и номер порта, указанный во время установки масштаба Out Master.    
   ![Рабочей конфигурации 1](media/worker-config.PNG "рабочей конфигурации 1")    

  4. Для **нескольких компьютеров** среды, укажите SSL-сертификат клиента, используемый для проверки шкалы Out Master. Для **на одном компьютере** среды, укажите SSL-сертификат клиента не требуется. 
  
     > [!NOTE]
     > При самозаверяющий SSL-сертификаты, используемые шкалы Out Master соответствующий SSL-сертификат клиента должен быть установлен на компьютере с шкалы ожидания рабочим процессом. Если необходимо указать путь к файлу для SSL-сертификат клиента на **конфигурации Integration Services шкалы Out рабочих** страницы, сертификат будет автоматически установлен; в противном случае вы можете установить сертификат вручную позднее. 
     
     Нажмите кнопку **Обзор** , чтобы найти файл сертификата (CER). Чтобы использовать SSL-сертификат по умолчанию, выберите файл SSISScaleOutMaster.cer, расположенный в разделе \<диск\>: \Program Files\Microsoft SQL Server\140\DTS\Binn на компьютере, на котором установлен масштаб Out Master.   
   ![Конфигурации рабочих 2](media/worker-config-2.PNG "рабочей конфигурации 2")
  5. Завершите работу мастера установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)].
- Шаги для выполнения в командной строке

    Следуйте инструкциям в разделе [Установка SQL Server из командной строки](../../database-engine/install-windows/install-sql-server-2016-from-the-command-prompt.md). Задайте параметры, связанные с рабочей ролью масштабного развертывания, выполнив указанные ниже действия.
    1.  Добавьте IS_Worker в параметр /FEATURES.
    2. Настройка шкалы Out Worker указания следующих параметров и их значения: /ISWORKERSVCACCOUNT, /ISWORKERSVCPASSWORD, /ISWORKERSVCSTARTUPTYPE, /ISWORKERSVCMASTER(optional), /ISWORKERSVCCERT(optional).

 
## <a name="InstallCert"></a> Установка сертификата клиента рабочей роли масштабного развертывания

Во время установки шкалы ожидания рабочий сертификат рабочего процесса будет автоматически создается и установленных на компьютере. Кроме того, соответствующий сертификат клиента SSISScaleOutWorker.cer устанавливается в папку \<диск\>:\Program Files\Microsoft SQL Server\140\DTS\Binn. Для масштабирования ожидания базы данных Master для проверки подлинности рабочих шкалы Out необходимо добавить данный сертификат клиента в корневое хранилище сертификатов на локальном компьютере с шкалы Out Master.
  
Чтобы добавить сертификат клиента в корневое хранилище, дважды щелкните файл CER и нажмите кнопку **Установить сертификат** в диалоговом окне сертификата. Отображается **Мастер импорта сертификатов** .  

## <a name="Firewall"></a> Открытие порта брандмауэра

Открыть порт, указанный во время установки масштаба Out главного и порт для SQL Server (по умолчанию 1433) с помощью брандмауэра Windows на компьютере шкалы Out Master.
    
## <a name="Start"></a> Запуск службы главной и рабочей роли масштабного развертывания

Если тип запуска службы не задано автоматически во время установки, запустите службы: SQL Server Integration служб шкалы Out Master 14.0 (SSISScaleOutMaster140) и SQL Server Integration служб шкалы Out работника 14.0 (SSISScaleOutWorker140). 

> [!Note]
> После открытия порта в брандмауэре также необходимо перезапустить службу шкалы Out рабочих.
   
## <a name="EnableMaster"></a> Включение главной роли масштабного развертывания

Щелкните **Включить этот сервер в качестве мастера масштабирования SSIS** в диалоговом окне **Создать каталог** при создании каталога SSISDB в [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] [!INCLUDE[ssManStudio_md](../../includes/ssmanstudio-md.md)]. Кроме того, можно включить шкалы Out главного с [шкалы ожидания диспетчера](integration-services-ssis-scale-out-manager.md) после создания каталога.

## <a name="EnableAuth"></a> Включение режима проверки подлинности SQL Server
Если [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] не включена проверка подлинности во время установки компонента Database Engine, включите режим проверки подлинности SQL Server на [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] экземпляр, на котором размещен каталог SSISDB. 

При отключенной проверке подлинности SQL Server выполнение пакетов не блокируется. Тем не менее журнал выполнения не сможет осуществлять запись в SSISDB.

## <a name="EnableWorker"></a> Включение рабочей роли масштабного развертывания

Масштаб Out работника можно включить с помощью [шкалы ожидания диспетчера](integration-services-ssis-scale-out-manager.md), который предоставляет графического пользовательского интерфейса; или включить с помощью хранимой процедуры, см. ниже.

Чтобы включить рабочую роль масштабного развертывания, выполните хранимую процедуру *[catalog].[enable_worker_agent]* , используя **WorkerAgentId** в качестве параметра. 

После регистрации рабочей роли масштабного развертывания в главной роли вы получаете значение **WorkerAgentId** из представления базы данных *[catalog].[worker_agents]* в SSISDB. Регистрация занимает несколько минут после запуска главной и рабочей ролей.

#### <a name="example"></a>Пример
В этом примере включается работника Out шкалы на компьютер а.
```tsql
SELECT WorkerAgentId, MachineName FROM [catalog].[worker_agents]
GO
-- Result: --
-- WorkerAgentId                           MachineName  --
-- 6583054A-E915-4C2A-80E4-C765E79EF61D    computerA    --

EXEC [catalog].[enable_worker_agent] '6583054A-E915-4C2A-80E4-C765E79EF61D'
GO 
```
## <a name="next-steps"></a>Следующие шаги
Настройка функции масштабного развертывания завершена. Теперь можно запустить пакеты в масштабное развертывание. Дополнительные сведения см. в разделе [Выполнение пакетов в масштабном развертывании служб Integration Services (SSIS)](run-packages-in-integration-services-ssis-scale-out.md).
