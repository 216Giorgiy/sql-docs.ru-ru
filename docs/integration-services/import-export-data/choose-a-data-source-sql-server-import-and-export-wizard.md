---
title: "Выбор источника данных (мастер импорта и экспорта SQL Server) | Microsoft Docs"
ms.custom: 
  - "SQL2016_New_Updated"
ms.date: "03/16/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "integration-services"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "sql13.dts.impexpwizard.chooseadatasource.f1"
ms.assetid: ebf28a62-dfc1-4b39-9db5-df1919e5fccb
caps.latest.revision: 124
author: "douglaslMS"
ms.author: "douglasl"
manager: "jhubbard"
caps.handback.revision: 113
---
# Выбор источника данных (мастер импорта и экспорта SQL Server)
  После страницы приветствия в мастере импорта и экспорта [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] откроется страница **Выбор источника данных**. На этой странице введите сведения об источнике данных и о том, как к нему подключиться.
  
Сведения об источниках данных, которые можно использовать, см. в разделе [Какие источники данных и назначения можно использовать](../../integration-services/import-export-data/import-and-export-data-with-the-sql-server-import-and-export-wizard.md#wizardSources).

## <a name="screen-shot-of-the-choose-a-data-source-page"></a>Снимок экрана: страница "Выбор источника данных" 
На следующем снимке экрана показана первая часть страницы **Выбор источника данных** мастера.

![Выбор источника](../../integration-services/import-export-data/media/choose-source.png)

## <a name="choose-a-data-source"></a>Выбор источника данных
 **Источник данных**  
Укажите источник данных, выбрав поставщик данных, который может подключиться к источнику. В большинстве случаев поставщик данных можно выбрать по имени, поскольку имя поставщика обычно содержит имя источника, например SQL Server, Oracle, неструктурированные файлы, Excel и Access.

Содержание списка **Источник данных** зависит от того, какие поставщики данных установлены на вашем компьютере, а также от того, работаете вы с 64- или 32-разрядным мастером.

Для источника данных может существовать несколько поставщиков. Как правило, можно выбрать любой поставщик, работающий с нужным источником данных. Например, для подключения к Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] можно использовать [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client, поставщик данных .NET Framework для SQL Server или поставщик Microsoft OLE DB для SQL Server. 

В некоторых случаях для начала нужно выбрать универсальный поставщик данных. Например, если у вас есть драйвер ODBC для источника данных, выберите поставщик данных .NET Framework для ODBC.  
 
Для некоторых источников данных поставщик необходимо загрузить с веб-сайта корпорации Майкрософт или другого разработчика. Сведения об источниках данных, которые можно использовать, см. в разделе [Какие источники данных и назначения можно использовать](Import%20and%20Export%20Data%20with%20the%20SQL%20Server%20Import%20and%20Export%20Wizard.md\#wizardSources).

## <a name="after-you-choose-a-data-source"></a>После выбора источника данных
После того, как вы выберете источник данных, в остальной части страницы **Выбор источника данных** отобразится определенный набор параметров, который зависит от выбранного поставщика данных.

В следующих разделах перечислены важные параметры некоторых часто используемых источников данных. Здесь перечислены не все источники, которые могут быть доступны в раскрывающемся списке **Источник данных**. Сведения о дополнительных параметрах других поставщиков см. в документации по соответствующему поставщику. 
  
> [!TIP]  Если для источника данных требуется строка подключения, см. примеры на стороннем сайте [The Connection Strings Reference](https://www.connectionstrings.com/) (Справочник по строкам подключения).  

## <a name="microsoft-sql-server"></a>Microsoft SQL Server 

### <a name="connect-to-sql-server-with-sql-server-native-client-or-the-microsoft-ole-db-provider-for-sql-server"></a>Подключение к SQL Server через собственный клиент SQL Server или поставщик Microsoft OLE DB для SQL Server  

Собственный клиент SQL Server и поставщик Microsoft OLE DB для SQL Server имеют одинаковый набор параметров. На следующем снимке экрана в качестве примера показаны параметры для собственного клиента SQL Server.

![Подключение к SQL Server через собственный клиент](../../integration-services/import-export-data/media/sql-server-connection-native.png)

 **Имя сервера**  
 Введите имя или IP-адрес сервера, содержащего данные, или выберите сервер из списка.  
  
> [!NOTE] Если в сети много серверов, имя сервера проще ввести вручную. Если вы щелкнете раскрывающийся список, запрос всех доступных серверов может потребовать много времени, причем нужного сервера может не оказаться в списке.

Чтобы указать нестандартный TCP-порт, введите запятую после имени или IP-адреса сервера, а затем введите номер порта.
  
 **Использовать проверку подлинности Windows**  
 Укажите, должен ли мастер использовать проверку подлинности [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows для доступа к базе данных. Для лучшей защиты рекомендуется использовать проверку подлинности Windows.  
  
 **Использовать проверку подлинности SQL Server**  
 Укажите, должен ли мастер использовать проверку подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для доступа к базе данных. Если используется проверка подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , необходимо ввести имя пользователя и пароль.  
  
 **Имя пользователя**  
 Укажите имя пользователя для подключения к базе данных, если используется проверка подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
 **Пароль**  
 Укажите пароль для подключения к базе данных, если используется проверка подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
 **База данных**  
 Выберите базу данных из списка баз данных на указанном экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
 **Обновить**  
 Обновите список доступных баз данных нажатием кнопки **Обновить**.  
  
### <a name="connect-to-sql-server-with-the-net-framework-data-provider-for-sql-server"></a>Подключение к SQL Server через поставщик Microsoft OLE DB для SQL Server 

На этой странице представлен сгруппированный список параметров поставщика данных [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] для [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Важные параметры перечислены ниже. Другие перечисленные ниже параметры для успешного подключения к базе данных-источнику [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] при выборе этого поставщика обычно указывать необязательно. 

Дополнительные сведения см. в разделе [Строки подключения поставщика данных .NET Framework для SQL Server](https://www.connectionstrings.com/sqlconnection/).

![Подключение к SQL Server через .NET](../../integration-services/import-export-data/media/sql-server-connection-net.png)
  
 **Источник данных**  
 Введите имя или IP-адрес сервера, содержащего данные, или выберите сервер из списка.  
  
> [!NOTE] Если в сети много серверов, имя сервера проще ввести вручную. Если вы щелкнете раскрывающийся список, запрос всех доступных серверов может потребовать много времени, причем нужного сервера может не оказаться в списке.  
 
 Чтобы указать нестандартный TCP-порт, введите запятую после имени или IP-адреса сервера, а затем введите номер порта.
 
 **Исходный каталог**  
 Введите имя базы данных-источника или выберите базу данных из списка.  
  
 **Встроенные функции безопасности**  
 Выберите значение **True**, чтобы использовать встроенную проверку подлинности Windows (рекомендуется), или **False** для подключения с использованием проверки подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. При выборе **False**необходимо ввести идентификатор пользователя и пароль. Значение по умолчанию равно **False**.  
  
 **Идентификатор пользователя**  
 Укажите имя пользователя для подключения к базе данных, если используется проверка подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
 **Пароль**  
 Укажите пароль для подключения к базе данных, если используется проверка подлинности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  

## <a name="oracle"></a>Oracle;

Подключение к Oracle с использованием поставщика данных .NET Framework для Oracle или поставщика OLE DB для Oracle (Майкрософт). Поставщик данных .NET Framework для Oracle легче настраивается и показан на приведенном ниже снимке экрана.

Дополнительные сведения см. в разделе [Строки подключения поставщика данных .NET Framework для Oracle](https://www.connectionstrings.com/net-framework-data-provider-for-oracle/) или [Строки подключения поставщика Microsoft OLE DB для Oracle](https://www.connectionstrings.com/microsoft-ole-db-provider-for-oracle-msdaora/).

![Подключение через Oracle](../../integration-services/import-export-data/media/oracle-connection.png)

## <a name="odbc-data-sources"></a>источники данных ODBC

Для загрузки данных из любого источника, оснащенного драйвером ODBC, выберите поставщик данных .NET Framework для ODBC.

Информацию о строке подключения для источника данных ODBC см. в документации к драйверу ODBC, который вы собираетесь использовать, или примеры на сайте [The Connection Strings Reference](https://www.connectionstrings.com/) (Справочник по строкам подключения). 

На следующем снимке экрана в качестве примера показано подключение ODBC к SQL Server. В этом примере используется следующая строка подключения:

    Driver={SQL Server};Server=(local);Database=TestData;Trusted_Connection=Yes;

После того как вы введете строку подключения в поле **Строка подключения**, мастер проанализирует ее и отобразит соответствующие индивидуальные свойства и их значения в разделе **Разное**.

![Подключение к SQL через ODBC](../../integration-services/import-export-data/media/odbc-connection-sql.png)

## <a name="text-files-flat-files"></a>Текстовые (неструктурированные) файлы
 
 Параметры для источников данных типа "Неструктурированный файл" занимают несколько страниц.
 
 ### <a name="general-page"></a>Страница "Общие"
 На странице **Общие** найдите и выберите файл, а затем проверьте параметры в разделе **Формат**.
 
 ![Подключение через неструктурированный файл: "Общие"](../../integration-services/import-export-data/media/flat-file-connection-general.png)  
   
Дополнительные сведения о странице **Общие** см. на следующей странице справочника по службам Integration Services: [Редактор диспетчера соединений с неструктурированными файлами (страница "Общие")](../../integration-services/connection-manager/flat-file-connection-manager-editor-general-page.md).  

### <a name="columns-page"></a>Страница "Столбцы"

 На странице **Столбцы** проверьте список обнаруженных мастером столбцов и разделителей.
 
 ![Подключение через неструктурированный файл: столбцы](../../integration-services/import-export-data/media/flat-file-connection-columns.png)
  
Дополнительные сведения о странице **Столбцы** см. на следующей странице справочника по службам Integration Services: [Редактор диспетчера соединений с неструктурированными файлами (страница "Столбцы")](../../integration-services/connection-manager/flat-file-connection-manager-editor-columns-page.md).

### <a name="advanced-page"></a>Страница "Дополнительно"

На странице **Дополнительно** отображаются подробные сведения о каждом столбце в источнике данных, включая тип данных и размер.

Обратите внимание, что на следующем снимке экрана столбец **идентификатор** изначально имеет тип данных "Строка".

![Подключение через неструктурированный файл: "Дополнительно" (до)](../../integration-services/import-export-data/media/flat-file-connection-advanced-before.png)

Щелкните **Предложить типы...**, чтобы открыть окно **Предположение типов столбцов**. 

![Подключение через неструктурированный файл: "Предложение"](../../integration-services/import-export-data/media/flat-file-connection-suggest.png)

После того как вы выберете параметры в диалоговом окне **Предположение типов столбцов** и нажмете кнопку **ОК**, типы данных в некоторых предназначенных для импорта столбцов могут измениться.

На следующем снимке экрана мастер определил, что столбец **id** в источнике данных фактически представляет собой число, а не текстовую строку, и изменит тип данных со строки на целое число.

![Подключение через неструктурированный файл: "Дополнительно" (после)](../../integration-services/import-export-data/media/flat-file-connection-advanced-after.png)
  
Дополнительные сведения о странице **Дополнительно** см. на следующей странице справочника по службам Integration Services: [Редактор диспетчера соединений с неструктурированными файлами (страница "Дополнительно")](../../integration-services/connection-manager/flat-file-connection-manager-editor-advanced-page.md).

### <a name="preview-page"></a>Страница "Предварительный просмотр"

На странице **Предварительный просмотр** убедитесь, что список столбцов и образец данных соответствуют вашим ожиданиям.

![Подключение через неструктурированный файл: "Предварительный просмотр"](../../integration-services/import-export-data/media/flat-file-connection-preview.png)

Дополнительные сведения о странице **Предварительный просмотр** см. на следующей странице справочника по службам Integration Services: [Редактор диспетчера соединений с неструктурированными файлами (страница "Предварительный просмотр")](../../integration-services/connection-manager/flat-file-connection-manager-editor-preview-page.md).  
 
## <a name="microsoft-excel"></a>Microsoft Excel

На следующем снимке экрана показан пример подключения к книге Microsoft Excel.

![Подключение через Excel](../../integration-services/import-export-data/media/excel-connection.png) 
 
 **Путь к файлу Excel**  
 Укажите путь и имя файла для рабочего листа, с которого импортируются данные. Например, **C:\\MyData.xlsx** для файла на локальном компьютере или **\\\\Sales\\Database\\Northwind.xlsx** для файла на общем сетевом ресурсе. или нажмите **Обзор**.  
  
 **Обзор**  
 Выберите электронную таблицу с помощью диалогового окна **Открыть**.  

> [!NOTE] Мастер не может открыть защищенный паролем файл Excel.

 **Версия Excel**  
 Выберите версию Excel для исходной рабочей книги.

Может потребоваться скачать и установить дополнительные файлы для подключения к выбранной версии Excel. Дополнительные сведения см. в разделе [Получение скачиваемых файлов, необходимых для Excel и Access](Choose%20a%20Data%20Source%20\%28SQL%20Server%20Import%20and%20Export%20Wizard%29.md\#officeDownloads) на этой странице.

Если при указании версии возникает проблема (например, если невозможно установить среду выполнения Access 2016, так как у вас установлен набор Microsoft Office 365), попробуйте указать другую, даже более раннюю версию, например 2013 вместо 2016.

**Первая строка содержит имена столбцов.**  
Укажите, содержит ли первая строка исходных данных имена столбцов.
-   Если исходные данные содержат имена столбцов, но этот параметр включен, мастер рассматривает первую строку исходных данных как имена столбцов.
-   Если исходные данные содержат имена столбцов, но этот параметр отключен, мастер рассматривает строку имен столбцов как первую строку данных.

Если в исходных данных отсутствуют имена столбцов, в качестве временных заголовков столбцов мастер внутренним образом использует F1, F2 и т. д.

## <a name="microsoft-access"></a>Microsoft Access  

На следующем снимке экрана показан пример подключения к базе данных Microsoft Access.

![Подключение через Access](../../integration-services/import-export-data/media/access-connection.png)

 **Имя файла**  
 Укажите путь и имя файла базы данных, их которого импортируются данные. Например, **C:\MyData.mdb, \\\Sales\Database\Northwind.mdb**. или нажмите **Обзор**.
 
 >   [!NOTE] Мастер может подключиться к базе данных Access, только если она представляет собой файл в формате MDB.  
  
 **Обзор**  
 Выберите файл базы данных с помощью диалогового окна **Открыть**.  
  
 **Имя пользователя**  
Если информационный файл рабочей группы связан с базой данных, укажите допустимое имя пользователя для подключения к базе данных.  
  
 **Пароль**  
Если информационный файл рабочей группы связан с базой данных, укажите пароль пользователя для подключения к базе данных.
 
Если база данных защищена одним и тем же паролем для всех пользователей, укажите это значение в диалоговом окне **Свойства связи данных**. Чтобы открыть диалоговое окно **Свойства связи данных**, нажмите кнопку **Дополнительно**.  
  
 **Дополнительно**  
Задайте дополнительные параметры (например, пароль базы данных или нестандартный информационный файл рабочей группы) в диалоговом окне **Свойства связи данных**.  
  
## <a name="a-nameofficedownloadsaget-the-downloads-you-need-for-excel-and-access"></a><a name="officeDownloads"></a> Получение скачиваемых файлов, необходимых для Excel и Access  
Если компоненты подключения для источников данных Microsoft Excel и Access не установлены, может потребоваться скачать их.

Более поздние версии компонентов могут открывать файлы, созданные в более ранних версиях программ. В некоторых случаях более ранние версии компонентов могут также открывать файлы, созданные в более поздних версиях программ.  
  
Если на компьютере установлена 32-разрядная версия Office, необходимо установить 32-разрядную версию компонентов. Кроме того, мастер (или создаваемый им пакет служб Integration Services) должен работать в 32-разрядном режиме.  
|Версия Microsoft Office|Загрузить|  
|------------------------------|--------------|  
|2007 г.|[Системный драйвер Office 2007: компоненты подключения к данным](https://www.microsoft.com/download/details.aspx?id=23734)|  
|2010|[Среда выполнения Microsoft Access 2010](https://www.microsoft.com/download/details.aspx?id=10910)|  
|2013|[Среда выполнения Microsoft Access 2013](http://www.microsoft.com/download/details.aspx?id=39358)|  
|2016|[Среда выполнения Microsoft Access 2016](https://www.microsoft.com/download/details.aspx?id=50040)|  
 
 
## <a name="azure-blob-storage"></a>Хранилище больших двоичных объектов Azure  
Чтобы использовать назначение источник двоичных объектов Azure, необходимо установить пакет дополнительных компонентов Azure для служб SSIS. Дополнительные сведения см. в статье [Пакет дополнительных компонентов Azure для служб Integration Services (SSIS)](../../integration-services/azure-feature-pack-for-integration-services-ssis.md).  

>   [!NOTE] Чтобы диспетчер соединений хранилища Azure и компоненты, которые его используют (включая источник BLOB-объектов), могли подключаться к учетным записям хранения общего назначения и учетным записям хранения BLOB-объектов, убедитесь, что вы скачали последнюю версию пакета дополнительных компонентов Azure [здесь](https://www.microsoft.com/download/details.aspx?id=49492). Дополнительные сведения об этих двух типах учетных записей хранения см. на странице [Вводная информация о службе хранилища Microsoft Azure](https://azure.microsoft.com/en-us/documentation/articles/storage-introduction/#general-purpose-storage-accounts).

![Подключение хранилища BLOB-объектов Azure](../../integration-services/import-export-data/media/azure-blob-storage-connection.png)

 **Использовать учетную запись Azure**  
 Укажите, следует ли использовать сетевую учетную запись.
  
 **Имя учетной записи хранения**  
 Укажите имя учетной записи хранения Azure.  
  
**Ключ учетной записи**  
Предоставьте ключ для учетной записи хранения Azure.  
  
 **Использовать HTTPS**  
 Укажите, какой протокол следует использовать для подключения к учетной записи хранения: HTTP или HTTPS.  
  
 **Использовать локальную учетную запись разработчика**  
 Укажите, следует ли использовать эмулятор хранения на локальном компьютере.  
  
 **Имя контейнера больших двоичных объектов**  
 Выберите контейнер в списке контейнеров хранилища, который доступен в указанной учетной записи хранения.  
  
 **Формат файла большого двоичного объекта**  
 Выберите формат файла Text или Avro.  
  
 **Символ-разделитель столбцов**  
 Если выбран текстовый формат, укажите знак-разделитель столбцов.  
  
 **Использовать первую строку в качестве имен столбцов**  
 Укажите, содержит ли первая строка данных имена столбцов.  
  
## <a name="whats-next"></a>Дальнейшие действия  
 После того как вы укажете сведения об источнике данных и о том, как к нему подключиться, откроется страница **Выбор назначения**. На этой странице введите сведения о месте назначения для данных и о том, как к нему подключиться. Дополнительные сведения см. в разделе [Выбор назначения](../../integration-services/import-export-data/choose-a-destination-sql-server-import-and-export-wizard.md).  
