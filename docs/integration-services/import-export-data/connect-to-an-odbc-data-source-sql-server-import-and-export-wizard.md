---
title: "Подключение к источнику данных ODBC (мастер экспорта и импорта SQL Server) | Документы Microsoft"
ms.custom: 
ms.date: 03/16/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- integration-services
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: e6318776-a188-48a7-995d-9eafd7148ff2
caps.latest.revision: 9
author: douglaslMS
ms.author: douglasl
manager: jhubbard
ms.workload: Active
ms.translationtype: MT
ms.sourcegitcommit: 21f0cfd102a6fcc44dfc9151750f1b3c936aa053
ms.openlocfilehash: 0e3ffe2ff1695de69be7149f4be7b42f57b0e991
ms.contentlocale: ru-ru
ms.lasthandoff: 08/28/2017

---
# <a name="connect-to-an-odbc-data-source-sql-server-import-and-export-wizard"></a>Подключение к источнику данных ODBC (мастер экспорта и импорта SQL Server)
В этом разделе показано, как подключиться к **ODBC** из источника данных **выберите источник данных** или **Выбор назначения** страницы мастера экспорта и импорта SQL Server.

Может потребоваться загрузить драйвер ODBC, необходимо от корпорации Майкрософт или сторонней разработки.

Кроме того, может потребоваться поиск сведений о соединении требуется, вы должны предоставить. Этот узел сторонних - [Reference строки подключения](https://www.connectionstrings.com/) -содержит примеры строк подключения и Дополнительные сведения о поставщиках данных и сведений о соединении, они требуют.

## <a name="make-sure-the-driver-you-want-is-installed"></a>Убедитесь, что драйвера, который будет установлен
1.  Поиск или перейти к **источники данных ODBC (64-разрядная версия)** элемент панели управления. Если имеется только 32-разрядный драйвер, или вы знаете, что нужно использовать 32-разрядный драйвер, поиск, или выберите **источники данных ODBC (32-разрядная версия)** вместо него.
2.  Запустите приложение. **Администратор источников данных ODBC** открывается окно.
3.  На **драйверы** вкладку, можно найти список драйверов ODBC, установленной на компьютере. (Имена некоторые драйверы могут отображаться на нескольких языках.)

    Ниже приведен пример списка установленных 64-разрядные драйверы.

    ![Установить 64-разрядные драйверы ODBC](../../integration-services/import-export-data/media/installed-64-bit-odbc-drivers.png)

> [!TIP]
> Если вы знаете, что ваш драйвер установлен и вы не видите в 64-разрядное приложение, найдите в 32-разрядное приложение. Это также означает, нужно ли запустить 64-разрядной или 32-разрядный SQL Server мастер импорта и экспорта.
>
> Чтобы использовать 64-разрядной версии мастера экспорта и импорта SQL Server, необходимо установить SQL Server. SQL Server Data Tools (SSDT) и SQL Server Management Studio (SSMS), 32-разрядных приложений и установить только 32-разрядных файлов, включая 32-разрядную версию мастера.
    
## <a name="step-1---select-the-data-source"></a>Шаг 1. Выбор источника данных
Драйверы ODBC, установленной на компьютере не перечислены в раскрывающемся списке источников данных. Чтобы подключиться с помощью драйвера ODBC, начинают с выбора **поставщик данных .NET Framework для ODBC** как источник данных на **выберите источник данных** или **Выбор назначения** странице мастера. Этот поставщик действует как оболочка для драйвера ODBC.

Вот универсального экран, появляется сразу после выбора поставщик данных .NET Framework для ODBC.

![Подключение к SQL с ODBC до](../../integration-services/import-export-data/media/connect-to-sql-with-odbc-before.jpg)

## <a name="step-2---provide-the-connection-info"></a>Шаг 2 - предоставляют сведения о подключении
Следующим шагом является для предоставления сведений о соединении для драйвера ODBC и источника данных. Имеются две возможности.
1.  Укажите **DSN** (имя источника данных), уже существует, или создайте с **администратор источников данных ODBC** элемент панели управления. Имя источника данных является сохраненная коллекция параметров, необходимых для подключения к источнику данных ODBC.

    Если вы уже знаете имя DSN или знать правила создания нового источника данных теперь, можно пропустить с оставшейся части этой страницы. Введите в поле имя DSN **Dsn** на **выберите источник данных** или **Выбор назначения** страницы, а затем продолжайте к следующему шагу мастера.

    [Укажите имя источника данных](#odbc_dsn)
    
2.  Укажите **строка подключения**, online, поиск или создание и тестирование на компьютере с **администратор источников данных ODBC** приложения.

    Если строка подключения или уже знаете, как создать его, можно пропустить с оставшейся части этой страницы. Введите строку подключения в **ConnectionString** на **выберите источник данных** или **Выбор назначения** страницы, а затем продолжайте к следующему шагу мастера.

    [Укажите строку соединения](#odbc_connstring)

Если указать строку подключения **выберите источник данных** или **Выбор назначения** странице отображаются все сведения о соединении, мастер будет использовать для подключения к источнику данных, например сервера и базы данных имя и метод проверки подлинности. Если указать имя источника данных, эта информация не отображается.

## <a name="odbc_dsn"></a>Вариант 1: укажите имя источника данных
Если вы хотите предоставить сведения о соединении с DSN (имя источника данных), используйте **администратор источников данных ODBC** приложение для поиска имени существующего источника данных или для создания нового источника данных.
1.  Поиск или перейти к **источники данных ODBC (64-разрядная версия)** элемент панели управления. При наличии только 32-разрядный драйвер, либо использовать 32-разрядный драйвер, поиск, или перейти к **источники данных ODBC (32-разрядная версия)** вместо него.
2.  Запустите приложение. **Администратор источников данных ODBC** открывается окно. Вот, как выглядит приложение.

    ![Администратор ODBC на панели управления](../../integration-services/import-export-data/media/odbc-administrator-control-panel-applet.png)
    
3.  Если вы хотите **использования существующего источника данных** для источника данных можно использовать любое имя источника данных, отображаемых для **DSN пользователя**, **системный DSN**, или **файловый DSN** вкладки. Проверьте имя, а затем вернуться в мастер и введите его в **Dsn** на **выберите источник данных** или **Выбор назначения** страницы. Пропустите оставшейся части этой страницы и перейдите к следующему шагу мастера.
4.  Если вы хотите **Создание нового источника данных**, решите, следует быть видны ли только текущему пользователю (Пользовательский DSN), видимы всем пользователям компьютера, включая Windows служб (системный DSN) или сохранен в файле (Файловый DSN). В этом примере создается новый системный DSN.
5. На **системный DSN** щелкните **добавить**.

    ![Добавить новую систему ODBC DSN](../../integration-services/import-export-data/media/add-a-new-odbc-system-dsn.png)
    
6.  В **создать новый источник данных** диалоговое окно, выберите драйвер для источника данных, а затем нажмите кнопку **Готово**.

    ![Выберите драйвер для новый системный DSN](../../integration-services/import-export-data/media/pick-driver-for-new-system-dsn.png)
    
7. Драйвер теперь отображает один или несколько экранов драйвера, где введите сведения, необходимые для подключения к источнику данных. (Для драйвера SQL Server, например, отсутствуют четыре страницы настраиваемых параметров.) После завершения, в списке появляется новая система DSN.

    ![Новый системный DSN в списке](../../integration-services/import-export-data/media/new-system-dsn-in-list.png)
    
8.  Вернитесь в мастер и введите в поле имя DSN **Dsn** на **выберите источник данных** или **Выбор назначения** страницы. Продолжить на следующем шаге мастера.

## <a name="odbc_connstring"></a>Вариант 2: укажите строку соединения
Если вы хотите предоставить сведения о подключении к со строкой соединения, остальной части этого раздела поможет получить строку подключения, что нужно.

В этом примере будет использоваться следующая строка подключения, которая подключается к Microsoft SQL Server.

    ```
    Driver={ODBC Driver 13 for SQL Server};server=localhost;database=WideWorldImporters;trusted_connection=Yes;
    ```

Введите строку подключения в **ConnectionString** на **выберите источник данных** или **Выбор назначения** страницы. Введите строку подключения, мастер анализирует строку и отображает отдельные свойства и их значения в списке.

Вот экрана, которое будет отображаться после ввода строки подключения.

![Подключение к SQL с ODBC после](../../integration-services/import-export-data/media/connect-to-sql-with-odbc-after.jpg)

> [!NOTE]
> Параметры соединения для драйвера ODBC одинаковы ли вы настраиваете источнике или месте назначения. То есть варианты, вы увидите одинаковы на обоих **выберите источник данных** и **Выбор назначения** страницах мастера.

## <a name="get-the-connection-string-online"></a>Получить строку подключения
Строки подключения для драйвера ODBC, в разделе [Reference строки соединения](https://www.connectionstrings.com/). Этот сайт стороннего содержит примеры строк подключения и Дополнительные сведения о поставщиках данных и сведений о соединении, которые необходимы.

## <a name="get-the-connection-string-with-an-app"></a>Получить строку подключения с помощью приложения
Чтобы построить и проверьте строку соединения по драйверу ODBC на локальном компьютере, можно использовать **администратор источников данных ODBC** элемент панели управления. Создать файловый DSN для подключения, а затем копировать параметры из файловый DSN для сборки строки подключения. Это требует выполнения нескольких действий, но помогает обеспечить, что у вас есть допустимую строку соединения.

1.  Поиск или перейти к **источники данных ODBC (64-разрядная версия)** элемент панели управления. При наличии только 32-разрядный драйвер, либо использовать 32-разрядный драйвер, поиск, или перейти к **источники данных ODBC (32-разрядная версия)** вместо него.
2.  Запустите приложение. **Администратор источников данных ODBC** открывается окно.
3.  Теперь перейдите к **файловый DSN** вкладку приложения. Нажмите кнопку **Добавить**.

    В этом примере создайте файловый DSN, а не пользовательский DSN или системный DSN, так как файловый DSN сохраняет пары «имя значение» в определенном формате, необходимых для строки подключения.

    ![Добавьте новый файл ODBC DSN](../../integration-services/import-export-data/media/add-a-new-odbc-file-dsn.png)

4.  В **Создание нового источника данных** диалоговое окно, выберите драйвер в списке и нажмите кнопку **Далее**. В этом примере будет создана DSN, который содержит аргументы строки соединения, необходимо подключиться к Microsoft SQL Server.

    ![Создать новый источник данных ODBC](../../integration-services/import-export-data/media/create-new-odbc-data-source.png)
    
5.  Выберите расположение и введите имя файла для нового файла источника данных и нажмите кнопку **Далее**. Помните, где сохранить файл, можно найти и открыть его на последующем шаге.

    ![Сохранить новый файловый DSN](../../integration-services/import-export-data/media/save-new-file-dsn.png)

6.  Просмотрите сводку выбранных параметров, а затем нажмите кнопку **Готово**.

7.  После нажатия кнопки **Готово**, драйвер, который вы выбрали отображает один или несколько собственных экраны для сбора сведений, необходимо подключение. Обычно эти сведения включают сервер, сведения о имени входа и базы данных для источников данных на основе сервера и файл, формат и версия для источников данных на основе файлов.

8. После настройки источника данных и нажмите кнопку **Готово**, обычно просмотреть выбранные параметры и иметь возможность проверить их.

    ![Новый файловый DSN теста](../../integration-services/import-export-data/media/test-new-file-dsn.png)

9. После проверки источник данных и закройте диалоговые окна, найдите файловый DSN, где был сохранен в файловой системе. Если не изменить расширение файла, по умолчанию используется расширение. ИМЯ ИСТОЧНИКА ДАННЫХ.

10. Откройте сохраненный файл с «Блокнот» или другом текстовом редакторе. Далее приведено содержимое из нашего примера SQL Server.

    ```   
    [ODBC]  
    DRIVER=ODBC Driver 13 for SQL Server  
    TrustServerCertificate=No  
    DATABASE=WideWorldImporters    
    WSID=<local computer name>  
    APP=Microsoft® Windows® Operating System  
    Trusted_Connection=Yes  
    SERVER=localhost   
    ```
        
11. Скопируйте и вставьте необходимые значения в строку подключения, в котором пары «имя значение» разделенных точкой с запятой.

    После собрать необходимые значения из файла образца DSN, имеется следующая строка подключения.
    
        ```
        DRIVER=ODBC Driver 13 for SQL Server;SERVER=localhost;DATABASE=WideWorldImporters;Trusted_Connection=Yes
        ```

    Не требуется обычно все параметры источника данных, созданные, администратор источников данных ODBC для создания строки подключения, которое работает.  
    -   Всегда необходимо указывать драйвер ODBC.
    -   Для источника данных на основе сервера как SQL Server обычно требуется сервер, базу данных и сведения об имени входа. В образце источника данных, вам требуется TrustServerCertificate, WSID или приложения.
    -   Для источника данных на основе файла требуется по крайней мере файл имя и расположение.
    
12. Вставьте эту строку подключения в **ConnectionString** на **выберите источник данных** или **Выбор назначения** странице мастера. Мастер анализирует строку, и вы будете готовы продолжить!

    ![Подключение к SQL с ODBC после](../../integration-services/import-export-data/media/connect-to-sql-with-odbc-after.jpg)

## <a name="see-also"></a>См. также:
[Выберите источник данных](../../integration-services/import-export-data/choose-a-data-source-sql-server-import-and-export-wizard.md)  
[Выбор назначения](../../integration-services/import-export-data/choose-a-destination-sql-server-import-and-export-wizard.md)



