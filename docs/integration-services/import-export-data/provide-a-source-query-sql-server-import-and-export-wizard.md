---
title: "Определение исходного запроса (мастер экспорта и импорта SQL Server) | Документы Microsoft"
ms.custom: 
ms.date: 03/16/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- integration-services
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- sql13.dts.impexpwizard.providesourcequery.f1
ms.assetid: c8cbd07e-b9c3-422f-94b8-d6fc8cf31cf5
caps.latest.revision: 61
author: douglaslMS
ms.author: douglasl
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: 2edcce51c6822a89151c3c3c76fbaacb5edd54f4
ms.openlocfilehash: 190c39de92d8fc1b559f43c90c95e446ccc87272
ms.contentlocale: ru-ru
ms.lasthandoff: 09/26/2017

---
# <a name="provide-a-source-query-sql-server-import-and-export-wizard"></a>Определение исходного запроса (мастер импорта и экспорта SQL Server)
Если вы указали, что нужно определить запрос для выбора копируемых данных, в мастере импорта и экспорта [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] откроется страница **Определение исходного запроса**. На этой странице выполняется написание и тестирование запроса SQL, который выбирает данные для копирования из источника данных в место назначения. Можно также вставить текст сохраненный запрос или загрузить текст запроса из файла.

## <a name="screen-shot-of-the-source-query-page"></a>Снимок экрана: страница "Исходный запрос"  
На следующем снимке экрана показана страница мастера **Определение исходного запроса** .
 
В этом простом примере пользователь ввел запрос `SELECT * FROM Sales.Customer` чтобы скопировать все строки и столбцы из **Sales.Customer** таблицы базы данных-источника.
-   `SELECT *`означает копирование всех столбцов.
-   Отсутствие `WHERE` предложение означает копирование всех строк.
  
 ![Страница «источник запроса» мастера импорта и экспорта](../../integration-services/import-export-data/media/source-query.png "источника запроса страницы из мастера импорта и экспорта")  

## <a name="provide-the-query-and-check-its-syntax"></a>Определение запроса и проверка его синтаксиса
**Инструкция SQL**  
 Введите запрос SELECT для получения определенных строк и столбцов данных из базы данных-источника. Также можно вставить текст сохраненный запрос или загрузка запроса из файла, нажав кнопку **Обзор**. 
  
 Например, следующий запрос извлекает **SalesPersonID**, **SalesQuota**, и **SalesYTD** из образца AdventureWorks базы данных для менеджеров по продажам, Процент комиссии — более 1,5 процентов.  
  
```sql
SELECT SalesPersonID, SalesQuota, SalesYTD  
FROM Sales.SalesPerson  
WHERE CommissionPct > 0.015  
```  

Дополнительные примеры запросов SELECT см. в разделе [Примеры использования инструкции SELECT &#40;Transact-SQL&#41;](../../t-sql/queries/select-examples-transact-sql.md) либо в Интернете.  

Если источником данных является Microsoft Excel, сведения об указании листов и диапазонов Excel в запросе см. далее в подразделе [Определение исходного запроса для Excel](#excelQueries) в этом разделе.
  
 **Синтаксический анализ**  
 Проверьте синтаксис инструкции SQL, введенной в текстовое поле **Инструкция SQL** .  
  
> [!NOTE]
> Если время, затрачиваемое на проверку синтаксиса инструкции, превышает 30 секунд, синтаксический анализ прерывается и возникает ошибка. Перейти на следующую страницу мастера невозможно, пока не будет успешно выполнен синтаксический анализ. Одно из возможных решений по избежанию времени ожидания заключается в создании представления базы данных на основе запроса и выполнения запросов из мастера к этому представлению вместо явного ввода текста запроса.  
  
 **Обзор**  
 Выберите сохраненный файл, содержащий текст SQL-запроса с помощью **откройте** диалоговое окно. При выборе файла текст копируется из файла в текстовое поле **Инструкция SQL** .  
 
## <a name="excelQueries"></a> Определение исходного запроса для Excel
### <a name="specify-excel-objects-in-queries"></a>Укажите объекты Excel, в запросах
Существует три типа объектов Excel, к которым можно выполнить запрос.
-   **Лист** Чтобы выполнить запрос к листу, добавьте в конец имени листа символ $ и окружите строку разделителями, например **[Лист1$]**.

    ```
    SELECT * FROM [Sheet1$]
    ```

-   **Именованный диапазон** Чтобы выполнить запрос к именованному диапазону, используйте имя диапазона, например **Мой_диапазон**.
    
    ```
    SELECT * FROM MyDataRange
    ```

-   **Неименованный диапазон** Чтобы указать диапазон ячеек, которым не были заданы имена, добавьте символ $ после имени листа, добавьте спецификацию диапазона и окружите строку разделителями, например **[Лист1$A1:B4]**.

    ```
    SELECT * FROM [Sheet1$A1:B4]
    ```

### <a name="prepare-the-excel-source-data"></a>Подготовка данных источника Excel
Если в качестве исходной таблицы указан лист или диапазон, драйвер считывает *непрерывный* блок ячеек, начиная с первой непустой ячейки в верхнем левом углу листа или диапазона. Поэтому в исходных данных не должно быть пустых строк. Например, пустой строки не должно быть между заголовками столбцов и строками данных. Если после заголовка следуют пустые строки в верхней части листа над данными, выполнить запрос к листу не удастся. В Excel необходимо присвоить имя диапазону данных и выполнить запрос к именованному диапазону, а не к листу.

## <a name="whats-next"></a>Дальнейшие действия  
 После написания и тестирования запроса SQL, выбирающего данные для копирования, откроется страница, которая зависит от назначения для данных.  
  
-   Для большинства назначений откроется страница **Выбор исходных таблиц и представлений**. На этой странице просмотрите запрос, который вы определили, и при необходимости выберите столбцы для копирования и просмотрите образец данных. Дополнительные сведения см. в разделе [Выбор исходных таблиц и представлений](../../integration-services/import-export-data/select-source-tables-and-views-sql-server-import-and-export-wizard.md).  
  
-   Если назначением является неструктурированный файл, откроется страница **Настройка назначения "Неструктурированный файл"**. На этой странице можно задать параметры форматирования для назначения "Неструктурированный файл". (После настройки неструктурированного файла откроется страница **Выбор исходных таблиц и представлений**.) Дополнительные сведения см. в разделе [Настройка назначения "Неструктурированный файл"](../../integration-services/import-export-data/configure-flat-file-destination-sql-server-import-and-export-wizard.md).  



