---
title: "Определение исходного запроса (мастер импорта и экспорта SQL Server) | Документы Майкрософт"
ms.custom: 
ms.date: 03/16/2017
ms.prod: sql-non-specified
ms.prod_service: integration-services
ms.service: 
ms.component: import-export-data
ms.reviewer: 
ms.suite: sql
ms.technology:
- integration-services
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- sql13.dts.impexpwizard.providesourcequery.f1
ms.assetid: c8cbd07e-b9c3-422f-94b8-d6fc8cf31cf5
caps.latest.revision: 
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: On Demand
ms.openlocfilehash: 4399fdeb68ee0768ac083e0193ae0513b221021d
ms.sourcegitcommit: 9e6a029456f4a8daddb396bc45d7874a43a47b45
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/25/2018
---
# <a name="provide-a-source-query-sql-server-import-and-export-wizard"></a>Определение исходного запроса (мастер импорта и экспорта SQL Server)
Если вы указали, что нужно определить запрос для выбора копируемых данных, в мастере импорта и экспорта [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] откроется страница **Определение исходного запроса**. На этой странице выполняется написание и тестирование запроса SQL, который выбирает данные для копирования из источника данных в место назначения. Можно также вставить текст сохраненного запроса или загрузить его из файла.

## <a name="screen-shot-of-the-source-query-page"></a>Снимок экрана: страница "Исходный запрос"  
На следующем снимке экрана показана страница мастера **Определение исходного запроса** .
 
В этом простом примере пользователь ввел запрос `SELECT * FROM Sales.Customer` для копирования всех строк и столбцов из таблицы **Sales.Customer** в базе данных-источнике.
-   `SELECT *` задает копирование всех столбцов.
-   Отсутствие предложения `WHERE` означает, что копируются все строки.
  
 ![Страница "Исходный запрос" в мастере импорта и экспорта](../../integration-services/import-export-data/media/source-query.png "Страница "Исходный запрос" в мастере импорта и экспорта")  

## <a name="provide-the-query-and-check-its-syntax"></a>Определение запроса и проверка его синтаксиса
**Инструкция SQL**  
 Введите запрос SELECT для извлечения нужных строк и столбцов данных из базы данных-источника. Можно также вставить текст сохраненного запроса или загрузить его из файла, щелкнув **Обзор**. 
  
 Например, следующий запрос запроса извлекает столбцы **SalesPersonID**, **SalesQuota** и **SalesYTD** из образца базы данных AdventureWorks для менеджеров по продажам, получающих более 1,5 процентов комиссионных от продаж.  
  
```sql
SELECT SalesPersonID, SalesQuota, SalesYTD  
FROM Sales.SalesPerson  
WHERE CommissionPct > 0.015  
```  

Дополнительные примеры запросов SELECT см. в разделе [Примеры использования инструкции SELECT &#40;Transact-SQL&#41;](../../t-sql/queries/select-examples-transact-sql.md) либо в Интернете.  

Если источником данных является Microsoft Excel, сведения об указании листов и диапазонов Excel в запросе см. далее в подразделе [Определение исходного запроса для Excel](#excelQueries) в этом разделе.
  
 **Синтаксический анализ**  
 Проверьте синтаксис инструкции SQL, введенной в текстовое поле **Инструкция SQL** .  
  
> [!NOTE]
> Если время, затрачиваемое на проверку синтаксиса инструкции, превышает 30 секунд, синтаксический анализ прерывается и возникает ошибка. Перейти на следующую страницу мастера невозможно, пока не будет успешно выполнен синтаксический анализ. Одно из возможных решений по избежанию времени ожидания заключается в создании представления базы данных на основе запроса и выполнения запросов из мастера к этому представлению вместо явного ввода текста запроса.  
  
 **Обзор**  
 Выберите сохраненный файл, содержащий текст запроса SQL, с помощью диалогового окна **Открыть**. При выборе файла текст копируется из файла в текстовое поле **Инструкция SQL** .  
 
## <a name="excelQueries"></a> Определение исходного запроса для Excel
### <a name="specify-excel-objects-in-queries"></a>Указание объектов Excel в запросах
Существует три типа объектов Excel, к которым можно выполнить запрос.
-   **Лист** Чтобы выполнить запрос к листу, добавьте в конец имени листа символ $ и окружите строку разделителями, например **[Лист1$]**.

    ```sql
    SELECT * FROM [Sheet1$]
    ```

-   **Именованный диапазон** Чтобы выполнить запрос к именованному диапазону, используйте имя диапазона, например **Мой_диапазон**.
    
    ```sql
    SELECT * FROM MyDataRange
    ```

-   **Неименованный диапазон** Чтобы указать диапазон ячеек, которым не были заданы имена, добавьте символ $ после имени листа, добавьте спецификацию диапазона и окружите строку разделителями, например **[Лист1$A1:B4]**.

    ```sql
    SELECT * FROM [Sheet1$A1:B4]
    ```

### <a name="prepare-the-excel-source-data"></a>Подготовка исходных данных Excel
Если в качестве исходной таблицы указан лист или диапазон, драйвер считывает *непрерывный* блок ячеек, начиная с первой непустой ячейки в верхнем левом углу листа или диапазона. Поэтому в исходных данных не должно быть пустых строк. Например, пустой строки не должно быть между заголовками столбцов и строками данных. Если после заголовка следуют пустые строки в верхней части листа над данными, выполнить запрос к листу не удастся. В Excel необходимо присвоить имя диапазону данных и выполнить запрос к именованному диапазону, а не к листу.

## <a name="whats-next"></a>Дальнейшие действия  
 После написания и тестирования запроса SQL, выбирающего данные для копирования, откроется страница, которая зависит от назначения для данных.  
  
-   Для большинства назначений откроется страница **Выбор исходных таблиц и представлений**. На этой странице просмотрите запрос, который вы определили, и при необходимости выберите столбцы для копирования и просмотрите образец данных. Дополнительные сведения см. в разделе [Выбор исходных таблиц и представлений](../../integration-services/import-export-data/select-source-tables-and-views-sql-server-import-and-export-wizard.md).  
  
-   Если назначением является неструктурированный файл, откроется страница **Настройка назначения "Неструктурированный файл"**. На этой странице можно задать параметры форматирования для назначения "Неструктурированный файл". (После настройки неструктурированного файла откроется страница **Выбор исходных таблиц и представлений**.) Дополнительные сведения см. в разделе [Настройка назначения "Неструктурированный файл"](../../integration-services/import-export-data/configure-flat-file-destination-sql-server-import-and-export-wizard.md).  


