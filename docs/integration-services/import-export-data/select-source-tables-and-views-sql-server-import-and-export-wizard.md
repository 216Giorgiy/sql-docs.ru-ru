---
title: "Выбор исходных таблиц и представлений (мастер экспорта и импорта SQL Server) | Документы Microsoft"
ms.custom: 
ms.date: 03/16/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- integration-services
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- sql13.dts.impexpwizard.selectsourcetablesandviews.f1
ms.assetid: f60e1a19-2ea6-403c-89ab-3e60ac533ea0
caps.latest.revision: 96
author: douglaslMS
ms.author: douglasl
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: 2edcce51c6822a89151c3c3c76fbaacb5edd54f4
ms.openlocfilehash: 9a0c3c4fc8d41206ea077498dafb755e7b433a78
ms.contentlocale: ru-ru
ms.lasthandoff: 09/26/2017

---
# <a name="select-source-tables-and-views-sql-server-import-and-export-wizard"></a>Выбор исходных таблиц и представлений (мастер импорта и экспорта SQL Server)
  После того как вы укажете, хотите ли вы скопировать всю таблицу, или после определения запроса в мастере импорта и экспорта [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] откроется страница **Выбор исходных таблиц и представлений**. На этой странице выберите существующие таблицы и представления, которые нужно скопировать. Затем следует сопоставить исходные таблицы с новыми или существующими целевыми таблицами. При необходимости можно проверить, правильно ли сопоставлены отдельные столбцы, и открыть предпросмотр образца данных.

> [!TIP]
> Если нужно скопировать несколько баз данных SQL Server или объектов базы данных SQL Server, отличных от таблиц и представлений, используйте мастер копирования баз данных вместо мастера импорта и экспорта. Дополнительные сведения см. в разделе [Использование мастера копирования базы данных](../../relational-databases/databases/use-the-copy-database-wizard.md).  
  
## <a name="screen-shot---if-youre-going-to-copy-tables"></a>Снимок экрана — Если вы собираетесь копирование таблиц  
 На следующем снимке экрана показан пример **Выбор исходных таблиц и представлений** мастера, если ранее был выбран **скопировать данные из одного или нескольких таблиц или представлений** параметр  **Выбор копирования таблицы или запроса** страницы. В списке показаны все таблицы и представления, доступные в источнике данных.
 
В этом примере **источника** список содержит все таблицы в базе данных AdventureWorks. Выбранной строки показывает, что пользователь хочет Копировать **Sales.Customer** таблицы из источника в новую **Sales.CustomerNew** таблицы в месте назначения. 
   
 ![Выберите таблицы страница мастера импорта и экспорта](../../integration-services/import-export-data/media/select-tables1.png "таблиц выберите страницу мастера импорта и экспорта")
  
## <a name="screen-shot---if-you-provided-a-query"></a>Снимок экрана — при указании запроса  
 На следующем снимке экрана показан пример **Выбор исходных таблиц и представлений** мастера, если ранее был выбран **написать запрос, указывающий данные для передачи** параметр на **Выбор копирования таблицы или запроса** страницы. **Источника** список содержит только одну строку, где элемент с именем `[Query]` представляет запрос, который вы указали на **определение исходного запроса** страницы.
 
В этом примере пользователь хочет скопировать результаты запроса в таблицу **Sales.CustomerNew** в месте назначения.  
    
 ![Выберите таблицы страница мастера импорта и экспорта](../../integration-services/import-export-data/media/select-tables2.png "таблиц выберите страницу мастера импорта и экспорта")  

## <a name="select-source-and-destination-tables"></a>Выбор исходных и целевых таблиц 
**Источник**  
С помощью флажков выберите из списка таблицы и представления для копирования в место назначения. По умолчанию данные из источника данных копируются без изменений. Если создается новая целевая таблица схемы для новой таблицы — то есть список столбцов и их свойств — также копируются без изменений из источника данных.

Если вы указали запрос, список содержит только один элемент с именем `[Query]`. 

**Назначение**  
 Выберите из списка целевую таблицу для каждой исходной таблицы или запроса либо введите имя таблицы, которую мастер должен создать. Если выбирается существующая целевая таблица, она должна включать столбцы с типами данных, совместимыми с исходными данными.  

> [!NOTE]
> Если в этой точке работы мастера вы создадите целевую таблицу в базе данных назначения вручную, используя внешнее средство (например,  [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]), новая таблица не сразу появится в списке доступных целевых таблиц. Чтобы обновить список целевых таблиц, вернитесь на страницу **Выбор назначения** , еще раз выберите целевую базу данных, чтобы обновить список доступных таблиц и представлений, и снова перейдите на страницу **Выбор исходных таблиц и представлений** .  

## <a name="optionally-review-column-mappings-and-preview-data"></a>При необходимости проверьте сопоставления столбцов и предварительного просмотра данных
**Изменение сопоставлений**   
При необходимости щелкните **изменить сопоставления** для отображения **сопоставления столбцов** диалоговое окно для выбранной таблицы. В диалоговом окне **Сопоставления столбцов** можно выполнять следующие действия:
-   просмотреть сопоставление отдельных столбцов между источником и местом назначения;
-   скопировать отдельное подмножество столбцов, установив флажок **пропустить** для тех столбцов, копировать которые не нужно.

Дополнительные сведения см. в разделе [Сопоставления столбцов](../../integration-services/import-export-data/column-mappings-sql-server-import-and-export-wizard.md).  

**Предварительный просмотр**  
При необходимости щелкните **предварительного просмотра** для предварительного просмотра до 200 строк образца данных в **данные для предварительного просмотра** диалоговое окно. Таким образом вы убедитесь, что мастер будет копировать именно необходимые данные. Дополнительные сведения см. в разделе [Предварительный просмотр данных](../../integration-services/import-export-data/preview-data-dialog-box-sql-server-import-and-export-wizard.md).  
  
После просмотра данных может потребоваться изменить параметры, выбранные на предыдущих страницах мастера. Для этого вернитесь на страницу **Выбор исходных таблиц и представлений** и нажмите кнопку **Назад** , чтобы вернуться к предыдущим страницам, где можно изменить выбранные параметры.  

## <a name="select-source-and-destination-tables-for-excel"></a>Выбор исходных и целевых таблиц для Excel

### <a name="excel-source-tables"></a>Исходные таблицы Excel
В список исходных таблиц и представлений для источника данных Excel входит два типа объектов Excel.
-   **Листы**. После имен листов следует символ доллара ($), например **Лист1$**.
-   **Именованные диапазоны** Именованные диапазоны (если таковые имеются) указываются по имени.

Если требуется загрузить данные из определенного неименованного диапазона ячеек или в него, например из диапазона **[Лист1$A1:B4]**или в него, необходимо написать запрос. Вернитесь на страницу **Выбор копирования таблицы или запроса** и выберите вариант **Написать запрос, указывающий данные для передачи**.

#### <a name="prepare-the-excel-source-data"></a>Подготовка данных источника Excel
Если в качестве исходной таблицы указан лист или диапазон, драйвер считывает *непрерывный* блок ячеек, начиная с первой непустой ячейки в верхнем левом углу листа или диапазона. Поэтому в исходных данных не должно быть пустых строк. Например, пустой строки не должно быть между заголовками столбцов и строками данных. Если после заголовка следуют пустые строки в верхней части листа над данными, выполнить запрос к листу не удастся. В Excel необходимо присвоить имя диапазону данных и выполнить запрос к именованному диапазону, а не к листу.

### <a name="excel-destination-tables"></a>Целевые таблицы Excel
При экспорте данных в Excel можно указать назначение одним из следующих трех способов.
-   **Лист** Чтобы указать лист, добавьте в конец имени листа символ $ и окружите сроку разделителями, например **[Лист1$]**.
-   **Именованный диапазон** Чтобы указать именованный диапазон, используйте имя диапазона, например **Мой_диапазон**.
-   **Неименованный диапазон** Чтобы указать диапазон ячеек, которым не были заданы имена, добавьте символ $ после имени листа, добавьте спецификацию диапазона и окружите строку разделителями, например **[Лист1$A1:B4]**.

## <a name="special-considerations-for-excel-sources-and-destinations"></a>Особые замечания, касающиеся Excel в качестве источника и назначения
Если Excel используется в качестве источника или назначения, рекомендуется выбрать пункт **Изменить сопоставления** и проверить сопоставления типов данных на странице **Сопоставления столбцов** . 

**Типы данных в книгах Excel**. Excel не является обычной базой данных. У его столбцов нет фиксированных типов данных. Мастер распознает только ограниченный набор данных типов в Excel — числовой, денежный, логический, дата и время, строковый (255 символов или меньше) и типа memo (более 255 символов). Мастер делает выборку определенного числа строк (по умолчанию первых восьми строках) в источник данных Excel может распознать тип данных каждого столбца.

Если мастеру приходится выполнить явное преобразование типа данных для загрузки в Excel или из него, обычно отображается страница **Просмотр сопоставления типов данных** , где можно просмотреть эти преобразования. В число этих преобразований могут входить следующие.
-   Преобразование между числовыми столбцами Excel с плавающей запятой двойной точности и числовыми столбцами других типов.
-   Преобразование между строковыми столбцами Excel длиной в 255 символов и строковыми столбцами другой длины.
-   Преобразование между строковыми столбцами Excel в Юникоде и строковыми столбцами не в Юникоде, используемые конкретными кодовыми страницами.

### <a name="special-considerations-for-excel-sources"></a>Особые замечания, касающиеся источников Excel
**Значения NULL или отсутствующие значения в импортированных данных**. Если столбец Excel содержит смешанные типы данных в первых восьми строках выборки с помощью мастера - например, числовые значения, смешанный с текстовыми значениями - мастер выбирает тип большинство данных в качестве типа данных столбца и возвращает значения null в ячейки, содержат n данных других типов. Изменить это поведение мастера невозможно.

**Усеченные строки в импортированных данных**. Когда мастер определяет, что столбец Excel содержит текстовые данные, он выбирает тип данных столбца (строковый или memo) на основании самого длинного значения, отобранного в первых восьми строках. Если мастер не находит значений длиннее 255 символов в выбираемых строках, он считает, что столбец является строковым с длиной 255 символов, а не столбцом типа memo, и усекает значения длиннее 255 символов. Чтобы импортировать данные из столбца типа memo без усечения, необходимо убедиться, что столбец memo содержит хотя бы одно значение длиннее 255 символов в первых восьми строках, которые проверяются с помощью мастера.

### <a name="special-considerations-for-excel-destinations"></a>Особые замечания, касающиеся назначений Excel
**Указание существующего диапазона**. При указании существующего диапазона в качестве цели, возникает сообщение об ошибке, если диапазон содержит меньше *столбцы* от источника данных. Тем не менее если указанного вами диапазона содержит меньше *строк* от источника данных, мастер продолжает записывать строк и расширяет определение диапазона для соответствия новым количеством строк.

**Сохранение данных типа memo (ntext)**. Чтобы успешно сохранять в столбцы Excel строки, имеющие длину более 255 символов, мастер должен распознать тип данных целевого столбца как **memo** , а не как **string**.
-   Если в целевой таблице уже содержатся строки данных, первые восемь строк, выбранных в мастере должны содержать хотя бы одну строку со значением в столбце типа memo 255 знаков.
-   Если целевой таблицы создается с помощью мастера **CREATE TABLE** инструкция должна использовать **LONGTEXT** (или один из его синонимов) как тип данных столбца типа memo. Проверьте **CREATE TABLE** инструкции и изменить ее, при необходимости, щелкнув **изменить SQL** рядом с **создать целевую таблицу** параметр **столбца Сопоставления** страницы.

## <a name="whats-next"></a>Дальнейшие действия  
 После того как вы выберете существующие таблицы и представления, которые нужно скопировать, и сопоставите их с местами назначения, откроется страница **Сохранение и запуск пакета**. На этой странице можно указать, нужно ли немедленно запустить операцию копирования. В зависимости от конфигурации, также можно сохранить пакет [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , созданный с помощью мастера, чтобы настроить и использовать его позднее. Дополнительные сведения см. в разделе [Сохранение и запуск пакета](../../integration-services/import-export-data/save-and-run-package-sql-server-import-and-export-wizard.md).
 
 ## <a name="see-also"></a>См. также:
[Приступая к работе с простым примером мастера импорта и экспорта](../../integration-services/import-export-data/get-started-with-this-simple-example-of-the-import-and-export-wizard.md)



