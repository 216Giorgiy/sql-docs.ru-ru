---
title: "настроить преобразование &#171;Команда OLE DB&#187; | Microsoft Docs"
ms.custom: ""
ms.date: "03/01/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "integration-services"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "параметры [службы Integration Services]"
  - "преобразование «Команда OLE DB»"
ms.assetid: c800f167-3d2e-4c10-8ba3-a02f1872ccea
caps.latest.revision: 24
author: "douglaslMS"
ms.author: "douglasl"
manager: "jhubbard"
caps.handback.revision: 24
---
# настроить преобразование &#171;Команда OLE DB&#187;
  Для добавления и настройки преобразования «Команда OLE DB» пакет должен уже содержать по меньшей мере одну задачу потока данных и такой источник, как источник неструктурированного файла или источник OLE DB. Преобразование обычно используется для выполнения параметризованных запросов.  
  
### Настройка преобразования «Команда OLE DB»  
  
1.  В среде [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]откройте проект служб [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] , содержащий необходимый пакет.  
  
2.  Чтобы открыть пакет, дважды щелкните его в обозревателе решений.  
  
3.  Перейдите на вкладку **Поток данных** , затем из **области элементов**переместите преобразование «Команда OLE DB» в область конструктора.  
  
4.  Подключите преобразование «Команда OLE DB» к потоку данных, перетащив соединитель — зеленую или красную стрелку — из источника данных или из предыдущего преобразования в преобразование «Команда OLE DB».  
  
5.  Щелкните правой кнопкой мыши компонент и выберите редактировать или показать **Расширенный редактор**.  
  
6.  На вкладке **Диспетчеры соединений** выберите диспетчер соединений OLE DB в списке **Диспетчер соединений** . Дополнительные сведения см. в статье [OLE DB Connection Manager](../../../integration-services/connection-manager/ole-db-connection-manager.md).  
  
7.  Перейдите на вкладку **Свойства компонентов** и нажмите кнопку с многоточием **(…)** в окне **SqlCommand**.  
  
8.  В **редакторе строковых значений** введите параметризованную инструкцию SQL, используя знак вопроса (?) в качестве маркера параметра для каждого параметра.  
  
9. Нажмите кнопку **Обновить**. При нажатии кнопки **Обновить** преобразование создает столбец для каждого параметра в коллекции "Внешние столбцы" и устанавливает свойство DBParamInfoFlags.  
  
10. Щелкните вкладку **Свойства входов и выходов** .  
  
11. Раскройте **Вход команды OLE DB**, затем раскройте коллекцию **Внешние столбцы**.  
  
12. Проверьте, что в коллекции **Внешние столбцы** перечисляются столбцы для всех параметров инструкции SQL. Столбцы имеют имена **Param_0**, **Param_1** и т. д.  
  
     Не изменяйте имена столбцов. Если изменить имена столбцов, службы [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] сформирует ошибку проверки правильности для трансформации команды OLE DB.  
  
     Не изменяйте и тип данных. Свойство DataType в каждом столбце устанавливается в соответствии с правильным типом данных.  
  
13. Если в списке **Внешние столбцы** нет ни одного столбца, введите их вручную.  
  
    -   Щелкните **Добавить столбец** один раз для каждого параметра в инструкции SQL.  
  
    -   Переименуйте столбцы в **Param_0**, **Param_1** и т. д.  
  
    -   Укажите значение в свойстве DBParamInfoFlags. Значение должно соответствовать значению перечисления OLE DB DBPARAMFLAGSENUM. Дополнительные сведения см. в справочной документации по OLE DB.  
  
    -   Задайте тип данных столбца и в зависимости от типа данных задайте кодовую страницу, длину, точность и масштаб столбца.  
  
    -   Чтобы удалить неиспользуемый параметр, выберите параметр в коллекции **Внешние столбцы**, затем щелкните **Удалить столбец**.  
  
    -   Щелкните **Сопоставления столбцов** и сопоставьте столбцы в списке **Входные столбцы** с параметрами в списке **Доступные целевые столбцы** .  
  
14. Нажмите кнопку **ОК**.  
  
15. Чтобы сохранить обновленный пакет, щелкните **Сохранить** в меню **Файл** .  
  
## См. также  
 [Преобразование «Команда OLE DB»](../../../integration-services/data-flow/transformations/ole-db-command-transformation.md)   
 [Преобразования служб Integration Services](../../../integration-services/data-flow/transformations/integration-services-transformations.md)   
 [Пути служб Integration Services](../../../integration-services/data-flow/integration-services-paths.md)   
 [Задача потока данных](../../../integration-services/control-flow/data-flow-task.md)  
  
  