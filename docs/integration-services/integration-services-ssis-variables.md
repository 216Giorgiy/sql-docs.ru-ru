---
title: "Переменные в службах Integration Services (SSIS) | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "integration-services"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "переменные [службы Integration Services], передача между пакетами"
  - "пользовательские переменные [службы Integration Services]"
  - "область действия [службы Integration Services]"
  - "системные переменные [службы Integration Services]"
  - "переменные [службы Integration Services]"
  - "переменные [службы Integration Services], о переменных"
  - "значения [службы Integration Services]"
ms.assetid: c1e81ad6-628b-46d4-9b09-d2866517b6ca
caps.latest.revision: 60
author: "douglaslMS"
ms.author: "douglasl"
manager: "jhubbard"
caps.handback.revision: 59
---
# Переменные в службах Integration Services (SSIS)
  Переменные хранят значения, которые могут использоваться пакетом служб [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] , а также его контейнерами, задачами и обработчиками событий во время выполнения. Скрипты в задаче «Скрипт» и компоненте скрипта также могут использовать переменные. Управления очередностью, которые упорядочивают задачи и контейнеры в рабочий процесс, могут использовать переменные, если связанные с ними определения ограничений включают в себя выражения.  
  
 Переменные в пакетах служб [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] могут использоваться в следующих целях.  
  
-   Обновление свойств элементов пакета во время выполнения. Например, можно динамически задать количество параллельно исполняемых объектов, которые допускаются контейнером «цикл по каждому элементу».  
  
-   Включение таблицы уточняющих запросов в памяти. Например, пакет может запустить задачу «Выполнение SQL», загружающую переменную со значениями данных.  
  
-   Загрузка переменных со значениями данных и использование их для задания условий поиска в предложении WHERE. Например, скрипт в задаче «Скрипт» может обновить значение переменной, которая используется инструкцией Transact-SQL в задаче «Выполнение SQL».  
  
-   Присвоение переменной значения целого числа и использование этого значения для управления циклом в потоке управления пакетом. Например, вычисляемое выражение в контейнере «цикл по каждому элементу» может использовать переменную для управления итерацией.  
  
-   Заполнение значений параметров инструкций Transact-SQL во время выполнения. Например, пакет может запустить задачу «Выполнение SQL» и затем динамически задавать параметры в инструкции Transact-SQL.  
  
-   Построение выражений, содержащих значения переменных. Например, преобразование «Производный столбец» может заполнить столбец результатами, полученными путем умножения значения переменной на значение столбца.  
  
## Пользовательские и системные переменные  
 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] поддерживают два типа переменных: пользовательские и системные переменные. Пользовательские переменные определяются разработчиками пакетов, а системные переменные определяются службами [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)]. Допустимо создание в пакете любого необходимого количества пользовательских переменных, однако дополнительные системные переменные не могут быть созданы.  
  
 Все переменные — как системные, так и определенные пользователем — могут быть использованы в связывании параметров, которые использует задача «Выполнение SQL» для сопоставления переменных параметрам в инструкциях SQL. Дополнительные сведения см. в разделах [Задача "Выполнение SQL"](../integration-services/control-flow/execute-sql-task.md) и [Параметры и коды возврата в задаче "Выполнение SQL"](../Topic/Parameters%20and%20Return%20Codes%20in%20the%20Execute%20SQL%20Task.md).  
  
> [!NOTE]  
>  В именах пользовательских и системных переменных учитывается регистр.  
  
 Пользователь может создать пользовательские переменные для всех типов контейнеров служб [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)]: пакетов, контейнеров "цикл по каждому элементу", контейнеров "цикл по элементам", контейнеров последовательности, задач и обработчиков событий. Пользовательские переменные являются элементами коллекции Variables соответствующего контейнера.  
  
 При создании пакета с помощью конструктора служб [!INCLUDE[ssIS](../includes/ssis-md.md)] элементы коллекции Variables доступны в папках **Переменные** на вкладке **Обозреватель пакета** конструктора [!INCLUDE[ssIS](../includes/ssis-md.md)] . В этих папках перечисляются пользовательские и системные переменные.  
  
 Пользовательские переменные можно настроить следующими способами:  
  
-   задать имя и описание переменной;  
  
-   указать пространство имен для переменной;  
  
-   указать, инициируется ли событие при изменении значения переменной;  
  
-   указать, доступна ли переменная только для чтения или для чтения и записи;  
  
-   использовать для задания значения переменной результат вычисления выражения;  
  
-   создать переменную в области видимости пакета или объекта пакета, например задачи;  
  
-   указать значение и тип данных переменной.  
  
 Для системной переменной доступен лишь один настраиваемый параметр: можно выбрать, инициируется ли событие при изменении ее значения.  
  
 Для разных типов контейнеров доступен разный набор системных переменных. Дополнительные сведения о системных переменных, используемых в пакетах и их элементах, см. в разделе [System Variables](../integration-services/system-variables.md).  
  
 Дополнительные сведения о практическом использовании переменных см. в разделе [Использование переменных в пакетах](../Topic/Use%20Variables%20in%20Packages.md).  
  
## Свойства переменной  
 Свойства пользовательских переменных можно установить в окне **Переменные** или окне **Свойства**. Некоторые свойства доступны только в окне «Свойства»  
  
> [!NOTE]  
>  Для системной переменной доступен лишь один настраиваемый параметр: можно выбрать, инициируется ли событие при изменении ее значения.  
  
 Description  
 Задает описание переменной.  
  
 EvaluateAsExpression  
 Если свойство имеет значение **True**, указанное выражение используется для задания значения переменной.  
  
 Выражение  
 Указывает выражение, назначаемое переменной.  
  
 Название  
 Определяет имя переменной.  
  
 Пространство имен  
 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] предоставляют два пространства имен: **User** и **System**. По умолчанию пользовательские переменные содержатся в пространстве имен **User** , а системные переменные — в пространстве имен **System** . Можно создать дополнительные пространства имен для пользовательских переменных и переименовать пространство имен **User**, однако переименовать пространство имен **System**, добавлять переменные в пространство имен **System** или назначить системные переменные другому пространству имен нельзя.  
  
 RaiseChangedEvent  
 Если это свойство имеет значение **True**, то при изменении значения переменной возникает событие **OnVariableValueChanged**.  
  
 ReadOnly  
 Если это свойство имеет значение **False**, переменная доступна для чтения и записи.  
  
 Область действия  
 > [!NOTE]  
>  Это свойство можно изменить только в окне **Переменные**, нажав кнопку **Переместить переменную**.  
  
 Переменная создается в области пакета либо в области контейнера, задачи или обработчика события, содержащегося в этом пакете. Поскольку контейнер пакета находится на верхнем уровне иерархии контейнеров, переменные в области пакета ведут себя как глобальные переменные и могут использоваться во всех контейнерах пакета. Аналогично, переменные определенные в области контейнера, такого как «цикл по элементам», могут использоваться всеми задачами или контейнерами внутри контейнера «цикл по элементам».  
  
 Если пакет запускает другие пакеты при помощи задачи «Выполнение пакета», то переменные, определенные в области вызывающего пакета или задачи выполнения пакета, могут быть сделаны доступными для вызываемого пакета при помощи конфигурации «Переменная родительского пакета». Дополнительные сведения см. в статье [Package Configurations](../integration-services/packages/package-configurations.md).  
  
 IncludeInDebugDump  
 Указывает, включается ли значение переменной в отладочные файлы дампа.  
  
 По умолчанию для системных и определенных пользователем переменных параметр **InclueInDebugDump** по умолчанию имеет значение **true**.  
  
 Однако для переменных, определенных пользователем, система сбрасывает параметр **IncludeInDebugDump** в значение **false** при соблюдении следующих условий:  
  
-   Если свойство переменной **EvaluateAsExpression** имеет значение **true**, то система устанавливает для параметра **IncludeInDebugDump** значение **false**.  
  
     Чтобы включить текст выражения в отладочные файлы дампа в качестве переменной, установите параметр **IncludeInDebugDump** в значение **true**.  
  
-   При смене типа данных переменной на строковый система устанавливает параметр **IncludeInDebugDump** в значение **false**.  
  
 Когда система сбрасывает параметр **IncludeInDebugDump** в значение **false**, выбранное пользователем значение может быть переопределено.  
  
 Значение  
 Значение пользовательской переменной может быть задано строкой или выражением. Переменная включает в себя параметры для установки значения и типа данных переменной. Эти два свойства должны быть совместимыми: например, недопустимо использование строкового значения совместно с типом данных integer.  
  
 Если переменная настроена как результат выражения, необходимо задать выражение. Во время выполнения выражение вычисляется, и переменной присваивается результат вычисления. Например, если переменная использует выражение `DATEPART("month", GETDATE())` , значением переменной является число, равное месяцу текущей даты. Выражение должно быть действительным выражением, использующим синтаксис выражений [!INCLUDE[ssIS](../includes/ssis-md.md)] . Если выражение используется с переменными, оно может использовать литералы, операторы и функции, допустимые грамматикой выражений, но не может ссылаться на столбцы в потоке данных пакета. Максимальная длина выражения составляет 4000 символов. Дополнительные сведения см. в разделе [Выражения служб Integration Services (SSIS)](../integration-services/expressions/integration-services-ssis-expressions.md).  
  
 ValueType  
 > [!NOTE]  
>  Значение свойства отображается в столбце **Тип данных** окна **Переменные**.  
  
 Задает тип данных для значения переменной.  
  
## Настройка переменных  
 Значения свойств можно задавать с помощью конструктора [!INCLUDE[ssIS](../includes/ssis-md.md)] или программными средствами.  
  
 Дополнительные сведения о свойствах, которые можно задавать в конструкторе служб [!INCLUDE[ssIS](../includes/ssis-md.md)], см. в статье [Окно "Переменные"](../integration-services/variables-window.md).  
  
 Чтобы узнать больше о свойствах переменных и получить дополнительные сведения об их программной настройке, см. раздел <xref:Microsoft.SqlServer.Dts.Runtime.Variable>.  
  
## Связанные задачи  
 [Добавление, удаление и изменение области определяемой пользователем переменной в пакете](../Topic/Add,%20Delete,%20Change%20Scope%20of%20User-Defined%20Variable%20in%20a%20Package.md)  
  
 [Установка свойств определяемой пользователем переменной](../Topic/Set%20the%20Properties%20of%20a%20User-Defined%20Variable.md)  
  
 [Использование значений переменных и параметров в дочернем пакете](../integration-services/packages/use-the-values-of-variables-and-parameters-in-a-child-package.md)  
  
 [Сопоставления параметров запросов с переменными в компонентах потока данных](../integration-services/data-flow/map-query-parameters-to-variables-in-a-data-flow-component.md)  
  
  