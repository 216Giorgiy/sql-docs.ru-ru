---
title: "Настройка компонента скрипта в редакторе компонентов скрипта | Документы Microsoft"
ms.custom: 
ms.date: 03/17/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- docset-sql-devref
ms.tgt_pltfrm: 
ms.topic: reference
applies_to:
- SQL Server 2016 Preview
dev_langs:
- VB
helpviewer_keywords:
- SSIS Script component
- Script Component Editor
- SSIS Script component, configuring
- Script component [Integration Services], configuring
ms.assetid: 586dd799-f383-4d6d-b1a1-f09233d14f0a
caps.latest.revision: 46
author: douglaslMS
ms.author: douglasl
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: 1419847dd47435cef775a2c55c0578ff4406cddc
ms.openlocfilehash: 8488fcc7d402430f66b9b9018b31956a5a1d8383
ms.contentlocale: ru-ru
ms.lasthandoff: 08/03/2017

---
# <a name="configuring-the-script-component-in-the-script-component-editor"></a>Настройка компонента скрипта в редакторе компонента скрипта
  Прежде чем писать пользовательский код в компоненте скрипта, необходимо выбрать тип компонента потока данных, который требуется создать — источника, преобразования или назначения и затем настройте метаданные и свойства в компонента **редактор преобразования «скрипт»**.  
  
## <a name="selecting-the-type-of-component-to-create"></a>Выбор типа создаваемого компонента  
 При добавлении компонента скрипта в область потока данных [!INCLUDE[ssIS](../../../includes/ssis-md.md)] конструкторе **Выбор типа компонента скрипта** откроется диалоговое окно. Компонент должен быть предварительно настроен как источник, преобразование или назначение. После внесения этого первоначального выбора можно продолжить настройку компонента в **редактор преобразования «скрипт»**.  
  
 Чтобы задать язык сценариев по умолчанию для компонента скрипта, используйте **язык сценариев** параметр **Общие** страница **параметры** диалоговое окно. Дополнительные сведения см. в разделе [General Page](https://msdn.microsoft.com/library/ms189436(v=sql.110).aspx).  
  
## <a name="understanding-the-two-design-time-modes"></a>Основные сведения о двух режимах времени разработки  
 В конструкторе [!INCLUDE[ssIS](../../../includes/ssis-md.md)] у компонента Script есть два режима: режим конструирования метаданных и режим конструирования кода.  
  
 При открытии **редактор преобразования «скрипт»**, компонент перейдет в режим конструктора метаданных. В этом режиме можно выбрать входные столбцы, а также добавить или настроить выходы и выходные столбцы, но нельзя писать код. После настройки метаданных компонента можно переключиться в режим конструктора кода для создания скрипта.  
  
 При переключении в режим конструктора кода, щелкнув **изменить скрипт**, компонент скрипта блокирует внесение дополнительных изменений метаданных и автоматически создает базовый код из метаданных входов и выходов. После завершения автоматического формирования кода появляется возможность вводить пользовательский код. В разрабатываемом коде используются автоматически сформированные базовые классы для обработки входных строк, доступа к буферам и столбцам в буферах, а также для получения диспетчеров соединений и переменных из пакета; при этом все объекты рассматриваются как строго типизированные.  
  
 После ввода пользовательского кода в режиме конструктора кода можно переключиться обратно в режим конструктора метаданных. Это не приводит к удалению введенного кода, но последующие изменения в метаданных вызывают повторное формирование базового класса. В дальнейшем проверка компонента может окончиться неудачей из-за того, что объекты, на которые имеются ссылки в пользовательском коде, больше не существуют или, возможно, были изменены. В этом случае необходимо исправить код вручную, чтобы можно было успешно скомпилировать его для повторно сформированного базового класса.  
  
## <a name="configuring-the-component-in-metadata-design-mode"></a>Настройка компонента в режиме конструктора метаданных  
 В режиме конструктора метаданных можно выбирать входные столбцы, а также добавлять и настраивать выходы и выходные столбцы, но возможность писать код не предусмотрена. После настройки конфигурации метаданных компонента переключитесь в режим конструктора кода для написания скрипта.  
  
 Свойства, которые необходимо настроить в пользовательском редакторе, зависят от выбранной области применения компонента скрипта. Компонент скрипта можно настроить как источник, преобразование или назначение. В зависимости от того, как компонент используется, он поддерживает либо вход, либо выход, либо и вход и выход одновременно. Пользовательский код, который должен быть написан, применяется для обработки входных и выходных строк и столбцов.  
  
### <a name="inputs-columns-page-of-the-script-transformation-editor"></a>Страница «Входные столбцы» окна «Редактор преобразования "Скрипт"»  
 **Входные столбцы** страница **редактор преобразования «скрипт»** отображается для преобразований и назначений, но не для источников. На этой странице выбираются доступные входные столбцы, которые необходимо сделать доступными для пользовательского скрипта, а также указывается тип доступа для них: только для чтения или для чтения и записи.  
  
 В проекте кода, создаваемого на основе этих метаданных, элемент проекта BufferWrapper содержит класс для каждого входа и этот класс включает свойства типизированного метода доступа для каждого выбранного входного столбца. Например, если выбрать целое **CustomerID** столбец и строку **CustomerName** столбец с именем входа **CustomerInput**, элемент проекта bufferwrapper будет содержать **CustomerInput** класс, производный от <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>и **CustomerInput** класса будет предоставлять целочисленное свойство с именем **CustomerID** и строковое свойство с именем **CustomerName**. Благодаря наличию такого соглашения появляется возможность писать код с проверкой соответствия типов, подобный следующему:  
  
```vb  
Dim currentCustomerID as Integer = CustomerInput.CustomerID  
Dim currentCustomerName as String = CustomerInput.CustomerName  
```  
  
 Дополнительные сведения о том, как настраивать входные столбцы для конкретного типа компонента потока данных см. в разделе соответствующем примере в разделе [разработка определенных типов компонента скрипта](../../../integration-services/extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).  
  
### <a name="inputs-and-outputs-page-of-the-script-transformation-editor"></a>Страница «Входы и выходы» окна «Редактор преобразования "Скрипт"»  
 **Входы и выходы** страница **редактор преобразования «скрипт»** отображается для источников, преобразований и назначений. На этой странице можно добавлять, удалять и настраивать входы, выходы и выходные столбцы, которые нужно использовать в пользовательском скрипте, с учетом следующих ограничений.  
  
-   При использовании в качестве источника компонент скрипта не имеет входов и поддерживает несколько выходов.  
  
-   При использовании в качестве преобразования компонент скрипта поддерживает один вход и несколько выходов.  
  
-   При использовании в качестве назначения компонент скрипта поддерживает один вход и не имеет выходов.  
  
 В проекте кода, создаваемом на основе этих метаданных, элемент проекта BufferWrapper содержит класс для каждого входа и выхода. Например, если создать выход с именем **CustomerOutput**, элемент проекта bufferwrapper будет содержать **CustomerOutput** класс, производный от <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>и **CustomerOutput** класс будет содержать свойства типизированного метода доступа для каждого созданного выходного столбца.  
  
 Выходные столбцы можно настроить только на **входы и выходы** страницы. Можно выбрать входные столбцы для преобразований и назначений на **входные столбцы** страницы. Свойства типизированного метода доступа, созданные для разработчика в элементе проекта BufferWrapper, будут доступны только для записи для выходных столбцов. Свойства метода доступа для входных столбцов будут доступны только для чтения или чтения и записи, в зависимости от выбранного для каждого столбца на тип использования **входные столбцы** страницы.  
  
 Дополнительные сведения о настройке входов и выходов для конкретного типа данных компоненту потока см. соответствующем примере в разделе [разработка определенных типов компонента скрипта](../../../integration-services/extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).  
  
> [!NOTE]  
>  Хотя нельзя непосредственно настроить выход в качестве вывода ошибок в компоненте скрипта для автоматической обработки ошибочных строк, но можно воспроизвести функциональные возможности вывода ошибок путем создания дополнительного выхода и использования скрипта для направления строк в этот выход при соответствующих условиях. Дополнительные сведения см. в разделе [имитация вывода ошибок для компонента скрипта](../../../integration-services/extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).  
  
#### <a name="exclusiongroup-and-synchronousinputid-properties-of-outputs"></a>Свойства ExclusionGroup и SynchronousInputID выходов  
 **ExclusionGroup** свойство имеет ненулевое значение только в преобразованиях с синхронными выходами, когда ваш код выполняется фильтрация или ветвление и направляет каждую строку на один из выходов, одна и та же ненулевое значение **ExclusionGroup** значение. Например, преобразование может направлять строки либо в выход по умолчанию, либо в вывод ошибок. При создании дополнительных выходов для этого сценария, убедитесь, что значение **SynchronousInputID** свойство целое число, которое соответствует **идентификатор** входа компонента.  
  
 **SynchronousInputID** свойство имеет ненулевое значение только в преобразованиях с синхронными выходами. Если это свойство равно нулю, выход является асинхронным. Для синхронного выхода, где строки передаются в выбранный выход или выходы без добавления новых строк, это свойство должно содержать **идентификатор** входа компонента.  
  
> [!NOTE]  
>  При **редактор преобразования «скрипт»** первого выхода, редактор задает **SynchronousInputID** свойство вывода **идентификатор** входа компонента. Тем не менее, при создании последующих выходов редактор редактор задает **SynchronousInputID** свойства этих выходов значение равное нулю.  
>   
>  При создании компонента с синхронными выходами каждого выхода необходимо его **SynchronousInputID** свойство **идентификатор** входа компонента. Поэтому для каждого выхода, редактор создает после первого выхода необходимо его **SynchronousInputID** изменено значение от нуля до **идентификатор** входа компонента.  
>   
>  При создании компонента с асинхронными выходами каждого выхода необходимо его **SynchronousInputID** свойство равным нулю. Таким образом, первого выхода необходимо его **SynchronousInputID** значение изменено из **идентификатор** входа компонента в нуль.  
  
 Пример перенаправления строк в один из двух синхронных выходов в компоненте скрипта см. в разделе [создание синхронного преобразования с помощью компонента скрипта](../../../integration-services/extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).  
  
### <a name="object-names-in-generated-script"></a>Имена объектов в созданном скрипте  
 Компонент скрипта анализирует имена входов и выходов, а также имена столбцов во входах и выходах, после чего на основе этих имен создает классы и свойства в элементе проекта BufferWrapper. Если найденные имена включают символы, которые не относятся к категории Юникода **UppercaseLetter**, **LowercaseLetter**, **TitlecaseLetter**, **ModifierLetter**, **OtherLetter**, или **DecimalDigitLetter**, недопустимые символы удаляются из создаваемых имен. Например, удаляются пробелы, поэтому два входных столбцов, которые имеют имена, **FirstName** и [**имя**] интерпретируются как имеющие имя столбца **FirstName**, с непредсказуемыми результатами. Чтобы избежать такой ситуации, имена входов и выходов и имена входных и выходных столбцов, используемых в компоненте скрипта, должны содержать только символы из категорий Юникода, перечисленных в этом разделе.  
  
### <a name="script-page-of-the-script-transformation-editor"></a>Страница «Скрипт» окна «Редактор преобразования "Скрипт"»  
 На **сценарий** страница **редактор задачи «скрипт»**, присвоить уникальное имя и описание для задачи «скрипт». Можно также присваивать значения для следующих свойств.  
  
> [!NOTE]  
>  В [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] и более поздних версиях все скрипты предварительно скомпилированы. В предыдущих версиях, указан ли скрипты предварительно скомпилированными, задав **Precompile** свойства для задачи.  
  
#### <a name="validateexternalmetadata-property"></a>Свойство ValidateExternalMetadata  
 Логическое значение **ValidateExternalMetadata** свойство указывает, является ли компонент должен выполнять проверку на внешних источниках данных во время разработки или ли он эту проверку следует отложить до времени выполнения. По умолчанию, значение этого свойства равно **True**; то есть, внешние метаданные проверяются во время разработки и во время выполнения. Требуется задать значение этого свойства равным **False** когда внешнего источника данных доступен не во время разработки: например, если пакет загружается источник или создается назначение только во время выполнения.  
  
#### <a name="readonlyvariables-and-readwritevariables-properties"></a>Свойства ReadOnlyVariables и ReadWriteVariables  
 Можно вводить разделенные запятыми списки существующих переменных в качестве значений этих свойств, чтобы обеспечить доступ к переменным только для чтения или для чтения и записи в коде компонента скрипта. Доступ к переменным в коде осуществляется с помощью свойств <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> и <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> автоматически сформированного базового класса. Дополнительные сведения см. в разделе [использование переменных в компоненте скрипта](../../../integration-services/extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).  
  
> [!NOTE]  
>  В именах переменных учитывается регистр букв.  
  
#### <a name="scriptlanguage"></a>ScriptLanguage  
 В качестве языка программирования для компонента «Скрипт» можно выбрать [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic или [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#.  
  
#### <a name="edit-script-button"></a>Кнопка «Изменить скрипт»  
 **Изменить скрипт** открывает [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] средств для приложений (VSTA) интегрированной среды разработки, в котором можно написать пользовательский скрипт. Дополнительные сведения см. в разделе [кодировании и отладке компонента скрипта](../../../integration-services/extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md).  
  
### <a name="connection-managers-page-of-the-script-transformation-editor"></a>Страница «Диспетчеры соединений» окна «Редактор преобразования "Скрипт"»  
 На **диспетчеры соединений** страница **редактор преобразования «скрипт»**, добавлять и удалять диспетчеры соединений, которые вы хотите использовать пользовательский скрипт. Обычно необходимость ссылаться на диспетчеры соединений возникает при создании компонента источника или назначения.  
  
 В коде проекта, который будет создан на основе этих метаданных, **ComponentWrapper** элемент проекта содержит **подключений** класс коллекции, имеющий свойство типизированного метода доступа для каждого выбранного диспетчера соединений. Каждое свойство типизированного метода доступа имеет такое же имя, что и сам диспетчер соединений, и возвращает ссылку на диспетчер соединений как экземпляр <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>. Например, при добавлении диспетчера соединений с именем `MyADONETConnection` на **диспетчеры соединений** страницы редактора, можно получить ссылку на диспетчер соединений в скрипте, используя следующий код:  
  
```vb  
Dim myADONETConnectionManager As IDTSConnectionManager100 = _  
    Me.Connections.MyADONETConnection  
```  
  
 Дополнительные сведения см. в разделе [соединения с источниками данных в компоненте скрипта](../../../integration-services/extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md).  
  
## <a name="see-also"></a>См. также:  
 [Кодирование и отладка компонента скрипта](../../../integration-services/extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md)  
  
  

