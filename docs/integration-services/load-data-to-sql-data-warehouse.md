---
title: Загрузка данных из SQL Server в хранилище данных SQL Azure (SSIS) | Документы Майкрософт
description: Сведения о создании пакета служб SQL Server Integration Services (SSIS) для перемещения данных из разнообразных источников данных в хранилище данных SQL.
documentationcenter: NA
ms.service: sql-data-warehouse
ms.component: data-movement
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.custom: loading
ms.date: 04/04/2018
ms.author: douglasl
author: douglaslMS
manager: craigg-msft
ms.openlocfilehash: 84295d9d1e43a9d10724ab8381aa4308f50c8513
ms.sourcegitcommit: abd71294ebc39695d403e341c4f77829cb4166a8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2018
ms.locfileid: "36887410"
---
# <a name="load-data-from-sql-server-to-azure-sql-data-warehouse-with-sql-server-integration-services-ssis"></a>Загрузка данных из SQL Server в хранилище данных SQL Azure с помощью служб SQL Server Integration Services (SSIS)

Вы можете создать пакет служб SQL Server Integration Services (SSIS) для загрузки данных из SQL Server в [хранилище данных SQL Azure](/azure/sql-data-warehouse/index). При необходимости можно реструктуризировать, преобразовать и очистить данные по мере их прохождения через поток данных SSIS.

В этом учебнике рассматриваются следующие задачи:

* Создание проекта служб Integration Services в Visual Studio.
* Подключение к источникам данных, включая SQL Server (как источник) и хранилище данных SQL (как назначение).
* Создание пакета служб SSIS, который загружает данные из источника в назначение.
* Запуск пакета служб SSIS для загрузки данных.

В этом учебнике в качестве источника данных используется SQL Server. SQL Server может выполняться на локальном компьютере или на виртуальной машине Azure.

## <a name="basic-concepts"></a>Основные понятия
Пакет — это единица работы в службах SSIS. Связанные пакеты группируются в проекты. Для создания проектов и пакетов разработки в Visual Studio используется SQL Server Data Tools. Процесс разработки — это визуальный процесс, в котором вы перетаскиваете компоненты с панели элементов в область конструктора, соединяете их и задаете их свойства. После завершения пакета его при необходимости можно развернуть в SQL Server для комплексного обеспечения управления, мониторинга и безопасности.

## <a name="options-for-loading-data-with-ssis"></a>Варианты загрузки данных с помощью служб SSIS
Службы SQL Server Integration Services (SSIS) — это гибкий набор средств, предоставляющий разнообразные возможности для подключения к хранилищу данных SQL и загрузки в него данных.

1. Используйте назначение ADO.NET для подключения к хранилищу данных SQL. В этом учебнике используется назначение ADO.NET, так как оно имеет минимальные параметры конфигурации.
2. Используйте назначение OLE DB для подключения к хранилищу данных SQL. Этот вариант может обеспечить небольшое повышение производительности по сравнению с назначением ADO.NET.
3. Используйте задачу передачи BLOB-объектов Azure для размещения данных в хранилище BLOB-объектов Azure. После этого используйте задачу "Выполнить SQL" служб SSIS, чтобы запустить скрипт Polybase, который загружает данные в хранилище данных SQL. Из трех представленных здесь вариантов этот обеспечивает наибольшую производительность. Чтобы получить задачу передачи BLOB-объектов Azure, скачайте [пакет дополнительных компонентов Microsoft SQL Server 2016 Integration Services для Azure][Microsoft SQL Server 2016 Integration Services Feature Pack for Azure]. Дополнительные сведения о Polybase см. в [руководстве по PolyBase][PolyBase Guide].

## <a name="before-you-start"></a>Перед началом
Для пошагового изучения этого учебника потребуется следующее:

1. **SQL Server Integration Services (SSIS)**. Службы SSIS — это компонент SQL Server, которому для работы нужна ознакомительная или лицензионная версия SQL Server. Чтобы получить ознакомительную версию SQL Server 2016 Preview, см. раздел [Ознакомительные версии SQL Server][SQL Server Evaluations].
2. **Visual Studio**. Для получения бесплатного выпуска Visual Studio Community см. раздел [Visual Studio Community][Visual Studio Community].
3. **SQL Server Data Tools для Visual Studio (SSDT)**. Чтобы получить SQL Server Data Tools для Visual Studio, см. раздел [Скачивание SQL Server Data Tools (SSDT)][Download SQL Server Data Tools (SSDT)].
4. **Образец данных**. В этом учебнике в качестве исходных данных для загрузки в хранилище данных SQL используется образец данных, сохраненный в SQL Server в образце базы данных AdventureWorks. Чтобы получить образец базы данных AdventureWorks, см. раздел [Образцы баз данных AdventureWorks 2014][AdventureWorks 2014 Sample Databases].
5. **База данных хранилища данных SQL и разрешения**. Этот учебник подключается к экземпляру хранилища данных SQL и загружает в него данные. Вам нужны разрешения на создание таблицы и загрузку данных.
6. **Правило брандмауэра**. Перед загрузкой данных в хранилище данных SQL вам нужно создать в нем правило брандмауэра с IP-адресом локального компьютера.

## <a name="step-1-create-a-new-integration-services-project"></a>Шаг 1. Создание проекта служб Integration Services
1. Запустите Visual Studio.
2. В меню **Файл** выберите **Создать | Проект**.
3. Перейдите к типам проектов **Установленные | Шаблоны | Бизнес-аналитика | Integration Services**.
4. Выберите **Проект служб SSIS**. Укажите значения для параметров **Имя** и **Расположение**, а затем нажмите кнопку **ОК**.

Visual Studio открывает и создает проект служб Integration Services (SSIS). Затем Visual Studio открывает конструктор для отдельного нового пакета служб SSIS (Package.dtsx) в проекте. Видны следующие области экрана:

* В левой части **панель элементов** для компонентов служб SSIS.
* В центре область конструктора с несколькими вкладками. Как правило, используются по меньшей мере вкладки **Поток управления** и **Поток данных**.
* В правой части — области **Обозреватель решений** и **Свойства**.
  
    ![][01]

## <a name="step-2-create-the-basic-data-flow"></a>Шаг 2. Создание простого потока данных
1. Перетащите задачу потока данных с панели элементов в центр области конструктора (на вкладке **Поток управления**).
   
    ![][02]
2. Дважды щелкните элемент "Задача потока данных", чтобы перейти на вкладку "Поток данных".
3. В списке "Другие источники" на панели элементов перетащите источник ADO.NET в область конструктора. Выбрав адаптер источника данных, измените его имя на **SQL Server source** (Источник SQL Server) в области **Свойства**.
4. В списке "Другие назначения" на панели элементов перетащите назначение ADO.NET в область конструктора под источником ADO.NET. Выбрав адаптер загрузки данных, измените его имя на **SQL DW destination** (Назначение хранилища данных SQL) в области **Свойства**.
   
    ![][09]

## <a name="step-3-configure-the-source-adapter"></a>Шаг 3. Настройка адаптера источника данных
1. Дважды щелкните адаптер источника данных, чтобы открыть **Редактор источника ADO.NET**.
   
    ![][03]
2. На вкладке **Диспетчер соединений** окна **Редактор источника ADO.NET** нажмите кнопку **Создать** рядом со списком **Диспетчер соединений ADO.NET**, чтобы открыть диалоговое окно **Настройка диспетчера соединений ADO.NET** и создать параметры подключения для базы данных SQL Server, откуда этот учебник загружает данные.
   
    ![][04]
3. В диалоговом окне **Настройка диспетчера соединений ADO.NET** нажмите кнопку **Создать**, чтобы открыть диалоговое окно **Диспетчер соединений** и создать подключение к данным.
   
    ![][05]
4. В диалоговом окне **Диспетчер соединений** сделайте следующее:
   
   1. В поле **Поставщик** выберите поставщик данных SqlClient.
   2. В поле **Имя сервера** введите имя SQL Server.
   3. В разделе **Вход на сервер** выберите или введите сведения для проверки подлинности.
   4. В разделе **Соединение с базой данных** выберите образец базы данных AdventureWorks.
   5. Нажмите кнопку **Проверить соединение**.
      
       ![][06]
   6. В диалоговом окне, сообщающем результаты проверки соединения, нажмите кнопку **ОК**, чтобы вернуться в диалоговое окно **Диспетчер соединений**.
   7. В диалоговом окне **Диспетчер соединений** нажмите кнопку **ОК** для возврата в диалоговое окно **Настройка диспетчера соединений ADO.NET**.
5. В диалоговом окне **Настройка диспетчера соединений ADO.NET** нажмите кнопку **ОК** для возврата в **Редактор источника ADO.NET**.
6. В окне **Редактор источника ADO.NET** в списке **Имя таблицы или представления** выберите таблицу **Sales.SalesOrderDetail**.
   
    ![][07]
7. Нажмите кнопку **Предварительный просмотр**, чтобы просмотреть первые 200 строк данных исходной таблицы в диалоговом окне **Предварительный просмотр результатов запроса**.
   
    ![][08]
8. В диалоговом окне **Предварительный просмотр результатов запроса** нажмите кнопку **Закрыть** для возврата в **Редактор источника ADO.NET**.
9. В окне **Редактор источника ADO.NET** нажмите кнопку **ОК**, чтобы завершить настройку источника данных.

## <a name="step-4-connect-the-source-adapter-to-the-destination-adapter"></a>Шаг 4. Подключение адаптера источника данных к адаптеру загрузки данных
1. Выберите адаптер источника данных в области конструктора.
2. Выберите синюю стрелку, отходящую от адаптера источника данных, и перетащите к редактору назначения до ее фиксации.
   
    ![][10]
   
    В типичном пакете служб SSIS между источником и назначением используется несколько других компонентов из панели элементов SSIS для реструктуризации, преобразования и очистки данных по мере их прохождения через поток данных SSIS. Чтобы сделать этот пример как можно более простым, мы подключаем источник непосредственно к назначению.

## <a name="step-5-configure-the-destination-adapter"></a>Шаг 5. Настройка адаптера загрузки данных
1. Дважды щелкните адаптер загрузки данных, чтобы открыть **Редактор назначения ADO.NET**.
   
    ![][11]
2. На вкладке **Диспетчер соединений** окна **Редактор назначения ADO.NET** нажмите кнопку **Создать** рядом со списком **Диспетчер соединений ADO.NET**, чтобы открыть диалоговое окно **Настройка диспетчера соединений ADO.NET** и создать параметры подключения для базы данных хранилища данных SQL Azure, куда этот учебник загружает данные.
3. В диалоговом окне **Настройка диспетчера соединений ADO.NET** нажмите кнопку **Создать**, чтобы открыть диалоговое окно **Диспетчер соединений** и создать подключение к данным.
4. В диалоговом окне **Диспетчер соединений** сделайте следующее:
   1. В поле **Поставщик** выберите поставщик данных SqlClient.
   2. В поле **Имя сервера** введите имя хранилища данных SQL.
   3. В разделе **Вход на сервер** выберите **Использовать проверку подлинности SQL Server** и введите сведения для проверки подлинности.
   4. В разделе **Соединение с базой данных** выберите существующую базу данных хранилища данных SQL.
   5. Нажмите кнопку **Проверить соединение**.
   6. В диалоговом окне, сообщающем результаты проверки соединения, нажмите кнопку **ОК**, чтобы вернуться в диалоговое окно **Диспетчер соединений**.
   7. В диалоговом окне **Диспетчер соединений** нажмите кнопку **ОК** для возврата в диалоговое окно **Настройка диспетчера соединений ADO.NET**.
5. В диалоговом окне **Настройка диспетчера соединений ADO.NET** нажмите кнопку **ОК** для возврата в **Редактор назначения ADO.NET**.
6. В окне **Редактор назначения ADO.NET** нажмите кнопку **Создать** рядом со списком **Использовать таблицу или представление**, чтобы открыть диалоговое окно **Создание таблицы** для создания целевой таблицы со списком столбцов, соответствующим исходной таблице.
   
    ![][12a]
7. В диалоговом окне **Создание таблицы** сделайте следующее:
   
   1. Измените имя целевой таблицы на **SalesOrderDetail**.
   2. Удалите столбец **rowguid**. Тип данных **Uniqueidentifier** в хранилище данных SQL не поддерживается.
   3. Измените тип данных столбца **LineTotal** на **money**. Тип данных **decimal** в хранилище данных SQL не поддерживается. Сведения о поддерживаемых типах данных см. в разделе [CREATE TABLE (хранилище данных SQL Azure или Parallel Data Warehouse)][CREATE TABLE (Azure SQL Data Warehouse, Parallel Data Warehouse)].
      
       ![][12b]
   4. Нажмите кнопку **ОК**, чтобы создать таблицу и вернуться в **Редактор назначения ADO.NET**.
8. В окне **Редактор назначения ADO.NET** откройте вкладку **Сопоставления**, чтобы просмотреть, как столбцы в источнике сопоставляются со столбцами в назначении.
   
    ![][13]
9. Нажмите кнопку **ОК**, чтобы завершить настройку источника данных.

## <a name="step-6-run-the-package-to-load-the-data"></a>Шаг 6. Запуск пакета для загрузки данных
Запустите пакет, нажав кнопку **Пуск** на панели инструментов или выбрав один из параметров **запуска** в меню **Отладка**.

Как только начнется выполнение пакета, вы увидите желтые вращающиеся колеса, обозначающие активность, а также количество обработанных строк.

![][14]

После завершения выполнения пакета появляются зеленые галочки, указывающие успешность операции, а также общее число строк данных, загруженных из источника в назначение.

![][15]

Поздравляем! Вы успешно использовали службы SQL Server Integration Services для загрузки данных в хранилище данных SQL Azure.

## <a name="next-steps"></a>Следующие шаги
* Дополнительные сведения о потоке данных SSIS. Вы можете начать отсюда: [Поток данных][Data Flow].
* Сведения об отладке пакетов и устранении их неполадок прямо в среде разработки. Вы можете начать отсюда: [Инструменты устранения неполадок при разработке пакета][Troubleshooting Tools for Package Development].
* Сведения о развертывании пакетов и проектов служб SSIS на сервере служб Integration Services или в другом хранилище. Вы можете начать отсюда: [Развертывание проектов и пакетов][Deployment of Projects and Packages].

<!-- Image references -->
[01]:  ./media/load-data-to-sql-data-warehouse/ssis-designer-01.png
[02]:  ./media/load-data-to-sql-data-warehouse/ssis-data-flow-task-02.png
[03]:  ./media/load-data-to-sql-data-warehouse/ado-net-source-03.png
[04]:  ./media/load-data-to-sql-data-warehouse/ado-net-connection-manager-04.png
[05]:  ./media/load-data-to-sql-data-warehouse/ado-net-connection-05.png
[06]:  ./media/load-data-to-sql-data-warehouse/test-connection-06.png
[07]:  ./media/load-data-to-sql-data-warehouse/ado-net-source-07.png
[08]:  ./media/load-data-to-sql-data-warehouse/preview-data-08.png
[09]:  ./media/load-data-to-sql-data-warehouse/source-destination-09.png
[10]:  ./media/load-data-to-sql-data-warehouse/connect-source-destination-10.png
[11]:  ./media/load-data-to-sql-data-warehouse/ado-net-destination-11.png
[12a]: ./media/load-data-to-sql-data-warehouse/destination-query-before-12a.png
[12b]: ./media/load-data-to-sql-data-warehouse/destination-query-after-12b.png
[13]:  ./media/load-data-to-sql-data-warehouse/column-mapping-13.png
[14]:  ./media/load-data-to-sql-data-warehouse/package-running-14.png
[15]:  ./media/load-data-to-sql-data-warehouse/package-success-15.png

<!-- Article references -->

<!-- MSDN references -->
[PolyBase Guide]: ../relational-databases/polybase/polybase-guide.md
[Download SQL Server Data Tools (SSDT)]: ../ssdt/download-sql-server-data-tools-ssdt.md
[CREATE TABLE (Azure SQL Data Warehouse, Parallel Data Warehouse)]: ../t-sql/statements/create-table-azure-sql-data-warehouse.md
[Data Flow]: ./data-flow/data-flow.md
[Troubleshooting Tools for Package Development]: ./troubleshooting/troubleshooting-tools-for-package-development.md
[Deployment of Projects and Packages]: ./packages/deploy-integration-services-ssis-projects-and-packages.md

<!--Other Web references-->
[Microsoft SQL Server 2016 Integration Services Feature Pack for Azure]: http://go.microsoft.com/fwlink/?LinkID=626967
[SQL Server Evaluations]: https://www.microsoft.com/evalcenter/evaluate-sql-server-2016
[Visual Studio Community]: https://www.visualstudio.com/products/visual-studio-community-vs.aspx
[AdventureWorks 2014 Sample Databases]: https://github.com/Microsoft/sql-server-samples/releases/tag/adventureworks
