---
title: SQL Server XML объектная модель массовой загрузки (SQLXML 4.0) | Документы Microsoft
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- database-engine
- docset-sql-devref
ms.tgt_pltfrm: ''
ms.topic: reference
helpviewer_keywords:
- bulk load [SQLXML], object model
- ErrorLogFile property
- SGDropTables property
- SGUseID property
- KeepNulls property
- ConnectionCommand property
- SchemaGen property
- XMLFragment property
- SQLXMLBulkLoad object
- ForceTableLock property
- CheckConstraints property
- BulkLoad property
- TempFilePath property
- IgnoreDuplicateKeys property
- Transaction property
- KeepIdentity property
- ConnectionString property
- FireTriggers property
- Execute method
- XML Bulk Load [SQLXML], object model
ms.assetid: a9efbbde-ed2b-4929-acc1-261acaaed19d
caps.latest.revision: 27
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: bb60aaf57869dbbd108c0815ed3fc02b07ed4bf5
ms.sourcegitcommit: 5dd5cad0c1bbd308471d6c885f516948ad67dfcf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2018
ms.locfileid: "36193551"
---
# <a name="sql-server-xml-bulk-load-object-model-sqlxml-40"></a>Объектная модель массовой загрузки XML SQL Server (SQLXML 4.0)
  Microsoft [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Массовая загрузка XML объектная модель состоит из свойство sqlxmlbulkload. Этот объект поддерживает следующие свойства и методы.  
  
## <a name="methods"></a>Методы  
 Execute  
 Проводит массовую загрузку данных на основании файла схемы и файла (или потока) данных, которые передаются как параметры.  
  
## <a name="properties"></a>Свойства  
 BulkLoad  
 Указывает, должна ли проводиться массовая загрузка. Это свойство полезно, если требуется только создать схемы (см. свойства SchemaGen SGDropTables и SGUseID, которые следуют) и не выполнять массовую загрузку. Это свойство является логическим. Когда свойство имеет значение TRUE, проводится массовая загрузка XML. Когда свойство имеет значение FALSE, массовая загрузка XML не проводится.  
  
 Значение по умолчанию — TRUE.  
  
 CheckConstraints  
 Указывает, следует ли проверять ограничения (например, ограничения связи «первичный ключ - внешний ключ» между столбцами), заданные для столбцов, когда массовая загрузка XML вставляет данные в столбцы. Это свойство является логическим.  
  
 Если свойство имеет значение TRUE, массовая загрузка XML проверяет ограничения для каждого вставляемого значения (а это значит, что при нарушении ограничения возникнет ошибка).  
  
> [!NOTE]  
>  Чтобы задать этому свойству значение FALSE, необходимо иметь **ALTER TABLE** разрешений в целевых таблицах. Дополнительные сведения см. в разделе [ALTER TABLE (Transact-SQL)](/sql/t-sql/statements/alter-table-transact-sql).  
  
 Значение по умолчанию — FALSE. Когда для свойства задано значение FALSE, массовая загрузка XML при выполнении вставки не учитывает ограничения. В текущей реализации нужно определять таблицы в порядке связи первичного и внешнего ключей, заданных в схеме сопоставления. Иными словами, таблица, содержащая первичный ключ, должна быть определена раньше, чем соответствующая ей таблица с внешним ключом. В противном случае массовая загрузка XML завершится ошибкой.  
  
 Следует заметить, что, если проводится распространение идентификаторов, этот параметр неприменим и проверка ограничений будет проводиться. Это происходит в том случае, если задано `KeepIdentity=False` и определена связь, в которой родительский элемент является полем идентификатора, а значение назначается дочернему элементу при его формировании.  
  
 ConnectionCommand  
 Указывает существующий объект соединения (например, ADO или ICommand объект команды), которые должна использовать Массовая загрузка XML. Свойство ConnectionCommand вместо указания строки подключения с помощью свойства ConnectionString. Свойство транзакции должно быть присвоено значение TRUE, если вы используете ConnectionCommand.  
  
 Если вы используете свойства ConnectionString и ConnectionCommand, Массовая загрузка XML использует последнее указанное свойство.  
  
 Значение по умолчанию — NULL.  
  
 ConnectionString  
 Задает строку соединения OLE DB, содержащую необходимую информацию для установления соединения с экземпляром базы данных. Если вы используете свойства ConnectionString и ConnectionCommand, Массовая загрузка XML использует последнее указанное свойство.  
  
 Значение по умолчанию — NULL.  
  
 ErrorLogFile  
 Указывает имя файла журнала, в который массовая загрузка XML заносит сообщения об ошибках и другие виды сообщений. Значение по умолчанию — пустая строка; в этом случае занесение в журнал не производится.  
  
 FireTriggers  
 Указывает, должны ли срабатывать триггеры, определенные в целевых таблицах, во время операции массовой загрузки. Значение по умолчанию — FALSE.  
  
 Если задано значение TRUE, триггеры будут срабатывать как при обычной операции вставки.  
  
> [!NOTE]  
>  Чтобы задать этому свойству значение FALSE, необходимо иметь **ALTER TABLE** разрешений в целевых таблицах. Дополнительные сведения см. в разделе [ALTER TABLE (Transact-SQL)](/sql/t-sql/statements/alter-table-transact-sql).  
  
 Следует заметить, что, если проводится распространение идентификаторов, этот параметр неприменим и все триггеры останутся включенными. Это происходит в том случае, если задано `KeepIdentity=False` и определена связь, в которой родительский элемент является полем идентификатора, а значение назначается дочернему элементу при его формировании.  
  
 ForceTableLock  
 Указывает, следует ли блокировать таблицы, в которые массовая загрузка XML копирует данные, на время массовой загрузки. Это свойство является логическим. Когда свойство имеет значение TRUE, массовая загрузка XML блокирует таблицы на все время своей работы. Когда для свойства задано значение FALSE, массовая загрузка XML блокирует таблицу только на то время, когда вставляет в нее запись.  
  
 Значение по умолчанию — FALSE.  
  
 IgnoreDuplicateKeys  
 Указывает, что делать в случае попытки вставить повторяющиеся значения в ключевой столбец. Если свойство имеет значение TRUE, то в случае попытки вставить повторяющиеся значения в ключевой столбец [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] не разрешит вставить запись. Однако следующая запись будет вставлена; таким образом, операция массовой загрузки XML завершится успешно. Если свойство имеет значение FALSE, в случае попытки вставить повторяющиеся значения в ключевой столбец операция массовой загрузки XML завершится ошибкой.  
  
 Если свойство IgnoreDuplicateKeys имеет значение TRUE, инструкция COMMIT выдается для каждой записи, вставляемой в таблицу. Это замедляет операцию. Свойство может быть задано значение TRUE, только когда свойство Transaction присвоено значение FALSE, поскольку транзакционное поведение реализовано с помощью файлов.  
  
 Значение по умолчанию — FALSE.  
  
 KeepIdentity  
 Указывает, как обрабатывать значения столбца типа Identity в исходном файле. Это свойство является логическим. Когда свойство имеет значение TRUE, массовая загрузка XML назначает столбцу идентификаторов значения, заданные в исходном файле. Когда свойство имеет значение FALSE, массовая загрузка XML не учитывает значения столбца идентификаторов, заданные в исходном файле. В этом случае [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] присваивает столбцу идентификаторов собственные значения.  
  
 Если в массовой загрузке XML участвует столбец, являющийся внешним ключом для столбца идентификаторов, в котором хранятся значения, сформированные [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], массовая загрузка распространяет эти значения идентификаторов на внешний ключевой столбец.  
  
 Значение этого свойства применяется ко всем столбцам, задействованным в массовой загрузке. Значение по умолчанию — TRUE.  
  
> [!NOTE]  
>  Чтобы задать этому свойству значение TRUE, необходимо иметь **ALTER TABLE** разрешений в целевых таблицах. В противном случае ему должно быть присвоено значение FALSE. Дополнительные сведения см. в разделе [ALTER TABLE (Transact-SQL)](/sql/t-sql/statements/alter-table-transact-sql).  
  
 KeepNulls  
 Указывает, какое значение будет использовано для столбца, не имеющего соответствующего атрибута или дочернего элемента в XML-документе. Это свойство является логическим. Если свойство имеет значение TRUE, массовая загрузка XML назначит этому столбцу значение NULL. Столбцу не будет присвоено значение по умолчанию, даже если таковое установлено на сервере. Значение этого свойства применяется ко всем столбцам, задействованным в массовой загрузке.  
  
 Значение по умолчанию — FALSE.  
  
 SchemaGen  
 Указывает, следует ли создавать нужные таблицы до операции массовой загрузки. Это свойство является логическим. Если свойство имеет значение TRUE, таблицы, заданные в схеме сопоставления, будут созданы (база данных должна существовать). Если один или несколько таблиц в базе данных уже существует, свойство SGDropTables определяет эти таблицы должен быть удален и создан повторно.  
  
 Значение по умолчанию для свойства SchemaGen имеет значение FALSE. SchemaGen не создает ограничения PRIMARY KEY на вновь созданных таблицах. SchemaGen Однако создать ограничения FOREIGN KEY в базе данных, если находит соответствующие `sql:relationship` и `sql:key-fields` заметки в схеме сопоставления и если ключевое поле состоит из одного столбца.  
  
 Обратите внимание, что если свойство SchemaGen задано значение TRUE, Массовая загрузка XML выполняет следующие задачи:  
  
-   создает необходимые таблицы на основании имен атрибутов и элементов. Поэтому нельзя использовать зарезервированные слова [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для имен атрибутов и элементов схемы;  
  
-   Возвращает данные переполнения для любого столбца, обозначенного с помощью [SQL: Overflow-поле](annotation-interpretation-sql-overflow-field.md) в [тип данных xml](/sql/t-sql/xml/xml-transact-sql) формат.  
  
 SGDropTables  
 Указывает, следует ли удалить и создать повторно существующие таблицы. Это свойство использовать в том случае, если свойство SchemaGen задано значение TRUE. Если SGDropTables имеет значение FALSE, существующие таблицы сохраняются. Если свойство имеет значение TRUE, существующие таблицы удаляются и создаются повторно.  
  
 Значение по умолчанию — FALSE.  
  
 SGUseID  
 Указывает, будет ли атрибут, заданный в схеме сопоставления как `id`, использован в создании ограничения типа PRIMARY KEY при создании таблицы. Это свойство используется в том случае, когда свойство SchemaGen имеет значение TRUE. Если SGUseID имеет значение TRUE, программа SchemaGen использует атрибут, для которого `dt:type="id"` указано в качестве столбца первичного ключа и добавляет ограничение PRIMARY KEY при создании таблицы.  
  
 Значение по умолчанию — FALSE.  
  
 Каталог временных файлов  
 Указывает файловый путь, по которому массовая загрузка XML создает временные файлы для хранения данных, массово загружаемых в транзакции. (Это свойство полезно, только когда свойство Transaction имеет значение TRUE.) Следует убедиться, что у учетной записи [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], используемой для массовой загрузки XML, есть доступ к этому пути. Если это свойство не установлено, массовая загрузка XML хранит временные файлы в месте, заданном переменной среды TEMP.  
  
 Transaction  
 Указывает, должна ли массовая загрузка выполняться в транзакции. В этом случае при неудачном завершении массовой загрузки производится откат транзакции. Это свойство является логическим. Когда свойство имеет значение TRUE, массовая загрузка XML проводится в контексте транзакции. Свойство TempFilePath полезно только в том случае, если транзакция имеет значение TRUE.  
  
> [!NOTE]  
>  При загрузке двоичных данных (таких как bin.hex, bin.base64 типы данных XML в двоичные изображения [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] типов данных), свойство транзакции должно быть присвоено значение FALSE.  
  
 Значение по умолчанию — FALSE.  
  
 XMLFragment  
 Указывает, являются ли исходные данные XML-фрагментом. Фрагмент XML — это XML-документ, в котором нет единственного элемента верхнего уровня. Это свойство является логическим. Если исходный файл является XML-фрагментом, для этого свойства следует задать значение TRUE.  
  
 Значение по умолчанию — FALSE.  
  
  
