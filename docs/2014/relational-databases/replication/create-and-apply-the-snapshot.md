---
title: Создание и применение моментального снимка | Документация Майкрософт
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], applying
- snapshots [SQL Server replication], creating
ms.assetid: 631f48bf-50c9-4015-b9d8-8f1ad92d1ee2
author: MashaMSFT
ms.author: mathoma
manager: craigg
ms.openlocfilehash: fc0654f4526ebd816b0b76dd7b2629a5bf2e1393
ms.sourcegitcommit: 3da2edf82763852cff6772a1a282ace3034b4936
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2018
ms.locfileid: "48135780"
---
# <a name="create-and-apply-the-snapshot"></a>Создание и применение моментального снимка
  Моментальные снимки создаются агентом моментальных снимков после создания публикации. Моментальные снимки могут создаваться:  
  
-   Немедленно. По умолчанию моментальный снимок для публикации слиянием формируется немедленно после создания публикации в мастере создания публикаций.  
  
-   По расписанию. Расписание задается на странице **Агент моментальных снимков** мастера создания публикаций либо при использовании хранимых процедур или объектов RMO.  
  
-   Вручную. Агент моментальных снимков запускается из командной строки или из среды [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]. Дополнительные сведения о выполнении агентов см. в статьях [Основные понятия исполняемых файлов агента репликации](concepts/replication-agent-executables-concepts.md) и [Запуск и остановка агента репликации (среда SQL Server Management Studio)](agents/start-and-stop-a-replication-agent-sql-server-management-studio.md).  
  
 Для репликации слиянием моментальный снимок формируется при каждом запуске агента моментальных снимков. Для репликации транзакций формирование моментального снимка зависит от настроек свойства публикации **immediate_sync**. Если значение свойства установлено в TRUE (значение по умолчанию при использовании мастера создания публикаций), моментальный снимок создается при каждом запуске агента моментальных снимков и может быть применен к подписчику в любое время. Если значение свойства установлено в FALSE (значение по умолчанию при использовании хранимой процедуры **sp_addpublication**), моментальный снимок создается только в том случае, если после запуска агента моментальных снимков была добавлена новая подписка. Для проведения синхронизации подписчики должны ждать завершения работы агента моментальных снимков.  
  
 Когда создаются моментальные снимки, они сохраняются по умолчанию в стандартной папке моментальных снимков, расположенной на распространителе. Файлы моментальных снимков можно также сохранить на сменных носителях, например на сменных дисках, компакт-дисках или в местоположениях, отличных от папки моментальных снимков по умолчанию. Кроме этого, эти файлы можно сжимать для облегчения их хранения и передачи, а также выполнять скрипты до или после применения моментального снимка на подписчике. Дополнительные сведения об этих параметрах см. в разделе [Snapshot Options](snapshot-options.md).  
  
 Если требуется моментальный снимок для публикации слиянием, в которой используются параметризованные фильтры, процесс создания моментального снимка происходит в два этапа. Сначала создается моментальный снимок схемы, который содержит скрипты репликации и схему публикуемых объектов, но не содержит данные. Потом каждая подписка инициализируется при помощи моментального снимка, который содержит скрипты и схему, скопированную из моментального снимка схемы, и данные, которые принадлежат секции подписки. Дополнительные сведения см. в статье [Snapshots for Merge Publications with Parameterized Filters](snapshots-for-merge-publications-with-parameterized-filters.md).  
  
 После того как моментальный снимок создан на издателе и сохранен в папке по умолчанию или в каком-либо другом местоположении, этот моментальный снимок можно передать подписчику и применить. Агент распространителя (для репликации моментальных снимков или репликации транзакций) или агент слияния (для репликации слиянием) передает моментальный снимок и применяет файлы схемы и данных в базе данных подписки на подписчике во время выполнения первоначальной синхронизации. Если используется мастер создания подписки, первоначальная синхронизация происходит по умолчанию немедленно после создания подписки. Этот режим управляется параметром **Инициализировать, когда** на странице **Инициализация подписок** мастера. Когда моментальные снимки создаются после инициализации подписки, они не применяются на подписчике, если подписка не помечена для повторной инициализации. Дополнительные сведения см. в статье [Повторная инициализация подписок](reinitialize-subscriptions.md).  
  
 После того, как агент распространителя или агент слияния применяет исходный моментальный снимок, агент распространяет последующие обновления и другие изменения данных. Когда моментальные снимки распространяются и применяются на подписчиках, воздействие оказывается только на подписчики, ожидающие исходные или новые моментальные снимки. Другие подписчики на данную публикацию (уже получающие вставки, обновления, удаления или другие изменения опубликованных данных) не подвергаются воздействию.  
  
 Чтобы создать и применить исходный моментальный снимок, см. раздел [Create and Apply the Initial Snapshot](create-and-apply-the-initial-snapshot.md).  
  
 Чтобы просмотреть или изменить папку по умолчанию для моментального снимка, см.  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: [Указание расположения моментальных снимков по умолчанию (SQL Server Management Studio)](specify-the-default-snapshot-location-sql-server-management-studio.md)  
  
-   Программирование репликации и RMO: [Configure Publishing and Distribution](configure-publishing-and-distribution.md)  
  
## <a name="see-also"></a>См. также  
 [Инициализация подписки с помощью моментального снимка](initialize-a-subscription-with-a-snapshot.md)   
 [Организация безопасности папки моментальных снимков](security/secure-the-snapshot-folder.md)   
 [sp_addpublication (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql)  
  
  
