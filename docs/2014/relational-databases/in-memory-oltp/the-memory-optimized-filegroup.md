---
title: Оптимизированная для памяти файловая группа | Документация Майкрософт
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- database-engine-imoltp
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 14106cc9-816b-493a-bcb9-fe66a1cd4630
caps.latest.revision: 12
author: stevestein
ms.author: sstein
manager: jhubbard
ms.openlocfilehash: e68b94ce70e24d16ac1cc94274b9dac05974dbe7
ms.sourcegitcommit: 5dd5cad0c1bbd308471d6c885f516948ad67dfcf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2018
ms.locfileid: "36102206"
---
# <a name="the-memory-optimized-filegroup"></a>Оптимизированная для памяти файловая группа
  Для создания оптимизированных для памяти таблиц необходимо сначала создать оптимизированную для памяти файловую группу. Оптимизированная для памяти файловая группа содержит один или несколько контейнеров. В каждом контейнере содержатся файлы данных или разностных файлы (или и те и другие).  
  
 Даже если строки данных из таблиц SCHEMA_ONLY не сохраняются, а метаданные оптимизированных для памяти таблиц и компилированных в собственном коде хранимых процедур хранятся в традиционных каталогах, модулю [!INCLUDE[hek_2](../../includes/hek-2-md.md)] все равно требуется оптимизированная для памяти файловая группа для оптимизированных для памяти таблиц SCHEMA_ONLY, чтобы обеспечить одинаковую работу баз данных, в которых есть оптимизированные для памяти таблицы.  
  
 В основе оптимизированной для памяти файловой группы лежит файловая группа FILESTREAM, но при этом имеются следующие отличия.  
  
-   Можно создать только одну оптимизированную для памяти файловую группу для одной базы данных. Необходимо явно пометить файловую группу как содержащую данные memory_optimized_data. Файловую группу можно создать при создании базы данных или же добавить ее позднее.  
  
    ```  
    ALTER DATABASE imoltp ADD FILEGROUP imoltp_mod CONTAINS MEMORY_OPTIMIZED_DATA  
    ```  
  
-   В файловую группу MEMORY_OPTIMIZED_DATA необходимо добавить один или несколько контейнеров. Например:  
  
    ```  
    ALTER DATABASE imoltp ADD FILE (name='imoltp_mod1', filename='c:\data\imoltp_mod1') TO FILEGROUP imoltp_mod  
    ```  
  
-   Для создания оптимизированной для памяти файловой группы не требуется включать файловый поток ([Включение и настройка FILESTREAM](../blob/enable-and-configure-filestream.md)). Сопоставление с файловым потоком выполняется модулем [!INCLUDE[hek_2](../../includes/hek-2-md.md)] .  
  
-   В оптимизированную для памяти файловую группу можно добавлять новые контейнеры. Необходимость развернуть новый контейнер может возникнуть, когда требуется расширить хранилище, которое нужно надежной, оптимизированной для памяти таблице, а также для распределения ввода-вывода по нескольким контейнерам.  
  
-   Перемещение данных в оптимизированной для памяти файловой группе оптимизировано в конфигурации группы доступности AlwaysOn. В отличие от файлов FILESTREAM, которые отправляются во вторичные реплики, файлы контрольных точек (файлы данных и разностные файлы) из оптимизированной для памяти файловой группы не отправляются во вторичные реплики. Файлы данных и разностные файлы формируются на вторичной реплике с помощью журнала транзакций.  
  
 Далее приведены ограничения оптимизированной для памяти файловой группы.  
  
-   После создания оптимизированной для памяти файловой группы удалить ее можно только после удаления базы данных. В рабочей среде возникновение необходимости в удалении оптимизированной для памяти файловой группы маловероятно.  
  
-   Невозможно удалить контейнер, который не является пустым, или перемещать пары, состоящие из файла данных и разностного файла, в другой контейнер в оптимизированной для памяти файловой группе.  
  
-   Для контейнера нельзя указывать параметр MAXSIZE.  
  
## <a name="configuring-a-memory-optimized-filegroup"></a>Настройка оптимизированной для памяти файловой группы  
 Следует рассмотреть возможность создания нескольких контейнеров в оптимизированной для памяти файловой группе и разместить их на разных дисках, чтобы получить большую пропускную способность по потоковой передаче данных в память.  
  
 При настройке хранилища необходимо обеспечить наличие свободного места на диске, которое будет в четыре раза больше размера надежных, оптимизированных для памяти таблиц. Также необходимо удостовериться в том, что подсистема ввода-вывода поддерживает необходимое значение IOPS для планируемой рабочей нагрузки. Если пары файлов данных и разностных файлов заполняются при данном IOPS, необходимо в три раза увеличить IOPS с учетом операций сортировки и объединения. Можно увеличить объем хранилища и IOPS путем добавления в оптимизированную для памяти файловую группу одного или нескольких контейнеров.  
  
 При использовании нескольких контейнеров, размещенных на нескольких дисках, файлы данных и разностные файлы распределяются по контейнерам путем циклического перебора. Первый файл данных выделяется из первого контейнера, разностный файл — из следующего контейнера, после чего дальнейшее выделение производится таким же образом. Эта схема выделения позволяет равномерно распределять файлы данных и разностные файлы по контейнерам при наличии нечетного числа дисков, каждый из которых сопоставлен с одним контейнером. Однако при наличии четного числа дисков, каждый из которых сопоставлен с одним контейнером, хранилище может получиться несбалансированным, когда файлы данных будут сопоставляться с нечетными дисками, а разностные файлы — с четными. Для получения сбалансированного потока ввода-вывода при восстановлении рекомендуется размещать пары файлов данных и разностных файлов на одном и том же шпинделе/хранилище, как показано в приведенном далее примере.  
  
 **Пример:** рассмотрим оптимизированной для памяти файловой группы с двумя контейнерами: контейнер 1 на диске X и контейнер 2 на диске Y. Поскольку распределения данных и разностных файлов выполняется в режиме циклического перебора, контейнер 1 будут находиться только файлы данных и контейнер 2 получат только разностные файлы, что приводит к несбалансированных сохраняемости для хранилища, а также операций ввода вывода в секунду, что и файлы данных будут значительно больше, чем разностные файлы. Равномерно распределять файлы данных и разностные файлы по дискам X и Y, создайте четыре, а не два контейнера и сопоставьте первые два контейнера диск X и следующие два контейнера с диском Y. С циклическое распределение данных и первой разностный файл будут распределяться из контейнера-1 и 2 соответственно, связанные с диском X. Аналогичным образом следующий файл данных и разностных попадет в контейнеры 3 и 4, которые сопоставлены с диском Y. Это позволяет равномерно распределение данных и разностных файлов по двум дискам.  
  
## <a name="see-also"></a>См. также  
 [Создание и управление хранилищем для оптимизированных для памяти объектов](creating-and-managing-storage-for-memory-optimized-objects.md)  
  
  