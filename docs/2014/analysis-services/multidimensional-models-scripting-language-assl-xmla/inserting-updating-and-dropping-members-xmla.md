---
title: Вставка, обновление и удаление элементов (XMLA) | Документы Microsoft
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- analysis-services
- docset-sql-devref
ms.tgt_pltfrm: ''
ms.topic: reference
helpviewer_keywords:
- inserting dimension members
- XML for Analysis, members
- removing dimension members
- dropping dimension members
- write-enabled dimensions [Analysis Services]
- XMLA, members
- deleting dimension members
- dimensions [Analysis Services], XML for Analysis
ms.assetid: bba922b5-8b88-4051-9506-ff055248182a
caps.latest.revision: 13
author: Minewiskan
ms.author: owend
manager: mblythe
ms.openlocfilehash: 4b283d0eec203422b97b9e7981783ac81999dc18
ms.sourcegitcommit: 5dd5cad0c1bbd308471d6c885f516948ad67dfcf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2018
ms.locfileid: "36101878"
---
# <a name="inserting-updating-and-dropping-members-xmla"></a>Вставка, обновление и удаление элементов (XMLA)
  Можно использовать [вставить](../xmla/xml-elements-commands/insert-element-xmla.md), [обновление](../xmla/xml-elements-commands/update-element-xmla.md), и [Drop](../xmla/xml-elements-commands/drop-element-xmla.md) команды XML для аналитики (XMLA) чтобы соответственно вставлять, обновления или удаления элементов из измерения, доступные для записи. Дополнительные сведения о записи измерений см. в разделе [измерениях](../multidimensional-models-olap-logical-dimension-objects/write-enabled-dimensions.md).  
  
## <a name="inserting-new-members"></a>Вставка новых элементов  
 Команда `Insert` вставляет новые элементы в указанные атрибуты в измерение, доступное для записи.  
  
 Перед созданием команды `Insert` для новых вставляемых элементов должна быть доступна следующая информация.  
  
-   Измерение, в которое будут вставлены новые элементы.  
  
-   Атрибут измерения, в которое будут вставлены новые элементы.  
  
-   Имена новых элементов, включая все применимые переводы этих имен.  
  
-   Ключи новых элементов. Если в атрибуте используется составной ключ, для ключа может потребоваться несколько значений.  
  
-   Значения для любых применимых свойств атрибутов, которые не реализованы в виде других атрибутов в измерении. К таким свойствам атрибутов относятся унарные операции, переводы, пользовательские свертки, свойства пользовательских сверток и пропускаемые уровни.  
  
 Команда `Insert` принимает только два свойства.  
  
-   [Объекта](../xmla/xml-elements-properties/object-element-xmla.md) свойство, которое содержит ссылку на объект для измерения, в которой должны быть вставлены элементы. Ссылка на объект для измерения содержит идентификатор базы данных, идентификатор куба и идентификатор измерения.  
  
-   [Атрибуты](../xmla/xml-elements-properties/attributes-element-xmla.md) свойство, которое содержит один или несколько [атрибута](../xmla/xml-elements-properties/attribute-element-xmla.md) элементы для определения атрибутов, в которых должны быть вставлены элементы. Каждый элемент `Attribute` определяет атрибут и указывает имя, значение, переводы, унарный оператор, пользовательскую свертку, свойства пользовательской свертки и пропущенные уровни для одного элемента, которые должны быть добавлены к указанному атрибуту.  
  
    > [!NOTE]  
    >  Необходимо включать все свойства для элемента `Attribute`. В противном случае может произойти ошибка.  
  
## <a name="updating-existing-members"></a>Обновление существующих элементов  
 Команда `Update` обновляет существующие элементы в указанных атрибутах на основе связей с другими элементами в других атрибутах в измерении, доступном для записи. Команда `Update` позволяет перемещать элементы на другие уровни в иерархиях, содержащихся в измерении, ее также можно использовать, чтобы реконструировать иерархии типа «родители-потомки», определенные родительскими атрибутами.  
  
 Перед созданием команды `Update` для обновляемых элементов должна быть доступна следующая информация.  
  
-   Измерение, в котором будут обновлены существующие элементы.  
  
-   Атрибуты измерения, в котором будут обновлены существующие элементы.  
  
-   Ключи существующих элементов. Если в атрибуте используется составной ключ, для ключа может потребоваться несколько значений.  
  
-   Значения для любых применимых свойств атрибутов, которые не реализованы в виде других атрибутов в измерении. К таким свойствам атрибутов относятся унарные операции, переводы, пользовательские свертки, свойства пользовательских сверток и пропускаемые уровни.  
  
 Команда `Update` принимает только три обязательных свойства.  
  
-   Свойство `Object`, содержащее ссылку на объект для измерения, в котором необходимо обновить элементы. Ссылка на объект для измерения содержит идентификатор базы данных, идентификатор куба и идентификатор измерения.  
  
-   Свойство `Attributes`, содержащее один или несколько элементов `Attribute` для определения атрибутов, в которых должны быть обновлены элементы. Элемент `Attribute` определяет атрибут и указывает имя, значение, переводы, унарный оператор, пользовательскую свертку, свойства пользовательской свертки и пропущенные уровни для одного элемента, которые должны быть обновлены для указанного атрибута.  
  
    > [!NOTE]  
    >  Необходимо включать все свойства для элемента `Attribute`. В противном случае может произойти ошибка.  
  
-   [Где](../xmla/xml-elements-properties/where-element-xmla.md) свойство, которое содержит один или несколько `Attribute` элементы, ограничивающих атрибуты, в которых должны быть обновлены элементы. Свойство `Where` является ключевым для ограничения действия команды `Update` указанными экземплярами элемента. Если `Where` свойство не задано, будут обновлены все экземпляры данного элемента. Например, есть три клиента, в отношении которых требуется изменить название города с Redmond на Bellevue. Чтобы изменить название города, необходимо задать свойство `Where`, определяющее три элемента атрибута Customer, для которых должны быть изменены элементы атрибута City. Если не задать это свойство `Where`, то после выполнения команды `Update` для каждого клиента, названием города которого в данный момент является Redmond, это название будет изменено на Bellevue.  
  
    > [!NOTE]  
    >  За исключением новых элементов, команда `Update` может обновлять только значения ключей атрибутов для атрибутов, не включенных в предложение `Where`. Например, название города невозможно обновить при обновлении клиента, поскольку в этом случае название города будет изменено для всех клиентов.  
  
### <a name="updating-members-in-parent-attributes"></a>Обновление элементов в родительских атрибутах  
 Для поддержки родительских атрибутов `Update` команда [MoveWithDescendants](../xmla/xml-elements-properties/movewithdescendants-element-xmla.md)имеет необязательные свойства. Если свойству `MoveWithDescendants` задано значение TRUE, это указывает, что потомки родительского элемента должны быть перемещены вместе с родительским элементом при изменении идентификатора данного родительского элемента. Если этому свойству задано значение FALSE, то при перемещении родительского элемента его непосредственные потомки повышаются до уровня, на котором до этого находился родительский элемент.  
  
 При обновлении элементов в родительском атрибуте команда `Update` не может обновлять элементы в других атрибутах.  
  
## <a name="dropping-existing-members"></a>Удаление существующих элементов  
 Перед созданием команды `Drop` для удаляемых элементов должна быть доступна следующая информация.  
  
-   Измерение, из которого будут удалены существующие элементы.  
  
-   Атрибуты измерения, из которого будут удалены существующие элементы.  
  
-   Ключи существующих элементов, которые будут удалены. Если в атрибуте используется составной ключ, для ключа может потребоваться несколько значений.  
  
 Команда `Drop` принимает только два обязательных свойства.  
  
-   Свойство `Object`, содержащее ссылку на объект для измерения, в котором необходимо удалить элементы. Ссылка на объект для измерения содержит идентификатор базы данных, идентификатор куба и идентификатор измерения.  
  
-   Свойство `Where`, содержащее один или несколько элементов `Attribute` для ограничения атрибутов, из которых должны быть удалены элементы. Свойство `Where` является ключевым для ограничения действия команды `Drop` указанными экземплярами элемента. Если значение свойства `Where` не задано, будут удалены все экземпляры данного элемента. Например, допустим, что в элементе Redmond есть три клиента, которых требуется удалить. Чтобы удалить этих клиентов, необходимо задать свойство `Where`, определяющее три элемента в атрибуте Customer, которые должны быть удалены, а также элемент Redmond атрибута City, из которого должны быть удалены три клиента. Если свойство `Where` указывает только элемент Redmond атрибута City, команда `Drop` удалит всех клиентов, связанных с элементом Redmond. Если свойство `Where` указывает только три элемента в атрибуте Customer, то команда `Drop` удаляет трех этих клиентов полностью.  
  
    > [!NOTE]  
    >  Элементы `Attribute`, включенные в команду `Drop`, должны содержать только свойства `AttributeName` и `Keys`. В противном случае может произойти ошибка.  
  
### <a name="dropping-members-in-parent-attributes"></a>Удаление элементов в родительских атрибутах  
 Установка [DeleteWithDescendants](../xmla/xml-elements-properties/deletewithdescendants-element-xmla.md) свойство указывает, что потомки родительского элемента также будут удалены с родительского элемента. Если этому свойству задано значение FALSE, непосредственные потомки данного родительского элемента не удаляются, а повышаются до уровня, на котором находился родительский элемент.  
  
> [!IMPORTANT]  
>  Чтобы удалить и родительский элемент, и его потомков, пользователю необходимо иметь только разрешения на удаление родительского элемента. Разрешения на удаление потомков иметь не обязательно.  
  
## <a name="see-also"></a>См. также  
 [Элемент DROP &#40;XML для Аналитики&#41;](../xmla/xml-elements-commands/drop-element-xmla.md)   
 [Элемент INSERT &#40;XML для Аналитики&#41;](../xmla/xml-elements-commands/insert-element-xmla.md)   
 [Элемент Update &#40;XML для Аналитики&#41;](../xmla/xml-elements-commands/update-element-xmla.md)   
 [Определение и идентификация объектов &#40;XML для Аналитики&#41;](../xmla/xml-elements-objects.md)   
 [Разработка с использованием XMLA в службах Analysis Services](developing-with-xmla-in-analysis-services.md)  
  
  