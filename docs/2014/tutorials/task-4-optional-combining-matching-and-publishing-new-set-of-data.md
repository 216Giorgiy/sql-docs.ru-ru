---
title: 'Задача 4 (необязательно): объединение, сопоставление и публикация нового набора данных | Документы Microsoft'
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.suite: ''
ms.technology:
- data-quality-services
- integration-services
- master-data-services
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 13a13f03-b307-4555-8e33-6d98c459d994
caps.latest.revision: 6
author: douglaslMS
ms.author: douglasl
manager: jhubbard
ms.openlocfilehash: 4ab096c1f43fbeab2165e1e32a83f2ba854b3b13
ms.sourcegitcommit: 5dd5cad0c1bbd308471d6c885f516948ad67dfcf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2018
ms.locfileid: "36100114"
---
# <a name="task-4-optional-combining-matching-and-publishing-new-set-of-data"></a>Задача 4 (дополнительно). Объединение, сопоставление и публикация нового набора данных
  Со временем в репозиторий MDS потребуется добавить дополнительные данные. Перед добавлением может быть полезно сравнить новые данные с данными, которые уже управляются в MDS, чтобы избежать повторения или добавления неточных данных. В надстройке служб Master Data Services для Excel можно объединять данные из двух листов, а также сравнивать данные для обнаружения и удаления повторений перед публикацией данных в MDS. Функция сопоставления надстройки MDS для Excel использует функциональность сопоставления служб DQS для выявления совпадений в данных. В этой задаче будет выполнено объединение данных из двух листов в один, а затем будет выполнено действие для выявления и удаления повторений перед публикацией в MDS. В разделе [сопоставление качества данных в надстройке MDS для Excel](http://msdn.microsoft.com/library/hh548681.aspx) и [объединение данных](http://msdn.microsoft.com/library/hh548680.aspx) разделы для получения дополнительных сведений.  
  
1.  Запустите новый экземпляр **Excel**. Нажмите кнопку **запустить**, пункты **запуска**, тип **Excel**и нажмите кнопку **ОК**.  
  
2.  Переключитесь в **основных данных** , нажав кнопку **основных данных** в строке меню.  
  
3.  Нажмите кнопку **Connect** на ленте в **подключение и загрузка** группы для подключения к **сервер MDS**. Это соединение было настроено ранее на этом занятии.  
  
     ![Excel — Показать кнопка обозревателя на основных данных](../../2014/tutorials/media/et-combinematchandpublishnewsod-01.jpg "Excel — Показать кнопка обозревателя на основных данных")  
  
4.  Вы увидите **обозреватель основных данных** справа. Если вы не видите обозреватель основных данных, нажмите кнопку **Показать обозреватель** кнопки на ленте.  
  
5.  В **обозреватель основных данных** выберите **поставщики** в раскрывающемся списке для **модели**. Вы увидите, что модель имеет одну сущность: **поставщика**.  
  
     ![Excel — окно обозревателя основных данных](../../2014/tutorials/media/et-combinematchandpublishnewsod-02.jpg "Excel — окно обозревателя основных данных")  
  
6.  Дважды щелкните **Supplier** в списке сущностей, чтобы загрузить элементы сущности в лист Excel.  
  
7.  Нажмите кнопку **Лист2** внизу, чтобы переключиться на **Лист2** вкладки. Если вы не видите **Лист2**, добавьте новый лист.  
  
8.  Откройте **Suppliers.xls** файла (исходный входной файл, включенный в файлы учебника) и скопируйте все строки (3) из **CombineAndCleanse** листа, чтобы **Лист2**.  
  
9. Вернитесь в **Supplier** листа **книге 1 — Microsoft Excel** (не **Cleansed and Matched Supplier List** Excel), подключенном к **MDS**.  
  
10. Нажмите кнопку **основных данных** в строке меню.  
  
11. Нажмите кнопку **объединение данных** на ленте. Вы увидите **объединение данных** диалоговое окно.  
  
12. В **объединение данных** диалогового окна поле, нажмите кнопку рядом с **диапазон для объединения с данными MDS** текстовое поле, как показано на следующем рисунке.  
  
     ![Excel — объединение данных-диалоговое окно](../../2014/tutorials/media/et-combinematchandpublishnewsod-03.jpg "Excel — объединение данных-диалоговое окно")  
  
13. Теперь должно отобразиться свернутое диалоговое окно. Теперь щелкните **Лист2** переключение **Лист2** вкладку, содержащую новые данные поставщика с 4 строки (включая одну строку заголовков).  
  
14. В **Лист2**выберите **все строки, включая строку заголовка** (даже если они уже быть выбран). Вы увидите **диапазон для объединения с данными MDS** автоматически обновляется.  
  
     ![Excel — объединение данных свернутым диалоговым окном-](../../2014/tutorials/media/et-combinematchandpublishnewsod-04.jpg "Excel — объединение данных диалоговое окно — свернуто")  
  
15. Вернитесь в **поставщики** не закрывая **объединение данных** диалоговое окно.  
  
16. Нажмите кнопку **кнопку** рядом с **текстовое поле**. Убедитесь, что диалоговое окно развернуто. Вы увидите все сопоставления между столбцами, имеющими **Supplier** MDS **сущности** для **Excel** столбцы заполняются автоматически.  
  
     ![Excel — объединение данных диалоговое окно с данными](../../2014/tutorials/media/et-combinematchandpublishnewsod-05.jpg "Excel — объединение данных диалоговое окно с данными")  
  
17. Убедитесь, что **кода** сущности столбец сопоставляется с **SupplierID** столбца на листе и **почтовый индекс** сущности столбец сопоставляется с **почтовый индекс** столбца на листе.  
  
18. На **объединение данных** диалоговое окно, нажмите кнопку **объединение**.  
  
19. Убедитесь, что 3 строки данных были помещены в конец листа. Они должны быть выделены цветом.  
  
     ![Excel — новые элементы после объединения](../../2014/tutorials/media/et-combinematchandpublishnewsod-06.jpg "Excel — новые элементы после объединения")  
  
20. Нажмите кнопку **сопоставить данные** на ленте для обнаружения дубликатов. Эта функция использует функции сопоставления служб DQS.  
  
21. В **сопоставить данные** выберите **поставщики** для **база знаний DQS**.  
  
     ![Excel — диалоговое окно соответствия данных](../../2014/tutorials/media/et-combinematchandpublishnewsod-07.jpg "Excel — диалоговое окно соответствия данных")  
  
22. Сопоставьте столбцы листа с доменами, как показано в следующей таблице.  
  
    |Столбец листа|Домен|  
    |----------------------|------------|  
    |Code (Supplier ID был загружен как Code для сущности Supplier в MDS)|Supplier ID|  
    |Name (Supplier Name было загружено как Name для сущности Supplier в MDS)|Имя поставщика|  
    |ContactEmailAddress|ContactEmail|  
  
23. Выберите **готовности к установке** для **кода** сопоставления столбцов.  
  
24. Введите **70%** как **вес** для **имя поставщика** и **30%** как **вес** для **Адрес электронной почты** как показано на рисунке.  
  
25. Нажмите кнопку **ОК**.  
  
26. Процесс сопоставления должен определить одно повторение для поставщика с **кода: S1**.  
  
     ![Excel — результаты сопоставления](../../2014/tutorials/media/et-combinematchandpublishnewsod-08.jpg "Excel — результаты сопоставления")  
  
27. Выберите **повторяющуюся строку (оранжевый)**, щелкните правой кнопкой мыши и нажмите кнопку **удаление** для удаления строки.  
  
28. Удалить **CLUSTER_ID** столбец, так как вы оно больше не требуется.  
  
29. Нажмите кнопку **публикации** опубликовать две новые записи с **кодами S66** и **S57** в MDS.  
  
30. В **публикация и заметки** диалогового окна добавьте **заметки**и нажмите кнопку **публикации**.  
  
31. Переключитесь в **веб-приложения диспетчера основных данных**.  
  
32. Убедитесь, что на домашней странице **поставщики** выбран для **модель**и нажмите кнопку **Explorer**. Если у вас уже есть **Explorer** откройте, обновите Интернет-браузер.  
  
33. **Сортировка** список по **кода** и найдите записи с **S57** и **S66** как коды. Можно также использовать **фильтра** на панели инструментов для поиска конкретной записи в списке.  
  
34. Теперь закройте **Книга1 — Microsoft Excel** окно без сохранения файла.  
  
## <a name="next-step"></a>Следующий шаг  
 [Задача 5. Создание атрибута на основе домена из Excel](../../2014/tutorials/task-5-creating-a-domain-based-attribute-from-excel.md)  
  
  