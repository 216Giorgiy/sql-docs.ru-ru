---
title: "Составление и тестирование плана обновления ядра СУБД | Документы Майкрософт"
ms.custom: 
ms.date: 07/20/2016
ms.prod: sql-non-specified
ms.prod_service: database-engine
ms.service: 
ms.component: install-windows
ms.reviewer: 
ms.suite: sql
ms.technology: server-general
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 19c5b725-7400-4881-af8f-fd232ca28234
caps.latest.revision: "16"
author: MikeRayMSFT
ms.author: mikeray
manager: craigg
ms.openlocfilehash: fd45301f5ce4497a672ffd4a684f972b08ac8013
ms.sourcegitcommit: dcac30038f2223990cc21775c84cbd4e7bacdc73
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/18/2018
---
# <a name="plan-and-test-the-database-engine-upgrade-plan"></a>Составление и тестирование плана обновления ядра СУБД
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)] Для выполнения успешного обновления [!INCLUDE[ssnoversion](../../includes/ssnoversion-md.md)], независимо от подхода, необходимо соответствующее планирование.  
  
## <a name="release-notes-and-known-upgrade-issues"></a>Заметки о выпуске и известные проблемы при обновлении  
 Прежде чем приступать к обновлению [!INCLUDE[ssDE](../../includes/ssde-md.md)], ознакомьтесь с разделами:

- [Заметки о выпуске SQL Server 2017](../../sql-server/sql-server-2017-release-notes.md) 
- [Заметки о выпуске SQL Server 2016](../../sql-server/sql-server-2016-release-notes.md) 
- [Обратная совместимость ядра СУБД SQL Server](../../database-engine/sql-server-database-engine-backward-compatibility.md).  
  
## <a name="pre-upgrade-planning-checklist"></a>Контрольный список планирования обновления  
 Перед обновлением [!INCLUDE[ssDE](../../includes/ssde-md.md)]просмотрите следующий контрольный список, а также связанные разделы. Сведения в этих разделах применимы ко всем обновлениям независимо от метода обновления. Они помогут вам определить оптимальный метод обновления: последовательное обновление, обновление путем новой установки или обновление на месте. Например, вы не можете выполнить обновление на месте или последовательное обновление при обновлении операционной системы, SQL Server 2005 или 32-разрядной версии SQL Server. Дерево принятия решений см. в разделе [Choose a Database Engine Upgrade Method](../../database-engine/install-windows/choose-a-database-engine-upgrade-method.md).  
  
-   **Требования к оборудованию и программному обеспечению** . Ознакомьтесь с требованиями к оборудованию и ПО для установки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Эти требования описываются в разделе [Требования к оборудованию и программному обеспечению для установки SQL Server](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md). В ходе планирования обновления необходимо рассмотреть обновление оборудования (новое оборудование работает быстрее и может позволить сократить число лицензий, например благодаря меньшему количеству процессоров или консолидации баз данных и серверов) и обновление операционной системы. Такие изменения оборудования и программного обеспечения влияют на выбор метода обновления.  
  
-   **Текущая среда** . Проведите оценку текущей среды, чтобы понять, какие компоненты [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] используются и какие клиенты подключаются к среде.  
  
    -   **Поставщики клиентов** . Хотя обновление платформы не требует непременного обновления поставщиков для каждого из клиентов, вы можете это сделать. При обновлении с [!INCLUDE[sql14](../../includes/sssql14-md.md)] или более ранних версий следующие компоненты [!INCLUDE[sql15](../../includes/sssql15-md.md)] могут требовать обновления поставщиков для клиентов или предоставлять дополнительные функциональные возможности при обновлении поставщиков:  
  
       -   [Постоянное шифрование (компонент Database Engine)](../../relational-databases/security/encryption/always-encrypted-database-engine.md)  
  
       -   [Stretch Database](../../sql-server/stretch-database/stretch-database.md)  
  
       -   [Прослушиватели групп доступности, возможность подключения клиентов и отработка отказа приложений (SQL Server)](../../database-engine/availability-groups/windows/listeners-client-connectivity-application-failover.md)  
  
       -   Обновление безопасности SSL  

   >[!NOTE]
   >Предыдущий список также применяется к [!INCLUDE[sscurrent](../../includes/sscurrent-md.md)].
  
-   **Сторонние компоненты** . Проверьте совместимость сторонних компонентов, таких как интегрированное резервное копирование.  
  
-   **Целевая среда** . Убедитесь, что целевая среда соответствует требованиям к оборудованию и программному обеспечению, а также может поддерживать требования исходной системы. Например, обновление может включать консолидацию нескольких экземпляров SQL Server в один новый экземпляр [!INCLUDE[ssnoversion](../../includes/ssnoversion-md.md)] или виртуализацию среды [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с преобразованием в частное или общедоступное облако.  
  
-   **Выпуск** . Определите соответствующий выпуск [!INCLUDE[ssCurrent](../../includes/ssnoversion-md.md)] и допустимые пути обновления. Дополнительные сведения см. в разделе [Supported Version and Edition Upgrades](../../database-engine/install-windows/supported-version-and-edition-upgrades.md). Если обновление производится с одного выпуска [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] до другого, то сначала проверьте, поддерживаются ли в целевом выпуске все используемые функции.  
  
    > [!NOTE]  
    >  При обновлении [!INCLUDE[ssCurrent](../../includes/ssnoversion-md.md)] с предыдущей версии выпуска [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Enterprise выберите "Enterprise Edition: лицензирование по числу ядер" и "Enterprise Edition". Эти выпуски Enterprise отличаются только режимом лицензирования. Дополнительные сведения см. в разделе [Compute Capacity Limits by Edition of SQL Server](../../sql-server/compute-capacity-limits-by-edition-of-sql-server.md).  
  
-   **Обратная совместимость** . Ознакомьтесь с разделом, посвященным обратной совместимости ядра СУБД [!INCLUDE[ssCurrent](../../includes/ssnoversion-md.md)] , в котором описываются изменения в поведении между [!INCLUDE[ssCurrent](../../includes/ssnoversion-md.md)] и версией [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которую вы обновляете. См. раздел [SQL Server Database Engine Backward Compatibility](../../database-engine/sql-server-database-engine-backward-compatibility.md).  
  
-   **Помощник по обновлению**  . Запустите помощник по обновлению [!INCLUDE[ssCurrent](../../includes/ssnoversion-md.md)] . Он поможет выявить проблемы, которые могут блокировать процесс обновления или требовать изменения существующих сценариев или приложений из-за критических изменений. [!INCLUDE[ssCurrent](../../includes/ssnoversion-md.md)] содержит новую версию помощника по обновлению, дающего возможность пользователям подготовиться к обновлению существующей системы.  Кроме того, это средство включает функцию проверки существующих баз данных на предмет поддержки новых функций (таких как таблицы Stretch) после завершения обновления.   
    Помощник по обновлению [!INCLUDE[ssCurrent](../../includes/ssnoversion-md.md)]можно скачать  [здесь](https://www.microsoft.com/en-us/download/details.aspx?id=48119).  
  
-   **Средство проверки конфигурации**  . Запустите средство проверки конфигурации [!INCLUDE[ssCurrent](../../includes/ssnoversion-md.md)] , чтобы выявить проблемы, которые могут блокировать работу программы установки SQL Server, до начала фактического обновления. Дополнительные сведения см. в разделе [Check Parameters for the System Configuration Checker](../../database-engine/install-windows/check-parameters-for-the-system-configuration-checker.md).  
  
-   **Обновление таблиц, оптимизированных для памяти** . При обновлении экземпляра базы данных SQL Server 2014, содержащей оптимизированные для памяти таблицы, до версии SQL Server 2016 процесс обновления может занять больше времени из-за необходимости преобразования таких таблиц в новый формат на диске (пока выполняется эта процедура, базы данных будут отключены).   Время, необходимое для этой процедуры, зависит от размера таблиц, оптимизированных для памяти, и быстродействия подсистемы ввода-вывода. Для обновления на месте и обновления путем новой установки требуется трехкратный размер операций с данными (шаг 1 не требуется для последовательного обновления, однако шаги 2 и 3 обязательны).  
  
    1.  Выполните восстановление базы данных с использованием старого формата на диске (включая загрузку всех данных в оптимизированных для памяти таблицах в память с диска).  
  
    2.  Выполните сериализацию данных на диск в новом формате на диске.  
  
    3.  Выполните восстановление базы данных с использованием нового формата (включая загрузку всех данных в оптимизированных для памяти таблицах в память с диска).  
  
     Кроме того, нехватка места на диске во время этой процедуры вызовет сбой восстановления. Убедитесь в наличии достаточного места на диске для хранения существующей базы данных, а также дополнительного пространства, равного текущему размеру контейнеров в файловой группе MEMORY_OPTIMIZED_DATA в базе данных, для выполнения обновления на месте или при присоединении базы данных SQL Server 2014 к экземпляру SQL Server 2016. Используйте следующий запрос, чтобы определить объем дискового пространства, необходимый для файловой группы MEMORY_OPTIMIZED_DATA, и, следовательно, объем свободного места на диске, необходимый для успешного обновления:  
  
    ```  
    select cast(sum(size) as float)*8/1024/1024 'size in GB'   
    from sys.database_files  
    where data_space_id in (select data_space_id from sys.filegroups where type=N'FX')  
    ```  
  
## <a name="develop-and-test-the-upgrade-plan"></a>Разработка и тестирование плана обновления  
 Рекомендуется подходить к обновлению как к любому другому ИТ-проекту. Следует сформировать рабочую группу по обновлению, включающую администратора базы данных, специалистов по сетям, извлечению, преобразованию и загрузке (ETL) и другим сферам, затрагиваемым в процессе обновления. Группа должна:  
  
-   **выбрать метод обновления** — см. раздел [Выбор метода обновления компонента Database Engine](../../database-engine/install-windows/choose-a-database-engine-upgrade-method.md);  
  
-   **разработать план отката**— выполнение этого плана позволит восстановить исходную среду, если потребуется откат;  
  
-   **определить условия приемки** — убедиться в успешном завершении обновления необходимо до переноса пользователей в обновленную среду;  
  
-   **провести тестирование плана** — для тестирования производительности на уровне фактической нагрузки используйте программу распределенного воспроизведения Microsoft SQL Server. Эта программа позволяет использовать несколько компьютеров для воспроизведения данных трассировки и моделирования ответственной рабочей нагрузки. С помощью воспроизведения на тестовом сервере до и после обновления SQL Server можно измерить разницу в производительности и обнаружить любые проблемы совместимости приложений с обновлением. Дополнительные сведения см. в разделах [Распределенное воспроизведение SQL Server](../../tools/distributed-replay/sql-server-distributed-replay.md) и [Параметры командной строки средства администрирования (программа распределенного воспроизведения)](../../tools/distributed-replay/administration-tool-command-line-options-distributed-replay-utility.md).  
  
## <a name="next-steps"></a>Следующие шаги  
 [Обновление [компонент ядра СУБД]](../../database-engine/install-windows/upgrade-database-engine.md)  
  
  
