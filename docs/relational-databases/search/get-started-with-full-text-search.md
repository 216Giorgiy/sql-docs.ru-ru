---
title: "Приступая к работе с компонентом Full-Text Search | Microsoft Docs"
ms.date: "08/22/2016"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dbe-search"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "полнотекстовые каталоги [SQL Server], создание"
  - "полнотекстовые индексы [SQL Server], создание"
  - "полнотекстовый поиск [SQL Server], сведения"
  - "полнотекстовый поиск [SQL Server], настройка"
ms.assetid: 1fa628ba-0ee4-4d8f-b086-c4e52962ca4a
caps.latest.revision: 76
author: "JennieHubbard"
ms.author: "jhubbard"
manager: "jhubbard"
caps.handback.revision: 72
---
# Приступая к работе с компонентом Full-Text Search
Полнотекстовый поиск поддерживает использование нескольких языков благодаря таким *лингвистическим компонентам*, как средства разбиения по словам и парадигматические модули, списки стоп-слов (известных также как пропускаемые слова) и файлы тезауруса. Для файлов тезауруса и в некоторых случаях для списков стоп-слов требуется настройка, выполняемая администратором базы данных. Данный файл тезауруса поддерживает все полнотекстовые индексы, которые используют соответствующий язык, а данный список стоп-слов может быть связан с любым необходимым числом полнотекстовых индексов.  
 
По умолчанию для баз данных SQL Server включен полнотекстовый поиск, однако сначала нужно [создать полнотекстовый каталог](https://msdn.microsoft.com/library/bb326035.aspx) и полнотекстовый индекс для таблиц или индексированных представлений, по которым требуется выполнить поиск.
 
 ## Пошаговые инструкции 
 
 Перейдите в раздел [Использование мастера полнотекстового индексирования](https://msdn.microsoft.com/library/ms180091.aspx), если хотите получить пошаговые инструкции.

В этом разделе приведены рекомендации, примеры и ссылки на другие разделы.
##  <a name="configure"></a> Планирование настройки

Чтобы настроить полнотекстовый поиск для столбцов таблицы в базе данных, обычно требуется выполнить два основных шага:  
  
- Создание полнотекстового каталога.  
  
- Создание полнотекстового индекса по таблицам или индексированному представлению, где требуется произвести поиск. 

     Полнотекстовый индекс — это специальный тип функционального индекса на основе маркеров, создаваемый и используемый средством полнотекстового поиска. Чтобы полнотекстовый поиск мог быть создан для таблиц или представлений, они должны иметь уникальный индекс, который включает один столбец и не допускает значений NULL. Этот уникальный индекс необходим средству полнотекстового для сопоставления каждой строки таблицы с уникальным ключом со сжатием. Полнотекстовый индекс может включать только столбцы следующих типов: **char**, **varchar**, **nchar**, **nvarchar**, **text**, **ntext**, **image**, **xml**, **varbinary** и **varbinary(max)**. Дополнительные сведения см. в разделе [Создание полнотекстовых индексов и управление ими](../../relational-databases/search/create-and-manage-full-text-indexes.md).   
  
     Полнотекстовый индекс должен принадлежать к полнотекстовому каталогу. Можно либо создать отдельный текстовый каталог для каждого полнотекстового индекса, либо связать с одним каталогом несколько полнотекстовых индексов. Полнотекстовый каталог является виртуальным объектом и не входит в файловую группу. Каталог — это логическое понятие, которое ссылается на группу полнотекстовых индексов.  
  

 Различия между полнотекстовыми индексами и обычными индексами SQL Server:  
  
|Полнотекстовые индексы|Обычные индексы SQL Server|  
|------------------------|--------------------------------|  
|Для одной таблицы разрешен только один полнотекстовой индекс.|Для одной таблицы разрешено несколько обычных индексов.|  
|Добавление данных к полнотекстовым индексам (*заполнение*) может быть запрошено явно, выполняться по расписанию либо автоматически при добавлении новых данных в базу.|Обновляются автоматически при создании, вставке, обновлении или удалении данных, на которых они созданы.|  
|Группируются в той же базе данных в один или несколько полнотекстовых каталогов.|Не группируются.|  
    
##  <a name="options"></a> Параметры  
  
### Язык столбца  
 Сведения о выборе языка столбца см. в разделе [Выбор языка при создании полнотекстового индекса](../../relational-databases/search/choose-a-language-when-creating-a-full-text-index.md).  
  
### Выбор файловой группы для полнотекстового индекса  
 Процесс построения полнотекстового индекса может сильно нагружать подсистему ввода-вывода (на высоком уровне он состоит из считывания данных из [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с последующим заполнением полнотекстового индекса отфильтрованными данными). Рекомендуется размещать полнотекстовый индекс в той файловой группе базы данных, которая обеспечит максимальную производительность операций ввода-вывода, либо разместить полнотекстовые индексы в другой файловой группе на другом томе.  
  
 Рекомендуется хранить табличные данные и все присоединенные полнотекстовые каталоги в одной файловой группе. Иногда в целях увеличения производительности можно расположить табличные данные и полнотекстовый индекс в разных файловых группах, хранящихся на разных томах. Это позволит обеспечить максимальный параллелизм ввода-вывода.  

  
### Назначение полнотекстового индекса   
 
 Таблицы с одинаковыми характеристиками обновления (например, небольшим числом изменений, в противоположность большому их количеству или частым изменением таблиц в определенное время дня) рекомендуется связывать с одним полнотекстовым каталогом. Если настроить расписание заполнения полнотекстового каталога, то полнотекстовые индексы будут синхронизироваться с таблицами, почти не влияя на использование ресурсов сервером баз данных в течение периодов высокой активности.  
  
 Необходимо учитывать следующие правила.  
  
-   Для полнотекстового уникального ключа всегда следует выбирать наименьший по размеру уникальный индекс. (Оптимален четырехбайтовый индекс на основе целочисленных значений.) Это значительно снизит потребление ресурсов, необходимых службе поиска [!INCLUDE[msCoName](../../includes/msconame-md.md)] для работы с файловой системой. Если первичный ключ велик (более 100 байт), попробуйте выбрать в таблице другой уникальный индекс (или создайте другой уникальный индекс) в качестве полнотекстового уникального ключа. В противном случае, если размер полнотекстового уникального ключа превышает максимально разрешенный размер (900 байт), выполнить полнотекстовое заполнение не удастся.  
  
-   Если индексируется таблица с миллионами строк, назначьте ее отдельному полнотекстовому каталогу.  
  
-   Учитывайте количество изменений в таблице, в которой выполняется полнотекстовое индексирование, а также общее количество строк в ней. Если общее число изменяемых строк вместе с количеством строк в таблице на момент последнего полнотекстового заполнения исчисляется миллионами, назначьте эту таблицу отдельному полнотекстовому каталогу.  

  
### Сопоставление списка стоп-слов   
  *Список стоп-слов* — это список, в котором перечислены стоп-слова, также известные как пропускаемые слова. Список стоп-слов связывается с каждым полнотекстовым индексом. Слова в данном списке применяются к полнотекстовым запросам в данном индексе. По умолчанию с новым полнотекстовым индексом связан системный список стоп-слов. Вы можете создать и использовать собственный список стоп-слов. Дополнительные сведения см. в разделе [Настройка стоп-слов и списков стоп-слов для полнотекстового поиска и управление ими](../../relational-databases/search/configure-and-manage-stopwords-and-stoplists-for-full-text-search.md).  
  
 Например, приведенная ниже инструкция [CREATE FULLTEXT STOPLIST](../../t-sql/statements/create-fulltext-stoplist-transact-sql.md) [!INCLUDE[tsql](../../includes/tsql-md.md)] создает список полнотекстовых стоп-слов с именем myStoplist3 путем копирования из системного списка стоп-слов:  
  
```  
CREATE FULLTEXT STOPLIST myStoplist FROM SYSTEM STOPLIST;  
GO  
```  
  
 Приведенная ниже инструкция [ALTER FULLTEXT STOPLIST](../../t-sql/statements/alter-fulltext-stoplist-transact-sql.md) [!INCLUDE[tsql](../../includes/tsql-md.md)] изменяет список стоп-слов myStoplist путем добавления слова en для испанского и затем французского языков:  
  
```  
ALTER FULLTEXT STOPLIST MyStoplist ADD 'en' LANGUAGE 'Spanish';  
ALTER FULLTEXT STOPLIST MyStoplist ADD 'en' LANGUAGE 'French';  
GO  
```  
    
## Обновление индекса  
 Аналогично обычным индексам [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] полнотекстовые индексы можно обновлять автоматически по мере изменения данных в связанных с ними таблицах. Это поведение по умолчанию. Обновлять полнотекстовые индексы можно и вручную либо по заданному расписанию. Заполнение полнотекстового индекса может потребовать значительного времени и ресурсов, вследствие чего обновление индекса обычно выполняется как асинхронный процесс в фоновом режиме, который обновляет полнотекстовый индекс после внесения изменений в базовую таблицу. 
 
 Для немедленного обновления полнотекстового индекса после каждого изменения в базовой таблице может потребоваться большой объем ресурсов. Следовательно, если обновление, вставка или удаление выполняются часто, то производительность запросов может снизиться. В таком случае попробуйте выполнять обновления отслеживания изменений вручную по определенному расписанию. Это позволит обрабатывать больше изменений в определенные моменты времени, а не конкурировать за ресурсы с запросами.  
  
 Наблюдайте за состоянием заполнения с помощью функции FULLTEXTCATALOGPROPERTY или OBJECTPROPERTYEX. Чтобы получить сведения о состоянии заполнения каталога, выполните следующую инструкцию:  
  
```  
SELECT FULLTEXTCATALOGPROPERTY('AdvWksDocFTCat', 'Populatestatus');  
```  
  
 Как правило, если выполняется полное заполнение, возвращается значение 1.  
 

##  <a name="example"></a> Пример. Настройка полнотекстового поиска  
 В следующем примере из двух частей в базе данных AdventureWorks создается полнотекстовый каталог с именем `AdvWksDocFTCat`, затем создается полнотекстовый индекс в таблице `Document` базы данных [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)]. Эта инструкция создает полнотекстовый каталог в папке по умолчанию, указанной во время установки, то есть папка `AdvWksDocFTCat` будет вложена в каталог по умолчанию.  
  
1.  Для создания полнотекстового каталога `AdvWksDocFTCat` в примере используется инструкция [CREATE FULLTEXT CATALOG](../../t-sql/statements/create-fulltext-catalog-transact-sql.md):  
  
    ```  
    USE AdventureWorks;  
    GO  
    CREATE FULLTEXT CATALOG AdvWksDocFTCat;  
    ```  
  
2.  Однако перед созданием полнотекстового индекса для таблицы Document следует убедиться, что в ней определен уникальный индекс с одним столбцом, не допускающий значений NULL. Следующая инструкция [CREATE INDEX](../../t-sql/statements/create-index-transact-sql.md) создает уникальный индекс `ui_ukDoc` для столбца DocumentID таблицы Document:  
  
    ```  
    CREATE UNIQUE INDEX ui_ukDoc ON Production.Document(DocumentID);  
    ```  
  
3.  После создания уникального ключа можно создать полнотекстовый индекс для таблицы `Document` с помощью следующей инструкции [CREATE FULLTEXT INDEX](../../t-sql/statements/create-fulltext-index-transact-sql.md).  
  
    ```  
    CREATE FULLTEXT INDEX ON Production.Document  
    (  
        Document                         --Full-text index column name   
            TYPE COLUMN FileExtension    --Name of column that contains file type information  
            Language 2057                 --2057 is the LCID for British English  
    )  
    KEY INDEX ui_ukDoc ON AdvWksDocFTCat --Unique index  
    WITH CHANGE_TRACKING AUTO            --Population type;  
    GO  
  
    ```  
  
     Столбец TYPE COLUMN, определенный в этом примере, задает столбец типов в таблице, которая в каждой строке столбца «Document» (имеющего двоичный тип) содержит тип документа. Столбец типа хранит заданное пользователем расширение файла документа — DOC, XLS и т. д. — в данной строке. Средство полнотекстового поиска будет использовать это расширение для вызова соответствующего фильтра, который применяется для синтаксического анализа данных в данной строке. После того как фильтр выполнит синтаксический анализ двоичных данных в строке, указанное средство разбиения по словам выполнит синтаксический анализ содержимого (в данном примере используется средство разбиения по словам для английского языка (Великобритания)). Следует отметить, что процесс фильтрации выполняется либо во время индексирования, либо при вставке или обновлении пользователем столбца в базовой таблице, если автоматическое отслеживание изменений было включено для полнотекстового индекса. Дополнительные сведения см. в разделе [Настройка фильтров для поиска и управление ими](../../relational-databases/search/configure-and-manage-filters-for-search.md).  
  
   
## Создание полнотекстового каталога  
  
-   [CREATE FULLTEXT CATALOG (Transact-SQL)](../../t-sql/statements/create-fulltext-catalog-transact-sql.md)  
  
-   [Создание и управление полнотекстовыми каталогами](../../relational-databases/search/create-and-manage-full-text-catalogs.md)  
  
## Просмотр индексов  
  
-   [sys.indexes (Transact-SQL)](../../relational-databases/system-catalog-views/sys-indexes-transact-sql.md)  
  
## Создание уникального индекса  
  
-   [CREATE INDEX (Transact-SQL)](../../t-sql/statements/create-index-transact-sql.md)  
  
-   [Открытие конструктора таблиц (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/open-table-designer-visual-database-tools.md)  
  
## Создание полнотекстового индекса  
  
-   [CREATE FULLTEXT INDEX (Transact-SQL)](../../t-sql/statements/create-fulltext-index-transact-sql.md)  
  
-   [Создание и управление полнотекстовыми индексами](../../relational-databases/search/create-and-manage-full-text-indexes.md)  
  
## Просмотр сведений о полнотекстовом индексе  
  
|Каталог или динамическое административное представление|Описание|  
|----------------------------------------|-----------------|  
|[sys.fulltext_index_catalog_usages (Transact-SQL)](../../relational-databases/system-catalog-views/sys-fulltext-index-catalog-usages-transact-sql.md)|Возвращает строку для каждого полнотекстового каталога, ссылающегося на полнотекстовый индекс.|  
|[sys.fulltext_index_columns (Transact-SQL)](../../relational-databases/system-catalog-views/sys-fulltext-index-columns-transact-sql.md)|Содержит по одной строке для каждого столбца, являющегося частью полнотекстового индекса.|  
|[sys.fulltext_index_fragments (Transact-SQL)](../../relational-databases/system-catalog-views/sys-fulltext-index-fragments-transact-sql.md)|Полнотекстовый индекс использует внутренние таблицы, называемые фрагментами полнотекстового индекса, для хранения данных инвертированного индекса. Это представление может использоваться для запросов к метаданным об этих фрагментах. Представление содержит строку для каждого фрагмента полнотекстового индекса в каждой таблице, содержащей полнотекстовый индекс.|  
|[sys.fulltext_indexes (Transact-SQL)](../../relational-databases/system-catalog-views/sys-fulltext-indexes-transact-sql.md)|Содержит по одной строке для каждого полнотекстового индекса табличного объекта.|  
|[sys.dm_fts_index_keywords (Transact-SQL)](../../relational-databases/system-dynamic-management-views/sys-dm-fts-index-keywords-transact-sql.md)|Возвращает сведения о содержимом полнотекстового индекса для указанной таблицы.|  
|[sys.dm_fts_index_keywords_by_document (Transact-SQL)](../../relational-databases/system-dynamic-management-views/sys-dm-fts-index-keywords-by-document-transact-sql.md)|Возвращает сведения о содержимом полнотекстового индекса на уровне документа для указанной таблицы. Данное ключевое слово может встречаться в нескольких документах.|  
|[sys.dm_fts_index_population (Transact-SQL)](../../relational-databases/system-dynamic-management-views/sys-dm-fts-index-population-transact-sql.md)|Возвращает сведения о выполняющихся в настоящий момент процессах заполнения полнотекстовых индексов.|  
  

  
## Дополнительные сведения 
 [CREATE FULLTEXT CATALOG (Transact-SQL)](../../t-sql/statements/create-fulltext-catalog-transact-sql.md)   
 [CREATE FULLTEXT INDEX (Transact-SQL)](../../t-sql/statements/create-fulltext-index-transact-sql.md)   
 [CREATE FULLTEXT STOPLIST (Transact-SQL)](../../t-sql/statements/create-fulltext-stoplist-transact-sql.md)   
 [CREATE TABLE (Transact-SQL)](../../t-sql/statements/create-table-transact-sql.md)   
 [Заполнение полнотекстовых индексов](../../relational-databases/search/populate-full-text-indexes.md)   
 [FULLTEXTCATALOGPROPERTY (Transact-SQL)](../../t-sql/functions/fulltextcatalogproperty-transact-sql.md)   
 [OBJECTPROPERTYEX (Transact-SQL)](../../t-sql/functions/objectpropertyex-transact-sql.md)  
  
  