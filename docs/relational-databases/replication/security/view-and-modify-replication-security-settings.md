---
title: "Просмотр и изменение параметров безопасности репликации | Microsoft Docs"
ms.custom: ""
ms.date: "03/16/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "replication"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "изменение настроек безопасности репликации"
  - "репликация [SQL Server], безопасность"
  - "безопасность [репликация SQL Server], просмотр параметров"
  - "просмотр настроек безопасности репликации"
  - "безопасность [репликация SQL Server], изменение параметров"
ms.assetid: 67d79532-1482-4de1-ac9f-4a23d162c85e
caps.latest.revision: 47
author: "BYHAM"
ms.author: "rickbyh"
manager: "jhubbard"
caps.handback.revision: 47
---
# Просмотр и изменение параметров безопасности репликации
  В данном разделе описывается процесс просмотра и изменения параметров безопасности репликации в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] при помощи среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)] или объектов RMO. Например, может потребоваться изменение подключения агента чтения журнала к издателю для использования проверки подлинности SQL Server вместо встроенной проверки подлинности Windows, или может потребоваться изменение учетных данных для запуска задания агента при изменении пароля учетной записи Windows. Сведения о разрешениях, необходимых для каждого агента см. в разделе [модель безопасности агента репликации](../../../relational-databases/replication/security/replication-agent-security-model.md).  
  
 **В этом разделе**  
  
-   **Перед началом работы выполните следующие действия.**  
  
     [Ограничения](#Restrictions)  
  
     [Безопасность](#Security)  
  
-   **Для просмотра и изменения параметров безопасности репликации используется:**  
  
     [Среда SQL Server Management Studio](#SSMSProcedure)  
  
     [Transact-SQL](#TsqlProcedure)  
  
     [объекты RMO;](#RMOProcedure)  
  
-   **Дальнейшие действия:**  [после изменения параметров безопасности репликации](#FollowUp)  
  
##  <a name="BeforeYouBegin"></a> Перед началом  
  
###  <a name="Restrictions"></a> Ограничения  
  
-   Какие именно хранимые процедуры для этого применяются, зависит от типа агента и соединения с сервером.  
  
-   Используемые классы и свойства RMO зависят от типа агента и типа соединения с сервером.  
  
###  <a name="Security"></a> Безопасность  
 В целях безопасности пароли, возвращаемые хранимыми процедурами репликации в результирующих наборах, будут замаскированы.  
  
####  <a name="Permissions"></a> Разрешения  
  
##  <a name="SSMSProcedure"></a> Использование среды SQL Server Management Studio  
 Просмотр и изменение настроек безопасности осуществляется в следующих диалоговых окнах:  
  
1.  В диалоговом окне **Обновление паролей репликации** , которое доступно из папки **Репликация** в среде [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]. При изменении пароля для учетной записи [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] или учетной записи Windows на сервере в топологии репликации, нужно использовать это диалоговое окно, а не обновлять пароль для каждого агента, использующего эту учетную запись. Если агенты на нескольких серверах используют одну и ту же учетную запись, то нужно подключиться к каждому из этих серверов и изменить пароль. Обновление пароля осуществляется везде, где его использует репликация. В других местах, например на связанных серверах, обновление пароля не происходит.  
  
2.   **Безопасность агента** Страница **Свойства публикации — \< публикация>** диалоговое окно. Дополнительные сведения о доступе к этому диалоговому окну см. в разделе [View and Modify Publication Properties](../../../relational-databases/replication/publish/view-and-modify-publication-properties.md).  
  
3.   **Свойства подписки — \< подписка>** диалоговое окно. Дополнительные сведения о доступе к этому диалоговому окну см. в разделах [View and Modify Push Subscription Properties](../../../relational-databases/replication/view-and-modify-push-subscription-properties.md) и [View and Modify Pull Subscription Properties](../../../relational-databases/replication/view-and-modify-pull-subscription-properties.md).  
  
4.   **Свойства распространителя — \< распространитель>** и **Свойства базы данных распространителя — \< база данных>** диалоговые окна. Дополнительные сведения о доступе к этим диалоговым окнам см. в разделе [View and Modify Distributor and Publisher Properties](../../../relational-databases/replication/view-and-modify-distributor-and-publisher-properties.md).  
  
5.   **Свойства издателя — \< издатель>** диалоговое окно. Дополнительные сведения о доступе к этому диалоговому окну см. в разделе [View and Modify Distributor and Publisher Properties](../../../relational-databases/replication/view-and-modify-distributor-and-publisher-properties.md).  
  
#### Изменение пароля для учетной записи, используемой одним или несколькими агентами  
  
1.  Если учетная запись является учетной записью SQL Server, то это диалоговое окно также изменит пароль для учетной записи SQL Server. Если учетная запись является учетной записью Windows, то нужно вначале изменить пароль в Windows. Дополнительные сведения см. в документации по Windows.  
  
    > [!NOTE]  
    >  После изменения пароля репликации необходимо остановить и перезапустить каждый агент, пользующийся этим паролем, прежде чем изменение вступит в силу для этого агента.  
  
2.  Подключитесь к серверу в среде [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], а затем раскройте узел сервера.  
  
3.  Щелкните правой кнопкой мыши **репликации** папку и выберите пункт **Обновление паролей репликации**.  
  
4.  В диалоговом окне **Обновление паролей репликации** укажите учетную запись и новый пароль.  
  
5.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### Изменение настроек безопасности для агента моментальных снимков  
  
1.  На **Безопасность агента** Страница **Свойства публикации — \< публикация>** диалоговом нажмите кнопку **Параметры безопасности** рядом с **агента моментальных снимков** текстовое поле.  
  
2.  В диалоговом окне **Безопасность агента моментальных снимков** укажите учетную запись, под которой должен запускаться агент:  
  
    -   Введите новую учетную запись Windows в текстовое поле **Учетная запись агента** .  
  
    -   Введите новый надежный пароль в текстовые поля **Пароль** и **Подтверждение пароля** .  
  
3.  Укажите контекст, в условиях которого агент должен подключаться с распространителя к издателю. Если вы выбрали **С использованием следующего имени входа SQL Server**, то вы также должны задать имя входа:  
  
    -   Введите имя входа в текстовое поле **Имя входа** .  
  
    -   Введите новый надежный пароль в текстовые поля **Пароль** и **Подтверждение пароля** .  
  
    > [!NOTE]  
    >  Если издатель является издателем Oracle, контекст соединения задается в **Свойства распространителя — \< распространитель>**диалоговое окно. Процедура изменения контекста приведена ниже.  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### Изменение настроек безопасности для агента чтения журнала  
  
1.  На **Безопасность агента** страницы **Свойства публикации — \< публикация>** диалоговом нажмите кнопку **Параметры безопасности** рядом с **агент чтения журнала** текстовое поле.  
  
2.  В диалоговом окне **Безопасность агента чтения журнала** задайте учетную запись, под которой должен запускаться агент:  
  
    -   Введите новую учетную запись Windows в текстовое поле **Учетная запись агента** .  
  
    -   Введите новый надежный пароль в текстовые поля **Пароль** и **Подтверждение пароля** .  
  
3.  Укажите контекст, в условиях которого агент должен подключаться с распространителя к издателю. Если вы выбрали **С использованием следующего имени входа SQL Server**, то вы также должны задать имя входа:  
  
    -   Введите имя входа в текстовое поле **Имя входа** .  
  
    -   Введите новый надежный пароль в текстовые поля **Пароль** и **Подтверждение пароля** .  
  
    > [!NOTE]  
    >  Если издатель является издателем Oracle, контекст соединения задается в **Свойства распространителя — \< распространитель>**диалоговое окно. Измените контекст с использованием следующей процедуры.  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  Для каждой публикуемой базы данных существует только один агент чтения журнала. Изменение настроек безопасности для этого агента в одной публикации влияет на настройки всех публикаций в базе данных публикации.  
  
#### Изменение контекста, под которым агент моментальных снимков и агент чтения журнала для публикации Oracle осуществляют соединения с издателем  
  
1.  На **издателей** Страница **Свойства распространителя — \< распространитель>** диалогового окна нажмите кнопку с многоточием (**...**) рядом с издателем.  
  
2.  В разделе **Соединение агента с издателем** задайте имя входа и пароль, используемые настроенной вами схемой административного пользователя репликации. Дополнительные сведения см. в разделе [настроить издатель Oracle](../../../relational-databases/replication/non-sql/configure-an-oracle-publisher.md).  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### Изменение настроек безопасности агента распространителя для принудительной подписки  
  
1.  В **Свойства подписки — \< подписка>** диалоговое окно на издателе можно внести следующие изменения:  
  
    -   Чтобы изменить учетную запись, под которой агент распространителя запускается и устанавливает соединения с распространителем, щелкните **учетной записи процесса агента** и нажмите кнопку свойств (**...**) кнопку в строке. Задайте учетную запись и пароль в диалоговом окне **Безопасность агента распространителя** .  
  
    -   Чтобы изменить контекст, под которой агент распространителя подключается к подписчику, щелкните **соединение с подписчиком** и нажмите кнопку свойств (**...**) кнопку в строке. Задайте контекст в диалоговом окне **Ввод сведений о соединении** .  
  
         При использовании подписок, обновляемых посредством очередей, заданный здесь контекст используется также агентом чтения очереди для подключений к подписчику.  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### Изменение настроек безопасности агента распространителя для подписки по запросу  
  
1.  В **Свойства подписки — \< подписка>** диалоговое окно на подписчике можно внести следующие изменения:  
  
    -   Чтобы изменить учетную запись, под которой агент распространителя запускается и устанавливает соединения с подписчиком, щелкните **учетной записи процесса агента** и нажмите кнопку свойств (**...**) кнопку в строке. Задайте учетную запись и пароль в диалоговом окне **Безопасность агента распространителя** .  
  
         При использовании подписок, обновляемых посредством очередей, заданный здесь контекст используется также агентом чтения очереди для подключений к подписчику.  
  
    -   Чтобы изменить контекст, под которым агент распространителя соединяется с распространителем, щелкните **соединение с распространителем** и нажмите кнопку свойств (**...**) кнопку в строке. Задайте контекст в диалоговом окне **Ввод сведений о соединении** .  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### Изменение настроек безопасности агента слияния для принудительной подписки  
  
1.  В **Свойства подписки — \< подписка>** диалоговое окно на издателе можно внести следующие изменения:  
  
    -   Чтобы изменить учетную запись, под которой агент слияния запускается и устанавливает соединения с издателем и распространителем, щелкните **учетной записи процесса агента** и нажмите кнопку свойств (**...**) кнопку в строке. Задайте учетную запись и пароль в диалоговом окне **Безопасность агента слияния** .  
  
    -   Чтобы изменить контекст, под которым агент слияния подключается к подписчику, щелкните **соединение с подписчиком** и нажмите кнопку свойств (**...**) кнопку в строке. Задайте контекст в диалоговом окне **Ввод сведений о соединении** .  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### Изменение настроек безопасности агента слияния для подписки по запросу  
  
1.  В **Свойства подписки — \< подписка>** диалоговое окно на подписчике можно внести следующие изменения:  
  
    -   Чтобы изменить учетную запись, под которой агент слияния запускается и устанавливает соединения с подписчиком, щелкните **учетной записи процесса агента** и нажмите кнопку свойств (**...**) кнопку в строке. Задайте учетную запись и пароль в диалоговом окне **Безопасность агента слияния** .  
  
    -   Чтобы изменить контекст, под которым агент слияния подключается к издателю и распространителю, щелкните **соединение с издателем** и нажмите кнопку свойств (**...**) кнопку в строке. Задайте контекст в диалоговом окне **Ввод сведений о соединении** .  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### Изменение учетной записи, под которой запускается агент чтения очереди  
  
1.  На **Общие** Страница **Свойства распространителя — \< распространитель>** диалогового окна нажмите кнопку свойств (**...**) рядом с базы данных распространителя.  
  
2.  В **Свойства базы данных распространителя — \< база данных>** диалоговом нажмите кнопку **Параметры безопасности** рядом с **учетной записи процесса агента** текстовое поле.  
  
3.  В диалоговом окне **Безопасность агента чтения очереди** задайте учетную запись, под которой агент запускается и устанавливает соединение с распространителем:  
  
    -   Введите новую учетную запись Windows в текстовое поле **Учетная запись процесса**  
  
    -   Введите новый надежный пароль в текстовые поля **Пароль** и **Подтверждение пароля** .  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  Для каждой базы распространителя существует только один агент чтения очереди. Изменение настроек безопасности агента оказывает влияние на параметры всех публикаций на всех издателях, использующих эту базу данных распространителя.  
  
#### Изменение контекста, под которым агент чтения очереди устанавливает соединения с издателем  
  
1.  На **издателей** Страница **Свойства распространителя — \< распространитель>** диалогового окна нажмите кнопку с многоточием (**...**) рядом с издателем.  
  
2.  В разделе **Соединение агента с издателем** задайте значение **Выполнять олицетворение учетной записи процесса агента** или **Проверка подлинности SQL Server** для параметра **Режим соединения агента** . Если вы задали **Проверка подлинности SQL Server**, то также введите значения для **Имя входа** и **Пароль**.  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  Для каждой базы распространителя существует только один агент чтения очереди. Изменение настроек безопасности агента оказывает влияние на параметры всех публикаций на всех издателях, использующих эту базу данных распространителя.  
  
#### Изменение контекста, под которым агент чтения очереди устанавливает соединения с подписчиком  
  
-   Агент чтения очереди использует тот же контекст соединения, который используется агентом распространителя для подписки. Дополнительные сведения см. выше в описании процедуры для агента распространителя.  
  
#### Изменение настроек безопасности для подписки по запросу, обновляемой немедленно  
  
1.  В **Свойства подписки — \< подписка>** диалоговое окно на подписчике, нажмите кнопку **соединение с издателем** строки и нажмите кнопку свойств (**...**) кнопку в строке.  
  
2.  В диалоговом окне **Ввод сведений о соединении** выберите один из следующих параметров:  
  
    -   **Использовать имя входа со связанного или удаленного сервера**. Выберите этот параметр, если вы определили удаленный сервер или связанный сервер между подписчиком и издателем с помощью [sp_addserver & #40; Transact-SQL & #41;](../../../relational-databases/system-stored-procedures/sp-addserver-transact-sql.md), [sp_addlinkedserver & #40; Transact-SQL & #41;](../../../relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql.md), [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], или другого метода.  
  
    -   **Использовать проверку подлинности SQL Server со следующим именем входа и паролем**. Выберите этот параметр, если вы не определили удаленный сервер или связанный сервер между подписчиком и издателем. Репликация создаст связанный сервер. Указанная учетная запись уже должна существовать на издателе.  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
> [!NOTE]  
>  Данная процедура изменяет метод, используемый триггерами репликации для соединения между подписчиком и издателем при внесении изменений на подписчике. Также можно изменить настройки, связанные с агентом распространителя, для подписки, обновляемой немедленно. Дополнительные сведения см. в описании процедуры, приведенном выше в данном разделе.  
>   
>  Данная процедура применяется только к подпискам по запросу. Для принудительных подписок, используйте хранимую процедуру [sp_link_publication & #40; Transact-SQL & #41;](../../../relational-databases/system-stored-procedures/sp-link-publication-transact-sql.md).  
  
#### Изменение пароля для административного соединения между издателем и распространителем  
  
1.  На **издателей** Страница **Свойства распространителя — \< распространитель>** диалогового окна введите надежный пароль в **пароль** и **Подтверждение пароля** текстовые поля.  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
3.  На **Общие** Страница **Свойства издателя — \< издатель>** диалогового окна введите надежный пароль в **пароль** и **Подтверждение пароля** текстовые поля.  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
##  <a name="TsqlProcedure"></a> Использование Transact-SQL  
  
> [!IMPORTANT]  
>  При выполнении всех следующих процедур, если это возможно, предлагайте пользователю вводить учетные данные безопасности во время выполнения. При хранении учетных данных в файле скрипта необходимо защитить этот файл во избежание несанкционированного доступа.  
  
#### Изменение всех экземпляров сохраненного пароля на сервере репликации  
  
1.  На сервере в топологии репликации в базе данных master, выполните хранимую процедуру [sp_changereplicationserverpasswords](../../../relational-databases/system-stored-procedures/sp-changereplicationserverpasswords-transact-sql.md). Укажите учетную запись [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows или имя входа [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] в параметре **@login** и новый пароль в параметре **@password**. В результате выполнения этой операции производится изменение всех экземпляров пароля, используемого всеми агентами сервера для соединения с другими серверами топологии.  
  
    > [!NOTE]  
    >  Чтобы изменить имя входа и пароль для подключения к определенному серверу в топологии (например, распространителя или подписчика), укажите имя этого сервера для **@server**.  
  
2.  Повторите шаг 1 на каждом из серверов в топологии репликации, где необходимо изменить пароль.  
  
    > [!NOTE]  
    >  После изменения пароля репликации необходимо остановить и перезапустить каждый агент, пользующийся этим паролем, прежде чем изменение вступит в силу для этого агента.  
  
#### Изменение настроек безопасности для агента моментальных снимков  
  
1.  На издателе, хранимую [sp_helppublication_snapshot](../../../relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql.md), указав **@publication**. Она возвращает текущие параметры безопасности агента моментальных снимков.  
  
2.  На издателе, хранимую [sp_changepublication_snapshot](../../../relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql.md), указав **@publication** и один или несколько следующих параметров безопасности для изменения:  
  
    -   Для изменения учетной записи Windows, под которой выполняется агент, или только пароль для этой учетной записи укажите **@job_login** и **@job_password**.  
  
    -   Чтобы изменить режим безопасности, используемый при соединении с издателем, укажите значение **1** или **0** для **@publisher_security_mode**.  
  
    -   При изменении режим безопасности, используемый при соединении с издателем из **1** для **0** или при изменении [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] имя входа, используемое для этого подключения, укажите **@publisher_login** и **@publisher_password**.  
  
    > [!IMPORTANT]  
    >  При настройке издателя с удаленным распространителем значения, указываемые для всех параметров, включая *job_login* и *job_password*, отправляются распространителю в виде обычного текста. Прежде чем выполнять эту хранимую процедуру, необходимо зашифровать соединение между издателем и его удаленным распространителем. Дополнительные сведения см. в разделе [Включение шифрования соединений в ядре базы данных & #40; SQL Server Configuration Manager & #41;](../../../database-engine/configure-windows/enable encrypted connections to the database engine.md).  
  
#### Изменение настроек безопасности для агента чтения журнала  
  
1.  На издателе, хранимую [sp_helplogreader_agent](../../../relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql.md), указав **@publisher**. Она возвращает текущие параметры безопасности агента чтения журнала.  
  
2.  На издателе, хранимую [sp_changelogreader_agent](../../../relational-databases/system-stored-procedures/sp-changelogreader-agent-transact-sql.md), указав **@publication** и один или несколько следующих параметров безопасности для изменения:  
  
    -   Для изменения учетной записи Windows, под которой выполняется агент, или только пароль для этой учетной записи укажите **@job_login** и **@job_password**.  
  
    -   Чтобы изменить режим безопасности, используемый при соединении с издателем, укажите значение **1** или **0** для **@publisher_security_mode**.  
  
    -   При изменении режим безопасности, используемый при соединении с издателем из **1** для **0** или при изменении [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] имя входа, используемое для этого подключения, укажите **@publisher_login** и **@publisher_password**.  
  
    > [!NOTE]  
    >  После изменения имени входа и пароля агента необходимо остановить и повторно запустить агент, чтобы изменения вступили в силу.  
  
    > [!IMPORTANT]  
    >  При настройке издателя с удаленным распространителем значения, указываемые для всех параметров, включая *job_login* и *job_password*, отправляются распространителю в виде обычного текста. Прежде чем выполнять эту хранимую процедуру, необходимо зашифровать соединение между издателем и его удаленным распространителем. Дополнительные сведения см. в разделе [Включение шифрования соединений в ядре базы данных & #40; SQL Server Configuration Manager & #41;](../../../database-engine/configure-windows/enable encrypted connections to the database engine.md).  
  
#### Изменение настроек безопасности агента распространителя для принудительной подписки  
  
1.  На издателе в базе данных публикации выполните хранимую процедуру [sp_helpsubscription](../../../relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql.md), указав **@publication** и **@subscriber**. Она возвращает свойства подписки, включая параметры безопасности агента распространителя на распространителе.  
  
2.  На издателе в базе данных публикации выполните хранимую процедуру [sp_changesubscription](../../../relational-databases/system-stored-procedures/sp-changesubscription-transact-sql.md), указав **@publication**, **@subscriber**, **@subscriber_db**, значение **все** для **@article**, имя свойства безопасности для **@property**, и новое значение свойства для **@value**.  
  
3.  Повторите шаг 2 для каждого из следующих свойств безопасности, которые подвергаются изменениям.  
  
    -   Для изменения учетной записи Windows, под которой запускается агент или только пароль для этой учетной записи, укажите значение **distrib_job_password** для **@property** и новый пароль для **@value**. Изменить саму учетную запись, повторите шаг 2, указав значение **distrib_job_login** для **@property** и новую учетную запись Windows для **@value**.  
  
    -   Чтобы изменить режим безопасности, используемый при соединении с подписчиком, укажите значение **subscriber_security_mode** для **@property** и значение **1** (встроенная проверка подлинности Windows) или **0** (проверка подлинности SQL Server) для **@value**.  
  
    -   При изменении режима безопасности подписчика для проверки подлинности SQL Server, или если меняются данные входа для проверки подлинности SQL Server, укажите значение **subscriber_password** для **@property** и новый пароль для **@value**. Повторите шаг 2, указав значение **subscriber_login** для **@property** и новое имя входа для **@value**.  
  
    > [!NOTE]  
    >  После изменения имени входа и пароля агента необходимо остановить и повторно запустить агент, чтобы изменения вступили в силу.  
  
    > [!IMPORTANT]  
    >  При настройке издателя с удаленным распространителем значения, заданные для всех свойств, включая **distrib_job_login** и **distrib_job_password**, отправляются распространителю в виде обычного текста. Прежде чем выполнять эту хранимую процедуру, необходимо зашифровать соединение между издателем и его удаленным распространителем. Дополнительные сведения см. в разделе [Включение шифрования соединений в ядре базы данных & #40; SQL Server Configuration Manager & #41;](../../../database-engine/configure-windows/enable encrypted connections to the database engine.md).  
  
#### Изменение настроек безопасности агента распространителя для подписки по запросу  
  
1.  На подписчике, выполните [sp_helppullsubscription](../../../relational-databases/system-stored-procedures/sp-helppullsubscription-transact-sql.md), указав **@publication**. Она возвращает список свойств подписки, включая параметры безопасности агента распространителя на подписчике.  
  
2.  На подписчике в базе данных подписки выполните хранимую процедуру [sp_change_subscription_properties](../../../relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql.md), указав **@publisher**, **@publisher_db**, **@publication**, имя свойства безопасности для **@property**, и новое значение свойства для **@value**.  
  
3.  Повторите шаг 2 для каждого из следующих свойств безопасности, которые подвергаются изменениям.  
  
    -   Для изменения учетной записи Windows, под которой запускается агент или только пароль для этой учетной записи, укажите значение **distrib_job_password** для **@property** и новый пароль для **@value**. Изменить саму учетную запись, повторите шаг 2, указав значение **distrib_job_login** для **@property** и новую учетную запись Windows для **@value**.  
  
    -   Чтобы изменить режим безопасности, используемый при соединении с распространителем, укажите значение **distributor_security_mode** для **@property** и значение **1** (встроенная проверка подлинности Windows) или **0** (проверка подлинности SQL Server) для **@value**.  
  
    -   При изменении режима безопасности распространителя для проверки подлинности SQL Server, или если меняются данные входа для проверки подлинности SQL Server, укажите значение **distributor_password** для **@property** и новый пароль для **@value**. Повторите шаг 2, указав значение **имя_входа_распространителя** для **@property** и новое имя входа для **@value**.  
  
    > [!NOTE]  
    >  После изменения имени входа и пароля агента необходимо остановить и повторно запустить агент, чтобы изменения вступили в силу.  
  
#### Изменение настроек безопасности агента слияния для принудительной подписки  
  
1.  На издателе в базе данных публикации выполните хранимую процедуру [sp_helpmergesubscription](../../../relational-databases/system-stored-procedures/sp-helpmergesubscription-transact-sql.md), указав **@publication**, **@subscriber**, и **@subscriber_db**. Она возвращает свойства подписки, включая параметры безопасности агента слияния на распространителе.  
  
2.  На издателе в базе данных публикации выполните хранимую процедуру [sp_changemergesubscription](../../../relational-databases/system-stored-procedures/sp-changemergesubscription-transact-sql.md), указав **@publication**, **@subscriber**, **@subscriber_db**, имя свойства безопасности для **@property**, и новое значение свойства для **@value**.  
  
3.  Повторите шаг 2 для каждого из следующих свойств безопасности, которые подвергаются изменениям.  
  
    -   Чтобы изменить учетную запись Windows, под которой запускается агент, или просто пароль для этой учетной записи, укажите значение **merge_job_password** для **@property** и новый пароль для **@value**. Изменить саму учетную запись, повторите шаг 2, указав значение **merge_job_login** для **@property** и новую учетную запись Windows для **@value**.  
  
    -   Чтобы изменить режим безопасности, используемый при соединении с подписчиком, укажите значение **subscriber_security_mode** для **@property** и значение **1** (встроенная проверка подлинности Windows) или **0** (проверка подлинности SQL Server) для **@value**.  
  
    -   При изменении режима безопасности подписчика для проверки подлинности SQL Server, или если меняются данные входа для проверки подлинности SQL Server, укажите значение **subscriber_password** для **@property** и новый пароль для **@value**. Повторите шаг 2, указав значение **subscriber_login** для **@property** и новое имя входа для **@value**.  
  
    -   Чтобы изменить режим безопасности, используемый при соединении с издателем, укажите значение **publisher_security_mode** для **@property** и значение **1** (встроенная проверка подлинности Windows) или **0** (проверка подлинности SQL Server) для **@value**.  
  
    -   При изменении режима безопасности издателя на проверку подлинности SQL Server, или если меняются данные входа для проверки подлинности SQL Server, укажите значение **publisher_password** для **@property** и новый пароль для **@value**. Повторите шаг 2, указав значение **publisher_login** для **@property** и новое имя входа для **@value**.  
  
    > [!NOTE]  
    >  После изменения имени входа и пароля агента необходимо остановить и повторно запустить агент, чтобы изменения вступили в силу.  
  
    > [!IMPORTANT]  
    >  При настройке издателя с удаленным распространителем значения, заданные для всех свойств, включая **merge_job_login** и **merge_job_password**, отправляются распространителю в виде обычного текста. Прежде чем выполнять эту хранимую процедуру, необходимо зашифровать соединение между издателем и его удаленным распространителем. Дополнительные сведения см. в разделе [Включение шифрования соединений в ядре базы данных & #40; SQL Server Configuration Manager & #41;](../../../database-engine/configure-windows/enable encrypted connections to the database engine.md).  
  
#### Изменение настроек безопасности агента слияния для подписки по запросу  
  
1.  На подписчике, выполните [sp_helpmergepullsubscription](../../../relational-databases/system-stored-procedures/sp-helpmergepullsubscription-transact-sql.md), указав **@publication**. Она возвращает свойства подписки, включая параметры безопасности агента слияния на подписчике.  
  
2.  На подписчике в базе данных подписки выполните хранимую процедуру [sp_change_subscription_properties](../../../relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql.md), указав **@publisher**, **@publisher_db**, **@publication**, имя свойства безопасности для **@property**, и новое значение свойства для **@value**.  
  
3.  Повторите шаг 2 для каждого из следующих свойств безопасности, которые подвергаются изменениям.  
  
    -   Для изменения учетной записи Windows, под которой запускается агент или только пароль для этой учетной записи, укажите значение **merge_job_password** для **@property** и новый пароль для **@value**. Изменить саму учетную запись, повторите шаг 2, указав значение **merge_job_login** для **@property** и новую учетную запись Windows для **@value**.  
  
    -   Чтобы изменить режим безопасности, используемый при соединении с распространителем, укажите значение **distributor_security_mode** для **@property** и значение **1** (встроенная проверка подлинности Windows) или **0** (проверка подлинности SQL Server) для **@value**.  
  
    -   При изменении режима безопасности распространителя для проверки подлинности SQL Server, или если меняются данные входа для проверки подлинности SQL Server, укажите значение **distributor_password** для **@property** и новый пароль для **@value**. Повторите шаг 2, указав значение **имя_входа_распространителя** для **@property** и новое имя входа для **@value**.  
  
    -   Чтобы изменить режим безопасности, используемый при соединении с издателем, укажите значение **publisher_security_mode** для **@property** и значение **1** (встроенная проверка подлинности Windows) или **0** (проверка подлинности SQL Server) для **@value**.  
  
    -   При изменении режима безопасности издателя на проверку подлинности SQL Server, или если меняются данные входа для проверки подлинности SQL Server, укажите значение **publisher_password** для **@property** и новый пароль для **@value**. Повторите шаг 2, указав значение **publisher_login** для **@property** и новое имя входа для **@value**.  
  
    > [!NOTE]  
    >  После изменения имени входа и пароля агента необходимо остановить и повторно запустить агент, чтобы изменения вступили в силу.  
  
#### Изменение параметров безопасности агента моментальных снимков для создания моментального снимка с фильтрацией для подписчика  
  
1.  На издателе, хранимую [sp_helpdynamicsnapshot_job](../../../relational-databases/system-stored-procedures/sp-helpdynamicsnapshot-job-transact-sql.md), указав **@publication**. В результирующий набор, обратите внимание на значение **job_name** для секции подписчика для изменения.  
  
2.  На издателе, хранимую [sp_changedynamicsnapshot_job](../../../relational-databases/system-stored-procedures/sp-changedynamicsnapshot-job-transact-sql.md), указав **@publication**, значение, полученное из шага 1 для **@dynamic_snapshot_jobname**, и новый пароль для **@job_password** или имя входа и пароль для учетной записи Windows, под которой работает агент **@job_login** и **@job_password**.  
  
    > [!IMPORTANT]  
    >  При настройке издателя с удаленным распространителем значения, указываемые для всех параметров, включая *job_login* и *job_password*, отправляются распространителю в виде обычного текста. Прежде чем выполнять эту хранимую процедуру, необходимо зашифровать соединение между издателем и его удаленным распространителем. Дополнительные сведения см. в разделе [Включение шифрования соединений в ядре базы данных & #40; SQL Server Configuration Manager & #41;](../../../database-engine/configure-windows/enable encrypted connections to the database engine.md).  
  
#### Изменение параметров безопасности для агента чтения очереди  
  
1.  На распространителе выполните хранимую процедуру [sp_helpqreader_agent](../../../relational-databases/system-stored-procedures/sp-helpqreader-agent-transact-sql.md). Она возвращает текущую учетную запись Windows, от которой запускается агент чтения очереди.  
  
    -   На распространителе выполните хранимую процедуру [sp_changeqreader_agent](../../../relational-databases/system-stored-procedures/sp-changeqreader-agent-transact-sql.md), указав параметры учетной записи Windows для **@job_login** и **@job_passwsord**.  
  
    > [!NOTE]  
    >  После изменения имени входа и пароля агента необходимо остановить и повторно запустить агент, чтобы изменения вступили в силу. Для каждой базы распространителя существует только один агент чтения очереди. Изменение настроек безопасности агента оказывает влияние на параметры всех публикаций на всех издателях, использующих эту базу данных распространителя.  
  
2.  Агент чтения очереди подключается к подписчику с тем же контекстом соединения, который используется агентом распространителя для подписки.  
  
#### Смена текущего режима безопасности, используемого при немедленном обновлении подписчика при соединении с издателем  
  
1.  На подписчике в базе данных подписки выполните хранимую процедуру [sp_link_publication](../../../relational-databases/system-stored-procedures/sp-link-publication-transact-sql.md). Укажите **@publisher**, **@publication**, имя базы данных публикации для **@publisher_db**, и одно из следующих значений для **@security_mode**:  
  
    -   **0** — использовать проверку подлинности SQL Server при выполнении обновлений на издателе. При этом необходимо указать допустимое имя входа на издатель в параметрах **@login** и **@password**.  
  
    -   **1** — при соединении с издателем использовать контекст безопасности пользователя, вносящего изменения на подписчике. В разделе [sp_link_publication](../../../relational-databases/system-stored-procedures/sp-link-publication-transact-sql.md) для ограничений, связанных с этим режимом безопасности.  
  
    -   **2** использования существующих, определяемых пользователем имя входа связанного сервера создан с помощью [sp_addlinkedserver & #40; Transact-SQL & #41;](../../../relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql.md).  
  
#### Смена пароля для удаленного распространителя  
  
1.  На распространителе в базе данных распространителя, выполните [sp_changedistributor_password](../../../relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql.md), указав новый пароль для этого имени входа для **@password**.  
  
    > [!IMPORTANT]  
    >  Не меняйте пароль для **distributor_admin** напрямую.  
  
2.  На каждом издателе, использующего этот удаленный распространитель, выполнение [sp_changedistributor_password](../../../relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql.md), указав пароль из шага 1 для **@password**.  
  
##  <a name="RMOProcedure"></a> При помощи объектов RMO  
  
> [!IMPORTANT]  
>  По возможности предлагайте пользователям вводить учетные данные системы безопасности во время выполнения приложения. Если необходимо хранить учетные данные, используйте [службы шифрования](http://go.microsoft.com/fwlink/?LinkId=34733) , предоставляемые платформой [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.  
  
#### Изменение всех экземпляров пароля, хранящихся на сервере репликации  
  
1.  Создайте соединение с сервером репликации с помощью <xref:Microsoft.SqlServer.Management.Common.ServerConnection> класса.  
  
2.  Создайте экземпляр <xref:Microsoft.SqlServer.Replication.ReplicationServer> используя соединение из шага 1.  
  
3.  Вызов <xref:Microsoft.SqlServer.Replication.ReplicationServer.ChangeReplicationServerPasswords%2A> метод. Укажите значения следующих параметров.  
  
    -   *security_mode* - <xref:Microsoft.SqlServer.Replication.ReplicationSecurityMode> значение, указывающее тип проверки подлинности, для которой изменяются все экземпляры пароля.  
  
    -   *Имя входа* -имя входа, для которой изменяются все экземпляры пароля.  
  
    -   *пароль* -новое значение пароля.  
  
        > [!IMPORTANT]  
        >  По возможности предлагайте пользователям вводить учетные данные системы безопасности во время выполнения приложения. Если необходимо хранить учетные данные, используйте [службы шифрования](http://go.microsoft.com/fwlink/?LinkId=34733) , предоставляемые платформой Windows .NET Framework.  
  
        > [!NOTE]  
        >  Только члены **sysadmin** фиксированной серверной роли может вызывать этот метод.  
  
4.  Повторите шаги 1 — 3 для каждого сервера в топологии репликации, на котором необходимо обновить пароли.  
  
#### Изменение параметров безопасности агента распространителя для принудительной подписки на публикацию транзакций  
  
1.  Создайте соединение с издателем с помощью <xref:Microsoft.SqlServer.Management.Common.ServerConnection> класса.  
  
2.  Создайте экземпляр <xref:Microsoft.SqlServer.Replication.TransSubscription> класса.  
  
3.  Задайте <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, и <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> Свойства подписки, а соединение из шага 1 для <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> свойство.  
  
4.  Вызов <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> метод, чтобы получить свойства объекта. Если этот метод возвращает значение **false**, то либо на шаге 3 были неверно определены свойства подписки, либо подписка не существует.  
  
5.  Задайте одно или несколько из следующих свойств безопасности на экземпляре <xref:Microsoft.SqlServer.Replication.TransSubscription>:  
  
    -   Чтобы изменить учетные данные для учетной записи Windows, под которой выполняется агент, установите <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> и <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> поля <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.  
  
    -   Чтобы использовать встроенную проверку подлинности Windows тип проверки подлинности, используемый агентом при соединении с подписчиком, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> Свойства **значение true,**.  
  
    -   Чтобы использовать проверку подлинности SQL Server тип проверки подлинности, используемый агентом при соединении с подписчиком, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> Свойства **false**, и укажите учетные данные входа подписчика для <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> и <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> полей.  
  
        > [!NOTE]  
        >  Соединение агента с распространителем всегда выполняются с использованием учетных данных Windows, заданные <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>. Эта учетная запись также используется для установления удаленных соединений с проверкой подлинности Windows.  
  
6.  (Необязательно) Если задано значение **true** для <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, вызовите <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> метод для внесения изменений на сервере. Если задано значение **false** для <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (по умолчанию), изменения отправляются на сервер немедленно.  
  
#### Изменение параметров безопасности агента распространителя для подписки по запросу на публикацию транзакций  
  
1.  Создайте соединение с подписчиком с помощью <xref:Microsoft.SqlServer.Management.Common.ServerConnection> класса.  
  
2.  Создайте экземпляр <xref:Microsoft.SqlServer.Replication.TransPullSubscription> класса.  
  
3.  Задайте <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, и <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> Свойства подписки, а соединение из шага 1 для <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> свойство.  
  
4.  Вызов <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> метод, чтобы получить свойства объекта. Если этот метод возвращает значение **false**, то либо на шаге 3 были неверно определены свойства подписки, либо подписка не существует.  
  
5.  Задайте одно или несколько из следующих свойств безопасности на экземпляре <xref:Microsoft.SqlServer.Replication.TransPullSubscription>:  
  
    -   Чтобы изменить учетные данные для учетной записи Windows, под которой выполняется агент, установите <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> и <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> поля <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.  
  
    -   Чтобы использовать встроенную проверку подлинности Windows тип проверки подлинности, используемый агентом при соединении с распространителем, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> Свойства **значение true,**.  
  
    -   Чтобы использовать проверку подлинности SQL Server тип проверки подлинности, используемый агентом при соединении с распространителем, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> Свойства **false**, и укажите учетные данные входа распространителя для <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> и <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> полей.  
  
        > [!NOTE]  
        >  Соединение агента с подписчиком всегда выполняется с использованием учетных данных Windows, заданные <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>. Эта учетная запись также используется для установления удаленных соединений с проверкой подлинности Windows.  
  
6.  (Необязательно) Если задано значение **true** для <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, вызовите <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> метод для внесения изменений на сервере. Если задано значение **false** для <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (по умолчанию), изменения отправляются на сервер немедленно.  
  
#### Изменение параметров безопасности агента слияния для подписки по запросу на публикацию слиянием  
  
1.  Создайте соединение с подписчиком с помощью <xref:Microsoft.SqlServer.Management.Common.ServerConnection> класса.  
  
2.  Создайте экземпляр <xref:Microsoft.SqlServer.Replication.MergePullSubscription> класса.  
  
3.  Задайте <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, и <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> Свойства подписки, а соединение из шага 1 для <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> свойство.  
  
4.  Вызов <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> метод, чтобы получить свойства объекта. Если этот метод возвращает значение **false**, то либо на шаге 3 были неверно определены свойства подписки, либо подписка не существует.  
  
5.  Задайте одно или несколько из следующих свойств безопасности на экземпляре <xref:Microsoft.SqlServer.Replication.MergePullSubscription>:  
  
    -   Чтобы изменить учетные данные для учетной записи Windows, под которой выполняется агент, установите <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> и <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> поля <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.  
  
    -   Чтобы использовать встроенную проверку подлинности Windows тип проверки подлинности, используемый агентом при соединении с распространителем, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> Свойства **значение true,**.  
  
    -   Чтобы использовать проверку подлинности SQL Server тип проверки подлинности, используемый агентом при соединении с распространителем, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> Свойства **false**, и укажите учетные данные входа распространителя для <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> и <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> полей.  
  
    -   Чтобы использовать встроенную проверку подлинности Windows тип проверки подлинности, используемый агентом при соединении с издателем, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> Свойства **значение true,**.  
  
    -   Чтобы использовать проверку подлинности SQL Server тип проверки подлинности, используемый агентом при соединении с издателем, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> Свойства **false**, и укажите учетные данные входа издателя для <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> и <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> полей.  
  
        > [!NOTE]  
        >  Соединение агента с подписчиком всегда выполняется с использованием учетных данных Windows, заданные <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>. Эта учетная запись также используется для установления удаленных соединений с проверкой подлинности Windows.  
  
6.  (Необязательно) Если задано значение **true** для <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, вызовите <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> метод для внесения изменений на сервере. Если задано значение **false** для <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (по умолчанию), изменения отправляются на сервер немедленно.  
  
#### Изменение параметров безопасности агента слияния для принудительной подписки на публикацию слиянием  
  
1.  Создайте соединение с издателем с помощью <xref:Microsoft.SqlServer.Management.Common.ServerConnection> класса.  
  
2.  Создайте экземпляр <xref:Microsoft.SqlServer.Replication.MergeSubscription> класса.  
  
3.  Задайте <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, и <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> Свойства подписки, а соединение из шага 1 для <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> свойство.  
  
4.  Вызов <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> метод, чтобы получить свойства объекта. Если этот метод возвращает значение **false**, то либо на шаге 3 были неверно определены свойства подписки, либо подписка не существует.  
  
5.  Задайте одно или несколько из следующих свойств безопасности на экземпляре <xref:Microsoft.SqlServer.Replication.MergeSubscription>:  
  
    -   Чтобы изменить учетные данные для учетной записи Windows, под которой выполняется агент, установите <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> и <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> поля <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.  
  
    -   Чтобы использовать встроенную проверку подлинности Windows тип проверки подлинности, используемый агентом при соединении с подписчиком, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> Свойства **значение true,**.  
  
    -   Чтобы использовать проверку подлинности SQL Server тип проверки подлинности, используемый агентом при соединении с подписчиком, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> Свойства **false**, и укажите учетные данные входа подписчика для <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> и <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> полей.  
  
    -   Чтобы использовать встроенную проверку подлинности Windows тип проверки подлинности, используемый агентом при соединении с издателем, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> Свойства **значение true,**.  
  
    -   Чтобы использовать проверку подлинности SQL Server тип проверки подлинности, используемый агентом при соединении с издателем, установите <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> поле <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> Свойства **false**, и укажите учетные данные входа издателя для <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardLogin%2A> и <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardPassword%2A> полей.  
  
        > [!NOTE]  
        >  Соединение агента с распространителем всегда выполняются с использованием учетных данных Windows, заданные <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>. Эта учетная запись также используется для установления удаленных соединений с проверкой подлинности Windows.  
  
6.  (Необязательно) Если задано значение **true** для <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, вызовите <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> метод для внесения изменений на сервере. Если задано значение **false** для <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (по умолчанию), изменения отправляются на сервер немедленно.  
  
#### Изменение сведений об имени входа, используемых немедленно обновляемым подписчиком при подключении к издателю транзакций  
  
1.  Создайте соединение с подписчиком с помощью <xref:Microsoft.SqlServer.Management.Common.ServerConnection> класса.  
  
2.  Создайте экземпляр <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> класс для базы данных подписки. Укажите <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.Name%2A> и <xref:Microsoft.SqlServer.Management.Common.ServerConnection> из шага 1 для <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.  
  
3.  Вызов <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> метод, чтобы получить свойства объекта. Если этот метод возвращает значение **false**, значит, в шаге 2 были неправильно определены свойства базы данных либо база данных подписки не существует.  
  
4.  Вызов <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LinkPublicationForUpdateableSubscription%2A> метод, со следующими параметрами:  
  
    -   *Издатель* -Имя издателя.  
  
    -   *PublisherDB* -имя базы данных публикации.  
  
    -   *Публикация* — Имя публикации, на которую подписана немедленного обновления подписчика.  
  
    -   *Распространитель* -Имя распространителя.  
  
    -   *PublisherSecurity* - <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext> указывающий тип режима безопасности, используемые немедленного обновления подписчика при соединении с издателем и учетные данные входа для соединения.  
  
###  <a name="PShellExample"></a> Пример (объекты RMO)  
 В этом примере проверяется указанное значение имени входа и изменяются все пароли для указанного имени входа в Windows или имени входа в SQL Server, хранимые репликацией на сервере.  
  
 [!code-csharp[HowTo#rmo_ChangeServerPasswords](../../../relational-databases/replication/codesnippet/csharp/rmohowto/rmotestevelope.cs#rmo_changeserverpasswords)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeServerPasswords](../../../relational-databases/replication/codesnippet/visualbasic/rmohowtovb/rmotestenv.vb#rmo_vb_changeserverpasswords)]  
  
##  <a name="FollowUp"></a> Дальнейшие действия. После изменения параметров безопасности репликации  
 После изменения имени входа и пароля агента необходимо остановить и повторно запустить агент, чтобы изменения вступили в силу.  
  
## См. также:  
 [Основные понятия объектов RMO](../../../relational-databases/replication/concepts/replication-management-objects-concepts.md)   
 [Обновление скриптов репликации & #40; Программирование репликации Transact-SQL и #41;](../../../relational-databases/replication/administration/upgrade-replication-scripts-replication-transact-sql-programming.md)   
 [Управление именами входа и паролями в репликации](../../../relational-databases/replication/security/manage-logins-and-passwords-in-replication.md)   
 [Модель безопасности агента репликации](../../../relational-databases/replication/security/replication-agent-security-model.md)   
 [Рекомендации по защите репликации](../../../relational-databases/replication/security/replication-security-best-practices.md)   
 [Безопасность и защита и #40; Репликация & #41;](../../../relational-databases/replication/security/security-and-protection-replication.md)   
 [Основные понятия системных хранимых процедур репликации](../../../relational-databases/replication/concepts/replication-system-stored-procedures-concepts.md)  
  
  