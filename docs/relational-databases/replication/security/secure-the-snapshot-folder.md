---
title: "Организация безопасности папки моментальных снимков | Документация Майкрософт"
ms.custom: 
ms.date: 03/14/2017
ms.prod: sql-non-specified
ms.prod_service: database-engine
ms.service: 
ms.component: replication
ms.reviewer: 
ms.suite: sql
ms.technology: replication
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: snapshots [SQL Server replication], security
ms.assetid: 3cd877d1-ffb8-48fd-a72b-98eb948aad27
caps.latest.revision: "46"
author: BYHAM
ms.author: rickbyh
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: c7bfea98b84a87b9bd35a06f4ce2ae49a69a0105
ms.sourcegitcommit: 44cd5c651488b5296fb679f6d43f50d068339a27
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2017
---
# <a name="secure-the-snapshot-folder"></a>Организация безопасности папки моментальных снимков
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)] Папка моментальных снимков представляет собой каталог, в котором хранятся файлы моментальных снимков. Рекомендуется выделить каталог для хранения моментальных снимков. Предоставьте агенту моментальных снимков разрешение на запись в данную папку и убедитесь, что разрешение на чтение предоставлено только учетной записи Windows, которая используется агентом слияния или агентом распространителя при обращении к данной папке. Чтобы обеспечить доступ к папке моментальных снимков, расположенной на удаленном компьютере, учетная запись Windows, связанная с агентом, должна быть учетной записью домена.  
  
> [!NOTE]  
>  Средство «Контроль учетных записей» (UAC) помогает администраторам управлять своими повышенными пользовательскими разрешениями (иногда называемыми *правами доступа*). В операционной системе с включенным контроль учетных записей, администраторы не пользуются своими административными правами, Вместо этого они выполняют большинство операций от имени обычных пользователей (не администраторов) и используют административные права только по необходимости. С помощью средства «Управление учетными записями пользователя» можно запретить административный доступ к хранилищу моментального снимка. Поэтому необходимо явно предоставить разрешения на доступ к хранилищу моментального снимка учетным записям Windows, которые используются агентом моментальных снимков, агентом распространителя и агентом слияния. Это необходимо делать даже в том случае, если эти учетные записи Windows являются членами группы «Администраторы».  
  
 Когда вы настраиваете распространитель с помощью мастера настройки распространителя или мастера создания публикаций, папке моментального снимка по умолчанию назначается следующий локальный путь: X:\Program Files\Microsoft SQL Server\\\*\<экземпляр>*\MSSQL\ReplData. Если вы используете удаленный распространитель или подписки по запросу, необходимо указывать не локальный путь, а путь к общей сетевой папке в формате UNC (например, \\\\<*имя_компьютера>*\snapshot).  
  
 Предоставлять разрешения на доступ к папке моментальных снимков необходимо в соответствии со способом доступа к данной папке. В [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003 используются следующие вкладки диалогового окна:  
  
-   Если указывается локальный путь, предоставляйте разрешения на работу с папкой на вкладке **Безопасность** диалогового окна **Свойства** .  
  
-   Если указывается сетевой ресурс, предоставляйте разрешения на работу с папкой на вкладке **Общий ресурс** диалогового окна **Свойства** .  
  
    > [!NOTE]  
    >  Если агент репликации запущен на распространителе, то в диалоговом окне **Свойства** этой папки на вкладке **Безопасность** необходимо предоставить учетной записи Windows разрешение на запуск агента. Это необходимо делать даже в том случае, если используется общая сетевая папка. Это относится к агенту слияния и агенту распространителя для принудительных подписок и к агенту моментальных снимков, когда издатель и распространитель располагаются на одном и том же компьютере.  
  
 Дополнительные сведения о предоставлении разрешений для локальных путей и общих сетевых ресурсов см. в документации по Windows.  
  
> [!NOTE]  
>  При удалении публикации репликация согласно контексту безопасности учетной записи службы [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] пытается удалить папку моментальных снимков. Если у этой учетной записи нет достаточных прав доступа, войдите в систему под другой учетной записью с необходимыми разрешениями и удалите папку вручную. Чтобы удалить папку, необходимо право доступа **Изменение** , если папка расположена по локальному пути, или разрешение **Полный доступ** , если папка является сетевым ресурсом.  
  
## <a name="delivering-snapshots-through-ftp"></a>Доставка моментальных снимков по FTP-протоколу  
 В соответствии с оптимальными методами обеспечения безопасности рекомендуется хранить моментальные снимки в общем UNC-ресурсе, хотя снимки можно хранить и в общем FTP-ресурсе, а затем доставлять их подписчику по протоколу FTP. При настройке FTP-сервера убедитесь, что виртуальный каталог предоставляет основной общий UNC-ресурс, и агент моментальных снимков обладает разрешением на запись для публикации.  
  
 Чтобы настроить подписчик на получение моментальных снимков по FTP, сначала установите FTP-сервер с именем для входа и паролем, предоставляющими подписчику доступ на чтение (или «получение»), который необходим для загрузки файлов моментальных снимков.  
  
 Сведения о доставке моментальных снимков по протоколу FTP см. в статье [Доставка моментальных снимков по FTP](../../../relational-databases/replication/publish/deliver-a-snapshot-through-ftp.md).  
  
 Сведения о задании и изменении пароля для доступа к моментальным снимкам по FTP см. в подразделе «Доставка моментальных снимков по FTP» раздела [Secure the Publisher](../../../relational-databases/replication/security/secure-the-publisher.md).  
  
## <a name="see-also"></a>См. также:  
 [Альтернативные расположения папки моментальных снимков](../../../relational-databases/replication/alternate-snapshot-folder-locations.md)   
 [Инициализация подписки с помощью моментального снимка](../../../relational-databases/replication/initialize-a-subscription-with-a-snapshot.md)   
 [Replication Security Best Practices](../../../relational-databases/replication/security/replication-security-best-practices.md)   
 [Безопасность и защита (репликация)](../../../relational-databases/replication/security/security-and-protection-replication.md)   
 [Передача моментальных снимков через FTP](../../../relational-databases/replication/transfer-snapshots-through-ftp.md)  
  
  
