---
title: "настроить сервер IIS для веб-синхронизации | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "replication"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "конфигурация сервера IIS [репликация SQL Server]"
  - "websync.log"
  - "Веб-синхронизация, серверы IIS"
ms.assetid: d651186e-c9ca-4864-a444-2cd6943b8e35
caps.latest.revision: 88
author: "BYHAM"
ms.author: "rickbyh"
manager: "jhubbard"
caps.handback.revision: 88
---
# настроить сервер IIS для веб-синхронизации
  Описанные в данном разделе процедуры составляют второй этап настройки веб-синхронизации при репликации слиянием. Эти процедуры выполняют после включения веб-синхронизации для публикации. Обзор процесса настройки см. в разделе [настройки веб-синхронизации](../../relational-databases/replication/configure-web-synchronization.md). После завершения выполнения процедур, описанных в этом разделе, перейдите к третьему этапу — настройке подписки для использования веб-синхронизации. Этот этап описывается в следующих разделах:  
  
-   [! ВКЛЮЧИТЬ [ssManStudioFull] (.. / Token/ssManStudioFull_md.md)]: [How to: Configure a Subscription to Use Web Synchronization \(SQL Server Management Studio\)](http://msdn.microsoft.com/library/ms345214.aspx)  
  
-   Репликация [!INCLUDE[tsql](../../includes/tsql-md.md)] программирования: [Практическое руководство: Настройка подписки для использования веб-синхронизации (Программирование репликации Transact-SQL)](http://msdn.microsoft.com/library/ms345206.aspx)  
  
-   Объекты RMO: [Практическое руководство: Настройка подписки для использования веб-синхронизации (программирование объектов RMO)](http://msdn.microsoft.com/library/ms345207.aspx)  
  
 Веб-синхронизация использует сервер служб [!INCLUDE[msCoName](../../includes/msconame-md.md)] IIS для синхронизации подписок по запросу на публикации слиянием. IIS версии 5.0, IIS версии 6.0, и [!INCLUDE[iisver](../../includes/iisver-md.md)] поддерживаются. Мастер настройки веб-синхронизации не поддерживается в версии [!INCLUDE[iisver](../../includes/iisver-md.md)].  
  
> [!IMPORTANT]  
>  Убедитесь в том, что приложение использует только [!INCLUDE[dnprdnlong](../../includes/dnprdnlong-md.md)] или более позднюю версию, а более ранние версии [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] на IIS-сервере не установлены. Более ранние версии [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] могут вызывать ошибки. В частности: "Недопустимый формат сообщения во время веб-синхронизации. Убедитесь в том, что компоненты репликации на веб-сервере настроены правильно».  
  
> [!CAUTION]  
>  Не используйте одновременно и расположение WebSync, и альтернативное расположение папки моментальных снимков.  
  
 Чтобы использовать веб-синхронизацию, необходимо настроить службы IIS, выполнив следующие шаги. Каждый шаг подробно описан в данном разделе.  
  
1.  Настройте протокол SSL (Secure Sockets Layer). Протокол SSL необходим для связи между сервером IIS и всеми подписчиками.  
  
2.  Установка [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] компоненты связи на компьютере со службами IIS с помощью [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] мастера установки. Если планируется использовать мастер настройки веб-синхронизации, упомянутый в шаге 3, то также необходимо установить среду [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] на сервер IIS.  
  
3.  Настройте сервер IIS для проведения веб-синхронизации. Можно выполнить настройку вручную или использовать мастер настройки веб-синхронизации. Рекомендуется использовать мастер настройки веб-синхронизации.  
  
    > [!NOTE]  
    >  Если сервер служб IIS работает под управлением 64-разрядной версии Windows, необходимо выполнить следующую команду, чтобы убедиться, что этот сервер правильно настроен для запуска приложений ISAPI. Дополнительные сведения см. в документации служб IIS.  
  
    ```  
    cscript %SystemDrive%\inetpub\AdminScripts\adsutil.vbs set w3svc/AppPools/Enable32bitAppOnWin64 1  
    ```  
  
4.  Установите нужные разрешения для средства прослушивания репликации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
5.  Запустите веб-синхронизацию в диагностическом режиме, чтобы проверить соединение с сервером IIS и убедиться, что SSL-сертификат установлен правильно.  
  
## Настройка протокола SSL  
 Чтобы настроить протокол SSL, укажите сертификат, который будет использоваться сервером IIS. Веб-синхронизация для репликации слиянием поддерживает использование серверных сертификатов, а не клиентских. Чтобы настроить службы IIS для развертывания, необходимо вначале получить сертификат из центра сертификации (certification authority, CA). Центр сертификации — это организация, отвечающая за установку и документальное подтверждение подлинности открытых ключей шифрования, принадлежащих пользователям, компьютерам и другим центрам сертификации. Дополнительные сведения о сертификатах см. в документации по службам IIS. После установки сертификата необходимо связать сертификат с веб-сайтом, который используется веб-синхронизацией.  
  
#### Указание сертификата для развертывания  
  
1.  Войдите на сервер IIS под учетной записью администратора.  
  
2.  Запустите **Internet Information Services (IIS) Manager**:  
  
    1.  Нажмите кнопку **Пуск**, затем щелкните **Выполнить**.  
  
    2.  В **Откройте** введите **inetmgr**, а затем нажмите кнопку **ОК**.  
  
3.  Запустите мастер сертификатов служб IIS:  
  
    1.  В **диспетчера Internet Information Services (IIS)**, разверните **локального компьютера** узел и разверните **веб-узлы** папки.  
  
    2.  Щелкните правой кнопкой мыши **веб-узел по умолчанию**, а затем нажмите кнопку **Свойства**.  
  
    3.  В **Свойства веб-сайт по умолчанию** диалогового **Безопасность каталога** щелкните **сертификат сервера**.  
  
    4.  Выполните все указания мастера сертификатов веб-сервера  
  
4.  Нажмите кнопку **ОК**.  
  
 Если не удается получить сертификат от центра сертификации, можно указать сертификат для тестирования. Чтобы настроить службы IIS 6.0 для тестирования, установите сертификат с помощью программы SelfSSL. Эта программа доступна в IIS 6.0 Resource Kit. Инструменты можно загрузить [центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkId=30958). В IIS 5.0, перейдите к [Центр справки и поддержки](http://go.microsoft.com/fwlink/?LinkId=46229).  
  
> [!NOTE]  
>  Сертификат должен быть связан с веб-сайтом, прежде чем этот сайт сможет использовать протокол SSL. Программа SelfSSL автоматически связывает сертификат с веб-сайтом по умолчанию. Если сертификат уже имеется или будет установлен позже из центра сертификации, то необходимо явно связать этот сертификат с веб-сайтом, который используется для веб-синхронизации. Убедитесь, что существует только один сертификат, связанный с веб-сайтом, который используется для синхронизации подписок. Если имеется несколько сертификатов, подписчик будет использовать первый доступный веб-сайт.  
  
#### Указание сертификата для тестирования в службах IIS 6.0  
  
1.  Войдите на сервер IIS под учетной записью администратора.  
  
2.  Загрузите и установите программу SelfSSL. По умолчанию приложение установлено для \<*диск*>: \Program Files\IIS Resources\SelfSSL. Ярлыки программы и документации копируются в \<*диск*>: \Documents and Settings\All Users\Start Menu\Programs\IIS Resources\SelfSSL.  
  
3.  Запустите SelfSSL:  
  
    -   Чтобы запустить SelfSSL со значениями по умолчанию для всех параметров, найдите каталог установки этой программы, а затем дважды щелкните файл SelfSSL.exe.  
  
        > [!NOTE]  
        >  По умолчанию сертификат, устанавливаемый программой SelfSSL, действителен в течение семи дней.  
  
    -   Указать значения для одного или нескольких параметров: щелкните **запустить**, и нажмите кнопку **запуска**. В поле **Открыть** введите **cmd**и нажмите кнопку **ОК**. Найдите каталог установки программы SelfSSL, введите `SelfSSL`, а затем задайте значения для одного или нескольких параметров. Для просмотра списка параметров введите команду `SelfSSL -?`.  
  
## Установка сетевых компонентов и среды SQL Server Management Studio  
  
#### Установка сетевых компонентов SQL Server и среды SQL Server Management Studio  
  
1.  Войдите на компьютер, где работает IIS под учетной записью администратора.  
  
2.  С установочного диска [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] запустите мастер установки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Дополнительные сведения об использовании этого мастера см. в разделе [установить SQL Server 2016 из мастера установки & #40; Настройка & #41;](../../database-engine/install-windows/install-sql-server-2016-from-the-installation-wizard-setup.md).  
  
3.  На **Выбор компонентов** выберите **средства связи клиентских средств**.  
  
4.  Если планируется использовать мастер настройки веб-синхронизации, выберите **Основные средства управления**.  
  
5.  Выполните все инструкции мастера и перезапустите компьютер.  
  
    > [!NOTE]  
    >  Можно установить дополнительные компоненты, но для веб-синхронизации требуются только сетевые компоненты.  
  
## Настройка сервера IIS с помощью мастера настройки веб-синхронизации  
 Настройте сервер IIS вручную или с помощью мастера настройки веб-синхронизации. Рекомендуется использовать мастер настройки, несмотря на это, в следующем разделе содержатся инструкции по настройке вручную. Мастер веб-синхронизации [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] может использоваться только для публикаций, созданных на издателе, на котором работает [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], или на издателе, обновленном до уровня [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]. Мастер нельзя использовать для публикаций на [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]. Мастер можно использовать при работе с подписками на [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и более поздних версиях, а также на [!INCLUDE[ssEWnoversion](../../includes/ssewnoversion-md.md)] 3.0 и более поздних версиях.  
  
 Эта конфигурация имеет следующие характеристики.  
  
-   Использует веб-сайт по умолчанию в IIS. Однако можно использовать другой веб-сайт. Дополнительные сведения о том, как создавать веб-сайты, содержатся в документации по службам IIS.  
  
    > [!NOTE]  
    >  Заданный веб-сайт обеспечивает доступ к компонентам, которые используются при веб-синхронизации. Веб-сайт не предоставляет доступ к другим данным или веб-страницами, если его не настроить соответствующим образом.  
  
-   Создает виртуальный каталог и связанный с ним псевдоним. Этот псевдоним используется при доступе к компонентам веб-синхронизации. Например, если адрес сервера IIS — https://*server.domain.com* и укажите псевдоним «websync1», адрес для доступа к компоненту replisapi.dll будет https://*server.domain.com*/websync1/replisapi.dll.  
  
-   Использует обычную проверку подлинности. Рекомендуется использовать процедуру обычной проверки подлинности, поскольку она позволяет запускать сервер IIS и издатель/распространитель [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на отдельных компьютерах (рекомендованная конфигурация) без делегирования Kerberos. Использование протокола SSL в сочетании с обычной проверкой подлинности обеспечивает шифрование имен входа, паролей и всех данных в процессе передачи. (SSL требуется, независимо от типа используемой проверки подлинности.) Дополнительные сведения о рекомендациях по веб-синхронизации, обратитесь к разделу «Безопасности советы и рекомендации для веб-синхронизации» в [настройки веб-синхронизации](../../relational-databases/replication/configure-web-synchronization.md).  
  
#### Настройка сервера IIS с помощью мастера настройки веб-синхронизации  
  
1.  На сервере IIS запустите среду [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].  
  
2.  Подключитесь к издателю и разверните узел сервера.  
  
3.  Разверните **Локальные публикации** папку, щелкните правой кнопкой мыши публикацию и выберите **настройки веб-синхронизации**.  
  
4.  В мастере настройки веб-синхронизации на **Тип подписчика** выберите **SQL Server**.  
  
5.  На **веб-сервере** страницы:  
  
    1.  Выберите экземпляр сервер IIS, который будет синхронизировать подписки.  
  
    2.  Выберите **Создание нового виртуального каталога**.  
  
    3.  В нижней части страницы разверните экземпляр сервера IIS, затем **веб-узлы**, и нажмите кнопку **веб-узел по умолчанию**.  
  
6.  На **сведения о виртуальном каталоге** страницы:  
  
    1.  В **псевдоним** Введите псевдоним виртуального каталога.  
  
    2.  В **пути** Введите путь виртуального каталога. Например, если вы ввели **websync1** в **псевдоним** введите **C:\Inetpub\wwwroot\websync1** в **путь** поле. Нажмите кнопку **Далее**.  
  
    3.  В обоих диалоговых окнах нажмите кнопку **Да**. Это означает, что нужно создать новую папку и скопировать [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Internet Server API (ISAPI) DLL. .  
  
7.  На **доступ с проверкой подлинности** страницы:  
  
    1.  Убедитесь, что **встроенную проверку подлинности Windows** и **Дайджест-проверка для серверов доменов Windows** очищаются.  
  
    2.  Выберите **обычной проверки подлинности**.  
  
    3.  В **домен по умолчанию** и **область** окна, введите имя домена компьютера, на котором работает IIS-сервер.  
  
8.  На **доступ к каталогу** страницы:  
  
    1.  Щелкните **Добавить**, а затем в **Выбор пользователей или групп** диалогового окна добавьте учетные записи, под которыми подписчик будет подключаться к серверу IIS. Это учетные записи, которые будут указывать на **сведения о сервере Web** страницы мастера создания подписки или в качестве значения для [sp_addmergepullsubscription_agent](../../relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql.md)*@internet_login* параметр.  
  
9. На **доступ к общей папке моментальных снимков** страница, укажите общую папку моментальных снимков. Устанавливаются соответствующие разрешения для этой общей папки, чтобы подписчики могли получить доступ к файлам моментальных снимков. Дополнительные сведения о разрешениях для общей папки см. в разделе [Безопасность папки моментальных снимков](../../relational-databases/replication/security/secure-the-snapshot-folder.md).  
  
10. На **Завершение работы мастера** щелкните **Готово**.  
  
     Если во время настройки удаленного сервера IIS произойдет ошибка, например ошибка в сети, то по всем выполненным действиям выполняется откат, а оставшиеся действия отменяются. Если выполненного действия нельзя выполнить откат, на последней странице мастера отображается состояние **Успех** и выполненные действия остаются зафиксированными.  
  
11. Если службы IIS работают на компьютере под управлением 64-разрядной версии Windows, библиотека replisapi.dll должна быть скопирована в соответствующий каталог.  
  
    1.  Нажмите кнопку **Пуск**, затем щелкните **Выполнить**. В **Откройте** введите **iisreset**, а затем нажмите кнопку **ОК**.  
  
    2.  После остановки и перезапуска служб IIS скопируйте файл replisapi.dll из расположения [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]COM\replisapi в каталог, указанный в шаге 6б.  
  
    3.  Нажмите кнопку **Пуск**, затем щелкните **Выполнить**. В поле **Открыть** введите **cmd**и нажмите кнопку **ОК**.  
  
    4.  В каталоге указанном на шаге 6б выполните следующую команду:  
  
         **regsvr32 replisapi.dll**  
  
## Ручная настройка сервера IIS  
 Для ручной настройки сервера IIS необходимо установить и настроить средство прослушивания репликации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], а затем настроить авторизацию для подписчиков, которые подключаются к серверу IIS.  
  
#### Установка и настройка средства прослушивания репликации SQL Server  
  
1.  Создайте на компьютере, где работают службы IIS, каталог для файла replisapi.dll. Можно создать каталог везде, где это требуется, но рекомендуется создать каталог в разделе \<*диск*>: \Inetpub directory. Например, создайте каталог \<*диск*>: \Inetpub\SQLReplication\\.  
  
    > [!IMPORTANT]  
    >  Настоятельно рекомендуется создавать этот каталог в разделе жесткого диска с файловой системой NTFS, а не с файловой системой FAT. При выборе файловой системы NTFS для точного управления доступом пользователей к репликации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] можно использовать разрешения файловой системы NTFS.  
  
2.  Скопируйте файл replisapi.dll из каталога [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]com\ в каталог с файлами, созданный на шаге 1.  
  
3.  Зарегистрируйте файл replisapi.dll:  
  
    1.  Нажмите кнопку **Пуск**, затем щелкните **Выполнить**. В поле **Открыть** введите **cmd**и нажмите кнопку **ОК**.  
  
    2.  В каталоге созданном на шаге 1 выполните следующую команду:  
  
         **regsvr32 replisapi.dll**  
  
4.  Создайте новый веб-сайт для репликации или воспользуйтесь уже существующим. Во время синхронизации компоненты репликации будут обращаться к этому веб-сайту. Дополнительные сведения о том, как создавать веб-сайты, содержатся в документации по службам IIS.  
  
5.  Создайте виртуальный каталог в службах IIS. Виртуальный каталог должен быть создан на веб-сайте, созданном на шаге 4, и сопоставлен с каталогом, созданным на шаге 1. Дополнительные сведения о создании виртуальных каталогов см. в документации по службам IIS. При назначении разрешений для этого каталога рекомендуется установить максимальные ограничения. Необходимо выбрать **чтения** и **Execute** разрешений, но можно снять **запускать сценарии**, **записи**, и **Обзор** разрешения.  
  
6.  Установите в настройках служб IIS разрешение выполнять файл replisapi.dll. Для предыдущих версий служб IIS достаточно разрешений, назначенных на шаге 4, однако для служб IIS 6.0 необходимо включить модули Internet Server API (ISAPI). Дополнительные сведения см. в разделах «Настройка модулей ISAPI» и «Включение и выключение динамического содержимого» документации по службам IIS 6.0.  
  
#### Настройка проверки подлинности службами IIS  
  
-   При подключении подписчиков к серверу IIS службы IIS должны проверить подлинность подключаемых подписчиков перед предоставлением им доступа к ресурсам и процессам. Службы IIS выполняют три типа проверки подлинности: анонимную, обычную и встроенную. Проверка подлинности может выполняться для всего веб-сайта или для созданного виртуального каталога.  
  
     Рекомендуется использовать процедуру обычной проверки подлинности в сочетании с протоколом SSL. Протокол SSL должен использоваться вне независимости от типа применяемой проверки подлинности. Дополнительные сведения о настройке проверки подлинности см. в документации по службам IIS.  
  
## Установка разрешений для средства прослушивания репликации SQL Server  
 При подключении подписчика к серверу IIS проверка подлинности подписчика производится с помощью типа проверки подлинности, который был задан при настройке служб IIS. После проверки подлинности подписчика службы IIS проверяют, обладает ли подписчик правами для вызова репликации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Задание разрешений на файл replisapi.dll позволяет определить пользователей, которые получают возможность запускать репликацию [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Правильная настройка разрешений необходима для предотвращения несанкционированного доступа к репликации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
 Чтобы установить минимальные разрешения для учетной записи, под которой может запускаться средство прослушивания репликации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , выполните следующую процедуру. Шаги процедуры относятся к [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[winxpsvr](../../includes/winxpsvr-md.md)] под управлением IIS 6.0.  
  
 Помимо выполнения следующих шагов, убедитесь в том, что все необходимые имена входа содержатся в списке доступа к публикации (PAL). Дополнительные сведения о списке доступа к публикации см. в разделе [организация безопасности издателя](../../relational-databases/replication/security/secure-the-publisher.md).  
  
#### Настройка учетной записи и разрешений  
  
1.  На сервере IIS создайте локальную учетную запись:  
  
    1.  Щелкните правой кнопкой мыши **Мой компьютер**, а затем нажмите кнопку **Управление**.  
  
    2.  В **Управление компьютером**, разверните **Локальные пользователи и группы**.  
  
    3.  Щелкните правой кнопкой мыши **пользователей**, а затем нажмите кнопку **нового пользователя**.  
  
    4.  Введите имя пользователя и надежный пароль.  
  
    5.  Нажмите кнопку **Создать**, а затем кнопку **Закрыть**.  
  
2.  Добавьте учетную запись в группу IIS_WPG:  
  
    1.  В **Управление компьютером**, разверните **Локальные пользователи и группы**, а затем нажмите кнопку **группы**.  
  
    2.  Щелкните правой кнопкой мыши **IIS_WPG**, а затем нажмите кнопку **Добавить в группу**.  
  
    3.  В **Свойства: IIS_WPG** диалоговом нажмите кнопку **Добавить**.  
  
    4.  В диалоговом окне **Выбор: Пользователи, Компьютеры или Группы** добавьте учетную запись, созданную на шаге 1.  
  
    5.  Убедитесь, что имя в **из этого расположения** указано имя локального компьютера, а не домена. Если это не имя локального компьютера, нажмите кнопку **расположения**. В **расположения** диалоговое окно, выберите локальный компьютер и нажмите кнопку **ОК**.  
  
    6.  В **Выбор: пользователи** диалоговое окно и **Свойства: IIS_WPG** диалоговом нажмите **OK**.  
  
3.  Предоставьте учетной записи минимальные разрешения для доступа к папке, содержащей библиотеку replisapi.dll:  
  
    1.  Перейдите в папку, созданную для файла replisapi.dll, щелкните правой кнопкой мыши папку и нажмите кнопку **общий доступ и безопасность**.  
  
    2.  На **безопасности** щелкните **Добавить**.  
  
    3.  В **Выбор пользователей, компьютеров или групп** диалоговом поле, добавьте учетную запись, созданную на шаге 1.  
  
    4.  Убедитесь, что имя в **из этого расположения** указано имя локального компьютера, а не домена. Если это не имя локального компьютера, нажмите кнопку **расположения**. В диалоговом окне **Расположение...** выберите локальный компьютер, а затем нажмите кнопку **ОК**.  
  
    5.  Убедитесь, что учетной записи предоставлены только **чтения**, **Чтение и выполнение**, и **Список содержимого папки** разрешения.  
  
    6.  Выберите пользователей и группы, которые не требуется доступ к каталогу и нажмите кнопку **Удаление**.  
  
    7.  Нажмите кнопку **ОК**.  
  
4.  Создайте пул приложений в **диспетчера Internet Information Services (IIS)**:  
  
    1.  Нажмите кнопку **Пуск**, затем щелкните **Выполнить**.  
  
    2.  В **Откройте** введите **inetmgr**, а затем нажмите кнопку **ОК**.  
  
    3.  В **диспетчера Internet Information Services (IIS)**, разверните **локального компьютера** узла.  
  
    4.  Щелкните правой кнопкой мыши **Пулы приложений**, пункты **New** и нажмите кнопку **пул приложений**.  
  
    5.  Введите имя пула в **идентификатор пула приложений** а затем щелкните **ОК**.  
  
5.  Свяжите учетную запись с этим пулом приложений:  
  
    1.  В **диспетчера Internet Information Services (IIS)**, разверните **локального компьютера** узел и разверните **Пулы приложений**.  
  
    2.  Щелкните правой кнопкой мыши пул приложений, который был создан и нажмите кнопку **Свойства**.  
  
    3.  В **\< ИмяПулаПриложений> Свойства** диалогового **идентификации** щелкните **Настраиваемый**.  
  
    4.  В **имя пользователя** и **пароль** Введите учетную запись и пароль, созданные на шаге 1.  
  
    5.  Нажмите кнопку **ОК**.  
  
6.  Свяжите пул приложений с виртуальным каталогом, используемым для веб-синхронизации:  
  
    1.  В **диспетчера Internet Information Services (IIS)**, разверните **локального компьютера** узел и разверните **веб-узлы**.  
  
    2.  Разверните веб-сайт, который вы используете для веб-синхронизации, щелкните правой кнопкой мыши виртуальный каталог, созданный для веб-синхронизации и нажмите кнопку **Свойства**.  
  
    3.  На **виртуальный каталог** вкладке **\< ИмяВиртуальногоКаталога> Свойства** диалоговом из **пул приложений** раскрывающегося списка выберите пул приложений, созданный на шаге 5.  
  
    4.  Нажмите кнопку **ОК**.  
  
## Проверка подключения к replisapi.dll  
 Запустите веб-синхронизацию в диагностическом режиме, чтобы проверить соединение с сервером IIS и удостовериться, что SSL-сертификаты установлены правильно. Чтобы запустить веб-синхронизацию в режиме диагностики, необходимо быть администратором сервера IIS.  
  
#### Проверка подключения к replisapi.dll  
  
1.  Убедитесь, что параметры локальной сети на подписчике установлены правильно:  
  
    1.  В [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Explorer в меню **Сервис** щелкните **Свойства обозревателя**.  
  
    2.  На вкладке **Подключения** щелкните **Настройки локальной сети**.  
  
    3.  Если в локальной сети не используется прокси-сервер, снимите флажки **Автоматическое определение параметров** и **Использовать прокси-сервер для подключений LAN**.  
  
    4.  Если используется прокси-сервер, выберите **использовать прокси-сервер для подключений LAN** и **использовать прокси-сервер для локальных адресов**.  
  
    5.  Нажмите кнопку **ОК**.  
  
2.  В обозревателе Internet Explorer на подписчике подключитесь к серверу в диагностическом режиме, добавив параметр `?diag` к адресу replisapi.dll. Пример: https://server.domain.com/directory/replisapi.dll?diag.  
  
3.  Если сертификат, заданный для сервера IIS, не распознается операционной системой  Windows, то выводится диалоговое окно **Предупреждение безопасности** . Это предупреждение может возникать из-за того, что это проверочный сертификат или сертификат, выданный центром сертификации, который не распознается Windows.  
  
    > [!NOTE]  
    >  Если это диалоговое окно не выводится, обязательно добавьте этот сертификат для сервера, с которым устанавливается соединение, в качестве доверенного в хранилище сертификатов на подписчике. Дополнительные сведения об экспорте сертификатов см. в документации по службам IIS.  
  
    1.  В диалоговом окне **Предупреждение системы безопасности** щелкните **Просмотреть сертификат**.  
  
    2.  В диалоговом окне **Сертификат** на вкладке **Общие** щелкните **Установить сертификат**.  
  
    3.  Выполните указания мастера импорта сертификатов, приняв значения по умолчанию.  
  
    4.  В диалоговом окне **Предупреждение безопасности** нажмите кнопку **Да**.  
  
    5.  В окне подтверждения мастера импорта сертификатов нажмите кнопку **ОК**.  
  
    6.  Закройте диалоговое окно **Сертификат** .  
  
    7.  В диалоговом окне **Предупреждение безопасности** нажмите кнопку **Да**.  
  
    > [!NOTE]  
    >  Сертификаты установлены. Эту операцию необходимо выполнить для каждого пользователя, который будет выполнять синхронизацию.  
  
4.  В **подключиться к \< имя_сервера>** диалоговом окне укажите имя входа и пароль, которые агент слияния будет использовать для подключения к серверу IIS. Эти учетные данные указываются также в мастере создания подписки.  
  
5.  В окне обозревателя Internet Explorer **Диагностические сведения SQL Websync**проверьте, чтобы значение в каждом столбце **Состояние** на этой странице было равно **SUCCESS**.  
  
6.  Убедитесь в том, что сертификат правильно установлен на подписчике:  
  
    1.  Закройте, а затем повторно откройте окно Internet Explorer.  
  
    2.  Подключитесь к серверу в диагностическом режиме. Если сертификат установлен правильно, диалоговое окно **Предупреждение безопасности** не появится. Если это окно появилось, то агент слияния не сможет подключиться к серверу IIS. Необходимо убедиться, что этот сертификат добавлен в качестве доверенного в хранилище сертификатов у подписчика. Дополнительные сведения об экспорте сертификатов см. в документации по службам IIS.  
  
## См. также:  
 [Настройка веб-синхронизации](../../relational-databases/replication/configure-web-synchronization.md)  
  
  