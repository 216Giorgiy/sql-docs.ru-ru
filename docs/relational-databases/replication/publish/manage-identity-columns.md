---
title: "Управление столбцами идентификаторов | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "replication"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "значения идентификаторов [репликация SQL Server]"
  - "репликация слиянием [репликация SQL Server], управление диапазонами идентификаторов"
  - "публикация [репликация SQL Server], столбцы идентификаторов"
  - "репликация транзакций, управление диапазонами идентификаторов"
  - "столбцы идентификаторов [SQL Server], репликация"
ms.assetid: 98892836-cf63-494a-bd5d-6577d9810ddf
caps.latest.revision: 42
author: "BYHAM"
ms.author: "rickbyh"
manager: "jhubbard"
caps.handback.revision: 42
---
# Управление столбцами идентификаторов
  В этом разделе описывается управление столбцами идентификаторов в [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] с помощью среды [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] или [!INCLUDE[tsql](../../../includes/tsql-md.md)]. Если операции вставки с подписчика реплицируются обратно на издатель, необходимо управлять столбцами идентификаторов, чтобы избежать присваивания одинаковых значений идентификаторов на подписчике и издателе. Репликация может управлять диапазонами идентификаторов автоматически, или можно управлять диапазонами идентификаторов вручную.  Сведения о параметрах управления диапазонами идентификаторов, предоставляемых репликацией, в разделе [репликации столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md).  
  
 **В этом разделе**  
  
-   **Перед началом работы выполните следующие действия.**  
  
     [Рекомендации](#Recommendations)  
  
-   **Для управления столбцами идентификаторов используются:**  
  
     [Среда SQL Server Management Studio](#SSMSProcedure)  
  
     [Transact-SQL](#TsqlProcedure)  
  
##  <a name="BeforeYouBegin"></a> Перед началом  
  
###  <a name="Recommendations"></a> Рекомендации  
  
-   При публикации таблицы в нескольких публикациях необходимо указать одинаковые параметры управления диапазонами идентификаторов для всех публикаций. Дополнительные сведения см. в разделе «Публикация таблиц в нескольких публикациях» в [публикации данных и объектов базы данных](../../../relational-databases/replication/publish/publish-data-and-database-objects.md).  
  
-   Чтобы создать автоматически увеличивающимся может использоваться в нескольких таблицах или, может вызываться из приложений без ссылки на все таблицы, см. [порядковые номера](../../../relational-databases/sequence-numbers/sequence-numbers.md).  
  
##  <a name="SSMSProcedure"></a> Использование среды SQL Server Management Studio  
 Укажите для параметра управления столбцом идентификаторов **Свойства** вкладке **Свойства статьи — \< статья>** диалоговое окно мастера создания публикаций. Дополнительные сведения об использовании этого мастера см. в разделе [Создать публикацию](../../../relational-databases/replication/publish/create-a-publication.md). В мастере создания публикации выполните следующие действия.  
  
-   При выборе **Публикация слиянием** или **публикации транзакций с обновляемыми подписками** на **Тип публикации** выберите Управление диапазонами идентификаторов автоматически или вручную (автоматическое, по умолчанию, рекомендуется использовать). После публикации таблицы данное свойство невозможно изменить, но другие связанные свойства изменить можно.  
  
-   При выборе других типов публикаций должен быть установлен ручной режим управления диапазонами идентификаторов.  
  
 Изменение диапазонов идентификаторов и пороговые значения на **Свойства** Вкладка **Свойства статьи — \< статья>**, доступный в **Свойства публикации — \< публикации>** диалоговое окно. Дополнительные сведения о доступе к этому диалоговому окну см. в разделе [View and Modify Publication Properties](../../../relational-databases/replication/publish/view-and-modify-publication-properties.md).  
  
#### Указание параметра управления столбцом идентификаторов  
  
1.  Если на издателе запущена версия [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , более ранняя, чем [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], то на странице **Тип публикации** мастера создания публикаций выберите **Публикация слиянием** или **Публикация транзакций с обновляемыми подписками**.  
  
2.  На странице **Статьи** выберите таблицу со столбцом идентификаторов.  
  
3.  Щелкните **Свойства статьи**, затем щелкните **Указать свойства выделенной статьи таблицы**.  
  
4.  На **Свойства** Вкладка **Свойства статьи — \< статья>** в диалоговом **управление диапазонами идентификаторов** установите **автоматически управлять диапазонами идентификаторов** Свойства **автоматического** или **вручную** (для издателей, использующих [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] или более поздней версии), или **значение True,** или **False** (для издателей, использующих версию [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] до [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]).  
  
5.  Если на шаге 4 выбрано **Автоматически** или **True** , введите значения для параметров в следующей таблице. Дополнительные сведения об использовании этих параметров см. в разделе «Назначение диапазонов идентификаторов» из [репликации столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md).  
  
    |Параметр|Значение|Описание|  
    |------------|-----------|-----------------|  
    |**Размер диапазона издателя**|Целое значение для размера диапазона (например, 20 000).|Ознакомьтесь с разделом «Назначение диапазонов идентификаторов» [репликации столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md).|  
    |**Размер диапазона на стороне подписчика**|Целое значение для размера диапазона (например, 10000).|Ознакомьтесь с разделом «Назначение диапазонов идентификаторов» [репликации столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md).|  
    |**Процентный порог выделения диапазона**|Целое значение для процентного порога (например, 90 эквивалентно 90 процентам).|Процент общего числа значений идентификаторов, используемый в узле до задания нового диапазона идентификаторов.<br /><br /> <br /><br /> Примечание. Данное значение должно быть указано, но оно используется только подписчиками, использующими подписки, обновляемые посредством очередей, а также подписчиками публикаций слиянием, на которых выполняется [!INCLUDE[ssEW](../../../includes/ssew-md.md)] или предыдущие версии других выпусков SQL Server. Дополнительные сведения см. в разделе «Назначение диапазонов идентификаторов» из [репликации столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md).|  
    |**Начальное значение следующего диапазона**|Целое значение. Только для чтения.|Значение, с которого начнется следующий диапазон. Например, если текущий диапазон 5001-6000, то это значение будет равно 6001.|  
    |**Максимальное значение идентификатора**|Целое значение. Только для чтения.|Наибольшее значение для столбца идентификаторов. Определяется базовым типом данных столбца.|  
    |**Приращение**|Целое значение. Только для чтения.|Значение, на которое должно увеличиться или уменьшиться для каждой вставки значение в столбце идентификаторов. Обычно используется значение 1.|  
  
6.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### Изменение диапазонов идентификаторов и пороговых значений после публикации таблицы  
  
1.  На **статьи** Страница **Свойства публикации — \< публикация>** диалоговое окно, выберите таблицу со столбцом идентификаторов.  
  
2.  Щелкните **Свойства статьи**, затем щелкните **Указать свойства выделенной статьи таблицы**.  
  
3.  На **Свойства** вкладке **Свойства статьи — \< статья>** в диалоговом **управление диапазонами идентификаторов** Введите значения для одного или нескольких из следующих свойств: **размер диапазона издателя**, **размер диапазона подписчика**, и **пороговое значение в процентах в диапазоне**.  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
5.  Щелкните **ОК** на **Свойства публикации — \< публикация>** диалоговое окно.  
  
##  <a name="TsqlProcedure"></a> Использование Transact-SQL  
 Чтобы указать параметры управления диапазонами идентификаторов, при создании статьи можно использовать хранимые процедуры репликации.  
  
#### Включение автоматического управления диапазонами идентификаторов при определении статей для публикации транзакций  
  
1.  На издателе в базе данных публикации выполните хранимую процедуру [sp_addarticle](../../../relational-databases/system-stored-procedures/sp-addarticle-transact-sql.md). Если в публикуемой исходной таблице есть столбец идентификаторов, укажите значение **автоматически** для **@identityrangemanagementoption**, диапазон значений идентификаторов, назначенный издателю для **@pub_identity_range**, диапазон значений идентификаторов, назначенный подписчикам для **@identity_range**, и процент общего числа значений идентификаторов используется перед назначением нового диапазона идентификаторов для **@threshold**. Дополнительные сведения об определении статей см. в разделе [определить статью](../../../relational-databases/replication/publish/define-an-article.md).  
  
    > [!NOTE]  
    >  Убедитесь, что тип данных столбца идентификаторов достаточно большой, чтобы поддерживать полный диапазон идентификаторов, назначаемый всем подписчикам.  
  
#### Отключение автоматического управления диапазонами идентификаторов при определении статей для публикации транзакций  
  
1.  На издателе в базе данных публикации выполните хранимую процедуру [sp_addarticle](../../../relational-databases/system-stored-procedures/sp-addarticle-transact-sql.md). Укажите значение **manual** в параметре **@identityrangemanagementoption**. Дополнительные сведения об определении статей см. в разделе [определить статью](../../../relational-databases/replication/publish/define-an-article.md).  
  
2.  Назначьте диапазоны для столбцов идентификаторов в статье на подписчике, чтобы избежать возникновения конфликтов при обновлении подписчиков. Дополнительные сведения см. в разделе о назначении диапазонов для ручного управления диапазонами идентификаторов в разделе [репликации столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md).  
  
#### Включение автоматического управления диапазонами идентификаторов при определении статей для публикации слиянием  
  
1.  На издателе в базе данных публикации выполните хранимую процедуру [sp_addmergearticle](../../../relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql.md). Если в публикуемой исходной таблице есть столбец идентификаторов, укажите значение **автоматически** для **@identityrangemanagementoption**, диапазон значений идентификаторов, назначенный серверной подпиской для **@pub_identity_range**, диапазон значений идентификаторов, назначенный издателю и каждой подписки клиента **@identity_range**, и процент общего числа значений идентификаторов используется перед назначением нового диапазона идентификаторов для **@threshold**. Дополнительные сведения о при назначены новые диапазоны идентификаторов см в разделе Назначение диапазонов идентификаторов [репликации столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md). Дополнительные сведения об определении статей см. в разделе [определить статью](../../../relational-databases/replication/publish/define-an-article.md).  
  
    > [!NOTE]  
    >  Убедитесь, что тип данных столбца идентификаторов достаточно большой, чтобы поддерживать полный диапазон идентификаторов, назначаемый всем подписчикам, особенно для подписчиков с серверными подписками.  
  
#### Отключение автоматического управления диапазонами идентификаторов при определении статей для публикации слиянием  
  
1.  На издателе в базе данных публикации выполните хранимую процедуру [sp_addmergearticle](../../../relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql.md). Укажите одно из следующих значений в параметре **@identityrangemanagementoption**:  
  
    -   **вручную** -диапазоны идентификаторов должны назначаться вручную для обновления подписчиков.  
  
    -   **Нет** -столбцы идентификаторов на издателе не будут определены как столбцы идентификаторов на подписчике.  
  
     Дополнительные сведения об определении статей см. в разделе [определить статью](../../../relational-databases/replication/publish/define-an-article.md).  
  
2.  Назначьте диапазоны для столбцов идентификаторов в статье на подписчике, чтобы избежать возникновения конфликтов при обновлении подписчиков.  
  
#### Изменение настроек автоматического управления диапазонами идентификаторов для существующей статьи в публикации моментального снимка или публикации транзакций  
  
1.  На издателе в базе данных публикации выполните хранимую процедуру [sp_helparticle](../../../relational-databases/system-stored-procedures/sp-helparticle-transact-sql.md) и обратите внимание на значение **identityrangemanagementoption** в результирующем наборе. Если это значение равно **0**, автоматическое управление диапазонами идентификаторов отключено.  
  
2.  Если значение **identityrangemanagementoption** в результирующем наборе равно **1**, измените настройки следующим образом.  
  
    -   Чтобы изменить назначенные диапазоны идентификаторов, выполните [sp_changearticle](../../../relational-databases/system-stored-procedures/sp-changearticle-transact-sql.md) на издателе в базе данных публикации. Укажите значение **identity_range** или **pub_identity_range** для **@property** и новое значение диапазона **@value**.  
  
    -   Чтобы изменить назначение новых диапазонов порогового значения, выполните [sp_changearticle](../../../relational-databases/system-stored-procedures/sp-changearticle-transact-sql.md) на издателе в базе данных публикации. Укажите значение **threshold** в параметре **@property** и задайте новое значение порога в параметре **@value**.  
  
#### Изменение настроек автоматического управления диапазонами идентификаторов для существующей статьи в публикации слиянием  
  
1.  На издателе в базе данных публикации выполните хранимую процедуру [sp_helpmergearticle](../../../relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql.md) и обратите внимание на значение **identity_support** в результирующем наборе. Если это значение равно **0**, автоматическое управление диапазонами идентификаторов отключено.  
  
2.  Если значение **identity_support** в результирующем наборе равно **1**, измените параметры следующим образом:  
  
    -   Чтобы изменить назначенные диапазоны идентификаторов, выполните [sp_changemergearticle](../../../relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql.md) на издателе в базе данных публикации. Укажите значение **identity_range** или **pub_identity_range** для **@property** и новое значение диапазона **@value**.  
  
    -   Чтобы изменить назначение новых диапазонов порогового значения, выполните [sp_changemergearticle](../../../relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql.md) на издателе в базе данных публикации. Укажите значение **threshold** в параметре **@property** и задайте новое значение порога в параметре **@value**. Дополнительные сведения о при назначены новые диапазоны идентификаторов см в разделе Назначение диапазонов идентификаторов [репликации столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md).  
  
    -   Чтобы отключить автоматическое управление диапазонами идентификаторов, выполните [sp_changemergearticle](../../../relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql.md) на издателе в базе данных публикации. Укажите значение **identityrangemanagementoption** в параметре **@property** и значение **manual** или **none** в параметре **@value**.  
  
## См. также:  
 [Одноранговая репликация транзакций](../../../relational-databases/replication/transactional/peer-to-peer-transactional-replication.md)   
 [Основные понятия системных хранимых процедур репликации](../../../relational-databases/replication/concepts/replication-system-stored-procedures-concepts.md)   
 [Репликация столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md)  
  
  