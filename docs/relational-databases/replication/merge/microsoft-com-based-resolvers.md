---
title: "Сопоставители на базе технологии Microsoft COM | Microsoft Docs"
ms.custom: ""
ms.date: "03/23/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "replication"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "сопоставители на базе технологии COM [репликация SQL Server]"
  - "пользовательские сопоставители [репликация SQL Server]"
ms.assetid: a6637e4b-4e6b-40aa-bee6-39d98cc507c8
caps.latest.revision: 38
author: "BYHAM"
ms.author: "rickbyh"
manager: "jhubbard"
---
# Сопоставители на базе технологии Microsoft COM
  Все сопоставители, основанные на технологии COM и поставляемые с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], обрабатывают конфликты обновления, а там, где это оговорено специально, они также обрабатывают конфликты вставки и удаления. Все арбитры производят отслеживание столбцов; большинство из них также производят отслеживание строк. Эти и все другие основанные на технологии COM сопоставители объявляют типы конфликтов, которые они обрабатывают, а для всех остальных типов конфликтов агент слияния использует сопоставитель по умолчанию.  
  
 Сопоставители устанавливаются во время процесса установки [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Выполнение **sp_enumcustomresolvers** хранимой процедуры для просмотра всех арбитров конфликтов, зарегистрированных на компьютере. При выполнении этой процедуры отображаются описание и глобальный уникальный идентификатор (GUID) для каждого сопоставителя в отдельном результирующем наборе.  
  
 Чтобы указать сопоставитель, см. [Specify a Merge Article Resolver](../../../relational-databases/replication/publish/specify-a-merge-article-resolver.md).  
  
 В следующей таблице описываются атрибуты конкретных сопоставителей.  
  
|Название|Требуемые входные данные|Описание|Комментарии|  
|----------|--------------------|-----------------|--------------|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий суммирование|Имя суммируемого столбца. Он должен иметь к арифметическому типу данных (таких как **int**, **smallint**, **числовое**, и так далее).|Победитель в конфликте определяется по значению приоритета. Указанные значения столбца устанавливаются равными сумме значений исходного столбца и целевого столбца. Если одно из значений — NULL, итоговое значение устанавливается равным значению другого столбца.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий усреднение|Имя усредняемого столбца. Он должен иметь к арифметическому типу данных (таких как **int**, **smallint**, **числовое**, и так далее).|Победитель в конфликте определяется по значению приоритета. Значения результирующего столбца устанавливаются равными среднему значению от значений исходного и целевого столбца. Если одно из значений — NULL, итоговое значение устанавливается равным значению другого столбца.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Сопоставитель конфликтов типа DATETIME (побеждает более раннее значение)|Имя столбца, применяемого для определения победителя конфликта. Столбец должен иметь тип данных **datetime** .|Конфликт разрешается в пользу столбца с более ранним значением **datetime** . Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов. Значения столбцов сравниваются напрямую, и поправка на разницу в часовых поясах не производится.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Сопоставитель конфликтов типа DATETIME (побеждает более позднее)|Имя столбца, применяемого для определения победителя конфликта. Столбец должен иметь тип данных **datetime** .|Конфликт разрешается в пользу столбца с более поздним значением **datetime** . Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий максимум|Имя столбца, применяемого для определения победителя конфликта. Он должен иметь к арифметическому типу данных (таких как **int**, **smallint**, **числовое**, и так далее).|Столбец с большим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает отслеживание строк и столбцов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий минимум|Имя столбца, применяемого для определения победителя конфликта. Он должен иметь к арифметическому типу данных (таких как **int**, **smallint**, **числовое**, и так далее).|Столбец с меньшим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий слияние текста|Имя текстового столбца и разделитель, например `@resolver_info = '[col1][===]'`.|Победитель в конфликте определяется по значению приоритета. Конфликтующие текстовые столбцы устанавливаются равными объединенному значению, состоящему из общего префикса, за которым следует уникальная часть от издателя, затем следует разделитель, а затем — уникальная часть от подписчика.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] с победой подписчика|Нет входных данных.|Конфликт разрешается в пользу подписчика, независимо от того является он источником или пунктом назначения.|Поддерживает все типы конфликтов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий приоритетный столбец|Имя столбца, применяемого для определения победителя конфликта. Он должен иметь к арифметическому типу данных (таких как **int**, **smallint**, **числовое**, и так далее).|Столбец с большим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий только передачу|Нет входных данных.|Принимаются изменения, переданные на издатель; изменения не загружаются на подписчик.|Поддерживает все типы конфликтов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий только загрузку|Нет входных данных.|Отклоняются изменения, переданные на издатель; изменения загружаются на подписчик.|Поддерживает все типы конфликтов.|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] SQL Server|Имя хранимой процедуры, которую должен вызвать сопоставитель для разрешения конфликта.|Устранение конфликта зависит от логики указываемой хранимой процедуры.|Поддерживает конфликты обновления. Дополнительные сведения см. в разделе [Реализация пользовательского арбитра конфликтов для статьи слияния](../../../relational-databases/replication/implement-a-custom-conflict-resolver-for-a-merge-article.md)|  
  
## См. также:  
 [Расширенное обнаружение и разрешение конфликтов репликации слиянием](../../../relational-databases/replication/merge/advanced-merge-replication-conflict-detection-and-resolution.md)   
 [sp_enumcustomresolvers & #40; Transact-SQL и #41;](../../../relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql.md)  
  
  