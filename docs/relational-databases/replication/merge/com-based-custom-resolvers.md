---
title: "Пользовательские сопоставители на основе технологии COM | Microsoft Docs"
ms.custom: ""
ms.date: "03/23/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "replication"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "сопоставители на базе технологии COM [репликация SQL Server]"
  - "пользовательские сопоставители [репликация SQL Server]"
ms.assetid: 94195797-ad7a-4962-a8e3-b259cd13aa38
caps.latest.revision: 36
author: "BYHAM"
ms.author: "rickbyh"
manager: "jhubbard"
---
# Пользовательские сопоставители на основе технологии COM
  Пользовательские сопоставители предоставляют большую гибкость по сравнению с механизмом разрешения конфликтов по умолчанию, и они могут реализовать бизнес-логику, необходимую для приложений, использующих реплицированные данные. Пользовательский арбитр конфликтов на основе COM является библиотека динамической компоновки (DLL), реализующий **ICustomResolver** COM-интерфейса, его методы и свойства и другие поддерживаемые интерфейсы и определения типов, разработанные специально для разрешения конфликтов.  
  
> [!NOTE]  
>  Рекомендуется использовать обработчик бизнес-логики вместо пользовательского сопоставителя на основе COM, если это возможно. Дополнительные сведения об обработчиках бизнес-логики см. в разделе [выполнение бизнес логики во время слияния синхронизации](../../../relational-databases/replication/merge/execute-business-logic-during-merge-synchronization.md).  
  
 Для создания пользовательского COM-сопоставителя можно использовать библиотеку типов, которая содержится в файле replrec.dll. По умолчанию эта библиотека устанавливается в каталог [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.  
  
 Перед написанием пользовательского COM-сопоставителя необходимо определиться по следующим вопросам:  
  
-   Типы изменений строк, конфликты которых необходимо разрешить, например обновления, вставки и удаления, а также, должен ли сопоставитель вызываться во время передачи изменений слияния, загрузки изменений слияния, или его необходимо вызывать в обеих ситуациях. Можно указать один тип изменений, все изменения, или любое их сочетание. Сопоставитель конфликтов слияния по умолчанию обрабатывает любые конфликты, не охваченные пользовательским арбитром конфликтов.  
  
-   Надо ли использовать отслеживание столбца при разрешении конфликта. Когда включено отслеживание на уровне столбцов, только данные в тех столбцах, где существует конфликт, помечаются как конфликт, иначе данные объединяются. Однако конфликты разрешаются таким же способом, как и при отслеживании на уровне строк: победитель по приоритету перезаписывает всю строку данных (однако данные могут быть смесью значений от издателя, подписчиков или измененными значениями, которые не были получены ни от издателя, ни от подписчиков). Дополнительные сведения см. в статье [Detect and Resolve Merge Replication Conflicts](../../../relational-databases/replication/merge/detect-and-resolve-merge-replication-conflicts.md).  
  
 Для реализации арбитра конфликтов на основе COM, разделе [Реализация пользовательского арбитра конфликтов для статьи слияния](../../../relational-databases/replication/implement-a-custom-conflict-resolver-for-a-merge-article.md).  
  
 Пользовательский сопоставитель указывается для статьи, а не для всей публикации. Тот же самый сопоставитель может использоваться с более чем одной статьей, однако логика разрешения конфликтов в пользовательских сопоставителях часто характерна для определенной таблицы. Если используемая в статье таблица изменена после создания сопоставителя (например, изменено имя столбца, используемого при устранении конфликта), может потребоваться изменение и повторная компиляция пользовательского сопоставителя.  
  
 Чтобы указать пользовательский сопоставитель, см. раздел [Specify a Merge Article Resolver](../../../relational-databases/replication/publish/specify-a-merge-article-resolver.md).  
  
## См. также:  
 [Расширенное обнаружение и разрешение конфликтов репликации слиянием](../../../relational-databases/replication/merge/advanced-merge-replication-conflict-detection-and-resolution.md)   
 [Сопоставители на базе технологии Microsoft COM](../../../relational-databases/replication/merge/microsoft-com-based-resolvers.md)  
  
  