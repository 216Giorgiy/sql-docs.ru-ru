---
title: "Настройка клиента для SSL-шифрования | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: ae34cd1f-3569-4759-80c7-7c9b33b3e9eb
caps.latest.revision: 17
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: a5c395fcd8ae12a91db5dcd7bf26f8d81589d2f6
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="configuring-the-client-for-ssl-encryption"></a>Настройка SSL-шифрования на клиенте
[!INCLUDE[Driver_JDBC_Download](../../includes/driver_jdbc_download.md)]

  [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] Или клиент должен проверить, что сервер — правильный сервер и его сертификат выдан центром сертификации, которому доверяет клиент. Чтобы проверить сертификат сервера, необходимо при соединении предоставить данные о доверии. Кроме того, поставщик сертификата сервера должен быть центром сертификации, которому доверяет клиент.  
  
 В начале этого раздела описано, как задать материал доверия на клиентском компьютере. Далее в этом разделе приведено описание того, как импортировать сертификат сервера в хранилище доверия клиентского компьютера, если экземпляр сертификата SSL для SQL Server выдан закрытым центром сертификации.  
  
 Дополнительные сведения о проверке сертификата сервера см. в разделе Проверка SSL-сертификата сервера в [основные сведения о поддержке SSL](../../connect/jdbc/understanding-ssl-support.md).  
  
## <a name="configuring-the-client-trust-store"></a>Настройка клиентского хранилища доверия  
 Проверка сертификата сервера требует, что материал доверия должен указываться во время установления соединения с помощью **trustStore** и **trustStorePassword** свойства соединения явно, или с помощью неявно с помощью хранилища доверия базовой виртуальной машины Java (JVM) по умолчанию. Дополнительные сведения о настройке **trustStore** и **trustStorePassword** свойства в строке подключения, в разделе [подключение с шифрованием SSL](../../connect/jdbc/connecting-with-ssl-encryption.md).  
  
 Если **trustStore** свойство имеет значение null не задано или задано значение [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] основаны на поставщик безопасности базовой JVM, расширение защищенного сокета Java (SunJSSE). Поставщик SunJSSE предоставляет значение по умолчанию TrustManager, который используется для проверки сертификатов X.509, возвращенные SQL Server к материалу доверия, предоставленному в хранилище доверия.  
  
 TrustManager пытается найти trustStore по умолчанию в следующем порядке:  
  
-   Если определено системное свойство «javax.net.ssl.trustStore» TrustManager пытается найти файл trustStore по умолчанию, с именем, указанным этим системным свойством.  
  
-   Если не указано свойство системы «javax.net.ssl.trustStore», а файл «\<java-home >/lib/безопасность/jssecacerts» существует, этот файл используется.  
  
-   Если файл «\<java-home >/lib/безопасность/cacerts» существует, этот файл используется.  
  
 Дополнительные сведения см. в документации интерфейса SUNX509 TrustManager на веб-сайте Sun Microsystems.  
  
 Среда выполнения Java позволяет задавать системные свойства trustStore и trustStorePassword следующим образом.  
  
```  
java -Djavax.net.ssl.trustStore=C:\MyCertificates\storeName  
java -Djavax.net.ssl.trustStorePassword=storePassword  
```  
  
 В этом случае любое приложение, запущенное на данной виртуальной машине JVM, будет использовать данные параметры по умолчанию. Чтобы переопределить параметры по умолчанию в приложении, следует задать **trustStore** и **trustStorePassword** свойства соединения в строке соединения или в соответствующую метод задания свойства [SQLServerDataSource](../../connect/jdbc/reference/sqlserverdatasource-class.md) класса.  
  
 Кроме того, можно настроить и управлять файлами хранилища доверия по умолчанию, такие как «\<java-home >/lib/безопасность/jssecacerts» и «\<java-home >/lib/безопасность/cacerts». Для этого предназначена программа JAVA «keytool», которая устанавливается вместе со средой выполнения Java (JRE). Дополнительные сведения о программе «keytool» см. в документации по keytool на веб-сайте Sun Microsystems.  
  
### <a name="importing-the-server-certificate-to-trust-store"></a>Импорт сертификата сервера в хранилище доверия  
 Во время SSL-подтверждения сервер отправляет свой сертификат открытого ключа клиенту. Поставщик сертификата открытого ключа называется центром сертификации (ЦС). Клиент должен убедиться, что рассматриваемый центр сертификации является для клиента доверенным. Для этого заранее изучаются открытые ключи доверенных центров сертификации. JVM обычно поставляется со стандартным набором доверенных центров сертификации.  
  
 Если используемый экземпляр сертификата SSL для SQL Server выдан закрытым центром сертификации, то необходимо добавить этот сертификат центра сертификации к списку доверенных сертификатов в хранилище доверия клиентского компьютера.  
  
 Для этого используется программа JAVA «keytool», которая устанавливается со средой выполнения Java (JRE). В следующей командной строке показано, как использовать программу «keytool» для импорта сертификата из файла.  
  
```  
keytool -import -v -trustcacerts -alias myServer -file caCert.cer -keystore truststore.ks  
```  
  
 В этом примере в качестве файла сертификата используется файл «caCert.cer». Этот файл сертификата необходимо получить с сервера. Следующие шаги показывают, как экспортировать сертификат сервера в файл.  
  
1.  Нажмите «Пуск», затем «Выполнить» и введите MMC. (MMC — сокращение от Microsoft Management Console, консоль управления Microsoft.)  
  
2.  В программе MMC откройте окно «Сертификаты».  
  
3.  Разверните элемент «Личный», затем «Сертификаты».  
  
4.  Щелкните правой кнопкой мыши сертификат сервера и выберите «Все задачи/Экспорт».  
  
5.  Нажмите кнопку «Далее», чтобы перейти к окну, которое следует за диалоговым окном приветствия мастера экспорта сертификатов.  
  
6.  Убедитесь, что выбрано значение «Нет, не экспортировать закрытый ключ», затем нажмите «Далее».  
  
7.  Выберите либо двоичное значение в DER-кодировке X.509 (.CER), либо в Base64-кодировке X.509 (.CER) и нажмите кнопку «Далее».  
  
8.  Введите имя файла для экспорта.  
  
9. Нажмите кнопку «Далее», затем нажмите кнопку «Готово», чтобы экспортировать сертификат.  
  
## <a name="see-also"></a>См. также:  
 [С помощью шифрования SSL](../../connect/jdbc/using-ssl-encryption.md)   
 [Защита приложений драйвера JDBC](../../connect/jdbc/securing-jdbc-driver-applications.md)  
  
  
