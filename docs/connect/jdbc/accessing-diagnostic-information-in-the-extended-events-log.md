---
title: "Доступ к диагностическим сведениям в журнале расширенных событий | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: a79e9468-2257-4536-91f1-73b008c376c3
caps.latest.revision: 16
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: e6dfbd857905f0c0f444c44a9c9eb9813cc32ab2
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="accessing-diagnostic-information-in-the-extended-events-log"></a>Доступ к диагностическим сведениям в журнале расширенных событий
[!INCLUDE[Driver_JDBC_Download](../../includes/driver_jdbc_download.md)]

  В [!INCLUDE[jdbc_40](../../includes/jdbc_40_md.md)]трассировка ([трассировки драйвера за](../../connect/jdbc/tracing-driver-operation.md)) был обновлен для упрощения упростить сопоставление событий клиентов с диагностической информацией — ошибками соединения, из кольца подключения сервера буфер и приложение сведениями о производительности в журнале расширенных событий. Дополнительные сведения о чтении журнала расширенных событий см. в разделе [View Event Session Data](http://msdn.microsoft.com/library/hh710068(SQL.110).aspx).  
  
## <a name="details"></a>Сведения  
 Для операций подключения [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] будет отправлять клиенту идентификатор соединения. Если подключение завершилось ошибкой, то можно в кольцевом буфере подключений ([Устранение связанных с подключением неполадок в SQL Server 2008 с использованием кольцевого буфера подключений](http://go.microsoft.com/fwlink/?LinkId=207752)) найти поле **ClientConnectionID** и получить диагностические данные по ошибке подключения. Идентификаторы подключений клиентов регистрируются в кольцевом буфере только при возникновении ошибки. (Если подключение завершилось сбоем до отправки предварительного пакета входа, то идентификатор подключения клиента не формируется.) Идентификатор клиентского соединения — это 16-байтовый идентификатор GUID. Соединения клиента можно также найти идентификатор в выводе расширенных событий, если **client_connection_id** действия добавляется к событиям в сеансе расширенных событий. Включить трассировку и снова запустите команду соединения и просмотрите **ClientConnectionID** поля в трассировку, если вам нужна дополнительная помощь в диагностике драйвера клиента.  
  
 Клиента можно получить идентификатор соединения программным путем с помощью [ISQLServerConnection, интерфейс](../../connect/jdbc/reference/isqlserverconnection-interface.md). Идентификатор соединения также содержится во всех связанных с соединением исключениях.  
  
 В случае ошибки соединения идентификатор соединения клиента в трассировочной информации BID сервера и в кольцевом буфере соединений поможет сопоставить клиентские соединения с соединениями на сервере. Дополнительные сведения о BID трассировки на сервере, см. в разделе [трассировка доступа к данным](http://go.microsoft.com/fwlink/?LinkId=125805). Обратите внимание, что данные в статье о трассировке доступа также содержит сведения о выполнении трассировки доступа к данным, которые не применяются к [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)]; в разделе [трассировки драйвера за](../../connect/jdbc/tracing-driver-operation.md) сведения о выполнении трассировки доступа к данным с помощью [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)].  
  
 Драйвер JDBC также отсылает идентификатор действия определенного процесса. Идентификатор активности регистрируется в сеансах расширенных событий, если сеанс запущен со включенным параметром TRACK_CAUSAILITY. В случае проблем с производительностью активного соединения получить идентификатор действия можно из трассировки клиента (поле ActivityID), а затем найти этот идентификатор действия в выходных данных расширенных событий. Идентификатором действия в расширенных событиях является 16-байтовый идентификатор GUID (который отличается от идентификатора GUID соединения клиента), к которому добавляется порядковый номер из четырех байт. Этот порядковый номер представляет порядок запроса в потоке. Значение ActivityId отправляется для пакетных инструкций SQL и запросов RPC. Чтобы включить отправку значения ActivityId на сервер, сначала необходимо указать следующую пару «ключ-значение» в файле Logging.Properties:  
  
```  
com.microsoft.sqlserver.jdbc.traceactivity = on  
```  
  
 Любое значение, отличное от `on` (учитывается регистр) отключает отправку ActivityId.  
  
 Дополнительные сведения см. в разделе [Трассировка операций драйвера](../../connect/jdbc/tracing-driver-operation.md). Этот флаг трассировки используется совместно с соответствующими средствами ведения журнала объектов JDBC для определения того, следует ли выполнять трассировку и отправку значения ActivityId в драйвере JDBC. Помимо внесения изменений в файл Logging.Properties необходимо включить средство ведения журнала com.microsoft.sqlserver.jdbc на уровне FINER или более высоком уровне. Если требуется отправлять значение ActivityId на сервер в отношении запросов, выполняемых определенным классом, необходимо включить средство ведения журнала соответствующего класса на уровне FINER или FINEST. Например, если классом является класс SQLServerStatement, включите средство ведения журнала com.microsoft.sqlserver.jdbc.SQLServerStatement.  
  
 Ниже приведен пример, использующий [!INCLUDE[tsql](../../includes/tsql_md.md)] для запуска сеанса расширенных событий, который будет храниться в кольцевой буфер и будет записывать Идентификаторы действий, отправляемые с клиента на RPC и пакетных операций:  
  
```  
create event session MySession on server  
add event connectivity_ring_buffer_recorded,  
add event sql_statement_starting (action (client_connection_id)),  
add event sql_statement_completed (action (client_connection_id)),  
add event rpc_starting (action (client_connection_id)),  
add event rpc_completed (action (client_connection_id))  
add target ring_buffer with (track_causality=on)  
```  
  
## <a name="see-also"></a>См. также:  
 [Диагностика проблем с драйвером JDBC](../../connect/jdbc/diagnosing-problems-with-the-jdbc-driver.md)  
  
  
