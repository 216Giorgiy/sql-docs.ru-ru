---
title: "Ведение журнала | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- logging activity
ms.assetid: a777b3d9-2262-4e82-bc82-b62ad60d0e55
caps.latest.revision: 32
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: d748bac061fdd4b76b1df0b9a6cf0a8101f21092
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="logging-activity"></a>Ведение журнала
[!INCLUDE[Driver_PHP_Download](../../includes/driver_php_download.md)]

По умолчанию ошибки и предупреждения, созданные [!INCLUDE[ssDriverPHP](../../includes/ssdriverphp_md.md)] , не регистрируются в журнале. Эта статья описывает, как настроить ведение журнала.  
  
## <a name="logging-activity-using-the-pdosqlsrv-driver"></a>Ведение журнала с помощью драйвера PDO_SQLSRV  
Единственной конфигурацией, доступной для драйвера PDO_SQLSRV, является запись pdo_sqlsrv.log_severity в файле php.ini.  
  
Добавьте следующий код в конец файла php.ini:  
  
```  
[pdo_sqlsrv]  
pdo_sqlsrv.log_severity = <number>  
```  
  
**log_severity** может являться одним из следующих значений:  
  
|Значение|Описание|  
|---------|---------------|  
|0|Ведение журнала отключено (значение по умолчанию, если не указано иное).|  
|-1|Указывает, что будут регистрироваться ошибки, предупреждения и уведомления.|  
|1|Указывает, что будут регистрироваться ошибки.|  
|2|Указывает, что будут регистрироваться предупреждения.|  
|4|Указывает, что будут регистрироваться уведомления.|  
  
Сведения о ведении журнала будут добавляться в файл phperrors.log.  
  
PHP считывает файл конфигурации при инициализации и сохраняет данные в кэш. Он также предоставляет API для обновления этих параметров и оперативного использования, который записывается в файл конфигурации. Этот API позволяет скриптам приложений изменить параметры даже после инициализации PHP.  
  
## <a name="logging-activity-using-the-sqlsrv-driver"></a>Ведение журнала с помощью драйвера SQLSRV  
Чтобы включить ведение журнала, можно использовать функцию [sqlsrv_configure](../../connect/php/sqlsrv-configure.md) или изменить файл php.ini. Вы можете вести журнал для инициализаций, соединений, инструкций или функций ошибок. Также можно указать, следует ли вести журналы ошибок, предупреждений и (или) уведомлений.  
  
> [!NOTE]  
> Расположение файла журнала можно настроить в файле php.ini.  
  
### <a name="turning-logging-on"></a>Включение ведения журнала  
Вы можете включить ведение журнала, воспользовавшись функцией [sqlsrv_configure](../../connect/php/sqlsrv-configure.md) , чтобы указать значение для параметра **LogSubsystems** . Например, следующая строка кода настраивает драйвер на регистрацию событий для соединений:  
  
`sqlsrv_configure("LogSubsystems", SQLSRV_LOG_SYSTEM_CONN);`  
  
Следующая таблица содержит константы, которые можно использовать в качестве значения для параметра **LogSubsystems** :  
  
|Значение (целочисленный эквивалент в скобках)|Description|  
|-----------------------------------------------|---------------|  
|SQLSRV_LOG_SYSTEM_ALL (-1)|Включает ведения журнала для всех подсистем.|  
|SQLSRV_LOG_SYSTEM_OFF (0)|Отключает ведение журнала. Это значение по умолчанию.|  
|SQLSRV_LOG_SYSTEM_INIT (1)|Включает ведения журнала по инициализации.|  
|SQLSRV_LOG_SYSTEM_CONN (2)|Включает ведения журнала по соединениям.|  
|SQLSRV_LOG_SYSTEM_STMT (4)|Включает ведения журнала по инструкциям.|  
|SQLSRV_LOG_SYSTEM_UTIL (8)|Включает ведение журнала по функция ошибок (таким как handle_error и handle_warning).|  
  
Можно задать более одного значения во время для **LogSubsystems** задание с помощью логического оператора OR (|). Например, следующая строка кода включает ведение журнала как для соединений, так и для инструкций:  
  
`sqlsrv_configure("LogSubsystems", SQLSRV_LOG_SYSTEM_CONN | SQLSRV_LOG_SYSTEM_STMT);`  
  
Вы также можете включить ведение журнала, указав целочисленное значение для параметра **LogSubsystems** в файле php.ini. Например, при добавлении следующей строки в раздел `[sqlsrv]` файла php.ini ведение журнала включается для соединений:  
  
`sqlsrv.LogSubsystems = 2`  
  
Путем сложения целочисленных значений можно указать сразу несколько параметров. Например, при добавлении следующей строки в раздел `[sqlsrv]` файла php.ini ведение журнала включается для соединений и инструкций:  
  
`sqlsrv.LogSubsystems = 6`  
  
### <a name="logging-errors-warnings-and-notices"></a>Ведение журнала ошибок, предупреждений и уведомлений  
После включения ведения журнала необходимо указать, что именно следует регистрировать. Можно записывать в журнал один или несколько следующих элементов: ошибки, предупреждения и уведомления. Например, следующая строка кода задает регистрацию только предупреждений:  
  
`sqlsrv_configure("LogSeverity", SQLSRV_LOG_SEVERITY_WARNING);`  
  
> [!NOTE]  
> Значение по умолчанию для **LogSeverity** — **SQLSRV_LOG_SEVERITY_ERROR**. Если ведение журнала включено, а значение для **LogSeverity** не указано, регистрируются только ошибки.  
  
Следующая таблица содержит константы, которые можно использовать в качестве значения для параметра **LogSeverity** :  
  
|Значение (целочисленный эквивалент в скобках)|Description|  
|-----------------------------------------------|---------------|  
|SQLSRV_LOG_SEVERITY_ALL (-1)|Указывает, что будут регистрироваться ошибки, предупреждения и уведомления.|  
|SQLSRV_LOG_SEVERITY_ERROR (1)|Указывает, что будут регистрироваться ошибки. Это значение по умолчанию.|  
|SQLSRV_LOG_SEVERITY_WARNING (2)|Указывает, что будут регистрироваться предупреждения.|  
|SQLSRV_LOG_SEVERITY_NOTICE (4)|Указывает, что будут регистрироваться уведомления.|  
  
Можно задать более одного значения во время для **LogSeverity** задание с помощью логического оператора OR (|). Например, следующая строка кода задает регистрацию ошибок и предупреждений:  
  
`sqlsrv_configure("LogSeverity", SQLSRV_LOG_SEVERITY_ERROR | SQLSRV_LOG_SEVERITY_WARNING);`  
  
> [!NOTE]  
> Указание значения для параметра **LogSeverity** не включает ведение журнала. Необходимо включить ведение журнала, указав значение для параметра **LogSubsystems** , а затем указать уровень серьезности регистрируемых сведений, задав значение для **LogSeverity**.  
  
Значение для параметра **LogSeverity** Можно также указать с помощью целочисленных значений в файле php.ini. Например, при добавлении следующей строки в раздел `[sqlsrv]` файла php.ini ведение журнала включается только для предупреждений:  
  
`sqlsrv.LogSeverity = 2`  
  
Путем сложения целочисленных значений можно указать сразу несколько параметров. Например, при добавлении следующей строки в раздел `[sqlsrv]` файла php.ini ведение журнала включается для ошибок и предупреждений:  
  
`sqlsrv.LogSeverity = 3`  
  
## <a name="see-also"></a>См. также:  
[Руководство по программированию для драйвера PHP SQL](../../connect/php/programming-guide-for-php-sql-driver.md)
[константы &#40; Драйверы Майкрософт для PHP для SQL Server &#41;](../../connect/php/constants-microsoft-drivers-for-php-for-sql-server.md)  
[sqlsrv_configure](../../connect/php/sqlsrv-configure.md)  
[sqlsrv_get_config](../../connect/php/sqlsrv-get-config.md)  
[Справочник по API для драйвера SQLSRV](../../connect/php/sqlsrv-driver-api-reference.md)  
  

