---
title: Поддержка разреженных столбцов в драйвере OLE DB для SQL Server | Документы Microsoft
description: Поддержка разреженных столбцов в драйвер OLE DB для SQL Server
ms.custom: ''
ms.date: 06/12/2018
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.component: oledb|features
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: reference
helpviewer_keywords:
- sparse columns, OLE DB Driver for SQL Server
- sparse columns, OLE DB
author: pmasl
ms.author: Pedro.Lopes
manager: craigg
ms.openlocfilehash: d8e0139f126760cd62b44d699d8a0eef4fbaee38
ms.sourcegitcommit: 354ed9c8fac7014adb0d752518a91d8c86cdce81
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/14/2018
ms.locfileid: "35612010"
---
# <a name="sparse-columns-support-in-ole-db-driver-for-sql-server"></a>Поддержка разреженных столбцов в драйвере OLE DB для SQL Server
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-asdbmi-md](../../../includes/appliesto-ss-asdb-asdw-pdw-asdbmi-md.md)]

[!INCLUDE[Driver_OLEDB_Download](../../../includes/driver_oledb_download.md)]

  Драйвер OLE DB для SQL Server поддерживает разреженные столбцы. Дополнительные сведения о разреженных столбцах в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], в разделе [Использование разреженных столбцов](../../../relational-databases/tables/use-sparse-columns.md) и [использование наборов столбцов](../../../relational-databases/tables/use-column-sets.md).  
  
 Дополнительные сведения о поддержке разреженных столбцов в драйвер OLE DB для SQL Server [поддерживает разреженные столбцы &#40;OLE DB&#41;](../../oledb/ole-db/sparse-columns-support-ole-db.md).  
  
 Сведения о примерах приложений, которые демонстрируют эту функцию, см. в разделе [Образцы программирования для SQL Server](http://msftdpprodsamples.codeplex.com/).  
  
## <a name="user-scenarios-for-sparse-columns-and-ole-db-driver-for-sql-server"></a>Пользовательские сценарии для разреженных столбцов и драйвер OLE DB для SQL Server  
 В таблице ниже приведены обычные пользовательские сценарии драйвер OLE DB для SQL Server пользователей с разреженными столбцами:  
  
|Сценарий|Поведение|  
|--------------|--------------|  
|**Выберите \* из таблицы** или IOpenRowset::OpenRowset.|Возвращает все столбцы, которые не являются членами разреженного **column_set**, а также XML-столбец, содержащий значения всех ненулевых столбцов, которые являются членами разреженного **column_set**.|  
|Ссылка на столбец по имени.|На столбец можно ссылаться независимо от состояния разреженности или **column_set** членства.|  
|Доступ **column_set** столбцов члена с помощью вычисляемого столбца XML.|Столбцы, которые являются членами разреженного **column_set** может осуществляться путем выбора **column_set** по имени и могут иметь значения вставляются и обновляются при обновлении XML в **column_set** столбца.<br /><br /> Значение должно соответствовать схеме для **column_set** столбцов.|  
|Получение метаданных для всех столбцов в таблице при помощи набора строк схемы DBSCHEMA_COLUMNS без ограничений столбца (OLE DB).|Возвращает строку для всех столбцов, которые не являются членами **column_set**. Если таблица содержит разреженный **column_set**, для него будет возвращена строка.<br /><br /> Обратите внимание, что это не возвращает метаданные для столбцов, которые являются членами **column_set**.|  
|Получение метаданных для всех столбцов, независимо от разреженности или вхождения в **column_set**. В этом случае может вернуться очень большое число строк.|При вызове IDBSchemaRowset::GetRowset набора строк схемы DBSCHEMA_COLUMNS_EXTENDED.|  
|Получить метаданные только для столбцов, которые являются членами **column_set**. В этом случае может вернуться очень большое число строк.|При вызове IDBSchemaRowset::GetRowset набора строк схемы DBSCHEMA_SPARSE_COLUMN_SET.|  
|Определение, является ли столбец разреженным.|Обратитесь к столбцу SS_IS_SPARSE результирующего набора строк схемы DBSCHEMA_COLUMNS (ODBC).|  
|Определить, является ли столбец **column_set**.|Обратитесь к столбцу SS_IS_COLUMN_SET набора строк схемы DBSCHEMA_COLUMNS. Или обратитесь к *dwFlags* возвращаемый IColumnsinfo::GetColumnInfo или DBCOLUMNFLAGS в наборе строк, возвращенных IColumnsRowset::GetColumnsRowset. Для **column_set** столбцы, будет установлен DBCOLUMNFLAGS_SS_ISCOLUMNSET.|  
|Импорт и экспорт разреженных столбцов программой BCP для таблиц без **column_set**.|Поведение не меняется от предыдущих версий драйвера OLE DB для SQL Server.|  
|Импорт и экспорт разреженных столбцов программой BCP для таблицы с **column_set**.|**Column_set** импортируется и экспортируется таким же образом, как в XML, то есть, как **varbinary(max)** Если привязан как двоичному типу, или как **nvarchar(max)** Если привязаны как **char** или **wchar** типа.<br /><br /> Столбцы, которые являются членами разреженного **column_set** не экспортируются как отдельные столбцы, они экспортируются только в значении **column_set**.|  
|**queryout** поведение для BCP.|Без изменений в обработке явно именованных столбцов из предыдущих версий драйвера OLE DB для SQL Server.<br /><br /> Сценарии, задействующие импорт и экспорт между таблицами с различными схемами, могут потребовать специальной обработки.<br /><br /> Дополнительные сведения о программе BCP см. в подразделе «Поддержка массового копирования (BCP) для разреженных столбцов» далее в данном разделе.|  
  
## <a name="down-level-client-behavior"></a>Работа в клиентах низкого уровня  
 Клиенты низкого уровня вернут метаданные только для столбцов, которые не являются членами разреженного **column_set** SQLColumns и DBSCHMA_COLUMNS.
  
 Столбцы, которые являются членами разреженного могут получать доступ клиенты нижнего уровня **column_set** по имени и **column_set** столбец будет доступен как XML-столбец для [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] клиентов.  
  
## <a name="bulk-copy-bcp-support-for-sparse-columns"></a>Поддержка массового копирования (BCP) для разреженных столбцов  
 Нет изменений в API BCP в OLE DB для разреженных столбцов или **column_set** функции.  
  
 Если таблица имеет **column_set**, разреженные столбцы не обрабатываются как отдельные столбцы. Значения всех разреженных столбцов включаются в значение **column_set**, который экспортируется таким же образом, как XML-столбец; то есть, как **varbinary(max)** Если привязан как двоичному типу, или как  **nvarchar(max)** Если привязаны как **char** или **wchar** типа). При импорте **column_set** значение должно соответствовать схеме **column_set**.  
  
 Для **queryout** операций, не изменился для обработки явно указанным столбцам. **COLUMN_SET** столбцы имеют одинаковое поведение XML-столбцов, и разреженность не имеет значения для обработки именованных разреженных столбцов.  
  
 Однако если **queryout** используется для экспорта и можно ссылаться на разреженные столбцы, которые являются членами разреженного столбца задается имя, не удается выполнить импорт напрямую в таблицу такой же структуры. Это потому, что программа BCP использует метаданные, согласованные с **выберите \***  операции для импорта и не может сопоставить **column_set** столбцов элементов с этими метаданными. Для импорта **column_set** столбцы элементов по отдельности, необходимо определить представление на таблице, которая ссылается на нужном **column_set** столбцы, необходимо выполнить операцию импорта, с помощью представления.  
  
## <a name="see-also"></a>См. также  
 [Драйвер OLE DB для SQL Server](../../oledb/oledb-driver-for-sql-server.md)  
  
  
