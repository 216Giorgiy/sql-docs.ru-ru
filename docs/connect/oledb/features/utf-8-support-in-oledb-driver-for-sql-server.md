---
title: Поддержка UTF-8 в драйвере OLE DB для SQL Server | Документация Майкрософт
description: Поддержка UTF-8 в драйвере OLE DB для SQL Server
ms.custom: ''
ms.date: 03/27/2018
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
author: v-kaywon
ms.author: v-kaywon
ms.openlocfilehash: b7f138438d522c9da1b7ef74acbaf963e17d6144
ms.sourcegitcommit: 2db83830514d23691b914466a314dfeb49094b3c
ms.translationtype: MTE75
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2019
ms.locfileid: "58492606"
---
# <a name="utf-8-support-in-ole-db-driver-for-sql-server"></a>Поддержка UTF-8 в драйвере OLE DB для SQL Server
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

[!INCLUDE[Driver_OLEDB_Download](../../../includes/driver_oledb_download.md)]

Драйвер Microsoft OLE DB для SQL Server (версия 18.2.1) добавлена поддержка серверная кодировка UTF-8. Сведения о поддержке SQL Server UTF-8 см. в разделе:
- [Поддержка параметров сортировки и Юникода](../../../relational-databases/collations/collation-and-unicode-support.md)
- [Поддержка UTF-8](../../../sql-server/what-s-new-in-sql-server-ver15.md#utf-8-support-ctp-23)

## <a name="data-insertion-into-a-utf-8-encoded-char-or-varchar-column"></a>Вставка данных в UTF-8 в кодировке CHAR или VARCHAR столбца
При создании буфера входного параметра для вставки, буфер описан с помощью массив [структуры DBBINDING](https://go.microsoft.com/fwlink/?linkid=2071182). Каждая структура DBBINDING связывает отдельный параметр в буфере потребителя и содержит сведения, такие как длина и тип значения данных. Для буфера входного параметра типа CHAR *wType* из DBBINDING структуры должно быть присвоено DBTYPE_STR. Для буфера входного параметра типа WCHAR *wType* из DBBINDING структуры должно быть присвоено DBTYPE_WSTR.

При выполнении команды с параметрами, драйвер создает сведения о типе данных параметра. Если входной буфер типов и типов данных параметров соответствия, преобразование не выполняется в драйвере. В противном случае драйвер преобразует буфера входного параметра в тип данных параметра. Тип данных параметра может быть явным образом пользователь задал путем вызова [ICommandWithParameters::SetParameterInfo](https://go.microsoft.com/fwlink/?linkid=2071577). Если данные не указан, драйвер является производным сведения о типе данных параметра (a) получает метаданные столбца с сервера при подготовке инструкции или (б) попытки преобразования по умолчанию из типа данных входного параметра.

Буфер входного параметра преобразуется столбца параметры сортировки сервера, драйвером или сервером в зависимости от типа данных входного буфера и тип данных параметра. Во время преобразования возможна потеря данных, если в кодовой странице клиента или кодовой страницей параметров сортировки базы данных не может представлять все символы из входного буфера. В следующей таблице описаны процесс преобразования, включенный столбец Вставка данных в UTF-8:

|Тип буфера данных|Тип данных параметра|Преобразование|Меры предосторожности пользователя|
|---             |---                |---       |---            |
|DBTYPE_STR|DBTYPE_STR|Server преобразование из кодовой страницы клиента в кодовая страница параметров сортировки базы данных; Преобразование сервера из базы данных параметры сортировки кодовой страницы кодовая страница параметров сортировки столбца.|Убедитесь, кодовая страница клиента и кодовая страница параметров сортировки базы данных может представлять все символы во входных данных. Например для вставки польский символа, кодовая страница клиента может быть задано 1250 (ANSI центральноевропейские) и параметры сортировки базы данных может использовать польский как обозначение параметров сортировки (например, Polish_100_CI_AS_SC) или быть включены UTF-8.|
|DBTYPE_STR|DBTYPE_WSTR|Драйвер преобразование из кодовой страницы клиента в кодировку UTF-16; Преобразование сервера из кодировки UTF-16 в кодовую страницу параметров сортировки столбца.|Убедитесь, что кодовая страница клиента может представлять все символы во входных данных. Например чтобы вставить знак, польский, кодовая страница клиента может присвоить 1250 (ANSI центральноевропейские).|
|DBTYPE_WSTR|DBTYPE_STR|Драйвер преобразования из кодировки UTF-16 в кодовую страницу параметров сортировки базы данных; Преобразование сервера из базы данных параметры сортировки кодовой страницы кодовая страница параметров сортировки столбца.|Убедитесь, что кодовая страница параметров сортировки базы данных может представлять все символы во входных данных. Например для вставки польский символа, кодовая страница параметров сортировки базы данных может использовать польский как обозначение параметров сортировки (например, Polish_100_CI_AS_SC) или UTF-8 включено.|
|DBTYPE_WSTR|DBTYPE_WSTR|Server преобразование из UTF-16 в кодовую страницу параметров сортировки столбца.|Нет.|

## <a name="data-retrieval-from-a-utf-8-encoded-char-or-varchar-column"></a>Получение данных из UTF-8 в кодировке CHAR или VARCHAR столбца
При создании буфера для извлеченных данных, буфер описан с помощью массив [структуры DBBINDING](https://go.microsoft.com/fwlink/?linkid=2071182). Каждая структура DBBINDING связывает один столбец в извлеченных строк. Для получения данных в столбце как CHAR, набора *wType* структуры DBBINDING DBTYPE_STR. Для получения данных в столбце как тип данных WCHAR, набора *wType* структуры DBBINDING DBTYPE_WSTR.

Для результата буфера индикатор типа DBTYPE_STR драйвер преобразует данные в кодировке UTF-8 клиенту кодирования. Пользователь убедитесь, что клиент кодирование может представлять данные из столбца UTF-8, в противном случае — может привести к потере данных.

Для результата буфера индикатор типа DBTYPE_WSTR драйвер преобразует данные в кодировке UTF-8 в кодировку UTF-16.
  
## <a name="see-also"></a>См. также:  
[Возможности драйвера OLE DB для SQL Server](../../oledb/features/oledb-driver-for-sql-server-features.md) 

[Поддержка UTF-16 в драйвере OLE DB для SQL Server](../../oledb/features/utf-16-support-in-oledb-driver-for-sql-server.md)    
  
  
