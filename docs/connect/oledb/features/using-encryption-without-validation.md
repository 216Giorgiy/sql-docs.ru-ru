---
title: Использование шифрования без проверки | Документы Microsoft
description: Использование шифрования без проверки
ms.custom: ''
ms.date: 03/26/2018
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.service: ''
ms.component: oledb|features
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: reference
helpviewer_keywords:
- data access [OLE DB Driver for SQL Server], encryption
- cryptography [OLE DB Driver for SQL Server]
- MSOLEDBSQL, encryption
- encryption [OLE DB Driver for SQL Server]
- OLE DB Driver for SQL Server, encryption
author: pmasl
ms.author: Pedro.Lopes
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: ec40a58e50a1221dc321b9f4a4cfdb6c923f3f2a
ms.sourcegitcommit: 7a6df3fd5bea9282ecdeffa94d13ea1da6def80a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="using-encryption-without-validation"></a>Использование шифрования без проверки
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] всегда шифрует сетевые пакеты, связанные со входом в систему. Если сертификат не был предоставлен на сервере при запуске, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] создает самозаверенный сертификат, который используется для шифрования пакетов входа.  

Самозаверяющие сертификаты не гарантируют безопасность. Зашифрованные подтверждения основан на NT LAN Manager (NTLM). Настоятельно рекомендуется обеспечить подтверждаемого сертификата на сервере SQL Server для безопасного подключения к сети. Безопасности транспортного уровня (TLS) могут выполняться только с помощью проверки сертификата безопасности.

Приложения могут также запрашивать шифрование всего сетевого трафика путем использования ключевых слов строк соединения или свойств соединения. Ключевые слова являются «Encrypt» для OLE DB, при использовании строки поставщика с **IDbInitialize::Initialize**, или «Use Encryption for Data» для ADO и OLE DB при использовании строки инициализации с **IDataInitialize**. Это также может быть настроен по [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager с помощью **принудительное шифрование протокола** , а затем по настройке клиента на прием зашифрованных соединений. По умолчанию для шифрования всего сетевого трафика соединения требуется, чтобы сертификат присутствовал на сервере. Установив клиента на доверие к сертификату на сервере, может стать уязвимым для атак в середине. При развертывании подтверждаемого сертификата на сервере, убедитесь, что параметры клиента о доверии сертификата значение FALSE.

Сведения о ключевых словах строки соединения см. в разделе [с помощью ключевых слов строки подключения с драйвер OLE DB для SQL Server](../../oledb/applications/using-connection-string-keywords-with-oledb-driver-for-sql-server.md ).  
  
 Чтобы включить шифрование для использования, если сертификат не был предоставлен на сервере, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager может использоваться для установки как **принудительное шифрование протокола** и **доверять сертификату сервера**  параметры. В этом случае шифрование будет использовать самозаверяющий сертификат сервера, не проверяя наличия подтверждаемого сертификата сервера.  
  
 Приложения могут также использовать ключевое слово «TrustServerCertificate» или его атрибут связанного соединения, чтобы гарантировать применение шифрования. Параметры приложения никогда не снижают уровень безопасности, установленный клиентским диспетчером конфигурации [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], но могут повысить его. Например если **принудительное шифрование протокола** не задано для клиента, приложение может само запросить шифрование. Чтобы гарантировать применение шифрования, даже если сертификат сервера не был предоставлен, приложение может запросить шифрование и ключевое слово «TrustServerCertificate». Однако если ключевое слово «TrustServerCertificate» не включено в конфигурации клиента, предоставление сертификата сервера по-прежнему необходимо. В следующей таблице описываются все случаи:  
  
|Параметр «Принудительное шифрование протокола» на клиенте|Параметр «Доверять сертификату сервера» на клиенте|Строка соединения или атрибут соединения «Шифрование/использовать шифрование для данных»|Строка соединения или атрибут соединения «Надежный сертификат сервера»|Результат|  
|----------------------------------------------|---------------------------------------------|------------------------------------------------------------------------------|----------------------------------------------------------------------|------------|  
|Нет|Недоступно|Нет (по умолчанию)|Не учитывается|Шифрование отсутствует.|  
|Нет|Недоступно|Да|Нет (по умолчанию)|Шифрование применяется только при наличии подтверждаемого сертификата сервера, в противном случае попытка соединения завершается неудачно.|  
|Нет|Недоступно|Да|Да|Шифрование производится всегда, однако при этом может использоваться самозаверяющий сертификат сервера.|  
|Да|Нет|Не учитывается|Не учитывается|Шифрование применяется только при наличии подтверждаемого сертификата сервера, в противном случае попытка соединения завершается неудачно.|  
|Да|Да|Нет (по умолчанию)|Не учитывается|Шифрование производится всегда, однако при этом может использоваться самозаверяющий сертификат сервера.|  
|Да|Да|Да|Нет (по умолчанию)|Шифрование применяется только при наличии подтверждаемого сертификата сервера, в противном случае попытка соединения завершается неудачно.|  
|Да|Да|Да|Да|Шифрование производится всегда, однако при этом может быть использован самозаверяющий сертификат сервера.|  
||||||

> [!CAUTION]
> Только в предыдущей таблице содержится руководство на поведение системы при различных конфигурациях. Для безопасного подключения к сети убедитесь, что клиент и сервер требует шифрования. Также убедитесь, что сервер имеет подтверждаемого сертификата и что **TrustServerCertificate** на клиентском компьютере установлено значение FALSE.

## <a name="ole-db-driver-for-sql-server"></a>Драйвер OLE DB для SQL Server 
 Драйвер OLE DB для SQL Server поддерживает шифрование без проверки путем добавления SSPROP_INIT_TRUST_SERVER_CERTIFICATE свойство инициализации источника данных, которая реализована в наборе свойств dbpropset_sqlserverdbinit. Кроме того, добавлено новое ключевое слово строки соединения «TrustServerCertificate». Оно принимает значения «yes» и «no», значение по умолчанию — «no». При использовании компонентов службы оно принимает значения true и false, значение по умолчанию — false.  
  
 Дополнительные сведения об улучшениях, появившихся в наборе свойств dbpropset_sqlserverdbinit см. в разделе [свойства инициализации и авторизации](../../oledb/ole-db-data-source-objects/initialization-and-authorization-properties.md).  

  
## <a name="see-also"></a>См. также  
 [Возможности драйвера OLE DB для SQL Server](../../oledb/features/oledb-driver-for-sql-server-features.md)  
  
  
