---
title: Обновление приложения для драйвера OLE DB для SQL Server с компонентами MDAC | Документы Microsoft
description: Обновление приложения для драйвера OLE DB для SQL Server с компонентами MDAC
ms.custom: ''
ms.date: 03/26/2018
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.component: oledb|applications
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: reference
helpviewer_keywords:
- MDAC [SQL Server]
- MSOLEDBSQL, vs. MDAC
- OLE DB Driver for SQL Server, vs. MDAC
- data access [OLE DB Driver for SQL Server], vs. MDAC
- OLE DB Driver for SQL Server, updating applications
author: pmasl
ms.author: Pedro.Lopes
manager: craigg
ms.openlocfilehash: 907e1c08f422809a04d3e3c8846d91f7982bb7ea
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="updating-an-application-to-ole-db-driver-for-sql-server-from-mdac"></a>Обновление приложения для драйвера OLE DB для SQL Server с компонентами MDAC
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

[!INCLUDE[Driver_OLEDB_Download](../../../includes/driver_oledb_download.md)]

  Существует ряд различий между драйвер OLE DB для SQL Server и Microsoft данных Access Components (MDAC); начиная с Windows Vista, компоненты доступа к данным, теперь называются компонентами доступа к данным Windows (или Windows DAC). Хотя обе программы реализуют собственный доступ к данным [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] баз данных, драйвер OLE DB для SQL Server разработан специально для предоставления новых возможностей [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], в то же время обратную совместимость с более ранними версиями.   

 Помимо этого несмотря на то, что компоненты MDAC входят компоненты с помощью OLE DB, ODBC и объектов данных ActiveX (ADO), драйвер OLE DB для SQL Server реализует только интерфейсы OLE DB (хотя объекты ADO могут функциональные возможности драйвера OLE DB для SQL Server).  

 Драйвер OLE DB для SQL Server и компоненты MDAC отличаются в следующих областях:  

-   Пользователи, использующие объекты ADO для доступа к драйвер OLE DB для SQL Server может оказаться меньше функций фильтрации, чем при доступе поставщика SQL OLE DB.  

-   Если в приложении ADO используется драйвер OLE DB для SQL Server и предпринимается попытка обновить вычисляемый столбец, будет сообщение об ошибке. При использовании компонентов MDAC обновление было бы принято, но пропущено.  

-   Драйвер OLE DB для SQL Server является одной автономной файла библиотеки динамической компоновки (DLL). Количество интерфейсов с открытым доступом сведено к минимуму, чтобы упростить распространение, а также повысить уровень безопасности.  

-   Поддерживаются только интерфейсы OLE DB.  

-   Драйвер OLE DB для SQL Server имена отличаются от тех, которые используются с компонентами MDAC.  

-   Доступные для пользователя функции, предоставляемые компонентами MDAC доступна при использовании драйвера OLE DB для SQL Server. К ним помимо прочего относится создание пулов соединений, поддержка ADO и поддержка клиентских курсоров. При использовании любой из этих функций, драйвер OLE DB для SQL Server предоставляет только подключение к базе данных. Компоненты MDAC предоставляют такие функции, как трассировка, элементы управления в интерфейсе управления и счетчики производительности.  

-   Приложения могут использовать основные службы OLE DB с помощью драйвера OLE DB для SQL Server, но при использовании ядра курсора OLE DB, чтобы избежать потенциальных проблем, которые могут возникнуть, поскольку ядро курсора не имеет сведений о новой должны использовать параметр совместимости типов данных [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] типы данных.  

-   Драйвер OLE DB для SQL Server поддерживает доступ к предыдущей [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] баз данных.  

-   Драйвер OLE DB для SQL Server не содержит интеграция XML. Драйвер OLE DB для SQL Server поддерживает SELECT... БОЛЕЕ XML, но не поддерживает другие функциональные возможности XML. Тем не менее, поддерживает ли драйвер OLE DB для SQL Server **xml** появился тип данных в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].  

-   Драйвер OLE DB для SQL Server поддерживает настройку клиентские сетевые библиотеки, используя только атрибуты строки соединения. Если требуется провести более сложную настройку сетевых библиотек, необходимо использовать диспетчер конфигурации [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].  

-   Подключения MDAC поддерживает логическое значение (**true**) для **Trusted_Connection** ключевое слово. Драйвер OLE DB для строки подключения SQL Server необходимо использовать **Да** или **не**.  

-   Незначительные изменения внесены в предупреждения и ошибки. Предупреждения и ошибки, возвращенный сервером сохраняют такая же степень серьезности, при передаче в драйвер OLE DB для SQL Server. Следует тщательно протестировать приложение, если его работа зависит от перехвата определенных предупреждений и ошибок.  

-   Драйвер OLE DB для SQL Server имеет более строгую проверку чем в компонентах MDAC, это означает, что некоторые приложения, которые не полностью соответствуют спецификациям OLE DB могут работать иначе. Например, поставщик SQLOLEDB не предусмотрено принудительное применение правила, имена параметров должны начинаться с "@" для результата выполняет параметров, но драйвер OLE DB для SQL Server.  

-   Драйвер OLE DB для SQL Server ведет себя по-разному с компонентами MDAC в отношении неудачных попыток соединения. Например компоненты MDAC Возвращает кэшированные значения свойств соединения, которое не удалось, тогда как драйвер OLE DB для SQL Server сообщает об ошибке вызывающему приложению.  

-   Драйвер OLE DB для SQL Server не создает события Visual Studio Analyzer, но вместо этого формирует события трассировки Windows.  

-   Драйвер OLE DB для SQL Server не может использоваться с системным монитором. Системный монитор — это средство Windows, которое можно использовать только для файлов DSN, которые используют драйвер MDAC SQLODBC, входящий в Windows.  

-   Драйвер OLE DB для SQL Server при подключении к [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версиях ошибка сервера 16947 возвращается в виде SQL_ERROR. Эта ошибка возникает, если при выполнении позиционированного обновления или удаления не удается обновить или удалить строку. При использовании компонентов MDAC для соединения с любой версией [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ошибка сервера 16947 возвращается в виде предупреждения (SQL_SUCCESS_WITH_INFO).  

-   Драйвер OLE DB для SQL Server реализует **IDBDataSourceAdmin** интерфейс, который имеет необязательный интерфейс OLE DB, который не был ранее реализованных, но только **CreateDataSource** метод данного объекта дополнительный интерфейс реализован. [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  

-   Драйвер OLE DB для SQL Server возвращает синонимы в ТАБЛИЦАХ и TABLE_INFO наборы строк схемы с TABLE_TYPE присваивается значение SYNONYM.  

-   Возвращаемые значения типа данных **varchar(max)**, **nvarchar(max)**, **varbinary(max)**, **xml**, **определяемого пользователем типа**, или других типов больших объектов не могут быть возвращены клиенту с версиями более ранней, чем [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]. Если вы хотите использовать эти типы в качестве возвращаемых значений, необходимо использовать драйвер OLE DB для SQL Server.  

-   Компоненты MDAC позволяют следующие инструкции для выполнения при запуске ручных или неявных транзакций, но не поддерживает драйвер OLE DB для SQL Server. Они должны выполняться в режиме автоматической фиксации.  

    -   Все полнотекстовые операции (операции DDL с индексом и каталогом)  

    -   Все операции с базой данных (создание базы данных, изменение базы данных, удаление базы данных)  

    -   Повторная настройка  

    -   Shutdown  

    -   Удаление  

    -   Резервное копирование  

-   При подключении приложений MDAC к [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] типы данных, представленные в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], будут отображаться как типы данных, совместимые с [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)], как показано в следующей таблице.  

    |Тип SQL Server 2005|Тип SQL Server 2000|  
    |--------------------------|--------------------------|  
    |**varchar(max)**|**text**|  
    |**nvarchar(max)**|**ntext**|  
    |**varbinary(max)**|**image**|  
    |**определяемый пользователем тип**|**varbinary**|  
    |**xml**|**ntext**|  

     Это сопоставление типов затрагивает значения, возвращаемые для метаданных столбцов. Например **текст** столбец имеет максимальный размер 2 147 483 647, но драйвер OLE DB для SQL Server сообщает максимальный размер **varchar(max)** столбцы как 2 147 483 647 или -1, в зависимости от платформы.  

-   Драйвер OLE DB для SQL Server поддерживает неоднозначность в строках подключения (например, некоторые ключевые слова могут быть указаны несколько раз и конфликтующих ключевых слов могут разрешаться на основании позиции или приоритета) для обеспечения обратной совместимости. Будущие выпуски драйвер OLE DB для SQL Server могут не позволять неоднозначность в строках соединения. Рекомендуется при изменении приложениям использовать драйвер OLE DB для SQL Server, чтобы предусмотреть Устранение любых зависимостей от неоднозначности строки соединения.  

-   При использовании вызова OLE DB для запуска транзакции, является различие в поведении между драйвер OLE DB для SQL Server и компоненты MDAC; транзакции запускаются немедленно с помощью драйвера OLE DB для SQL Server, но транзакции запускаются после первой базы данных обращаться при помощи компонентов MDAC. Это может повлиять на поведение хранимых процедур и пакетов, так как [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] требует@TRANCOUNT должны совпадать после пакета или хранимой процедуры завершения выполнения, в котором он был при запуске пакета или хранимой процедуры.  

-   С помощью драйвер OLE DB для SQL Server ITransactionLocal::BeginTransaction вызовет немедленный запуск транзакции. При использовании компонентов MDAC запуск транзакции задерживается до выполнения приложением инструкции, которой требуется транзакция в неявном режиме. Дополнительные сведения см. в разделе [SET IMPLICIT_TRANSACTIONS (Transact-SQL)](../../../t-sql/statements/set-implicit-transactions-transact-sql.md).  


 Оба драйвер OLE DB для SQL Server и MDAC поддерживают изоляции транзакций read committed с использованием управления версиями строк, но только драйвер OLE DB для изоляции транзакций моментальных снимков SQL Server поддерживает. (С точки зрения программирования уровень изоляции транзакций READ COMMITTED с управлением версиями строк представляет собой то же, что и транзакция READ COMMITTED.)  

## <a name="see-also"></a>См. также  
 [Создание приложений с помощью драйвера OLE DB для SQL Server](../../oledb/applications/building-applications-with-oledb-driver-for-sql-server.md)  
