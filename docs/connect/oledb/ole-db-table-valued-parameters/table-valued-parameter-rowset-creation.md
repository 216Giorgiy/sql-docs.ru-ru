---
title: Создание набора строк возвращающего табличное значение параметра | Документы Microsoft
description: Статические и динамические создания набора строк возвращающего табличное значение параметра
ms.custom: ''
ms.date: 03/26/2018
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, rowset creation
author: pmasl
ms.author: Pedro.Lopes
manager: craigg
ms.openlocfilehash: b756e3573af050f1fd998c0861308855e456bd10
ms.sourcegitcommit: f16003fd1ca28b5e06d5700e730f681720006816
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35307433"
---
# <a name="table-valued-parameter-rowset-creation"></a>Создание набора строк возвращающего табличное значение параметра
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

  Несмотря на то, что потребители могут предоставить для возвращающих табличные значения параметров любой объект набора строк, типичные объекты наборов строк реализуются для конечных хранилищ данных и таким образом предоставляют ограниченную производительность. По этой причине драйвер OLE DB для SQL Server разрешает пользователям создавать специализированный объект набора строк на основе данных в памяти. Этот специальный объект набора данных в памяти является новым COM-объектом, называемым набором строк возвращающего табличное значение параметра. Он предлагает функциональные возможности, аналогичные набору параметров.  
  
 Объекты набора строк возвращающего табличное значение параметра создаются явным образом поставщиком для входных параметров через несколько интерфейсов уровня сеанса. Имеется один экземпляр объекта набора строк возвращающего табличное значение параметра в табличное значение параметра. Потребитель может создавать объекты набора строк возвращающего табличное значение параметра либо путем предоставления уже известных метаданных (статический сценарий), либо путем его обнаружения через интерфейсы поставщика (динамический сценарий). Эти два сценария описаны в следующих разделах.  
  
## <a name="static-scenario"></a>Статический сценарий  
 Если известны сведения о типе, потребитель использует ITableDefinitionWithConstraints::CreateTableWithConstraints создания экземпляра объекта набора строк возвращающего табличное значение параметра, соответствующее табличное значение параметра.  
  
 *Guid* поля (*pTableID* параметра) содержит специальный идентификатор GUID (CLSID_ROWSET_TVP). *PwszName* члена содержит имя типа возвращающего табличное значение параметра, который потребитель хочет создать. *EKind* полю будет присвоено значение DBKIND_GUID_NAME. Это имя является обязательным, если эта инструкция стоит нерегламентированные SQL; имя является необязательным, если он является вызов процедуры.  
  
 Для статистической обработки потребитель передает *pUnkOuter* параметр с управляющий IUnknown.  
  
 Свойства объекта набора строк возвращающего табличное значение параметра доступны только для чтения, поэтому потребитель не должен задавать любые свойства в *rgPropertySets*.  
  
 Для *rgPropertySets* члена каждой структуры DBCOLUMNDESC потребитель может указать дополнительные свойства для каждого столбца. Эти свойства принадлежат набору свойств DBPROPSET_SQLSERVERCOLUMN. Они позволяют указать для каждого столбца вычисляемые настройки и настройки по умолчанию. Также они поддерживают существующие свойства столбца, например допустимость значений NULL и идентификатор.  
  
 Для получения соответствующих сведений от объекта набора строк возвращающего табличное значение параметра, потребитель использует IRowsetInfo::GetProperties.  
  
 Для получения сведений о null, уникальном, вычисляемым и обновлять состояние каждого столбца, потребитель может использовать IColumnsRowset::GetColumnsRowset или IColumnsInfo::GetColumnInfo. Эти методы предоставляют подробные сведения о каждом столбце набора строк возвращающего табличные значения параметра.  
  
 Потребитель указывает тип каждого столбца возвращающего табличные значения параметра. Это похоже на как указываются столбцы при создании таблицы в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Потребитель получает объект набора строк возвращающего табличное значение параметра с помощью драйвера OLE DB для SQL Server с помощью *ppRowset* выходной параметр.  
  
## <a name="dynamic-scenario"></a>Динамический сценарий  
 Если потребитель не имеет сведений о типе, IOpenRowset::OpenRowset следует использовать для создания экземпляра объекта набора строк возвращающего табличное значение параметра. Потребитель должен предоставить поставщику имя типа.  
  
 В этом сценарии поставщик получает сведения о типе объекта набора строк возвращающего табличные значения параметра из сервера от лица потребителя.  
  
 *PTableID* и *pUnkOuter* должны устанавливаться аналогично статическому сценарию. Драйвер OLE DB для SQL Server, затем получает сведения о типе (сведения о столбцах и ограничения) на сервере и возвращать объект набора строк возвращающего табличное значение параметра по *ppRowset* параметра. Эта операция требует связи с сервером и, следовательно, не выполнять и статический сценарий. Динамический сценарий работает только с параметризованными вызовами процедур.  
  
## <a name="see-also"></a>См. также  
 [Возвращающие табличные значения параметров &#40;OLE DB&#41;](../../oledb/ole-db-table-valued-parameters/table-valued-parameters-ole-db.md)   
 [Использование возвращающих табличные значения параметров &#40;OLE DB&#41;](../../oledb/ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  
