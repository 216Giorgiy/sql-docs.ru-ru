---
title: Занятие 2 Подготовка R учебника среды с помощью PowerShell (SQL Server машинного обучения) | Документы Microsoft
description: Руководство для внедрения в SQL Server R хранимые процедуры и функции T-SQL
ms.prod: sql
ms.technology: machine-learning
ms.date: 06/07/2018
ms.topic: tutorial
author: HeidiSteen
ms.author: heidist
manager: cgronlun
ms.openlocfilehash: 1280d7c82d48c8ed596271cd7a73fa13ec1664c7
ms.sourcegitcommit: b52b5d972b1a180e575dccfc4abce49af1a6b230
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/08/2018
ms.locfileid: "35249747"
---
# <a name="lesson-2-set-up-the-tutorial-environment-using-powershell"></a>Занятие 2: Настройка учебника среды, с помощью PowerShell
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

В этой статье является частью учебника для разработчиков SQL по использованию R в SQL Server.

На этом шаге вы будете запускать сценарий PowerShell для создания объектов базы данных, необходимые для данного пошагового руководства. Этот сценарий создает и загружает базу данных, используя образец данные, полученные на предыдущем шаге. Он также создает функций и хранимых процедур для всего учебника.

## <a name="create-and-load-database-objects"></a>Создание и загрузка объектов базы данных

Среди загруженные файлы, вы увидите сценария PowerShell (`RunSQL_SQL_Walkthrough.ps1`) для подготовки среды к выполнению пошагового руководства. Он выполняет следующие действия:

- Установите собственный клиент SQL и служебные программы командной строки SQL, если еще не установлена. Эти программы необходимы для массовой загрузки данных в базу данных с помощью **bcp**.

- Создание базы данных и таблиц на [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляра и массовой вставки из CSV-файл источника данных.

- Создание нескольких функций SQL и хранимых процедур.

### <a name="modify-the-script-to-use-a-trusted-windows-identity"></a>Измените скрипт для использования доверенного удостоверения Windows

По умолчанию в скрипте предполагается имя пользователя базы данных SQL Server и пароль. Если db_owner под учетной записью пользователя Windows, можно использовать для создания объектов удостоверения Windows. Чтобы сделать это, откройте `RunSQL_SQL_Walkthrough.ps1` в редакторе кода и добавьте **`-T`** для bcp bulk insert, команда (строка 238):

```text
bcp $db_tb in $csvfilepath -t ',' -S $server -f taxiimportfmt.xml -F 2 -C "RAW" -b 200000 -U $u -P $p -T
```

### <a name="run-the-script-to-create-objects"></a>Запустите скрипт для создания объектов

Откройте командную строку PowerShell с правами администратора и выполните приведенную ниже команду.
  
```ps
.\RunSQL_SQL_Walkthrough.ps1
```
В ответ на приглашение введите следующие сведения:

- Экземпляр сервера, на котором [!INCLUDE[rsql_productname](../../includes/rsql-productname-md.md)] установлен. Для экземпляра по умолчанию это может быть простым, как имя компьютера.

- Имя базы данных. В этом учебнике скрипты предполагают, что `TaxiNYC_Sample`.

- Имя пользователя и пароль пользователя. Введите имя входа базы данных SQL Server для этих значений. Кроме того Если вы изменили сценарий для принятия доверенного удостоверения Windows, нажмите клавишу ВВОД, чтобы оставить пустым эти значения. Удостоверения Windows, используемый для соединения.

- Полное имя файла для образца данных, загруженных на предыдущем занятии. Например: `C:\tempRSQL\nyctaxi1pct.csv`.

После предоставления этих значений сценарий выполняется немедленно. Во время выполнения скрипта, все имена заполнитель в [!INCLUDE[tsql](../../includes/tsql-md.md)] скриптов обновляются для использования вами входных данных.

## <a name="review-database-objects"></a>Ознакомьтесь с объектами базы данных
   
По завершении выполнения скрипта подтверждение объекты базы данных, существующие на [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляра с помощью [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]. Вы увидите базы данных, таблицы, функции и хранимые процедуры.
  
   ![rsql_devtut_BrowseTables](media/rsql-devtut-browsetables.png "rsql_devtut_BrowseTables")

> [!NOTE]
> Если объекты базы данных уже существуют, их нельзя создать еще раз.
>   
> Если таблица уже существует, данные будут добавляться в нее, а не перезаписываться. Поэтому перед выполнением скрипта удалите все существующие объекты.

## <a name="objects-used-in-this-tutorial"></a>Объекты, используемые в этом учебнике

В следующей таблице перечислены объекты, созданные на этом занятии. Несмотря на то, что одновременно использовать только один скрипт PowerShell (`RunSQL_SQL_Walkthrough.ps1`), этот скрипт вызывает другие сценарии SQL, в свою очередь, для создания объектов в базе данных. Сценарии, используемые для создания каждого объекта упоминаются в описании.

|**Имя объекта**|**Тип объекта**|**Описание**|
|----------|------------------------|---------------|
|**TaxiNYC_Sample** | База данных |Созданный скрипт создания db ТБ Отправка data.sql. Создает базу данных и две таблицы:<br /><br />таблица dbo.nyctaxi_sample: содержит основной такси NYC набор данных. К таблице добавляется кластеризованный индекс columnstore для оптимизации хранения данных и производительности запросов. В примере 1% NYC такси набора данных вставляется в эту таблицу.<br /><br />таблица dbo.nyc_taxi_models: используется для сохранения модели обученной расширенной аналитики.|
|**fnCalculateDistance** |скалярная функция | Создаваемые сценарием fnCalculateDistance.sql. Вычисляет прямой расстояние между раскладки и dropoff расположений. Эта функция используется в [создание компонентов данных](../tutorials/sqldev-create-data-features-using-t-sql.md), [обучение и сохранить модель](sqldev-train-and-save-a-model-using-t-sql.md) и [ввода в эксплуатацию R-модели](../tutorials/sqldev-operationalize-the-model.md).|
|**fnEngineerFeatures** |функция с табличным значением | Создаваемые сценарием fnEngineerFeatures.sql. Создает новые возможности данных для обучения модели. Эта функция используется в [создание компонентов данных](../tutorials/sqldev-create-data-features-using-t-sql.md) и [ввода в эксплуатацию R-модели](../tutorials/sqldev-operationalize-the-model.md).|
|**PlotHistogram** |хранимая процедура | Создаваемые сценарием PlotHistogram.sql. Вызывает функцию R для построения гистограммы переменной, а затем возвращает диаграммы как двоичного объекта. Эта хранимая процедура используется в [анализ и визуализация данных](../tutorials/sqldev-explore-and-visualize-the-data.md).|
|**PlotInOutputFiles** |хранимая процедура| Создаваемые сценарием PlotInOutputFiles.sql. Создает графический объект, с помощью функции R и затем сохраняет выходные данные в формате PDF. Эта хранимая процедура используется в [анализ и визуализация данных](../tutorials/sqldev-explore-and-visualize-the-data.md).|
|**PersistModel** |хранимая процедура | Создаваемые сценарием PersistModel.sql. Получает модель, сериализованный в тип данных varbinary и записывает его в указанной таблице. |
|**PredictTip**  |хранимая процедура |Создаваемые сценарием PredictTip.sql. Вызывает обученной модели для создания прогнозов с помощью модели. Хранимая процедура принимает запрос в качестве входного параметра и возвращает столбец числовых значений, представляющих оценки для входных строк. Эта хранимая процедура используется в [ввода в эксплуатацию R-модели](../tutorials/sqldev-operationalize-the-model.md).|
|**PredictTipSingleMode**  |хранимая процедура| Создаваемые сценарием PredictTipSingleMode.sql. Вызывает обученной модели для создания прогнозов с помощью модели. Эта хранимая процедура принимает новое наблюдение в качестве входных данных, причем отдельные значения характеристик передаются как встроенные параметры, и возвращает значение, представляющее прогнозируемый результат для нового наблюдения. Эта хранимая процедура используется в [ввода в эксплуатацию R-модели](../tutorials/sqldev-operationalize-the-model.md).|
|**TrainTipPredictionModel**  |хранимая процедура|Создаваемые сценарием TrainTipPredictionModel.sql. Обучает модель логистической регрессии, вызвав R-пакет. Модель прогнозирует значение для столбца tipped и обучается на основе случайной выборки, содержащей 70 % данных. Выходными данными хранимой процедуры является обученная модель, которая сохраняется в таблице nyc_taxi_models. Эта хранимая процедура используется в [обучение и сохранить модель](sqldev-train-and-save-a-model-using-t-sql.md).|

## <a name="next-lesson"></a>Следующее занятие

[Занятие 3: Анализ и визуализация данных](../tutorials/sqldev-explore-and-visualize-the-data.md)

## <a name="previous-lesson"></a>Предыдущее занятие

[Урок 1: Загрузите образец данных](../tutorials/sqldev-download-the-sample-data.md)
