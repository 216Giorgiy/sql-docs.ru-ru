---
title: Синхронизация пакета R для SQL Server | Документы Microsoft
ms.custom: ''
ms.date: 01/04/2018
ms.reviewer: ''
ms.suite: sql
ms.prod: machine-learning-services
ms.prod_service: machine-learning-services
ms.component: r
ms.technology: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.author: heidist
author: HeidiSteen
manager: cgronlun
ms.workload: Inactive
ms.openlocfilehash: 8559100deb736885260c6f4b6812c8f3e714cad1
ms.sourcegitcommit: 059fc64ba858ea2adaad2db39f306a8bff9649c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/04/2018
---
# <a name="r-package-synchronization-for-sql-server"></a>Синхронизация пакета R для SQL Server
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

Версия RevoScaleR, включенных в SQL Server 2017 г. включает в себя возможность синхронизировать коллекции пакетов R в файловой системе с экземпляра и базы данных использования пакетов.

Эта функция, предоставленная упростить резервное копирование коллекции пакет R, связанные с базами данных SQL Server. Используя эту возможность, администратор сможет восстановить не только базы данных, но все пакеты R, используемые в работе с базой данных специалистами по анализу данных.

Эта статья описывает функцию синхронизации пакета и как использовать [rxSyncPackages](https://docs.microsoft.com/machine-learning-server/r-reference/revoscaler/rxsyncpackages) функцию для выполнения следующих задач:

+ Синхронизировать список пакетов для всей базы данных SQL Server

+ Синхронизация пакетов, используемого отдельного пользователя или группы пользователей

+ Если пользователь переходит на другой сервер SQL Server, можно создать резервную копию рабочей базы данных пользователя и восстановите ее на новый сервер, и пакеты для пользователя будут установлены в файловую систему на новом сервере, как того требует R.

Например можно использовать синхронизацию пакета в следующих сценариях:

+ Администратор базы данных восстанавливает экземпляр SQL Server на новом компьютере и просит пользователей для подключения от клиентов их R и запуска `rxSyncPackages` для обновления и восстановления своих пакетов.

+ Вы считаете, что повреждены R-пакет в файловой системе, чтобы запустить `rxSyncPackages` на сервере SQL Server.

## <a name="requirements"></a>Требования

Прежде чем использовать синхронизацию пакета, должен иметь соответствующую версию Microsoft R или машины обучения сервера. Эта функция предоставляется Microsoft R версии 9.1.0 или более поздней версии. 

Необходимо также включить [функции пакета управления](r-package-how-to-enable-or-disable.md) на сервере.

### <a name="determine-whether-your-server-supports-package-management"></a>Определить, поддерживает ли ваш сервер пакета управления

Эта функция доступна в CTP-версии 2 SQL Server 2017 г. или более поздней.

Эту возможность можно добавить к экземпляру SQL Server 2016, обновление экземпляра, чтобы использовать последнюю версию Microsoft R. Дополнительные сведения см. в разделе [SqlBindR.exe используется для обновления SQL Server R Services](use-sqlbindr-exe-to-upgrade-an-instance-of-sql-server.md).

### <a name="enable-the-package-management-feature"></a>Включить функции пакета управления

Для использования пакета синхронизации требуется включить компонент нового пакета управления на экземпляре SQL Server, а также на отдельных баз данных. Дополнительные сведения см. в разделе [включить или отключить управление пакетами для SQL Server](r-package-how-to-enable-or-disable.md).

1. Администратор сервера включает функцию для экземпляра SQL Server.
2. Для каждой базы данных предоставляются администратором отдельным пользователям возможность устанавливать или совместного использования пакетов R с помощью ролей базы данных.

Если это сделано, можно использовать функции RevoScaleR, такие как [rxInstallPackages](https://docs.microsoft.com/machine-learning-server/r-reference/revoscaler/rxinstallpackages) для установки пакетов в базу данных.  Сведения о пользователях и пакеты, которые они могут использовать хранится в экземпляре SQL Server. 

Каждый раз при добавлении нового пакета с помощью функций пакета управления, обновляются записи в SQL Server и в файловой системе. Эти сведения можно использовать для восстановления данных о пакете для всей базы данных.

### <a name="permissions"></a>Разрешения

+ Кто выполняет функцию синхронизации пакета должно быть участника на экземпляр SQL Server и базы данных, в котором пакеты безопасности.

+ Вызывающий эту функцию участник должен быть членом одной из этих ролей пакета управления: **общих rpkgs** или **rpkgs частного**.

+ Для синхронизации пакеты, которые помечены как **общего**, пользователя, выполняющего функции необходимо быть членом **rpkgs общих** роли и пакетами, которые перемещаются должен быть установлен к общей Библиотека области.

+ Для синхронизации пакеты, которые помечены как **закрытый**, либо владелец пакета или администратор должен запустить функцию, и пакеты должны быть закрытыми.

+ Чтобы синхронизировать пакеты от лица других пользователей, владелец должен bhe членом **db_owner** роли базы данных.

## <a name="how-package-synchronization-works"></a>Как работает синхронизация пакета

Чтобы использовать синхронизацию пакета, вызовите [rxSyncPackages](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxsyncpackages), который представляет собой новую функцию в [RevoScaleR](https://docs.microsoft.com/machine-learning-server/r-reference/revoscaler/revoscaler). 

Для каждого вызова `rxSyncPackages`, необходимо указать экземпляр SQL Server и базы данных. Затем либо список пакетов для синхронизации или указать области пакета.

1. Создание контекста вычислений SQL Server с помощью `RxInSqlServer` функции. Если не указать контекст вычислений, используется текущий контекст вычислений.

2. Укажите имя базы данных в экземпляре в контексте указанного вычислений. Пакеты синхронизируются на базу данных.

3. Укажите пакеты для синхронизации с помощью аргумента области.

    Если вы используете **закрытый** синхронизируются область только пакеты, принадлежащие указанным владельцем. При указании **общего** синхронизируются области, все открытые пакеты в базе данных. 
    
    Если запустить функцию без указания либо **закрытый** или **общего** области, синхронизируются все пакеты.

4. При успешном выполнении команды в базу данных с заданной областью и владелец добавляются существующие пакеты в файловой системе.

    В случае повреждения файловой системы пакеты будут восстановлены на основе списка, сохраняется в базе данных.

    Если компонент пакета управления недоступен в целевой базе данных, возникает ошибка: «компонент пакета управления не включен на сервере SQL Server или версия устарела»

### <a name="example-1-synchronize-all-package-by-database"></a>Пример 1. Синхронизировать всех пакетов, базы данных

В этом примере возвращает никакие пакеты из локальной файловой системы и устанавливает пакеты в базе данных [TestDB]. Так как владелец не является подходящим, этот список включает все пакеты, которые были установлены для личных и общих областей.

```R
connectionString <- "Driver=SQL Server;Server=myServer;Database=TestDB;Trusted_Connection=True;"
computeContext <- RxInSqlServer(connectionString = connectionString )
rxSyncPackages(computeContext=computeContext, verbose=TRUE)
```

### <a name="example-2-restrict-synchronized-packages-by-scope"></a>Пример 2. Ограничить синхронизированных пакетов по области

Следующие примеры синхронизировать только пакетов в указанной области.

```R
#Shared scope
rxSyncPackages(computeContext=computeContext, scope="shared", verbose=TRUE)

#Private scope
rxSyncPackages(computeContext=computeContext, scope="private", verbose=TRUE)
```

### <a name="example-3-restrict-synchronized-packages-by-owner"></a>Пример 3. Ограничить синхронизированных пакетов владельцем

Ниже приведен пример, как синхронизировать только пакеты, установленные для определенного пользователя. В этом примере пользователь идентифицируется по имени входа SQL, *user1*.

```R
rxSyncPackages(computeContext=computeContext, scope="private", owner = "user1", verbose=TRUE))
```

## <a name="related-resources"></a>Связанные ресурсы

[Управление пакетами R для SQL Server](r-package-management-for-sql-server-r-services.md)
