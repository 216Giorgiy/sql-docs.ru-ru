---
title: "Пакет установки, удаления и синхронизировать | Документы Microsoft"
ms.custom: 
ms.date: 04/12/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- r-services
ms.tgt_pltfrm: 
ms.topic: article
author: jeannt
ms.author: jeannt
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: 876522142756bca05416a1afff3cf10467f4c7f1
ms.openlocfilehash: 959282395d178a090a3d447769ced4dca8882f89
ms.contentlocale: ru-ru
ms.lasthandoff: 09/01/2017

---

# <a name="r-package-synchronization-for-sql-server"></a>Синхронизация пакета R для SQL Server

2017 г CTP-версия SQL Server 2.0 включает новую функцию синхронизации пакетов R, чтобы поддерживать резервное копирование и восстановление коллекций пакет R, связанные с базами данных SQL Server. Эта функция позволяет убедитесь, что сложные наборы пакетов R, созданные пользователями, не потеряны и могут быть легко восстановлены.  

В этом разделе описывается, как работает функция синхронизации пакета и как использовать `rxSyncPackages()` функцию для выполнения следующих задач:

+  Синхронизировать список пакетов для всей базы данных SQL Server
+  Синхронизировать пакеты, отдельного пользователя или группы пользователей

> [!NOTE]
> Эта функция предоставляется в рамках предварительной версии программного обеспечения и может измениться до выпуска окончательной версии.

## <a name="what-is-package-synchronization"></a>Что такое синхронизация пакета 

Синхронизацию пакета — новый компонент, который предназначен для работы с SQL Server контекстов вычислений. Она предназначена для получения списка пакетов R, установленных на определенной базе данных, для конкретного пользователя или группы, и убедитесь, что пакеты перечислены в файле системы совпадают в базе данных. 

Это полезно, если необходимо переместить базу данных пользователя и переместить пакеты вместе с базой данных. Также можно использовать синхронизацию пакета при резервное копирование и восстановление базы данных SQL Server, используемой для заданий R.

Синхронизация пакет использует новую функцию `rxSyncPackages()`. Чтобы синхронизировать список пакетов, откройте окно командной строки R, передать контексте вычислений, определяющий экземпляр и базу данных, предназначенную для работы с и затем предоставьте области пакета или имя пользователя или владелец. 

### <a name="how-packages-are-managed-in-r-and-sql-server"></a>Управление пакетами в R и SQL Server

Как правило при выполнении сценариев R с помощью стандартных средств R, R-пакеты устанавливаются в файловой системе. Если несколько пользователей используют R на том же компьютере, может быть множество копий те же пакеты, в разных папках или в библиотеках другого пользователя.

Тем не менее чтобы использовать R-пакет из SQL Server, пакет устанавливается в библиотеке R по умолчанию, связанный с экземпляром. Сервер может размещение нескольких экземпляров SQL Server с помощью R включена и в этом случае каждый экземпляр может иметь отдельный набор пакетов R. 

Администратор базы данных отвечает за установку пакетов в экземпляре. Тем не менее с помощью библиотеки пакета управления, администратор может делегировать эту ответственность на себя для пользователей. 

+ Для каждой базы данных администратор может предоставить пользователям возможность бесплатно установить R-пакеты, которые им необходимы. Этот механизм гарантирует, что несколько пользователей можно установить разные версии пакетов R без возникновения конфликтов для других пользователей компьютера SQL Server. Отдельные пользователи могут установить пакеты для собственных целей помечен как место файловой системы с помощью **закрытый**, если они принадлежат к роли базы данных **rpkgs частного**.

+ Администратор может настроить группу пользователей пакета в базе и пакетов установки, которые являются общими для всех пользователей в группе. Пакеты могут использоваться совместно члены роли базы данных **общих rpkgs**. Такие пользователи также могут устанавливать пакеты в частной области расположения. 

### <a name="goal-of-package-synchronization"></a>Цель пакета синхронизации

Если базы данных сервера утеряна или необходимо переместить, с помощью синхронизации пакета можно восстановить наборы пакетов определенной базы данных, пользователь или группа. 

Сведения о пользователях и пакетов, которые они установлены хранится в экземпляре SQL Server и используется для обновления пакетов в файловой системе. Каждый раз при добавлении нового пакета с помощью функций пакета управления, обновляются записи в SQL Server и в файловой системе. Таким образом Если пользователь переходит на другой сервер SQL Server, можно создать резервную копию базы данных работы пользователя и восстановите ее на новый сервер, и пакеты для пользователя будут установлены в файловую систему на новом сервере, как того требует R.


### <a name="supported-versions"></a>Поддерживаемые версии

Эта функция включена в SQL Server 2017 г CTP 2.0.

Так как эта функция является частью 9.1.0 версии Microsoft R, можно добавить этот компонент к экземпляру SQL Server 2016, обновление экземпляра, чтобы использовать последнюю версию Microsoft R. Дополнительные сведения см. в разделе [SqlBindR.exe используется для обновления SQL Server R Services](../r/use-sqlbindr-exe-to-upgrade-an-instance-of-sql-server.md).

## <a name="to-synchronize-packages"></a>Чтобы синхронизировать пакеты

Вызывается `rxSyncPackages` after восстановление экземпляра SQL Server на новом компьютере, или если R пакета в файловой системе, считается поврежден.

Если команда выполняется успешно, добавляются существующие пакеты в файловой системе базы данных, область и владельца, как указано. В случае повреждения файловой системы пакеты являются restred на основе списка, сохраняется в базе данных.

### <a name="syntax"></a>Синтаксис
`rxSyncPackages(computeContext = rxGetOption("computeContext"),  scope = c("shared", "private"), owner = c(), verbose = getOption("verbose"))`

+ Контекста вычислений

    Определение контекста вычислений SQL Server, состоящий из экземпляра и базы данных и пакетов для синхронизации. Создайте контекст сервера SQ с помощью `RxInSqlServer` функции. Если не указать контекст вычислений, используется текущий контекст вычислений. 

+ Область действия

  Указывают ли при установке пакетов для одного пользователя или группы пользователей: 

    + **закрытый** операция будет включать только те пакеты, которые были установлены для использования с указанным владельцем.
    + **общий** oepration будет включать все пакеты, установленные для группы пользователей. 

  Если запустить функцию без указания закрытые или общие области, применяются обе области. В результате весь набор пакетов, доступных для всех областей и пользователей будут скопированы.

+ Владелец 

    Укажите владельца пакетов для синхронизации. Имя владельца должно быть допустимым пользователем базы данных SQL. Если оставить его пустым, используется имя входа SQL, указанное в соединении.


### <a name="requirements"></a>Требования

+ Пользователя, который выполняет функцию должно быть участником безопасности на экземпляре SQL Server и базы данных, имеющей пакеты, необходимо быть членом роли пакета управления: **общих rpkgs** или **rpkgs private** 
  + Для синхронизации пакеты, которые помечены как **общего**, пользователя, выполняющего функции необходимо быть членом **rpkgs общих** роли и пакетами, которые перемещаются должен быть установлен к общей Библиотека области.
  + Синхронизировать пакетам, помеченные как **закрытый**, либо владелец пакета или администратор должен запустить функцию, и пакеты должны быть закрытыми.
+ **Пользователи rpkgs** -члены этой роли могут выполнять код, который использует пакеты, установленные на экземпляре SQL Server, но не удается установить или синхронизировать пакеты.
+ Чтобы синхронизировать пакеты от лица других пользователей, владелец должен быть членом **db_owner** роли базы данных.

## <a name="examples"></a>Примеры

Следующие примеры создания подключения к определенному экземпляру SQL Server, укажите базу данных и затем указать набор пакетов для синхронизации. 

При вызове `rxSyncPackages` выполняется пакет, списки синхронизируются между файловой системы и базы данных. 

### <a name="synchronize-all-by-database"></a>Синхронизировать с базы данных

В этом примере извлекаются все пакеты, установленные в базе данных [TestDB]. Так как владелец не является подходящим, этот список включает все пакеты, которые были установлены для личных и общих областей.

```R
connectionString <- "Driver=SQL Server;Server=myServer;Database=TestDB;Trusted_Connection=True;"
computeContext <- RxInSqlServer(connectionString = connectionString )

rxSyncPackages(computeContext=computeContext, verbose=TRUE)
```

### <a name="restrict-synchronized-packages-by-scope"></a>Ограничить синхронизированных пакетов по области 

Следующие примеры синхронизировать только пакеты в общую область или закрытыми.

**Общая область**

```R
rxSyncPackages(computeContext=computeContext, scope="shared", verbose=TRUE)
```

**Закрытая область**

```R
rxSyncPackages(computeContext=computeContext, scope="private", verbose=TRUE)
```

### <a name="restrict-synchronized-packages-by-owner"></a>Ограничить синхронизированных пакетов владельцем 

Ниже приведен пример, как получить только пакеты, установленные для определенного пользователя. В этом примере пользователь идентифицируется по имени входа SQL, *user1*.

```R
rxSyncPackages(computeContext=computeContext, scope="private", owner = "user1", verbose=TRUE))
```

## <a name="see-also"></a>См. также:

[Управление пакетами R для SQL Server](../r/r-package-management-for-sql-server-r-services.md)
