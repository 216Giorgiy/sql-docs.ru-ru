---
title: "Установка служб R SQL Server на виртуальной машине Azure | Документация Майкрософт"
ms.custom: 
ms.date: 07/10/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- r-services
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: c3c223b8-75c4-412e-a319-d57ecf6533af
caps.latest.revision: 11
author: jeannt
ms.author: jeannt
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: 876522142756bca05416a1afff3cf10467f4c7f1
ms.openlocfilehash: e673268b1f6b56890f22576d293135b2675ed4ab
ms.contentlocale: ru-ru
ms.lasthandoff: 09/01/2017

---
# <a name="installing-sql-server-r-services-on-an-azure-virtual-machine"></a>Установка служб R SQL Server на виртуальной машине Azure
 
При развертывании виртуальной машины Azure, включающий [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], теперь можно выбрать машинного обучения, как средство для добавления экземпляра при создании виртуальной Машины.

+ [Создание виртуальной машины с SQL Server 2016 и службами R](#new)
+ [Добавление служб R в существующую виртуальную машину с SQL Server 2016](#existing)

## <a name="new"></a>Создание виртуальной машины SQL Server 2016 Enterprise с включенными службами R

1. На портале Azure щелкните виртуальные МАШИНЫ и нажмите кнопку Создать.
2. Выберите выпуск SQL Server 2016 Enterprise.
3. Настройте имя сервера и разрешения учетной записи, а затем выберите ценовой план.
4. На шаге 4 в мастере установки виртуальной машины в разделе **Настройки SQL Server** найдите компонент **Службы R Services (расширенная аналитика)** и щелкните **Включить**.
5. Просмотрите сводку, представленную для проверки, и нажмите кнопку **ОК**.
6. Когда виртуальная машина будет готова, подключитесь к ней и откройте предварительно установленную среду SQL Server Management Studio. Службы R готовы к запуску.
7. Чтобы проверить их готовность, вы можете открыть новое окно запроса и выполнить простую инструкцию (например, приведенную ниже), в которой используется язык R для создания последовательности чисел от 1 до 10.
   ```
    execute sp_execute_external_script
    @language = N'R'
    , @script = N' OutputDataSet <- as.data.frame(seq(1, 10, ));'
    , @input_data_1 = N'   ;'
    WITH RESULT SETS (([Sequence] int NOT NULL));
   ```
6. Если вы будете подключаться к экземпляру из удаленного клиента обработки и анализа данных, вам необходимо выполнить [дополнительные действия](#additional-steps).


## <a name="additional-steps"></a>Дополнительные действия  

Некоторые дополнительные действия не требуются, если ожидается, что удаленным клиентам доступ к серверу удаленного контекста вычислений SQL Server.

### <a name="firewall"></a>Разблокирование брандмауэра

По умолчанию брандмауэр на виртуальной машине Azure использует правило, которое блокирует сетевой доступ для локальных учетных записей пользователя R.

Необходимо отключить это правило, чтобы убедиться, что доступ к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляр из клиента обработки и анализа удаленных данных.  В противном случае — код R не может выполняться в контексты вычислений, использующих рабочей виртуальной машины, даже если другой код R использует контексте вычислений SQL Server без проблем.

Чтобы разрешить доступ к службам R из удаленных клиентов для обработки и анализа данных:

1. На виртуальной машине откройте брандмауэр Windows в режиме повышенной безопасности.
2. Выберите **Правила для исходящих подключений**.
3. Отключите следующее правило:
  
     `Block network access for R local user accounts in SQL Server instance MSSQLSERVER`
  
### <a name="enable-odbc-callbacks-for-remote-clients"></a>Включение обратных вызовов ODBC для удаленных клиентов

Если вы хотите, чтобы клиенты R, вызывающие сервер, могли отправлять запросы ODBC как часть решений R, вызовы ODBC на панели запуска должны выполняться от имени удаленного клиента. Для этого необходимо разрешить вход в экземпляр рабочим учетным записям SQL, которые используются панелью запуска.
Дополнительные сведения см. в разделе [Установка служб R SQL Server](../../advanced-analytics/r/set-up-sql-server-r-services-in-database.md).

### <a name="network"></a>Добавление сетевых протоколов

+ Включите именованные каналы.
  
  Службы [!INCLUDE[rsql_productname](../../includes/rsql-productname-md.md)] используют протокол именованных каналов для подключений между компьютерами клиента и сервера, а также для некоторых внутренних подключений. Если именованные каналы не включены, вам необходимо установить и включить их на виртуальной машине Azure и любом клиенте обработки и анализа данных, который подключен к серверу.
  
+ Включите протокол TCP/IP.

  Он требуется для замыкания соединений к службам R SQL Server. Если возникли следующие ошибки, включите поддержку TCP/IP на виртуальной машине, которая поддерживает экземпляр:

  «DBNETLIB; SQL Server не существует или доступ запрещен»

## <a name="how-to-disable-r-services-on-an-instance"></a>Как отключить службы R в экземпляре

Вы также можете в любое время включить или отключить этот компонент на существующей виртуальной машине.

1. Откройте колонку виртуальной машины.
2. Щелкните **Параметры**, а затем выберите **Конфигурация SQL Server**.

## <a name="existing"></a>Добавление существующей виртуальной машины SQL Server 2016 Enterprise SQL Server R Services

При создании виртуальной машины Azure, не включающий служб R, можно добавить функцию, выполните следующие действия:

1. Повторно запустите установку [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и добавьте этот компонент на странице мастера **Конфигурация сервера**.
2. Включите выполнение внешних скриптов и перезапустите экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Дополнительные сведения см. в разделе [Установка служб R SQL Server](../../advanced-analytics/r/set-up-sql-server-r-services-in-database.md).
3. (Необязательно.) Настройте доступ к базе данных для рабочих учетных записей R, если требуется удаленное выполнение скрипта.
   Дополнительные сведения см. в разделе [Установка служб R SQL Server](../../advanced-analytics/r/set-up-sql-server-r-services-in-database.md).
3. (Необязательно.) Измените правило брандмауэра на виртуальной машине Azure, если вы планируете разрешить выполнение скрипта R из удаленных клиентов для обработки и анализа данных. Дополнительные сведения см. в разделе [Разблокирование брандмауэра](#firewall) выше.
4. Установите или включите необходимые сетевые библиотеки. Дополнительные сведения см. в разделе [Добавление сетевых протоколов](#network) выше.

## <a name="related-resources"></a>Связанные ресурсы

[Настройка служб R SQL Server в базе данных](../../advanced-analytics/r/set-up-sql-server-r-services-in-database.md)

