---
title: Установка компонентов обучения машины SQL Server на виртуальной машине Azure | Документы Microsoft
ms.custom: ''
ms.date: 03/21/2018
ms.reviewer: ''
ms.suite: sql
ms.prod: machine-learning-services
ms.prod_service: machine-learning-services
ms.component: r
ms.technology: ''
ms.tgt_pltfrm: ''
ms.topic: article
author: HeidiSteen
ms.author: heidist
manager: cgronlun
ms.workload: Inactive
ms.openlocfilehash: bb1cd5e695e59c898a0e5dbcad279e1a8796bb63
ms.sourcegitcommit: 059fc64ba858ea2adaad2db39f306a8bff9649c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/04/2018
---
# <a name="install-sql-server-machine-learning-features-on-an-azure-virtual-machine"></a>Установка SQL Server машинного обучения функции на виртуальной машине Azure
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]
 
Мы рекомендуем использовать [виртуальная машина анализа данных](ttps://docs.microsoft.com/azure/machine-learning/data-science-virtual-machine/provision-vm), но если требуется, чтобы к виртуальной Машине с только что служб SQL Server 2017 г машины обучения или служб R SQL Server 2016, в этой статье поможет выполнить действия.

## <a name="create-a-virtual-machine-on-azure"></a>Создание виртуальной машины в Azure

1. На портале Azure в списке слева, нажмите кнопку **виртуальные машины** и нажмите кнопку **добавить**.
2. Поиск SQL Server 2017 г Enterprise Edition или SQL Server 2016 Enterprise Edition.
3. Настройте имя сервера и разрешения учетной записи, а затем выберите ценовой план.
4. В **параметры сервера SQL Server** (шаг 4 в мастере установки виртуальной Машины), найдите **Machine Services обучения (Advanced Analytics)** (или **R Services** для SQL Server 2016) и нажмите кнопку  **Включить**.
5. Просмотрите сводку, представленную для проверки, и нажмите кнопку **ОК**.
6. Когда виртуальная машина будет готова, подключитесь к ней и откройте предварительно установленную среду SQL Server Management Studio. Машинное обучение готов к выполнению.
7. Чтобы проверить их готовность, вы можете открыть новое окно запроса и выполнить простую инструкцию (например, приведенную ниже), в которой используется язык R для создания последовательности чисел от 1 до 10.

    ```
    EXEC sp_execute_external_script
    @language = N'R'
    , @script = N' OutputDataSet <- as.data.frame(seq(1, 10, ));'
    , @input_data_1 = N'   ;'
    WITH RESULT SETS (([Sequence] int NOT NULL));
    ```

6. Если вы планируете подключиться к экземпляру из клиента обработки и анализа удаленных данных, выполните [дополнительные шаги](#additional-steps) при необходимости.

### <a name="disable-machine-learning-features-on-a-sql-server-vm"></a>Отключение функции обучения компьютера на виртуальной Машине SQL Server

Также можно включить или отключить эту функцию на существующей виртуальной машины SQL Server в любое время.

1. Откройте колонку виртуальной машины.
2. Щелкните **Параметры**, а затем выберите **Конфигурация SQL Server**.
3. Внесите изменения в функциях и применить.

### <a name="existing"></a>Добавление существующей виртуальной Машине SQL Server 2016 Enterprise служб R

При создании виртуальной машины Azure, включенные SQL Server без машинного обучения, можно добавить функцию, выполните следующие действия:

1. Повторно запустите установку [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и добавьте этот компонент на странице мастера **Конфигурация сервера**.
2. Включите выполнение внешних скриптов и перезапустите экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Дополнительные сведения см. в разделе [установки служб SQL Server 2016 R](../install/sql-r-services-windows-install.md).
3. (Необязательно.) Настройте доступ к базе данных для рабочих учетных записей R, если требуется удаленное выполнение скрипта.
4. (Необязательно.) Измените правило брандмауэра на виртуальной машине Azure, если вы планируете разрешить выполнение скрипта R из удаленных клиентов для обработки и анализа данных. Дополнительные сведения см. в разделе [Разблокирование брандмауэра](#firewall) выше.
5. Установите или включите необходимые сетевые библиотеки. Дополнительные сведения см. в разделе [Добавление сетевых протоколов](#network) выше.

## <a name="additional-steps"></a>Дополнительные действия

Некоторые дополнительные действия не требуются, если ожидается, что удаленным клиентам доступ к серверу удаленного контекста вычислений SQL Server.

### <a name="firewall"></a>Разблокирование брандмауэра

По умолчанию брандмауэр на виртуальную машину Azure использует правило, которое блокирует сетевой доступ для локальных учетных записей пользователей.

Необходимо отключить это правило, чтобы убедиться, что доступ к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляр из клиента обработки и анализа удаленных данных.  В противном случае машинного обучения кода невозможно выполнить в контексты вычислений, использующих рабочей виртуальной машины.

Чтобы включить доступ к удаленным данным обработки и анализа клиентам:

1. На виртуальной машине откройте брандмауэр Windows в режиме повышенной безопасности.
2. Выберите **Правила для исходящих подключений**.
3. Отключите следующее правило:
  
     `Block network access for R local user accounts in SQL Server instance MSSQLSERVER`
  
### <a name="enable-odbc-callbacks-for-remote-clients"></a>Включение обратных вызовов ODBC для удаленных клиентов

Если ожидается, что клиентов, вызывающих сервера необходимо выдавать запросы ODBC как часть их машинного обучения решения, необходимо убедиться, что панель запуска осуществлять вызовы ODBC от имени удаленного клиента. Для этого необходимо разрешить вход в экземпляр рабочим учетным записям SQL, которые используются панелью запуска.
Дополнительные сведения см. в разделе [установки служб SQL Server 2016 R](../install/sql-r-services-windows-install.md).

### <a name="network"></a>Добавление сетевых протоколов

+ Включите именованные каналы.
  
  Службы [!INCLUDE[rsql_productname](../../includes/rsql-productname-md.md)] используют протокол именованных каналов для подключений между компьютерами клиента и сервера, а также для некоторых внутренних подключений. Если именованные каналы не включены, вам необходимо установить и включить их на виртуальной машине Azure и любом клиенте обработки и анализа данных, который подключен к серверу.
  
+ Включите протокол TCP/IP.

  Он требуется для подключений замыкания на себя. Если возникли следующие ошибки, включите поддержку TCP/IP на виртуальной машине, которая поддерживает экземпляр:

  «DBNETLIB; SQL Server не существует или доступ запрещен»