---
title: Безопасность для машинного обучения SQL Server и R | Документация Майкрософт
ms.prod: sql
ms.technology: machine-learning
ms.date: 04/15/2018
ms.topic: conceptual
author: HeidiSteen
ms.author: heidist
manager: cgronlun
ms.openlocfilehash: c04670464d23f0951a957df945a2e81b817ae134
ms.sourcegitcommit: 2666ca7660705271ec5b59cc5e35f6b35eca0a96
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/06/2018
ms.locfileid: "43889190"
---
# <a name="security-for-sql-server-machine-learning-and-r"></a>Безопасность для машинного обучения SQL Server и R
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

В этой статье описывается общая архитектура безопасности, используемый для подключения [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] механизм баз данных и связанных компонентов в среду выполнения R. Примеры процесса обеспечения безопасности предоставляются для этих распространенных сценариев использования R в корпоративной среде.

+ выполнение функций RevoScaleR в [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] из клиента обработки и анализа данных;
+ выполнение R прямо из [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] с помощью хранимых процедур.

## <a name="security-overview"></a>Общие сведения о безопасности

Объект [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] требуется имя входа или учетная запись пользователя Windows для выполнения скриптов R, которые используют данные SQL Server или выполняющихся с SQL Server в качестве контекста вычисления. Это требование применяется к обоим [!INCLUDE[rsql_productname_md](../../includes/rsql-productname-md.md)] и SQL Server 2017 [!INCLUDE[rsql-productnamenew-md](../../includes/rsql-productnamenew-md.md)].

Определяет имя входа или учетной записи пользователя *субъекта безопасности*, кто может потребоваться несколько уровней доступа, в зависимости от требований сценария R:

+ Разрешение на доступ к базе данных, где включена среда r.
+ Разрешения на чтение данных из защищенных объектов, таких как таблицы
+ Возможность создавать новые данные к таблице, например модели или результаты оценки
+ Возможность создания новых объектов, таких как таблицы, хранимые процедуры, используйте скрипт R или пользовательских функций заданием использование R
+ Право устанавливать новые пакеты на компьютере с SQL Server, то есть использование R-пакеты, предоставленные группе пользователей. 

Таким образом, каждый пользователь, запускающий выполнение кода R с помощью [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] как выполнения контекста должно быть сопоставлено имя входа в базе данных. При использовании безопасности SQL Server обычно проще создавать роли для управления наборами разрешений и назначить эти роли пользователей, а не по отдельности настроить разрешения. 

В качестве примера предположим, что созданный код R, который выполняется на ноутбуке, и вы хотите использовать этот код на [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)]. Это можно сделать только в том случае, если эти условия будут выполнены:

+ База данных должна разрешать удаленные подключения.
+ Имя входа SQL с именем и паролем, которые вы использовали в коде R, должны быть добавлены на [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] на уровне экземпляра. Если же вы используете встроенную проверку подлинности Windows, пользователь Windows, указанный в строке подключения, должен быть добавлен в качестве пользователя в экземпляр.
+ Имя входа SQL или пользователя Windows должна иметь разрешение на выполнение внешних скриптов. Обычно это разрешение может добавить только администратор базы данных.
+ Имя входа SQL или пользователь Windows должны быть добавлены в качестве пользователя с соответствующими разрешениями в каждую базу данных, где задание R выполняет одно из следующих действий:
    + извлечение данных;
    + запись или обновление данных; 
    + создание новых объектов, например таблиц или хранимых процедур.

После имени входа или учетной записи пользователя Windows были подготовки и предоставления необходимых разрешений, можно выполнять код R на [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] , используя объект источника данных R или путем вызова хранимой процедуры. При каждом запуске R из [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], безопасности ядра СУБД получает контекст безопасности пользователя, который запустил задание R или выполнена хранимая процедура, а также управляет сопоставлением пользователя или имени входа к защищаемым объектам. 

Таким образом все задания R, запущенные из удаленного клиента нужно указать данные имени входа или пользователя в строке подключения.

## <a name="interaction-of-includessnoversionmdincludesssnoversion-mdmd-security-and-launchpad-security"></a>Взаимодействие [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] безопасности и панели запуска

Когда скрипт R выполняется в контексте компьютера [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], служба [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)] получает доступную рабочую учетную запись (учетную запись локального пользователя) из пула рабочих учетных записей, установленных для внешних процессов, и использует ее для выполнения связанных задач. 

Например, если вы запустите задание R с помощью своих учетных данных пользователя Windows, ваша учетная запись будет сопоставлена с рабочей учетной записью панели запуска *SQLRUser01*.

После сопоставления с рабочей учетной записью [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)] создаст токен пользователя, который будет использоваться для запуска процессов. 

Когда все операции [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] будут завершены, рабочая учетная запись пользователя будет помечена как свободная и вернется в пул.

Дополнительные сведения о службе см. в разделе [Extensibility framework](../concepts/extensibility-framework.md). 

### <a name="implied-authentication"></a>Неявная проверка подлинности

**Неявная проверка подлинности** — термин, используемый для процесса, в которой SQL Server возвращает пользователя, учетные данные, а затем выполняет все задачи внешний скрипт от имени пользователей, при условии, что пользователь имеет правильные разрешения в базе данных. Неявная проверка подлинности особенно важно в тех случаях, если скрипт R необходимо выполнить вызов ODBC вне базы данных SQL Server. Например код может получить более короткий список факторов из электронной таблицы или другого источника.

Для таких вызовов замыкания на себя, для успешного выполнения имя группы, содержащей рабочих учетных записей, SQLRUserGroup, требуются разрешения «Локальный вход в систему». По умолчанию это право предоставляется всем новым локальным пользователям, но в некоторых организациях могут действовать более строгие групповые политики.

![Неявная проверка подлинности для R](media/implied-auth-rsql.png)

## <a name="security-of-worker-accounts"></a>Безопасность рабочих учетных записей

Сопоставление внешнего пользователя Windows или допустимого имени входа SQL с рабочей учетной записью является допустимым только в течение времени существования SQL-запрос, который запускает скрипт R.

Параллельные запросы, выполняемые с тем же именем входа, сопоставляются с той же рабочей учетной записью пользователя.

Каталогами, используемыми для этих процессов, управляет [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)] с помощью RLauncher, и доступ к ним ограничен. У рабочей учетной записи нет доступа к каким-либо файлам в папках (за исключением своих), но есть возможность чтения, записи или удаления дочерних элементов в сеансе рабочей папки, созданной для SQL-запроса с помощью скрипта R.

Дополнительные сведения о том, как изменить количество рабочих учетных записей, имена учетных записей или паролей учетных записей см. в разделе [изменение пула учетных записей пользователей для машинного обучения SQL Server](../../advanced-analytics/r/modify-the-user-account-pool-for-sql-server-r-services.md).

## <a name="security-isolation-for-multiple-external-scripts"></a>Изоляция безопасности для нескольких внешних скриптов

Механизм изоляции основан на учетных записях физических пользователей. Так как вспомогательные процессы запускаются для определенной языковой среды выполнения, каждая вспомогательная задача использует рабочую учетную запись, которую указала [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)]. Если для выполнения задачи требуется несколько вспомогательных процессов, как в случае параллельных запросов, то для всех связанных задач будет использоваться одна рабочая учетная запись.

При этом доступ к файлам, используемым другими рабочими учетными записями, отсутствует.
 
Если вы являетесь администратором компьютера, вы можете просмотреть каталоги, созданные для каждого процесса. Каждый каталог определяется собственным идентификатором GUID сеанса.

## <a name="see-also"></a>См. также

[Обзор архитектуры для машинного обучения SQL Server](../../advanced-analytics/r/architecture-overview-sql-server-r.md)
