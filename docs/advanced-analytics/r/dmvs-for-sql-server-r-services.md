---
title: Динамических административных представлений (DMV) для SQL Server машинного обучения службы | Документы Microsoft
ms.prod: sql
ms.technology: machine-learning
ms.date: 04/15/2018
ms.topic: conceptual
author: HeidiSteen
ms.author: heidist
manager: cgronlun
ms.openlocfilehash: e2180794ca96fc6387105745e346802725afe1dd
ms.sourcegitcommit: 7a6df3fd5bea9282ecdeffa94d13ea1da6def80a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="dmvs-for-sql-server-machine-learning-services"></a>Динамические административные представления для служб SQL Server машины обучения
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

Статья список системных представлений каталога и динамические административные представления, связанные с машинного обучения в SQL Server.

Сведения о расширенных событиях см. в разделе [расширенные события для машинного обучения](../../advanced-analytics/r/extended-events-for-sql-server-r-services.md).

> [!TIP]
> С помощью встроенных отчетов для монитора сеансов машинного обучения и использования пакета. Дополнительные сведения см. в разделе [отслеживать машинного обучения с помощью пользовательских отчетов в среде Management Studio](../../advanced-analytics/r/monitor-r-services-using-custom-reports-in-management-studio.md).

## <a name="system-configuration-and-system-resources"></a>Конфигурации системы и системные ресурсы

Можно отслеживать и анализировать ресурсы, используемые внешних скриптов с помощью [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] системных представлений каталога и динамические административные представления.

+ [ sys.dm_exec_sessions](../../relational-databases/system-dynamic-management-views/sys-dm-exec-sessions-transact-sql.md)

  Возвращает сведения о подключениях пользователей и сеансах системы. Сеансы системы можно определить, просмотрев столбец *session_id*. Значения, превышающие или равные 51, являются подключениями пользователей, а значения меньше 51 — системными процессами.

+ [sys.dm_os_performance_counters (Transact-SQL)](../../relational-databases/system-dynamic-management-views/sys-dm-os-performance-counters-transact-sql.md)

  Возвращает строку для каждого счетчика производительности системы, используемого сервером.  На основе этих сведений можно узнать, сколько скриптов выполнялось, какой режим проверки подлинности использовался для каждого из них или общее количество отправленных вызовов R для экземпляра.

  В этом примере возвращаются только счетчики, относящиеся к скрипту R:

  ```SQL
  SELECT * from sys.dm_os_performance_counters WHERE object_name LIKE '%External Scripts%'
  ```

  Это динамическое административное представление возвращает данные следующих счетчиков для внешних скриптов по каждому экземпляру.

  + **Общее число выполнений**: число внешних процессов запуска с помощью локальных или удаленных вызовов
  + **Параллельное выполнение**: количество раз, которые включены в скрипт _@parallel_ спецификации и что [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] была возможность создания и использования в параллельном плане запроса
  + **Потоковая передача выполнений**: число попыток был вызван функциональные возможности потоковой передачи
  + **Выполнение SQL CC**: число внешних скриптов выполнения, когда вызов был создан удаленно и SQL Server был используется в контексте
  + **Имена для входа с подразумеваемой проверкой подлинности** — количество петлевых вызовов ODBC с использованием подразумеваемой проверки подлинности, то есть [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] выполнял вызов от имени пользователя, отправившего запрос скрипта.
  + **Общее время выполнения (мс)**: время, прошедшее между вызова и завершения вызова
  + **Ошибки выполнения** — количество ошибок, возникших при выполнении скриптов. Этот счетчик не содержит ошибки R.


+ [sys.dm_external_script_requests](../../relational-databases/system-dynamic-management-views/sys-dm-external-script-requests.md)

  Это динамическое административное представление возвращает одну строку для каждой рабочей учетной записи, которая в данный момент выполняет внешний скрипт. Обратите внимание, что эта рабочая учетная запись отличается от учетных данных отправителя скрипта. Если один пользователь Windows отправляет несколько запросов скриптов, для их обработки будет назначена только одна рабочая учетная запись. Если другой пользователь Windows выполняет вход для запуска внешнего скрипта, запрос будет обрабатываться с помощью отдельной рабочей учетной записи.

  Это динамическое административное представление не возвращает результатов, если в данный момент скрипты не выполняются. Поэтому это представление эффективно для отслеживания длительных скриптов. Оно возвращает следующие значения:

  + **external_script_request_id**: GUID, который используется в качестве временное имя рабочего каталога, используемого для хранения сценариев и промежуточных результатов
  + **Язык**: значение, такое как `R` , обозначающий язык сценария, внешний
  + **degree_of_parallelism**: целое число, указывающее число используемых параллельных процессов, которые использовались
  + **external_user_name**: панель запуска рабочей учетной записи, такие как **SQLRUser01**

+ [sys.dm_external_script_execution_stats (Transact-SQL)](../../relational-databases/system-dynamic-management-views/sys-dm-external-script-execution-stats.md)

  Это динамическое административное Представление предоставляется внутренней (телеметрия) для мониторинга отслеживать, сколько внешнего скрипта вызовы выполняются в экземпляре. При запуске службы телеметрии [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] и увеличивает значение счетчика на диске при каждом вызове определенной функции машинного обучения.

  Этот счетчик увеличивается на один вызов отслеживаемых определенной функции. Например, если вызывается `rxLinMod` , который запускается параллельно, счетчик увеличивается на 1.
  
  В общем случае счетчики производительности допустимы только при условии, что активен создавший их процесс. Таким образом, запрос к динамическому административному представлению не может отобразить подробные данные для остановленной службы. Например, если панель запуска создает несколько параллельных заданий R, которые быстро выполняются, а затем очищаются объектом задания Windows, динамическое административное представление может не отображать данные.
 
  Поэтому счетчики, отслеживаемые этим динамическим административным представлением, продолжают выполняться, а состояние для счетчика dm_external_script_execution сохраняется путем записи на диск, даже при завершении работы экземпляра.
 
 Дополнительные сведения о счетчиках производительности системы, используемых [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], см. в статье [Использование объектов SQL Server](../../relational-databases/performance-monitor/use-sql-server-objects.md).

## <a name="resource-governor-views"></a>Представления регулятора ресурсов

В выпусках, поддерживающих регулятор ресурсов Создание внешних пулов ресурсов для рабочих нагрузок R или Python можно en эффективный способ отслеживания и управления ресурсами.

+ [sys.resource_governor_resource_pools](../../relational-databases/system-catalog-views/sys-resource-governor-resource-pools-transact-sql.md)

  Возвращает информацию о текущем состоянии пула ресурсов, текущую конфигурацию пула ресурсов и статистику пула ресурсов.

  > [!IMPORTANT]
  > 
  > Прежде чем выделить дополнительные ресурсы для служб R, необходимо изменить пулы ресурсов, которые применяются к другим службам сервера.

+ [sys.resource_governor_external_resource_pools](../../relational-databases/system-catalog-views/sys-resource-governor-external-resource-pools-transact-sql.md)

  Новое представление каталога, отображающее текущие значения конфигурации внешних пулов ресурсов.
  В выпуске Enterprise Edition можно настроить дополнительные внешние пулы ресурсов. Например, может потребоваться управлять ресурсами заданий R, запущенных в [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], отдельно от тех, которые исходят от удаленного клиента.

  > [!NOTE]
  > 
  > В выпуске Standard Edition всех внешних скриптов задания выполняются в том же пуле ресурсов по умолчанию внешние.

+ [sys.resource_governor_workload_groups](../../relational-databases/system-catalog-views/sys-resource-governor-workload-groups-transact-sql.md)

  Возвращает статистику и текущую конфигурацию группы рабочей нагрузки. Это представление можно объединить с представлением `sys.dm_resource_governor_resource_pools` для получения имени пула ресурсов.
  Для внешних скриптов добавлен новый столбец, содержащий идентификатор внешнего пула, связанного с группой рабочей нагрузки.

+ [sys.dm_resource_governor_external_resource_pool_affinity](../../relational-databases/system-dynamic-management-views/sys-dm-resource-governor-external-resource-pool-affinity-transact-sql.md)

  Новое представление системного каталога, в котором можно увидеть процессоры и ресурсы, привязанные к определенному пулу ресурсов.

  Возвращает по одной строке для каждого планировщика [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], сопоставленного с отдельным процессором. Используйте это представление для мониторинга состояния планировщика или для определения отклонившихся от расписания задач.

  В конфигурации по умолчанию пулы рабочей нагрузки автоматически назначаются процессорам, и поэтому значения сопоставления отсутствуют.

  Расписание сопоставления сопоставляет пул ресурсов с расписаниями [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], обозначенными заданными идентификаторами. Эти идентификаторы сопоставляются со значениями в `scheduler_id` столбца в `sys.dm_os_schedulers`.


> [!NOTE] 
> 
> Несмотря на то что возможность настройки пулов ресурсов доступна только в выпусках Enterprise и Developer, пулы по умолчанию, а также динамические административные представления доступны во всех выпусках. Таким образом в выпуске Standard Edition можно использовать следующие представления DMV для определения лимиты ресурсов для внешних скриптов заданий.

Общие сведения об отслеживании экземпляров [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] см. в статьях [System Catalog Views (Transact-SQL)](../../relational-databases/system-catalog-views/catalog-views-transact-sql.md) (Представления системного каталога (Transact-SQL)) и [Resource Governor Related Dynamic Management Views](../../relational-databases/system-dynamic-management-views/resource-governor-related-dynamic-management-views-transact-sql.md) (Динамические административные представления регулятора ресурсов (Transact-SQL)).

## <a name="monitoring-script-execution"></a>Мониторинг выполнения скрипта

Сценарии R и Python, которые выполняются в [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] запускаются по [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)] интерфейса. Панель запуска не регулируется ресурсами и не отслеживается отдельно, так как считается безопасной службой, предоставляемой корпорацией Майкрософт, которая управляет ресурсами соответствующим образом.

Отдельные сценарии, в которых выполняются службы панели запуска осуществляется с помощью [объект задания Windows](https://msdn.microsoft.com/library/windows/desktop/ms684161.aspx). Объект задания позволяет управлять группой процессов как единым целым. Каждый объект задания является иерархическим и управляет атрибутами всех связанных с ним процессов. Операции, выполняемые объектом задания, влияют на все связанные с ним процессы.

Таким образом, если необходимо завершить одно задание, связанное с объектом, учтите, что все связанные с ним процессы также будут завершены. Если вы используете скрипт R, который назначен объекту задания Windows и выполняет задание, связанное с ODBC, которое необходимо завершить, родительский процесс скрипта R также будет завершен.

При запуске внешнего сценария, который использует параллельную обработку, объект задания Windows управляет все параллельные дочерние процессы.

Чтобы определить, выполняется ли процесс в задании, используйте функцию `IsProcessInJob`.

## <a name="next-steps"></a>Следующие шаги

[Управление решениями машинного обучения и их мониторинг](../../advanced-analytics/r/managing-and-monitoring-r-solutions.md)
