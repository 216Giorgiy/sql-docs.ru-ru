---
title: "Шаг 2: Импорт данных в SQL Server с помощью PowerShell | Документы Microsoft"
ms.custom: 
ms.date: 10/17/2017
ms.prod: sql-server-vnext-ctp2
ms.reviewer: 
ms.suite: 
ms.technology:
- r-services
ms.tgt_pltfrm: 
ms.topic: article
applies_to:
- SQL Server 2017
dev_langs:
- Python
- TSQL
ms.assetid: 
caps.latest.revision: 2
author: jeannt
ms.author: jeannt
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: 2f28400200105e8e63f787cbcda58c183ba00da5
ms.openlocfilehash: b4741dcfee4bdc2e5ca2327b50f5dd727be9de55
ms.contentlocale: ru-ru
ms.lasthandoff: 10/18/2017

---
# <a name="step-2-import-data-to-sql-server-using-powershell"></a>Шаг 2: Импорт данных в SQL Server с помощью PowerShell

В этой статье является частью учебника [analytics Python в базе данных для разработчиков SQL](sqldev-in-database-python-for-sql-developers.md). 

На этом шаге выполните одну из загруженного скрипты, для создания объектов базы данных, необходимые для данного пошагового руководства. Скрипт также создает несколько хранимых процедур и отправляет образец данных в таблицу в базе данных указанного.

## <a name="create-database-objects-and-load-data"></a>Создание объектов базы данных и загрузки данных

Среди загруженных файлов вы увидите сценарий PowerShell `RunSQL_SQL_Walkthrough.ps1`. Этот сценарий предназначен для подготовки среды к выполнению пошагового руководства.

Скрипт выполняет следующие действия:

- Устанавливает собственный клиент SQL и служебные программы командной строки SQL, если еще не установлена. Эти программы необходимы для массовой загрузки данных в базу данных с помощью **bcp**.

- Создает базу данных и таблицу на [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляра и массовые вставки данных в таблицу.

- Создает несколько функций SQL и хранимых процедур.

Если возникли проблемы, можно использовать сценарий как ссылка для выполнения шагов вручную.

1. Откройте командную строку PowerShell от имени администратора. Если вы еще не в папку, созданную на предыдущем шаге, перейдите в папку и выполните следующую команду:
  
    ```ps
    .\RunSQL_SQL_Walkthrough.ps1
    ```

2. Скрипт запрашивает следующие сведения:

    - Имя или адрес [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] экземпляра, где установлены службы обучения машины с Python.
    - имя пользователя и пароль учетной записи в экземпляре; Используется учетная запись должна иметь возможность создавать базы данных, создание таблиц и хранимых процедур и массовой загрузки данных в таблицы. 
    - Если не указано имя пользователя и пароль удостоверения Windows используется для входа в SQL Server и повышаются на ввод пароля.
    - путь к скачанному файлу с образцом данных и его имя. Например `C:\temp\pysql\nyctaxi1pct.csv`

    > [!NOTE]
    > Для успешной загрузки данных в той же папке, что bcp.exe необходимо библиотеку xmlrw.dll.

3. Скрипт также изменяет [!INCLUDE[tsql](../../includes/tsql-md.md)] сценарии ранее загруженный, которое заменяет местозаполнителей пользователя и имя базы данных именем, которое вы предоставляют.
  
4. По завершении сценария входа [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляра, используя имя входа, указанное, чтобы убедиться, что базы данных, таблицы, функции и хранимые процедуры были созданы. На следующем рисунке показаны объекты в [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].

    ![Обзор таблиц в среде SSMS](media/sqldev-python-browsetables1.png "просмотреть таблицы в среде SSMS")

    > [!NOTE]
    > Если объекты базы данных уже существует, их невозможно создать повторно.
    > 
    > Если обнаруживается существующую таблицу с тем же именем и схемы, данные будут добавлены, не перезаписываются. Таким образом не забудьте удалить или усечь существующих таблиц перед выполнением скрипта.

## <a name="list-of-stored-procedures-and-functions"></a>Список хранимых процедур и функций

Следующие объекты SQL Server создаются с помощью скрипта:

|**Имя файла скрипта SQL**|**Функция**|
|------|------|
|create-db-tb-upload-data.sql|Создает базу данных и две таблицы:<br /><br />nyctaxi_sample: содержит основной набор данных по работе такси в Нью-Йорке. К таблице добавляется кластеризованный индекс columnstore для оптимизации хранения данных и производительности запросов. В таблицу будет вставлена выборка, содержащая 1 % от общего объема набора данных по работе такси в Нью-Йорке.<br /><br />nyc_taxi_models: используется для сохранения обученной модели расширенной аналитики.|
|fnCalculateDistance.sql|Создает скалярную функцию, которая вычисляет прямое расстояние между местами посадки и высадки.|
|fnEngineerFeatures.sql|Создает табличную функцию, которая формирует новые характеристики данных для обучения модели.|
|TrainingTestingSplit.sql|Разделить данные в таблице nyctaxi_sample на две части: nyctaxi_sample_training и nyctaxi_sample_testing.|
|PredictTipSciKitPy.sql|Создает хранимую процедуру, которая вызывает обученной модели (scikit-узнать) для создания прогнозов с помощью модели. Хранимая процедура принимает запрос в качестве входного параметра и возвращает столбец числовых значений, представляющих оценки для входных строк.|
|PredictTipRxPy.sql|Создает хранимую процедуру, которая вызывает обученной модели (revoscalepy) для создания прогнозов с помощью модели. Хранимая процедура принимает запрос в качестве входного параметра и возвращает столбец числовых значений, представляющих оценки для входных строк.|
|PredictTipSingleModeSciKitPy.sql|Создает хранимую процедуру, которая вызывает обученной модели (scikit-узнать) для создания прогнозов с помощью модели. Эта хранимая процедура принимает новое наблюдение в качестве входных данных, причем отдельные значения характеристик передаются как встроенные параметры, и возвращает значение, представляющее прогнозируемый результат для нового наблюдения.|
|PredictTipSingleModeRxPy.sql|Создает хранимую процедуру, которая вызывает обученной модели (revoscalepy) для создания прогнозов с помощью модели. Эта хранимая процедура принимает новое наблюдение в качестве входных данных, причем отдельные значения характеристик передаются как встроенные параметры, и возвращает значение, представляющее прогнозируемый результат для нового наблюдения.|

В последней части этого пошагового руководства создайте эти дополнительные хранимые процедуры:
    
|**Имя файла скрипта SQL**|**Компонент**|
|------|------|
|SerializePlots.sql|Создает хранимую процедуру для изучения данных. Эта хранимая процедура создает графический объект, с помощью Python и последующей сериализации графа объектов.|
|TrainTipPredictionModelSciKitPy.sql|Создает хранимую процедуру, которая обучает модель логистической регрессии (scikit-узнать). Модель прогнозирует значение скошенные столбца и обучается с помощью случайно выбранных 60% данных. Выходными данными хранимой процедуры является обученная модель, которая сохраняется в таблице nyc_taxi_models.|
|TrainTipPredictionModelRxPy.sql|Создает хранимую процедуру, которая обучает модель логистической регрессии (revoscalepy). Модель прогнозирует значение скошенные столбца и обучается с помощью случайно выбранных 60% данных. Выходными данными хранимой процедуры является обученная модель, которая сохраняется в таблице nyc_taxi_models.|

## <a name="next-step"></a>Следующий шаг

[Шаг 3. Анализ и визуализация данных](sqldev-py3-explore-and-visualize-the-data.md)

## <a name="previous-step"></a>Предыдущий шаг

[Шаг 1. Скачивание образца данных](sqldev-py1-download-the-sample-data.md)


