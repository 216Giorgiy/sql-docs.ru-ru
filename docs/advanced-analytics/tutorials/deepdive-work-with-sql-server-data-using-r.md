---
title: "Работа с данными SQL Server, с помощью R | Документы Microsoft"
ms.custom: SQL2016_New_Updated
ms.date: 05/18/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology: r-services
ms.tgt_pltfrm: 
ms.topic: article
applies_to: SQL Server 2016
dev_langs: R
ms.assetid: 0a3d7ba0-4113-4cde-9645-debba45cae8f
caps.latest.revision: "20"
author: jeannt
ms.author: jeannt
manager: jhubbard
ms.workload: On Demand
ms.openlocfilehash: 2e8e8d4d802e2a940127fff8f6ecd0f831e6711a
ms.sourcegitcommit: 531d0245f4b2730fad623a7aa61df1422c255edc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2017
---
# <a name="work-with-sql-server-data-using-r"></a>Работа с данными SQL Server, с помощью R

На этом занятии вы настроите среду и добавите данные, которые потребуются для обучения моделей и создания кратких сводок. В рамках этого процесса вы выполните следующие задачи:
  
- создадите базу данных, в которой будут храниться данные для обучения и оценки двух моделей R;
  
- создадите учетную запись (пользователя Windows или имя входа SQL), которая будет использоваться для обмена данными между рабочей станцией и сервером [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ;
  
- создадите источники данных в R для работы с данными и объектами базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ;
  
- используете источник данных R для загрузки данных в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)];
  
- используете язык R для получения списка переменных и изменения метаданных таблицы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ;
  
- создадите контекст вычисления для удаленного выполнения кода на языке R;
  
- узнаете, как включать трассировку в удаленном контексте вычисления.
  
## <a name="create-the-database-and-user"></a>Создание базы данных и пользователя

Для работы с этим пошаговым руководством вы создадите базу данных в [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]и добавите имя входа SQL с разрешениями на запись и чтение данных, а также на выполнение скриптов R.

> [!NOTE]
> Если выполняется только чтение данных, учетная запись, которая запускает сценарии R требуется только разрешение SELECT (**db_datareader** роли) в указанной базе данных. Однако в этом учебнике вам потребуются права администратора DDL с целью подготовки базы данных и создания таблиц для сохранения результатов оценки.
> 
> Кроме того Если вы не являетесь владельцем базы данных, потребуются разрешения EXECUTE ANY EXTERNAL SCRIPT, чтобы иметь возможность выполнять сценарии R.

1. В среде [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]выберите экземпляр, в котором включены службы [!INCLUDE[rsql_productname](../../includes/rsql-productname-md.md)] , щелкните правой кнопкой мыши элемент **базы данных**и выберите пункт **Создать базу данных**.
  
2. Введите имя новой базы данных. Вы можете использовать любое имя, но не забудьте внести соответствующие изменения во все скрипты [!INCLUDE[tsql](../../includes/tsql-md.md)] и R в этом пошаговом руководстве.
  
    > [!TIP]
    > Чтобы увидеть новое имя базы данных, щелкните правой кнопкой мыши элемент **Базы данных** и выберите пункт **Обновить** .
  
3. Щелкните **Создать запрос**и измените контекст базы данных на master.
  
4. В новом окне **Запрос** выполните приведенные ниже команды, чтобы создать учетные записи пользователей и назначить их базе данных, используемой в этом учебнике. При необходимости измените имя базы данных.
  
**Пользователь Windows**
  
```SQL
 -- Create server user based on Windows account
USE master
GO
CREATE LOGIN [<DOMAIN>\<user_name>] FROM WINDOWS WITH DEFAULT_DATABASE=[DeepDive]

 --Add the new user to tutorial database
USE [DeepDive]
GO
CREATE USER [<user_name>] FOR LOGIN [<DOMAIN>\<user_name>] WITH DEFAULT_SCHEMA=[db_datareader]
```

**Имя входа SQL**

```SQL
-- Create new SQL login
USE master
GO
CREATE LOGIN DDUser01 WITH PASSWORD='<type password here>', CHECK_EXPIRATION=OFF, CHECK_POLICY=OFF;

-- Add the new SQL login to tutorial database
USE [DeepDive]
GO
CREATE USER [DDUser01] FOR LOGIN [DDUser01] WITH DEFAULT_SCHEMA=[db_datareader]
```

5. Чтобы проверить, был ли создан пользователь, выберите новую базу данных, а затем разверните узлы **Безопасность**и **Пользователи**.

## <a name="troubleshooting"></a>Устранение неполадок

В этом разделе перечислены некоторые распространенные проблемы, которые могут возникнуть в процессе настройки базы данных.

- **Как проверить подключение к базе данных и запросы SQL?**
  
    Перед выполнением кода на языке R с помощью сервера может потребоваться проверить, доступна ли база данных из среды разработки R. [Обозреватель сервера Visual Studio](https://msdn.microsoft.com/library/x603htbk.aspx) и [среда SQL Server Management Studio](../../ssms/download-sql-server-management-studio-ssms.md) являются бесплатными средствами с эффективными возможностями подключения к базам данных и функциями управления.
  
    Если вы не хотите устанавливать дополнительные средства управления базами данных, то можете создать тестовое подключение к экземпляру SQL Server с помощью компонента [Администратор источников данных ODBC](https://msdn.microsoft.com/library/ms714024.aspx) на панели управления. Если база данных настроена правильно и вы ввели верные имя пользователя и пароль, то вы увидите созданную базу данных и сможете выбрать ее в качестве базы данных по умолчанию.
  
    Если вы не можете подключиться к базе данных, проверьте, включены ли удаленные подключения для сервера и включен ли протокол именованных каналов. Дополнительные советы по устранению неполадок можно найти в [этой статье](http://social.technet.microsoft.com/wiki/contents/articles/2102.how-to-troubleshoot-connecting-to-the-sql-server-database-engine.aspx).
  
- **Почему имя таблицы имеет префикс datareader?**
  
    При указании схемы по умолчанию **db_datareader**для пользователя все таблицы и другие объекты, создаваемые этим пользователем, будут иметь префикс в виде этой *схемы*. Схема напоминает папку, которую можно добавить к базе данных для упорядочения объектов. Схема также определяет права пользователя в базе данных.
  
    Если схема связана с одним именем пользователя, этот пользователь называется владельцем схемы. Когда вы создаете объект, он всегда создается в вашей собственной схеме, если вы специально не укажете, что он должен быть создан в другой схеме.
  
    Например, если вы создаете таблицу с именем *TestData* и ваша схема по умолчанию — **db_datareader**, таблица будет создана с именем *<имя_базы_данных>.db_datareader.TestData*.
  
    По этой причине база данных может содержать несколько таблиц с одинаковыми именами, если они относятся к разным схемам.
   
    Если вы ищете таблицу, но не указали схему, сервер базы данных будет вести поиск в вашей собственной схеме. Поэтому нет необходимости указывать имя схемы при доступе к таблицам в схеме, связанной в вашим именем входа.
  
- **У меня нет прав DDL. Могу ли я работать с учебником?**
  
    Да. Однако вам нужно будет предварительно попросить кого-нибудь загрузить данные в таблицы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], а затем пропустить разделы, в которых требуется создать таблицы. Функции, требующие прав DDL, в этом учебнике в основном опущены.

    Кроме того обратитесь к администратору, чтобы предоставить вам разрешения EXECUTE ANY EXTERNAL SCRIPT. Он необходим для выполнения скриптов R, удаленных или с помощью `sp_execute_external_script`.

## <a name="next-step"></a>Следующий шаг

[Создание объектов данных SQL Server с помощью функции RxSqlServerData](../../advanced-analytics/tutorials/deepdive-create-sql-server-data-objects-using-rxsqlserverdata.md)

## <a name="overview"></a>Обзор

[Глубокое погружение в обработку и анализ данных: использование пакетов RevoScaleR](../../advanced-analytics/tutorials/deepdive-data-science-deep-dive-using-the-revoscaler-packages.md)



