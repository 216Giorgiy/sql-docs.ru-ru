---
title: Собственная Оценка в службе машинного обучения SQL Server | Документация Майкрософт
description: Создание прогнозов с помощью функции ПРОГНОЗИРОВАНИЯ T-SQL, количественная оценка входных данных dta к предварительно обученной модели на языке R или Python на сервере SQL Server.
ms.prod: sql
ms.technology: machine-learning
ms.date: 08/15/2018
ms.topic: conceptual
author: HeidiSteen
ms.author: heidist
manager: cgronlun
ms.openlocfilehash: bf8f9a6362b72efddccbf5c2b0e54096c6e86aa7
ms.sourcegitcommit: 9cd01df88a8ceff9f514c112342950e03892b12c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2018
ms.locfileid: "40392225"
---
# <a name="native-scoring-using-the-predict-t-sql-function"></a>Собственная Оценка с помощью функции ПРОГНОЗИРОВАНИЯ T-SQL
[!INCLUDE[appliesto-ss-asdb-xxxx-xxx-md](../includes/appliesto-ss-asdb-xxxx-xxx-md.md)]

Получив предварительно обученную модель, новые входные данные можно передать в функцию, для формирования прогноза значений или *оценок*. В SQL Server 2017 Windows или Linux, или в базе данных SQL Azure можно использовать функцию PREDICT в Transact-SQL для поддержки собственной оценки. Он требуется только, что у вас есть модель уже обучена, которую можно вызвать с помощью T-SQL. 

+ Что такое собственного, оценки и оценки в реальном времени
+ Принцип работы
+ Поддерживаемые платформы и требования

## <a name="what-is-native-scoring-and-how-is-it-different-from-real-time-scoring"></a>Что такое собственная оценка и чем она отличается от оценки в реальном времени?

В SQL Server 2016 Корпорация Майкрософт создала платформу расширения, позволяет сценариям R, выполняемый из T-SQL. Эта платформа поддерживает любой операции, которые можно выполнять в R, от простых функций для обучения сложных моделей машинного обучения. Тем не менее архитектура dual процесса требуется вызов внешнего процесса R для каждого вызова, вне зависимости от сложности операции. Если вы загружаете предварительно обученной модели из таблицы и оценку на основе его на основе данных уже в SQL Server, затраты на вызов внешний процесс r. представляет затрат производительности.

_Оценки_ представляет собой двухэтапный процесс. Сначала необходимо указать предварительно обученную модель для загрузки из таблицы. Во-вторых, передайте новые входные данные функции, для формирования прогноза значений (или _оценок_). Входные данные могут быть табличном, так и для одной строки. Можно выбрать для вывода одного столбца значение, представляющее вероятность или могут выдавать несколько значений, таких как доверительный интервал, ошибка или другим полезным дополнением к прогноза.

Если входных данных содержит несколько строк данных, обычно это быстрее для вставки значений прогноза в таблицу в ходе процесса оценки.  Создание оценки обычно в сценарии, где получает входные значения из формы или запроса пользователя, а также возвращают оценку клиентскому приложению. Чтобы повысить производительность при создании последовательных оценок, SQL Server может кэшировать модели таким образом, чтобы его можно загрузить в память.

Для поддержки быстрого оценки, службы машинного обучения SQL Server (и Microsoft Machine Learning Server) предоставляют встроенные оценки библиотеки, которые работают в R или T-SQL. Существуют различные варианты в зависимости от версии.

**Собственная оценка**

+ Функция PREDICT в Transact-SQL поддерживает _собственной оценки_ в любом экземпляре SQL Server 2017. Он требуется только, что у вас есть модель уже обучена, которую можно вызвать с помощью T-SQL. Собственная Оценка с помощью T-SQL, предоставляет следующие преимущества:

    + Дополнительная настройка не требуется.
    + Среда выполнения R не вызывается. Нет необходимости в установке R.

**Оценка в режиме реального времени**

+ **sp_rxPredict** является хранимой процедурой для оценки в реальном времени, можно использовать для создает оценок из любого типа поддерживаемых модели без вызова среды выполнения R.

  Эта хранимая процедура также доступна в SQL Server 2016, если обновить компоненты R, с помощью автономного установщика из Microsoft R Server. sp_rxPredict также поддерживается в SQL Server 2017. Таким образом эту функцию можно использовать при создании оценки с типом модели, не поддерживается функцией PREDICT.

+ Для быстрой оценки в коде R можно использовать функцию rxPredict.

Для всех методов количественной необходимо использовать модель, которая была обучена с помощью одного из поддерживаемых алгоритмов RevoScaleR или MicrosoftML.

Пример оценки в реальном времени в действии, см. в разделе [сквозное окончания ссуды списания кредита прогноза построен с помощью Azure HDInsight кластеров Spark и служба SQL Server 2016 R](https://blogs.msdn.microsoft.com/rserver/2017/06/29/end-to-end-loan-chargeoff-prediction-built-using-azure-hdinsight-spark-clusters-and-sql-server-2016-r-service/)

## <a name="how-native-scoring-works"></a>Как неуправляемый код оценки works

Собственная Оценка использует собственные библиотеки C++ корпорации Майкрософт, могут читать модели из специальных двоичный формат и формирование оценок. Поскольку модели можно публиковать и использовать для оценки без вызова интерпретатор R, сокращается объем работ нескольких взаимодействий процесса. Таким образом собственной оценки поддерживает значительно повысить производительность прогнозирования в рабочей среде на предприятии.

Для создания оценок с помощью этой библиотеки, вызвать функцию оценки и передать следующие необходимые входные данные:

+ Совместимой модели. См. в разделе [требования](#Requirements) подробные сведения см.
+ Входные данные, обычно определяется как SQL-запроса

Функция возвращает прогнозы для входных данных, а также все столбцы исходных данных, который будет проходить через.

Примеры кода, а также инструкции о том, как подготавливать моделей в требуемом двоичном формате, см. в статье:

+ [Способы выполнения оценки в реальном времени](r/how-to-do-realtime-scoring.md)

Для формирования комплексного решения, включающий собственной оценки см. в этих примерах от команды разработчиков SQL Server:

+ Развертывание скрипта машинного Обучения: [с помощью модели Python](https://microsoft.github.io/sql-ml-tutorials/python/rentalprediction/step/3.html)
+ Развертывание скрипта машинного Обучения: [с помощью R-модели](https://microsoft.github.io/sql-ml-tutorials/R/rentalprediction/step/3.html)

## <a name="requirements"></a>Требования

Поддерживаемыми платформами являются следующим образом:

+ Служб SQL Server 2017 машинного обучения с (включает в себя Microsoft R Server 9.1.0)
    
    Собственная Оценка использование PREDICT требуется SQL Server 2017.
    Он работает в любой версии SQL Server 2017, включая Linux.

    Можно также выполнить оценка с помощью sp_rxPredict в реальном времени. Для использования этой хранимой процедуры необходимо включить [интеграция со средой CLR для SQL Server](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/introduction-to-sql-server-clr-integration).

+ SQL Server 2016

   В реальном времени, оценки с использованием sp_rxPredict возможна с помощью SQL Server 2016, а также можно запустить на сервере Microsoft R Server. Этот параметр требует SQLCLR, чтобы включить и установить обновления Microsoft R Server.
   Дополнительные сведения см. в разделе [оценки в реальном времени](Real-time-scoring.md)

### <a name="model-preparation"></a>Модель подготовки

+ Обучение модели должен быть на основе заранее с помощью одного из поддерживаемых **rx** алгоритмы. Дополнительные сведения см. в разделе [Поддерживаемые алгоритмы](#bkmk_native_supported_algos).
+ Модель должна быть сохранена с помощью новой функции сериализации, в Microsoft R Server 9.1.0. Функция сериализации оптимизирован для поддержки быстрого оценки.

### <a name="bkmk_native_supported_algos"></a> Алгоритмы, поддерживающие собственной оценки

+ RevoScaleR моделей

  + [rxLinMod](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxlinmod)
  + [rxLogit](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxlogit)
  + [rxBTrees](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxbtrees)
  + [rxDtree](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxdtree)
  + [rxDForest](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxdforest)

Если вам нужно использовать модели из MicrosoftML, используйте оценки в реальном времени с sp_rxPredict.

### <a name="restrictions"></a>Ограничения

Не поддерживаются следующие модели:

+ Модели, содержащий другие неподдерживаемые типы преобразований R
+ Моделирует использование `rxGlm` или `rxNaiveBayes` алгоритмы в RevoScaleR
+ PMML модели
+ Модели, созданные с помощью других библиотек R из CRAN или других репозиториев
+ Модели, содержащий какого-либо другие преобразования R

## <a name="see-also"></a>См. также

[Оценка в службе машинного обучения SQL Server в реальном времени ](real-time-scoring.md)