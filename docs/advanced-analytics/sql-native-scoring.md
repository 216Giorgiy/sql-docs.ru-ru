---
title: "Оценки собственного | Документы Microsoft"
ms.custom: 
ms.date: 07/16/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- r-services
ms.tgt_pltfrm: 
ms.topic: article
author: jeannt
ms.author: jeannt
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: 876522142756bca05416a1afff3cf10467f4c7f1
ms.openlocfilehash: e1cb06223e5274c1fa439eb9f7d82a005e93a47d
ms.contentlocale: ru-ru
ms.lasthandoff: 09/01/2017

---

# <a name="native-scoring"></a>Машинный код оценки

В этом разделе описаны возможности 2017 г. SQL Server, предоставляющими оценки моделей машинного обучения в почти в реальном времени.

+ Что такое собственного оценки и оценки в реальном времени
+ Принцип работы
+ Поддерживаемые платформы и требования

## <a name="what-is-native-scoring-and-how-is-it-different-from-realtime-scoring"></a>Новые возможности собственного оценки и как он отличается от оценки в режиме реального времени?

В SQL Server 2016 Корпорация Майкрософт создала расширяемости платформу, позволяющую R-скриптов будет запускаться из T-SQL. Эта платформа поддерживает любой операции, которые необходимо выполнять в R, от простых функций, для обучения сложных моделей машинного обучения. Однако архитектура двумя процессами, связывающий R с помощью SQL Server означает, что внешние процессы R должна вызываться для каждого вызова, вне зависимости от сложности операции. При загрузке предварительно обученной модели из таблицы и ее оценки на ее основе данные SQL Server, издержки, связанные с вызовом внешний процесс R представляет затрат производительности.

_Оценки_ состоит из двух этапов: предварительно обученной модели загружается из таблицы, и новые входные данные, табличные или одной строки, передается в модель, которая создает новые значения (или _оценки_). Выходные данные может быть один столбец значение, представляющее вероятность или несколько значений, включая доверительный интервал, ошибки или другие полезные дополнения для прогноза.

При оценке большого количества строк данных, новые значения обычно будут вставлены в таблицу в рамках процедуры оценки.  Однако можно также получать среднему значению в режиме реального времени. При оценке последующих входов, модели, чтобы его можно загрузить в память быстрого могут быть кэшированы.

Для поддержки быстрой оценки, службы SQL Server машины обучения (и обучения машины Microsoft Server) предоставляют встроенные оценки библиотеки, работающие в R и в T-SQL. Существуют различные варианты в зависимости от версии имеются.

**Машинный код оценки**

+ Можно использовать функции ПРОГНОЗИРОВАНИЯ в Transact-SQL для _оценки собственного_ из любого экземпляра 2017 г. SQL Server. Требуется только что имеется модель уже обучена и сохраняется в таблице или может быть вызван с помощью T-SQL. Это тип оценки в реальном времени, который использует собственные функции T-SQL; Дополнительная настройка не требуется.

   Среда выполнения R не вызывается и не должны быть установлены.

**Оценки в реальном времени**

+ **sp_rxPredict** является хранимой процедурой, для оценки, в реальном времени можно использовать для создания оценки из любого типа поддерживаемых модели без вызова среды выполнения R.

  Этот параметр для использования в реальном времени оценки доступна в SQL Server 2016 при обновлении компонентов R, с помощью автономного установщика сервера Microsoft R Server. sp_rxPredict также поддерживается в SQL Server 2017 г. и может быть хорошим вариантом, если вы оцениваете типа модели, не поддерживается функция PREDICT.

+ Функция rxPredict может использоваться для быстрой оценки в коде R.

Все эти методы количественной оценки необходимо использовать модель, которая была обучена с помощью одного из поддерживаемых алгоритмов RevoScaleR или MicrosoftML.

Пример оценки в действии в реальном времени см. в разделе [начала до окончания кредитов ChargeOff прогноза построен с использованием Azure HDInsight Spark кластеров и службы R SQL Server 2016](https://blogs.msdn.microsoft.com/rserver/2017/06/29/end-to-end-loan-chargeoff-prediction-built-using-azure-hdinsight-spark-clusters-and-sql-server-2016-r-service/)

## <a name="how-native-scoring-works"></a>Как работает оценки

Оценки собственного использует собственные библиотеки C++ корпорации Майкрософт, могут читать модели из специальных двоичный формат и создавать оценки. Поскольку модели могут публиковаться и используемых для оценки без вызова интерпретатора R, снижает издержки взаимодействий нескольких процессов. Это позволяет значительно повысить производительность прогнозирования в рабочих сценариях enterprise.

Для формирования оценок с помощью этой библиотеки, вызвать функция оценки и передать следующие необходимые входные данные:

+ Совместимые модели. В разделе [требования](#Requirements) подробные сведения см.
+ Входные данные, обычно определяются как SQL-запроса

Эта функция возвращает прогнозы для входных данных, а также все столбцы источника данных необходимо пройти.

Образцы кода, а также инструкции по подготовке моделей в требуемый двоичный формат см. в этой статье:

+ [Как выполнять оценки в реальном времени](r/how-to-do-realtime-scoring.md)

## <a name="requirements"></a>Требования

Поддерживаемыми платформами являются следующим образом:

+ Службы SQL Server 2017 г машины обучения с (включает Microsoft R Server 9.1.0)
    
    ПРОГНОЗ с помощью собственного оценки требует 2017 г. SQL Server.
    Он работает с любой версии SQL Server 2017 г., включая Linux.

    Можно также выполнить оценки в реальном времени с помощью sp_rxPredict, который требует включения SQL CLR.

+ SQL Server 2016

   В реальном времени, оценки с помощью sp_rxPredict возможна с помощью SQL Server 2016, а также можно запустить на сервере Microsoft R Server. Этот параметр требует SQLCLR, чтобы включить и установить обновления Microsoft R Server.
   Дополнительные сведения см. в разделе [оценки в реальном времени](Real-time-scoring.md)

### <a name="model-preparation"></a>Подготовка к модели

+ Модель должна обучена заранее с помощью одного из поддерживаемых **rx** алгоритмы. Дополнительные сведения см. в разделе [поддерживается алгоритмы](#bkmk_native_supported_algos).
+ Модель должна быть сохранена с помощью новой функции сериализации, предоставляемые сервером Microsoft R 9.1.0. Функция сериализации оптимизирована для поддержки быстрой оценки.

### <a name="bkmk_native_supported_algos"></a>Алгоритмов, поддерживающих native оценки

+ RevoScaleR моделей

  + [rxLinMod](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxlinmod)
  + [rxLogit](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxlogit)
  + [rxBTrees](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxbtrees)
  + [rxDtree](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxdtree)
  + [rxdForest](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxdforest)

Если необходимо использовать модели на основе MicrosoftML, используйте оценки с sp_rxPredict в реальном времени.

### <a name="restrictions"></a>Ограничения

Приведенные ниже типы моделей не поддерживаются:

+ Моделей, которые содержат другие неподдерживаемые типы преобразований R
+ Модели с помощью `rxGlm` или `rxNaiveBayes` алгоритмы в RevoScaleR
+ PMML модели
+ Модели, созданные с помощью других библиотек R из CRAN или другие репозитории
+ Моделей, которые содержат любого другого вида преобразования R

