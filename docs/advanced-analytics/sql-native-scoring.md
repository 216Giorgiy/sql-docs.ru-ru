---
title: "Оценки собственного | Документы Microsoft"
ms.custom: 
ms.date: 09/19/2017
ms.prod: sql-non-specified
ms.prod_service: r-services
ms.service: 
ms.component: advanced-analytics
ms.reviewer: 
ms.suite: sql
ms.technology: r-services
ms.tgt_pltfrm: 
ms.topic: article
author: jeannt
ms.author: jeannt
manager: jhubbard
ms.openlocfilehash: 92bb9ad88b884d5104f2fbc716151ce91f3d764e
ms.sourcegitcommit: f1a6944f95dd015d3774a25c14a919421b09151b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2017
---
# <a name="native-scoring"></a>Машинный код оценки

В этом разделе описаны возможности 2017 г. SQL Server, предоставляющими оценки моделей машинного обучения в почти в реальном времени.

+ Что такое собственного оценки и оценки в реальном времени
+ Принцип работы
+ Поддерживаемые платформы и требования

## <a name="what-is-native-scoring-and-how-is-it-different-from-realtime-scoring"></a>Новые возможности собственного оценки и как он отличается от оценки в режиме реального времени?

В SQL Server 2016 Корпорация Майкрософт создала расширяемости платформу, позволяющую R-скриптов будет запускаться из T-SQL. Эта платформа поддерживает любой операции, которые необходимо выполнять в R, от простых функций, для обучения сложных моделей машинного обучения. Тем не менее архитектура процесса двумя требуется вызов внешнего процесса R для каждого вызова, вне зависимости от сложности операции. При загрузке предварительно обученной модели из таблицы и ее оценки на ее основе данные SQL Server, издержки, связанные с вызовом внешний процесс R представляет затрат производительности.

_Оценки_ состоит из двух этапов. Во-первых можно указать предварительно обученной модели для загрузки из таблицы. Во-вторых, передайте новые входные данные в функцию, для формирования прогноза значений (или _оценки_). Входные данные могут быть табличные или одной строки. Можно выбрать для вывода значения одного столбца, представляющее вероятность или могут выдавать несколько значений, таких как доверительный интервал, ошибки или другие полезные дополнения для прогноза.

Если входные данные включает множество строк данных, это обычно быстрее для вставки значений прогноза в таблицу как часть процесса оценки.  Создание среднему значению является типичной в сценарии, где получает входные значения из формы или пользовательского запроса, а также возвращать оценка клиентскому приложению. Чтобы повысить производительность при создании последующих оценок, SQL Server может кэшировать модели, чтобы его можно загрузить в память.

Для поддержки быстрой оценки, службы SQL Server машины обучения (и обучения машины Microsoft Server) предоставляют встроенные оценки библиотеки, работающие в R и в T-SQL. Существуют различные варианты в зависимости от версии имеются.

**Собственная оценка**

+ Функция ПРОГНОЗИРОВАНИЯ в Transact-SQL поддерживает _оценки собственного_ в любом экземпляре 2017 г. SQL Server. Она необходима только модель уже обучена, который можно вызывать с помощью T-SQL. Собственный оценки с помощью T-SQL предоставляет следующие преимущества:

    + Дополнительная настройка не требуется.
    + Среда выполнения R не вызывается. Нет необходимости устанавливать R.

**Оценки в реальном времени**

+ **sp_rxPredict** является хранимой процедурой, для оценки, в реальном времени можно использовать для создания оценки из любого типа поддерживаемых модели без вызова среды выполнения R.

  Эта хранимая процедура доступна в SQL Server 2016 при обновлении компонентов R, с помощью автономного установщика сервера Microsoft R Server. sp_rxPredict также поддерживается в 2017 г. SQL Server. Таким образом можно использовать эту функцию при создании оценки с типом модели, не поддерживается функция PREDICT.

+ Функция rxPredict может использоваться для быстрой оценки в коде R.

Все эти методы количественной оценки необходимо использовать модель, которая была обучена с помощью одного из поддерживаемых алгоритмов RevoScaleR или MicrosoftML.

Пример оценки в действии в реальном времени см. в разделе [начала до окончания кредитов ChargeOff прогноза построен с использованием Azure HDInsight Spark кластеров и службы R SQL Server 2016](https://blogs.msdn.microsoft.com/rserver/2017/06/29/end-to-end-loan-chargeoff-prediction-built-using-azure-hdinsight-spark-clusters-and-sql-server-2016-r-service/)

## <a name="how-native-scoring-works"></a>Как работает оценки

Оценки собственного использует собственные библиотеки C++ корпорации Майкрософт, могут читать модели из специальных двоичный формат и создавать оценки. Поскольку модели могут публиковаться и используемых для оценки без вызова интерпретатора R, снижает издержки взаимодействий нескольких процессов. Таким образом оценки собственного поддерживает значительно повысить производительность прогнозирования в рабочих сценариях предприятия.

Для формирования оценок с помощью этой библиотеки, вызвать функция оценки и передать следующие необходимые входные данные:

+ Совместимые модели. В разделе [требования](#Requirements) подробные сведения см.
+ Входные данные, обычно определяются как SQL-запроса

Эта функция возвращает прогнозы для входных данных, а также все столбцы источника данных необходимо пройти.

Образцы кода, а также инструкции по подготовке моделей в требуемый двоичный формат см. в этой статье:

+ [Как выполнять оценки в реальном времени](r/how-to-do-realtime-scoring.md)

Комплексное решение, включающий собственного оценки см. в этих примерах от команды разработчиков SQL Server.

+ Развертывание сценария ML: [с помощью модели Python](https://microsoft.github.io/sql-ml-tutorials/python/rentalprediction/step/3.html)
+ Развертывание сценария ML: [с помощью R-модели](https://microsoft.github.io/sql-ml-tutorials/R/rentalprediction/step/3.html)

## <a name="requirements"></a>Требования

Поддерживаемыми платформами являются следующим образом:

+ Службы SQL Server 2017 г машины обучения с (включает Microsoft R Server 9.1.0)
    
    ПРОГНОЗ с помощью собственного оценки требует 2017 г. SQL Server.
    Он работает с любой версии SQL Server 2017 г., включая Linux.

    Можно также выполнить оценки в реальном времени с помощью sp_rxPredict. Для использования этой хранимой процедуры необходимо включить [интеграция со средой CLR для SQL Server](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/introduction-to-sql-server-clr-integration).

+ SQL Server 2016

   Оценки с помощью sp_rxPredict в реальном времени возможна с помощью SQL Server 2016, а также можно запустить на сервере Microsoft R. Этот параметр требует SQLCLR, чтобы включить и установить обновления Microsoft R Server.
   Дополнительные сведения см. в разделе [оценки в реальном времени](Real-time-scoring.md)

### <a name="model-preparation"></a>Подготовка к модели

+ Модель должна обучена заранее с помощью одного из поддерживаемых **rx** алгоритмы. Дополнительные сведения см. в разделе [поддерживается алгоритмы](#bkmk_native_supported_algos).
+ Модель должна быть сохранена с помощью новой функции сериализации, предоставляемые сервером Microsoft R 9.1.0. Функция сериализации оптимизирована для поддержки быстрой оценки.

### <a name="bkmk_native_supported_algos"></a>Алгоритмов, поддерживающих native оценки

+ RevoScaleR моделей

  + [rxLinMod](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxlinmod)
  + [rxLogit](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxlogit)
  + [rxBTrees](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxbtrees)
  + [rxDtree](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxdtree)
  + [rxDForest](https://docs.microsoft.com/r-server/r-reference/revoscaler/rxdforest)

Если необходимо использовать модели на основе MicrosoftML, используйте оценки с sp_rxPredict в реальном времени.

### <a name="restrictions"></a>Ограничения

Приведенные ниже типы моделей не поддерживаются:

+ Моделей, которые содержат другие неподдерживаемые типы преобразований R
+ Модели с помощью `rxGlm` или `rxNaiveBayes` алгоритмы в RevoScaleR
+ PMML модели
+ Модели, созданные с помощью других библиотек R из CRAN или другие репозитории
+ Модели, содержащий все другие преобразования R
