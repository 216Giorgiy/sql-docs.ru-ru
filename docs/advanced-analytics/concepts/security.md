---
title: Безопасность для машинного обучения SQL Server | Документация Майкрософт
description: Общие сведения о безопасности инфраструктуры расширяемости в службах машинного обучения SQL Server. Безопасность для учетных записей входа и пользователя, службы панели запуска SQL Server, рабочих учетных записей, под управлением нескольких сценариев и разрешения для файлов.
ms.prod: sql
ms.technology: machine-learning
ms.date: 10/10/2018
ms.topic: conceptual
author: dphansen
ms.author: davidph
manager: cgronlun
ms.openlocfilehash: bee8e2162c56ac1b26273873943d848c2167dbda
ms.sourcegitcommit: 485e4e05d88813d2a8bb8e7296dbd721d125f940
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2018
ms.locfileid: "49100405"
---
# <a name="security-overview-for-the-extensibility-framework-in-sql-server-machine-learning-services"></a>Общие сведения о безопасности для инфраструктуры расширяемости в службах машинного обучения SQL Server

[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

В этой статье описывается общая архитектура безопасности, используемый для подключения к структуре расширяемости ядра СУБД SQL Server и связанных компонентов. Описываются компоненты и взаимодействия. 

<a name="launchpad"></a>

## <a name="sql-server-launchpad-service"></a>Служба панели запуска SQL Server

Для создания экземпляра внешних процессов, ядро базы данных предоставляет службу панели запуска SQL Server для создания сеанса R или Python. Отдельный [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)] служба создается для экземпляра компонента database engine к которому вы добавили интеграции SQL Server машины обучения (R или Python), одна служба каждого экземпляра.

По умолчанию [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)] настроен для запуска под **NT Service\MSSQLLaunchpad**, которой предоставлены все необходимые разрешения для выполнения внешних скриптов. Удаление разрешений из этой учетной записи может привести к [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)] не удается запустить или получить доступ к экземпляру SQL Server, где должны запускаться внешних скриптов. Служба панели запуска обычно используется в качестве-является, но Дополнительные сведения о настраиваемых параметрах см. в разделе [конфигурации службы панели запуска SQL Server](../security/sql-server-launchpad-service-account.md).

<a name="sqlrusergroup"></a>

## <a name="sqlrusergroup-and-worker-accounts"></a>SQLRUserGroup и рабочих учетных записей

Внешние скрипты выполняются в внешних процессов, с удостоверением наименьших привилегий локального рабочих учетных записей, может быть в списке управления доступом (ACL) родительского **SQLRUserGroup** (SQL ограниченная группа пользователей). 

**SQLRUserGroup** создается программой установки SQL Server и содержит пул локальных учетных записей пользователя Windows. Когда требуется внешний процесс, панель запуска принимает доступную рабочую учетную запись и использует его для запуска процесса. В частности панель запуска активирует доступную рабочую учетную запись, сопоставляет его с удостоверением вызывающего пользователя и запускает сценарий с использованием учетной записи рабочего. 

+ **SQLRUserGroup** связана с определенным экземпляром. Для каждого экземпляра, на компьютер, на котором работает обучения требуется отдельный пул рабочих учетных записей. Учетные записи не могут совместно использоваться разными экземплярами.

+ Размер пула учетных записей пользователей является статическим, и значение по умолчанию — 20, который поддерживает 20 одновременных сеансов. Размер этого пула учетных записей пользователей, ограничивается число сеансов внешней среды выполнения, которые могут запускаться одновременно. 

+ Имена рабочих учетных записей в пуле имеют формат SQLInstanceName*nn*. Например, для экземпляра по умолчанию **SQLRUserGroup** содержит учетные записи с именем MSSQLSERVER01, MSSQLSERVER02 и так далее вплоть до MSSQLSERVER20.

Распараллеленное задачи не используют дополнительные учетные записи. Например если пользователь запускает задачу оценки, которая использует параллельную обработку, одну и ту же учетную запись рабочей роли используется повторно для всех потоков. Если вы собираетесь активно использовать машинное обучение, можно увеличить количество учетных записей, используемых для выполнения внешних скриптов. Дополнительные сведения см. в разделе [изменение пула учетных записей пользователей для машинного обучения](../../advanced-analytics/administration/modify-user-account-pool.md).

### <a name="permissions-granted-to-sqlrusergroup"></a>Разрешения, предоставленные SQLRUserGroup

По умолчанию, члены **SQLRUserGroup** разрешения read и execute для файлов в SQL Server **Binn**, **R_SERVICES**, и **PYTHON_SERVICES** каталогов с доступом для исполняемых файлов, библиотек и встроенные наборы данных в дистрибутивах R и Python, установленная с SQL Server. 

Чтобы защитить конфиденциальные ресурсы на сервере SQL Server, при необходимости можно определить список управления доступом (ACL), которое запрещает доступ к **SQLRUserGroup**. И наоборот можно также предоставить разрешения для локальных данных ресурсов, которые существуют на главном компьютере, помимо SQL Server. 

По своей структуре **SQLRUserGroup** не имеет имени входа базы данных или разрешений на любые данные. В некоторых случаях может потребоваться создать имя входа для подключений на задней цикл, особенно если удостоверение Windows вызывающего пользователя. Эта функция называется [ *неявной проверки подлинности*](#implied-authentication). Дополнительные сведения см. в разделе [Добавление SQLRUserGroup в качестве пользователя базы данных](../../advanced-analytics/security/add-sqlrusergroup-to-database.md).

::: moniker range=">=sql-server-ver15||=sqlallproducts-allversions"
### <a name="appcontainer-isolation-in-sql-server-2019"></a>Изоляция AppContainer в SQL Server 2019

В SQL Server 2019, программа установки больше не создает рабочих учетных записей для **SQLRUserGroup**. Вместо этого, изоляция достигается за счет [AppContainers](https://docs.microsoft.com/windows/desktop/secauthz/appcontainer-isolation). Во время выполнения, при обнаружении внедренного скрипта или кода в хранимой процедуры или запроса, SQL Server вызывает панель запуска с запросом, относящихся к модулю средства запуска. Панель запуска вызывает необходимой среды выполнения в процессе его удостоверением, а также создает экземпляр AppContainer для его размещения. Это изменение является полезным, поскольку локальную учетную запись и пароль больше не требуется. Кроме того в установках, где запрещены локальные учетные записи пользователей, устраняя зависимость учетной записи локального пользователя означает, что теперь вы можете использовать эту функцию.

Реализованное в SQL Server, AppContainers представляют собой внутренний механизм. Пока вы не увидите вещественных доказательств из AppContainers в Process Monitor, их можно найти в правилах брандмауэра для исходящего трафика, созданный программой установки, чтобы предотвратить внесение сетевых вызовов процессов.

> [!Note]
> В SQL Server 2019 **SQLRUserGroup** имеет только один член, который теперь является одной учетной записи службы панели запуска SQL Server вместо нескольких рабочих учетных записей.
::: moniker-end

## <a name="user-security"></a>Безопасность пользователя

Модель безопасности SQL Server данных имена входа базы данных и ролей расширение в скрипт R и Python. Имена входа базы данных может основываться на удостоверения Windows или пользователя базы данных SQL Server. 

Как пользователь базы данных Если у вас есть разрешения на выполнение определенного запроса, любой сценарий R или Python, который запускается на SQL Server также имеет разрешения на извлечение и тех же данных. Возможность использования, создайте и сохраните базу данных объектов зависит от разрешений на базу данных. Дополнительные сведения см. в разделе [предоставление пользователям разрешения на службы машинного обучения SQL Server](../../advanced-analytics/security/user-permission.md).

### <a name="mapping-user-identities-to-worker-accounts"></a>Сопоставление удостоверений пользователей для рабочих учетных записей

При запуске сеанса, панель запуска сопоставляет удостоверения вызывающего пользователя с рабочей учетной записью. Сопоставление внешнего пользователя Windows или допустимого имени входа SQL с рабочей учетной записью является допустимым только в том случае, для времени существования SQL хранимой процедуры, которая выполняет внешний скрипт. Параллельные запросы, выполняемые с тем же именем входа, сопоставляются с той же рабочей учетной записью пользователя.

Во время выполнения панель запуска создает временные папки для хранения данных сеанса, удалять их, когда сеанс завершается. Каталоги имеют доступ только. Для R RLauncher выполняет эту задачу. Для Python PythonLauncher выполняет эту задачу. Каждая учетная запись отдельным рабочим предназначен только для его собственной папке и нет доступа к файлам в папках выше свой собственный уровень. Тем не менее рабочая учетная запись может чтения, записи или удаления дочерних элементов в сеансе рабочей папки, который был создан. Если вы являетесь администратором компьютера, вы можете просмотреть каталоги, созданные для каждого процесса. Каждый каталог определяется собственным идентификатором GUID сеанса.

<a name="implied-authentication"></a>

### <a name="implied-authentication"></a>Неявная проверка подлинности

*Неявная проверка подлинности* описывает поведение запроса подключения, под которой внешних процессов, запущенных как работника с низким уровнем прав учетные записи указываются как доверенные удостоверения пользователей в SQL Server на цикл обратной запросы для данных или операций. В качестве концепции неявная проверка подлинности является уникальным для проверки подлинности Windows, в строках подключения SQL Server, задание доверительное соединение, для запросов, исходящих от внешних процессов, например, сценарий R или Python. Он также называется *в цикле*.

Доверенные соединения поддающейся из сценария R и Python, но только с помощью дополнительной настройки. В архитектуру расширяемости, R и Python процессы выполняются в группе рабочих учетных записей, наследование разрешений от родительского **SQLRUserGroup**. Когда указывает строку подключения «Trusted_Connection = True», идентификатор учетной записи рабочего представлен на запрос на соединение и неизвестном по умолчанию для SQL Server. 

Для успешного доверенные соединения, необходимо создать имя входа базы данных для **SQLRUserGroup**. После этого любой доверенное_соединение из любой член **SQLRUserGroup** есть права входа на SQL Server. Пошаговые инструкции см. в разделе [Добавление SQLRUserGroup для входа в базу данных](../../advanced-analytics/security/add-sqlrusergroup-to-database.md).

Доверенные соединения не являются наиболее широко используемых формулировку запроса на подключение. Когда скрипт R или Python указывает соединение, бывает чаще всего используется имя входа SQL, или пользователь полностью указанное имя и пароль, если подключение к источнику данных ODBC.

#### <a name="how-implied-authentication-works-for-r-and-python-sessions"></a>Как подразумеваемой проверки подлинности работает для сеансов R и Python

На следующей схеме показано взаимодействие компонентов SQL Server со средой R и как работает неявная проверка подлинности для R.

![Неявная проверка подлинности для R](../security/media/implied-auth-rsql.png)

На следующей схеме показано взаимодействие компонентов SQL Server со средой Python, и как оно проделывает неявной проверки подлинности для Python.

![Неявная проверка подлинности для Python](../security/media/implied-auth-python2.png)

## <a name="no-support-for-transparent-data-encryption-at-rest"></a>Отсутствует поддержка прозрачного шифрования данных при хранении

[Прозрачное шифрование данных (TDE)](../../relational-databases/security/encryption/transparent-data-encryption.md) не поддерживается для данных, отправленных или полученных из среды выполнения внешнего скрипта. Причина в том, что внешний процесс (R или Python) выполняется вне процесса SQL Server. Таким образом данные, используемые внешней среды выполнения не защищен функции шифрования компонента database engine. Это поведение не отличается от любой другой клиент, запущенных на компьютере SQL Server, которая считывает данные из базы данных и создает копию.

Как следствие, прозрачное шифрование данных **не** применяется к данным, используемым в сценариях R или Python, или к любым данным, сохраненные на диске или сохраненным промежуточным результатам. Тем не менее, другие типы шифрования, такие как шифрование BitLocker для Windows или сторонних шифрования применяется на уровне файла или папки, по-прежнему применяются.

В случае использования [Always Encrypted](../../relational-databases/security/encryption/overview-of-key-management-for-always-encrypted.md), внешних сред выполнения не имеют доступа к ключам шифрования. Таким образом невозможно отправить данные в сценарии.


## <a name="next-steps"></a>Следующие шаги

В этой статье вы узнали, компоненты и модель взаимодействия архитектуры безопасности встроены в [extensibility framework](../../advanced-analytics/concepts/extensibility-framework.md). Ключевые моменты, описанные в этой статье включают назначение панели запуска, SQLRUserGroup и рабочие учетные записи, изоляция процессов R и Python и сопоставление удостоверений пользователей рабочих учетных записей. 

На следующем шаге, ознакомьтесь с инструкциями для [предоставление разрешений](../../advanced-analytics/security/user-permission.md). Для серверов, использующих проверку подлинности Windows, следует также просмотреть [Добавление SQLRUserGroup для входа в базу данных](../../advanced-analytics/security/add-sqlrusergroup-to-database.md) чтобы узнать, когда необходима дополнительная настройка.