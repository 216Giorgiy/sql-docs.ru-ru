---
title: "Динамические административные представления для служб SQL Server R | Microsoft Docs"
ms.custom: ""
ms.date: "11/29/2016"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "r-services"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: b3643ea0-d9f3-463f-8ece-572127f32a24
caps.latest.revision: 13
author: "jeannt"
ms.author: "jeannt"
manager: "jhubbard"
caps.handback.revision: 12
---
# Динамические административные представления для служб SQL Server R

Перечисляются представления системного каталога и динамические административные представления, связанные с [!INCLUDE[rsql_productname_md](../../includes/rsql-productname-md.md)]. 


Сведения о расширенных событий см. в разделе [расширенных событий для служб SQL Server R](../../advanced-analytics/r-services/extended-events-for-sql-server-r-services.md).

> [!TIP]
> Группа разработчиков предоставила пользовательские отчеты, которые можно использовать для отслеживания сеансов службы R и пакетов. Дополнительные сведения см. [монитор R службы пользовательских отчетов в среде Management Studio](../../advanced-analytics/r-services/monitor-r-services-using-custom-reports-in-management-studio.md).
> 

## <a name="system-configuration-and-system-resources"></a>Конфигурации системы и системных ресурсов

Можно отслеживать и анализировать ресурсы, используемые R-сценариев с помощью [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] системных представлений каталога и динамических административных представлений.


**Общие**
+ [ sys.dm_exec_sessions](../../relational-databases/system-dynamic-management-views/sys-dm-exec-sessions-transact-sql.md)

  Возвращает сведения о соединениях пользователей и сеансов системы. Можно определить, просмотрев системные сеансы *session_id* столбца; значения больше или равно 51, подключения пользователя и значения, меньшим 51 являются системными процессами. 



+ [sys.dm_os_performance_counters (Transact-SQL)](../../relational-databases/system-dynamic-management-views/sys-dm-os-performance-counters-transact-sql.md)

  Возвращает строку для каждого счетчика производительности системы, используемый сервером.  Эти сведения можно использовать для просмотра, сколько сценариев запуска, какие скрипты были выполнены с помощью режим проверки подлинности, или количество вызовов R были выданы на общий экземпляр.

  В этом примере извлекаются только счетчики, относящиеся к R сценария:

  ```SQL
  SELECT * from sys.dm_os_performance_counters WHERE object_name LIKE '%Extended Scripts%'
  ```

  Это динамическое административное Представление для каждого экземпляра внешних сценариев сообщили следующие счетчики:

  + **Общее число выполнений**: число процессов R запуска локальных или удаленных вызовов
  + **Параллельное выполнение**: количество раз, которые включены в сценарий @parallel спецификации и что [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] была возможность создавать и использовать в плане параллельного запроса
  + **Потоковая передача выполнений**: сколько раз был вызван возможности потоковой передачи. 
  + **Копия выполнений SQL**: номер R сценарии выполняются, где был создан вызов удаленно и SQL Server, используемая в качестве контекста вычисления 
  + **Проверка подлинности подразумеваемых. Имена входа**: подразумевается число ODBC замыкания на себя вызов с использованием проверки подлинности, то есть, [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] выполнен вызов от имени пользователя, отправляющего запрос сценария
  + **Общее время выполнения (мс)**: время, прошедшее от вызова и завершения вызова.
  + **Ошибки выполнения**: количество сценариев, сообщила об ошибках. Этот счетчик не включает ошибки R.


+ [sys.dm_external_script_requests](../../relational-databases/system-dynamic-management-views/sys-dm-external-script-requests.md)

  Это динамическое административное Представление отчеты только одну строку для каждой учетной записи работника, выполняется в данный момент внешнего сценария. Обратите внимание, что эта учетная запись рабочей отличаются от учетных данных отправителя скрипт. Если один пользователь Windows отправляет запросы на получение несколько сценариев, учетной записи только один рабочий процесс будет назначаться обрабатывать все запросы от этого пользователя. Если вход другого пользователя Windows для запуска внешнего скрипта запрос будет обрабатываться отдельной рабочей учетной записи. 
  Это динамическое административное Представление не возвращает никаких результатов, если в данный момент выполняются не сценарии; Таким образом может быть полезно для наблюдения за долго выполняющихся скриптов. Он возвращает следующие значения:
  + **external_script_request_id**: GUID, который также используется как временное имя рабочего каталога, используемого для хранения сценариев и промежуточные результаты.  
  + **Язык**: значение, такое как `R` обозначающий язык внешнего сценария.
  + **degree_of_parallelism**: целое число, указывающее число параллельных процессов, были использованы. 
  + **external_user_name**: учетной записи рабочей панели запуска, например SQLRUser01. 
  

+ [sys.dm_external_script_execution_stats (Transact-SQL)](../../relational-databases/system-dynamic-management-views/sys-dm-external-script-execution-stats.md)

  Это представление DMV предоставляется внутренний (телеметрии) для мониторинга отслеживать, сколько R вызовов в экземпляре. При запуске службы телеметрии [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] и увеличивает значение счетчика на диске при каждом вызове определенной функции R.

  Этот счетчик увеличивается на один вызов функции. Например, если вызывается `rxLinMod` , который запускается параллельно, счетчик увеличивается на 1.
  
  В общем случае счетчики производительности допустимы только при условии, что активен создавший их процесс. Таким образом, запрос к динамическому административному представлению не может отобразить подробные данные для остановленной службы. Например если панель запуска создает несколько параллельных заданий R, пока выполняется очень быстро и затем очищает объект задания Windows динамическое административное Представление может показывать все данные.
 
  Тем не менее, остаются счетчики, отслеживаемой этим динамическим административным Представлением запущен и состояния для счетчика _execution dm_external_script сохраняется с помощью записи на диск, даже при отключении экземпляра.
 
 Дополнительные сведения о счетчиках производительности системы, используемые [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], в разделе [объектов SQL Server используйте](../../relational-databases/performance-monitor/use-sql-server-objects.md).

**Представления регулятора ресурсов**

+ [sys.resource_governor_resource_pools](../../relational-databases/system-catalog-views/sys-resource-governor-resource-pools-transact-sql.md)

  Возвращает информацию о текущем состоянии пула ресурсов, текущую конфигурацию пула ресурсов и статистику пула ресурсов.

  > [!IMPORTANT]
  > 
  > Необходимо изменить пулов ресурсов, которые применяются к другим службам сервера перед R служб можно выделить дополнительные ресурсы.


+ [sys.resource_governor_external_resource_pools](../../relational-databases/system-catalog-views/sys-resource-governor-external-resource-pools-transact-sql.md)

  Новое представление каталога, отображаются текущие значения конфигурации для пулов внешних ресурсов.
  В выпуске Enterprise Edition можно настроить пулы дополнительных внешних ресурсов: например, может потребоваться управлять ресурсами R заданий, запущенных [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] отдельно от тех, которые исходят от удаленного клиента. 

  > [!NOTE]
  > 
  > В выпуске Standard Edition все задания R выполняются в том же пуле ресурсов внешних по умолчанию.

+ [sys.resource_governor_workload_groups](../../relational-databases/system-catalog-views/sys-resource-governor-workload-groups-transact-sql.md)

  Возвращает текущую конфигурацию группы рабочей нагрузки и статистика группы рабочей нагрузки. Это представление можно объединить с представлением sys.dm_resource_governor_resource_pools для получения имени пула ресурсов.
  Для внешних сценариев был добавлен новый столбец, который показывает идентификатор пула внешних, связанное с группой рабочей нагрузки. 


+ [sys.dm_resource_governor_external_resource_pool_affinity](../../relational-databases/system-dynamic-management-views/sys-dm-resource-governor-external-resource-pool-affinity-transact-sql.md)

  Новое системное представление каталога можно увидеть процессоров и ресурсов, которые привязаны к пулу определенного ресурса.

  Возвращает по одной строке для каждого планировщика [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], сопоставленного с отдельным процессором. Используйте это представление для мониторинга состояния планировщика или для определения отклонившихся от расписания задач.

  В конфигурации по умолчанию рабочей нагрузки пулы автоматически назначаются процессоров и поэтому отсутствуют значения сходства для возврата.

  Расписание сходства сопоставляет пул ресурсов [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] расписания, определяемый с заданными идентификаторами. Эти идентификаторы сопоставляются со значениями в столбце scheduler_id из sys.dm_os_schedulers (Transact-SQL).


> [!NOTE] 
> 
> Несмотря на то, что возможность настройки и настроить пулы ресурсов доступна только в Enterprise и Developer выпусков, пулы по умолчанию, а также динамических административных представлений доступны во всех выпусках. Таким образом чтобы определить ограничения ресурсов для заданий R можно использовать эти динамические административные представления в выпуске Standard Edition. 

Общие сведения о наблюдении за [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] экземпляры, в разделе [представления каталога](../../relational-databases/system-catalog-views/catalog-views-transact-sql.md) и [ресурсов регулятора связанных динамических административных представлений](../../relational-databases/system-dynamic-management-views/resource-governor-related-dynamic-management-views-transact-sql.md).

## <a name="r-script-execution-and-monitoring"></a>Выполнение сценария R и мониторинг

R сценариев, которые выполняются [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] запускаются по [!INCLUDE[rsql_launchpad_md](../../includes/rsql-launchpad-md.md)] интерфейса. Однако панель запуска не ресурсов управляет или отслеживание отдельно, как он считается службы безопасности корпорации Майкрософт, соответствующим образом управляет ресурсами.

Отдельные сценарии R, в которых выполняются службы панели запуска осуществляется с помощью [объект задания Windows](https://msdn.microsoft.com/library/windows/desktop/ms684161.aspx). Объект задания позволяет группы процессов управляться как единое целое. Каждый объект задания иерархических и управляет атрибуты всех процессов, связанных с ним. Операции, выполняемые на объект задания влияет на все процессы, связанные с заданием. 

Таким образом Если необходимо завершить одно задание, связанное с объектом, следует помнить, что все связанные с ней процессы также завершается. Если вы используете сценарий R, который назначен объект задания Windows, этот скрипт запускает задание связанных ODBC, который должна заканчиваться родительский процесс скрипта R также будет завершен. 

При запуске скрипта R, использующий параллельной обработки, объект задания Windows управляет все параллельные дочерними процессами.

Чтобы определить, выполняется ли процесс в задании, используйте `IsProcessInJob` функции.

## <a name="see-also"></a>См. также:
[Управление и мониторинг](../../advanced-analytics/r-services/managing-and-monitoring-r-solutions.md)

