---
title: "Установка служб SQL Server R на виртуальной машине Azure | Microsoft Docs"
ms.custom: ""
ms.date: "12/07/2016"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "r-services"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: c3c223b8-75c4-412e-a319-d57ecf6533af
caps.latest.revision: 11
author: "jeannt"
ms.author: "jeannt"
manager: "jhubbard"
caps.handback.revision: 8
---
# Установка служб SQL Server R на виртуальной машине Azure
 
При развертывании виртуальной машины Azure, включающий [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], теперь вы можете выбрать службы R как компонент для добавления экземпляра при создании виртуальной Машины. 



+ [Создайте новую виртуальную Машину с SQL Server 2016 и службами R](#new)
+ [Добавление служб R в существующей виртуальной машины с SQL Server 2016](#existing)

## <a name="a-namenewacreate-a-new-sql-server-2016-enterprise-virtual-machine-with-r-services-enabled"></a><a name="new"></a>Создание новой SQL Server 2016 Enterprise виртуальной машины с включены службы R

1. На портале Azure щелкните ВИРТУАЛЬНЫЕ МАШИНЫ и нажмите кнопку СОЗДАТЬ.
2. Выберите SQL Server 2016 Enterprise Edition.
3. Настройка разрешений учетной записи и имени сервера и выберите тарифный план.
4. На шаге 4 на виртуальной машине мастер установки, в **Параметры SQL Server**, найдите **R служб (Advanced Analytics)** и нажмите кнопку **Включить**.
5. Просмотрите сводные данные, представленные для проверки и нажмите кнопку **ОК**.
6. Если виртуальная машина будет готова, подключиться к нему и откройте SQL Server Management Studio, который не был предварительно установлен. Службы R готов к выполнению. 
7. Чтобы проверить это, можно открыть новое окно запроса и выполнение простой инструкции ниже, который использует R для формирования последовательности чисел от 1 до 10.
   ```
    execute sp_execute_external_script
    @language = N'R'
    , @script = N' OutputDataSet <- as.data.frame(seq(1, 10, ));'
    , @input_data_1 = N'   ;'
    WITH RESULT SETS (([Sequence] int NOT NULL));
   ```
6. Если вы будут подключаться к экземпляру клиента обработки удаленных данных, выполните [Дополнительные действия](#additional-steps) при необходимости.


## <a name="additional-steps"></a>Дополнительные действия  

Для использования служб R, если ожидается, что удаленным клиентам доступ к серверу, как контекст вычисления удаленный экземпляр SQL Server может потребоваться некоторые дополнительные действия.

### <a name="a-namefirewallaunblock-the-firewall"></a><a name="firewall"></a>Разблокировать брандмауэра  
  
Необходимо изменить правило брандмауэра на виртуальной машине, чтобы убедиться, что доступ к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляр из клиента обработки удаленных данных.  Для использования вычислительных контекстов, требующих использования пространства виртуальной машины может невозможно. 

По умолчанию брандмауэр на виртуальной машине Azure включает правило, блоки сетевой доступ для локальных учетных записей пользователя R.  
  
Для доступа к службам R от клиентов обработки удаленных данных:
1. На виртуальной машине откройте брандмауэр Windows с улучшенной безопасностью.
2. Выберите **правила для исходящих подключений**
3. Отключите следующие правила:  
  
     `Block network access for R local user accounts in SQL Server instance MSSQLSERVER`  
  
### <a name="enable-odbc-callbacks-for-remote-clients"></a>Включить обратные вызовы ODBC для удаленных клиентов

Если ожидается, что клиенты R вызов сервера будет необходимо отправлять запросы ODBC как часть своих решений R, необходимо убедиться, что панели запуска можно делать вызовы ODBC имени удаленного клиента. Чтобы сделать это, необходимо разрешить учетные записи работников SQL, используемые для входа в экземпляр путем запуска.
Дополнительные сведения см. в разделе [задать копии службы SQL Server R](../../advanced-analytics/r-services/set-up-sql-server-r-services-in-database.md). 

### <a name="a-namenetworkaadd-network-protocols"></a><a name="network"></a>Добавление сетевых протоколов  
  
+ Включите именованные каналы
  
  [!INCLUDE[rsql_productname](../../includes/rsql-productname-md.md)] использует протокол именованных каналов для соединений между компьютерами клиента и сервера, а также для некоторых внутренних соединений. Если именованные каналы не включен, необходимо установить и включить ее на обоих виртуальной машине Azure и на всех клиентских компьютерах обработки и анализа данных, подключения к серверу.  
  
+ Включить протокол TCP/IP

  Он требуется для замыкание соединений на R служб SQL Server. Если возникает следующая ошибка, включите TCP/IP на виртуальную машину, которая поддерживает экземпляр DBNETLIB; SQL Server не существует или доступ запрещен.

## <a name="how-to-disable-r-services-on-an-instance"></a>Отключение службы R в экземпляре

Можно также включить или отключить эту функцию на существующей виртуальной машины в любое время. 

1. Откройте колонку виртуальной машины
2. Щелкните **Параметры**, и выберите **конфигурации SQL Server**.


## <a name="a-nameexistingaadd-sql-server-r-services-to-an-existing-sql-server-2016-enterprise-virtual-machine"></a><a name="existing"></a>Добавление существующей виртуальной машины SQL Server 2016 Enterprise R служб SQL Server

При создании виртуальной Машины Azure с SQL Server 2016, не включающий служб R можно добавить функцию следующим образом:

1. Повторно запустите [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] настройки и добавить компонент в **конфигурации сервера** мастера.
2. Включить выполнение внешних сценариев и перезапустите [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] экземпляра. Дополнительные сведения см. в разделе [задать копии службы SQL Server R](../../advanced-analytics/r-services/set-up-sql-server-r-services-in-database.md).
3. (Необязательно) Настройка доступа к базе данных для учетных записей рабочих R, при необходимости для выполнения удаленного сценария.
   Дополнительные сведения см. в разделе [задать копии службы SQL Server R](../../advanced-analytics/r-services/set-up-sql-server-r-services-in-database.md). 
3. (Необязательно) Измените правило брандмауэра на виртуальной машине Azure, если планируется разрешить выполнение скрипта R от клиентов обработки удаленных данных. Дополнительные сведения см. в разделе [разблокировать брандмауэра](#firewall).
4. Установить и включить необходимые сетевые библиотеки. Дополнительные сведения см. в разделе [Добавление сетевых протоколов](#network).

## <a name="see-also"></a>См. также:
[Установка служб Sql Server R](../../advanced-analytics/r-services/set-up-sql-server-r-services-in-database.md)