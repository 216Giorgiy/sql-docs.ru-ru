---
title: "Создание моделей (глубокое погружение в обработку и анализ данных) | Microsoft Docs"
ms.custom: ""
ms.date: "02/27/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "r-services"
ms.tgt_pltfrm: ""
ms.topic: "article"
applies_to: 
  - "SQL Server 2016"
dev_langs: 
  - "R"
ms.assetid: a195d5e2-72e2-4dd6-bf43-947312e4a52a
caps.latest.revision: 14
author: "jeannt"
ms.author: "jeannt"
manager: "jhubbard"
---
# Создание моделей (глубокое погружение в обработку и анализ данных)
Теперь, когда вы расширили данные обучения, пора проанализировать их с помощью линейной регрессии. Линейные модели — важный инструмент в области прогнозирующего анализа, и пакет **RevoScaleR** в службах [!INCLUDE[rsql_productname](../../includes/rsql-productname-md.md)] содержит масштабируемый алгоритм с высокой производительностью.  
  
## Создание модели линейной регрессии  
Вы создадите простую линейную модель, которая оценивает баланс держателя кредитной карты, используя значения в столбцах *gender* и *creditLine* в качестве независимых переменных.  
  
Для этого вы будете использовать функцию *rxLinMod*, которая поддерживает контексты удаленных вычислений.  
  
1.  Создайте переменную R для хранения готовой модели и вызовите функцию *rxLinMod*.  
  
    ```R  
    linModObj <- rxLinMod(balance ~ gender + creditLine,  data = sqlFraudDS)   
    ```  
  
2.   Чтобы просмотреть сводку результатов, можно просто вызвать стандартную функцию R *summary* применительно к объекту модели.  
  
     ```R  
     summary(linModObj)   
     ```  

Вам может показаться странным, что обыкновенная функция R, такая как **summary**, будет здесь работать, поскольку на предыдущем шаге контекст вычислений был переключен на серверный. Однако даже если функция **rxLinMod** использует контекст удаленных вычислений для создания модели, она также возвращает объект, который содержит модель для локальной рабочей станции, и сохраняет его в общем каталоге.

Таким образом, для модели можно выполнять стандартные команды R, как если бы она была создана с помощью контекста local.
  
**Результаты**  
  
*Результаты линейной регрессии для: balance ~ gender + creditLineData: sqlFraudDS (RxSqlServerData Data Source)*  
*Зависимые переменные: balance*  
*Всего независимых переменных: 4 (в том числе удаленных: 1)*  
*Число допустимых наблюдений: 10000*  
*Число отсутствующих наблюдений: 0*    
*Коэффициенты: (1 не определен из-за особенностей)*      
*Значение t оценки средней квадратической ошибки Pr(>|t|) (Intercept)*   
*3253,575 71,194 45,700 2,22e-16*   
*gender=Male -88,813 78,360 -1,133 0,257*   
*gender=Female Удалено Удалено Удалено Удалено*   
*creditLine 95,379 3,862 24,694 2,22e-16*   
*Коды значимости: 0  0,001  0,01 "*" 0,05 "." 0.1 ‘ ’ 1*  
  
*Остаточная среднеквадратическая ошибка: 3812 при 9997 степенях свободы*  
*Квадрат коэффициента множественной корреляции: 0,05765*   
*Квадрат нормированного коэффициента корреляции: 0,05746*   
*Критерий Фишера: 305,8 при 2 и 9997 DF, p-величина: < 2,2e-16*  
*Коэффициент переноса: 1,0184*  
  
## Создание модели логистической регрессии  
Теперь вы создадите модель логистической регрессии, которая указывает, связан ли риск мошенничества с определенным заказчиком.  
  
Вы будете использовать функцию *rxLogit*, входящую в пакет **RevoScaleR**, которая поддерживает размещение моделей логистической регрессии в контекстах удаленных вычислений.  
  
1.  Не меняйте контекст вычисления. Кроме того, по-прежнему будет использоваться тот же источник данных.  
  
2.  Вызовите функцию *rxLogit* и передайте формулу, необходимую для определения модели.  
  
    ```R  
    logitObj <- rxLogit(fraudRisk ~ state + gender + cardholder + balance +      numTrans + numIntlTrans + creditLine, data = sqlFraudDS,      dropFirst = TRUE)   
    ```  
  
    Так как это большая модель, содержащая 60 независимых переменных, в том числе три фиктивные переменные, которые удаляются, возможно, придется подождать некоторое время, пока контекст вычислений вернет объект.  
    
    Причина такого большого размера модели в том, что в языке R (и в пакете **RevoScaleR**) каждый уровень категориальной факторной переменной автоматически обрабатывается как отдельная фиктивная переменная.  
  
3.  Чтобы просмотреть сводку по полученной модели, вызовите функцию R *summary*.  
  
    ```R  
    summary(logitObj)  
    ```  
  
**Частичные результаты**  
  
*Результаты логистической регресии для: fraudRisk ~ state + gender +     cardholder + balance + numTrans + numIntlTrans + creditLine*   
*Данные: sqlFraudDS (RxSqlServerData Data Source)*   
*Зависимые переменные: fraudRisk*   
*Всего независимых переменных: 60 (в том числе удаленных: 3)*   
*Число допустимых наблюдений: 10000 -2\*  
*LogLikelihood: 2032,8699 (остаточное отклонение при 9943 степенях свободы)*  
*Коэффициенты:*   
*Значение z оценки средней квадратической ошибки Pr(>|z|)     (Intercept)*  
*-8,627e+00  1,319e+00  -6,538 6,22e-11 \*\*\*   
state=AK                Удалено    Удалено Удалено  Удалено       
state=AL             -1,043e+00  1,383e+00  -0,754   0,4511* (другие состояния опущены) *gender=Male             Удалено    Удалено Удалено  Удалено*  
*gender=Female         7,226e-01  1,217e-01   5,936 2,92e-09 \*\*\**  
*cardholder=Principal    Удалено    Удалено Удалено  Удалено*       
*cardholder=Secondary  5,635e-01  3,403e-01   1,656   0,0977 .*     
*balance               3,962e-04  1,564e-05  25,335 2,22e-16 \*\*\**  
*numTrans              4,950e-02  2,202e-03  22,477 2,22e-16 \*\*\**  
*numIntlTrans          3,414e-02  5,318e-03   6,420 1.36e-10 \*\*\**  
*creditLine            1,042e-01  4,705e-03  22,153 2.22e-16 \*\*\**   
*---*   
*Коды значимости: 0 ‘\*\*\*’ 0.001 ‘\*\*’ 0.01 ‘\*’ 0,05 ‘.’ 0.1 " " 1*   
*Коэффициент переноса итоговой матрицы дисперсий и ковариаций: 3997,308*   
*Число итераций: 15*  
  
## Следующий шаг  
[Оценка новых данных (глубокое погружение в обработку и анализ данных)](../../advanced-analytics/r-services/score-new-data-data-science-deep-dive.md)  
  
## Предыдущий шаг  
[Визуализация данных SQL Server с помощью языка R (глубокое погружение в обработку и анализ данных)](../../advanced-analytics/r-services/visualize-sql-server-data-using-r-data-science-deep-dive.md)  
  
## См. также:  
[Глубокое погружение в обработку и анализ данных: использование пакетов RevoScaleR](../../advanced-analytics/r-services/data-science-deep-dive-using-the-revoscaler-packages.md)  
  
  
  
