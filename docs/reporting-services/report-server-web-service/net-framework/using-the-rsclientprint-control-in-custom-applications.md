---
title: "Использование элемента управления RSClientPrint в пользовательских приложениях | Документы Microsoft"
ms.custom: 
ms.date: 03/14/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- docset-sql-devref
- reporting-services-native
ms.tgt_pltfrm: 
ms.topic: reference
applies_to:
- SQL Server 2016 Preview
helpviewer_keywords:
- RSPrintClient control
- print controls [Reporting Services]
- custom printing [Reporting Services]
- client-side printing
ms.assetid: 8c0bdd18-8905-4e22-9774-a240fc81a8a7
caps.latest.revision: 31
author: sabotta
ms.author: carlasab
manager: erikre
ms.translationtype: Machine Translation
ms.sourcegitcommit: 0eb007a5207ceb0b023952d5d9ef6d95986092ac
ms.openlocfilehash: 8afee187160da9d35efd0c7079b649bac7e73740
ms.contentlocale: ru-ru
ms.lasthandoff: 06/13/2017

---
# <a name="using-the-rsclientprint-control-in-custom-applications"></a>Использование элемента управления RSClientPrint в пользовательских приложениях
  [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Элемента управления ActiveX, **RSPrintClient**, предоставляет клиентские функции печати для отчетов, просмотреть в средстве просмотра HTML. Он предоставляет **печати** диалоговое окно, чтобы пользователь может запустить задание печати, предварительного просмотра отчета, указания страниц и изменить поля. При выполнении операции печати на стороне клиента сервер отчетов подготавливает отчет с помощью модуля подготовки отчетов в графическом формате (EMF), создает задание на печать и отправляет его на принтер с помощью средств операционной системы.  
  
 Печать на стороне клиента повышает управляемость и качество печати для отчетов в формате HTML. Это происходит благодаря применению размеров страниц, полей и колонтитулов, заданных в самом отчете, а не параметров печати в браузере на компьютере пользователя. То есть элемент управления считывает значения размера страниц и полей из свойств отчета.  
  
 Разработчики, которым необходима для включения клиентские функции печати в сторонних панелей инструментов или программах просмотра доступны через элемент управления ActiveX **RSClientPrint** COM-объекта. Он распространяется бесплатно. При работе с этим элементом следуйте приведенным ниже рекомендациям.  
  
-   Элемент управления позволяет усовершенствовать функции печати веб-отчетов. Объект можно указать в любом из [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]-языки программирования или в скрипте. Данный элемент управления не предназначен для приложений [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows Forms.  
  
-   Скопируйте файл с расширением CAB из программных файлов служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] в базу кода нужного приложения.  
  
-   Используйте \<ОБЪЕКТА > тег, чтобы указать элемент управления.  
  
-   В формате URL-адреса укажите относительный или полный путь к файлу с расширением CAB в атрибуте CODEBASE тега OBJECT.  
  
-   Укажите сведения о версии приложения для файла с расширением CAB, чтобы отследить версию, которая используется в приложении.  
  
-   Чтобы понять, каким образом страницы готовятся к предварительному просмотру и выводу, ознакомьтесь с разделами электронной документации, посвященными подготовке отчетов в графическом формате (EMF).  
  
## <a name="rsprintclient-overview"></a>Общие сведения о RSPrintClient  
 Данный элемент управления отображает пользовательское диалоговое окно печати, в котором поддерживаются все стандартные функции: предварительный просмотр, указание отдельных страниц и их диапазонов, поля и ориентация страниц. Он упакован в файл с расширением CAB. Текст в **печати** диалоговое окно локализованы для всех языков, поддерживаемых в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. **RSPrintClient** элемент управления ActiveX использует модуль подготовки изображений (EMF) для печати отчета. Используются следующие параметры EMF: StartPage, EndPage, MarginBottom, MarginLeft, MarginTop, MarginRight, PageHeight и PageWidth. Другие информационные параметры устройства для подготовки изображений к просмотру не поддерживаются.  
  
### <a name="language-support"></a>Языковая поддержка  
 Элемент печати выводит текст пользовательского интерфейса на разных языках и принимает вводимые значения в разных единицах измерения. Язык и единицы измерения определяются **языка и региональных параметров** и **UICulture** свойства. Оба свойства принимают значения кода языка. Если указан код языка, который является вариантом поддерживаемого языка, то будет выбран тот язык, который ближе всего к указанному. Если указан код языка, который не поддерживается и похожий язык отсутствует, то будет использоваться английский язык (США).  
  
## <a name="using-rsclientprint-in-code"></a>Использование RSClientPrint в коде  
 **RSClientPrint** объект используется для получения доступа программным способом в элемент управления ActiveX и его методы и свойства. Элемент управления выводит модальное диалоговое окно предварительного просмотра.  
  
### <a name="specifying-default-values"></a>Настройка значений по умолчанию  
 Можно инициализировать **печати** диалоговое окно с страниц и полей отчета. По умолчанию **печати** диалоговое окно инициализируется со значениями из определения отчета. Можно либо оставить эти значения, либо указать другие путем настройки свойств объекта.  
  
 Все размеры указываются в миллиметрах. Преобразование единиц измерения происходит во время выполнения, если **языка и региональных параметров** и **UICulture** заданы языковые стандарты, которые не используют метрической.  
  
 Чтобы понять, какие значения используются размеры страниц и полей, можно использовать **GetProperties** метод для извлечения значения по умолчанию:  
  
-   **PageHeight** и **PageWidth** укажите ширина и высота страницы по умолчанию. При запуске элемента печати на основе значений этих свойств выбирается ближайший размер страницы, доступный для текущего выбранного устройства печати. Если **PageWidth** больше **PageHeight**, выбирается альбомная ориентация. в противном случае выбирается книжная.  
  
-   **LeftMargin**, **RightMargin**, **TopMargin**, и **BottomMargin** имеют значение 12,2 мм по умолчанию.  
  
 Эти свойства хранятся в **элемент** коллекции свойств на сервере отчетов. и перезаписываются при каждом обновлении определения отчета.  
  
### <a name="rsclientprint-properties"></a>Свойства RSClientPrint  
  
|Свойство|Тип|RW|По умолчанию|Description|  
|--------------|----------|--------|-------------|-----------------|  
|MarginLeft|Double|RW|Параметры отчета|Возвращает или задает левое поле. Значение по умолчанию — 12,2 мм (если оно не задано разработчиком или не указано в отчете).|  
|MarginRight|Double|RW|Параметры отчета|Возвращает или задает правое поле. Значение по умолчанию — 12,2 мм (если оно не задано разработчиком или не указано в отчете).|  
|MarginTop|Double|RW|Параметры отчета|Возвращает или задает верхнее поле. Значение по умолчанию — 12,2 мм (если оно не задано разработчиком или не указано в отчете).|  
|MarginBottom|Double|RW|Параметры отчета|Возвращает или задает нижнее поле. Значение по умолчанию — 12,2 мм (если оно не задано разработчиком или не указано в отчете).|  
|PageWidth|Double|RW|Параметры отчета|Возвращает или задает ширину страницы. Значение по умолчанию, если оно не задано разработчиком или определение отчета — 215,9 мм.|  
|PageHeight|Double|RW|Параметры отчета|Возвращает или задает высоту страницы. Значение по умолчанию — 279,4 мм (если оно не задано разработчиком или не указано в определении отчета).|  
|Культура|Int32|RW|Локаль браузера|Указывает код локали (код языка). Это значение определяет единицы измерения для вводимых пользователем значений. Например, если пользователь вводит **3**, оно измеряется в миллиметрах Если французского языка или дюймах, если выбран английский (США) язык. Допустимые значения: 1028, 1031, 1033, 1036, 1040, 1041, 1042, 2052, 3082.|  
|UICulture|String|RW|Client culture|Определяет локализацию текста в диалоговом окне. Текст в диалоговом окне печати локализован на следующих языках: китайский упрощенный, китайский традиционный, английский, французский, немецкий, итальянский, японский, корейский и испанский. Допустимые значения: 1028, 1031, 1033, 1036, 1040, 1041, 1042, 2052, 3082.|  
|Authenticate|Логическое значение|RW|False|Указывает способность элемента управления вызывать с помощью команды GET сервер отчетов, чтобы открыть соединение для внесеансовой печати.|  
  
### <a name="when-to-set-the-authenticate-property"></a>Случаи, в которых необходимо задавать свойство Authenticate  
 При печати из сеанса браузера, необходимо задать **Authenticate** свойство. В контексте активного сеанса все запросы элемента управления к серверу отчетов выполняются через браузер. Последний устанавливает переменные сеанса, необходимые для обмена данными с сервером отчетов.  
  
 При печати ожидания сеанса (например, при отправке отчета непосредственно на принтер без его открытия) элемент печати должен выдать HTTP- **получить** запроса для настройки сеанса на сервере отчетов. Проблемы **получить** запрос, задать **Authenticate** для **True**.  
  
 Необходимо выдать **получить** запроса, если вы используете Windows встроенной безопасности или обычной проверки подлинности. Если вы используете проверку подлинности форм, **Authenticate** свойство игнорируется. Код приложения должен установить сеанс и выполнить проверку подлинности пользователя через настраиваемый модуль безопасности. Если используется проверка подлинности с помощью форм, задайте в куки-файле приемлемый срок действия сеанса. Если это значение слишком мало, то у пользователя каждый раз после истечения срока действия куки-файла будут запрашиваться учетные данные.  
  
### <a name="clsids"></a>Идентификаторы CLSID  
 При локальном запуске отчета используйте следующие значения CLSID.  
  
-   41861299-EAB2-4DCC-986C-802AE12AC499  
  
-   5554DCB0-700B-498D-9B58-4E40E5814405  
  
-   60677965-AB8B-464f-9B04-4BA871A2F17F  
  
 При выполнении отчета в Windows Azure SQL Reporting используются следующие значения CLSID.  
  
-   3DD32426-554D-48C0-A200-65D3BF880E38  
  
-   05662494-ACF9-446A-BE4C-7D3F7EA7F62F  
  
### <a name="rsprintclient-support-for-the-print-method"></a>Поддержка RSPrintClient для метода Print  
 **RSClientPrint** поддерживает **печати** метод, используемый для запуска диалогового окна печати. **Печати** метод имеет следующие аргументы.  
  
|Аргумент|Ввод-вывод|Тип|Description|  
|--------------|----------|----------|-----------------|  
|ServerPath|In|Строковые значения|Указывает имя виртуального каталога сервера отчетов (например, `https://adventure-works/reportserver`).|  
|ReportPathParameters|In|Строковые значения|Указывает полное имя отчета в пространстве имен папок сервера отчетов, включая параметры. Получение отчетов производится через URL-адрес. Например: «/ AdventureWorks Sample Reports/Employee Sales Summary & EmpID = 1234»|  
|ReportName|In|Строковые значения|Краткое имя отчета (в приведенном выше примере кратким именем будет Employee Sales Summary). Это имя отображается в диалоговом окне «Печать» и в очереди печати.|  
  
### <a name="example"></a>Пример  
 В следующем примере HTML показано, как указать файл .cab **печати** метод и свойства в JavaScript:  
  
 `<BODY onload="Print()">`  
  
 `<OBJECT ID="RSClientPrint" CLASSID="CLSID: 5554DCB0-700B-498D-9B58-4E40E5814405D3" CODEBASE="<URL to the .CAB file>#Version=<your application version information>" VIEWASTEXT></OBJECT>`  
  
 `<script language="javascript">`  
  
 `function Print()`  
  
 `{`  
  
 `RSClientPrint.MarginLeft = 12.7;`  
  
 `RSClientPrint.MarginTop = 12.7;`  
  
 `RSClientPrint.MarginRight = 12.7;`  
  
 `RSClientPrint.MarginBottom = 12.7;`  
  
 `RSClientPrint.Culture = 1033;`  
  
 `RSClientPrint.UICulture = 9;`  
  
 `RSClientPrint.Print('http://localhost/rtm', '%2fEmployee_Sales_Summary&ReportMonth=6&ReportYear=2004&EmpID=20', 'Employee_Sales_Summary')`  
  
 `}`  
  
 `</script>`  
  
 `</BODY>`  
  
## <a name="see-also"></a>См. также:  
 [Печать отчетов из браузера с помощью элемента управления печатью &#40; Построитель отчетов и службы SSRS &#41;](../../../reporting-services/report-builder/print-reports-from-a-browser-with-the-print-control-report-builder-and-ssrs.md)   
 [Печать отчетов &#40; Построитель отчетов и службы SSRS &#41;](../../../reporting-services/report-builder/print-reports-report-builder-and-ssrs.md)   
 [Изображение настройки сведений об устройстве](../../../reporting-services/image-device-information-settings.md)  
  
  
