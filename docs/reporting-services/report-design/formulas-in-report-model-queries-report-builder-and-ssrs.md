---
title: "Формулы в запросах модели отчета (построитель отчетов и службы SSRS) | Microsoft Docs"
ms.custom: ""
ms.date: "03/01/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "reporting-services-sharepoint"
  - "reporting-services-native"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "10151"
ms.assetid: fbf68c59-7afc-4afe-bfcd-40ce84629af0
caps.latest.revision: 9
author: "maggiesMSFT"
ms.author: "maggies"
manager: "erikre"
caps.handback.revision: 9
---
# Формулы в запросах модели отчета (построитель отчетов и службы SSRS)
  Формулы — это вычисления, производимые над значениями в отчете и использующие модель отчета в качестве источника данных. Формулы задаются в диалоговом окне **Определение формулы** конструктора запросов моделей отчетов при определении запроса к источнику данных модели отчета. Формула может содержать функции, операторы, константы и ссылки на поля или сущности. Формулы позволяют комбинировать, статистически вычислять, фильтровать и оценивать как числовые, так и текстовые данные. Можно создавать и сохранять формулы для новых полей или изменять формулы существующих полей.  
  
 Формулы не являются выражениями языка определения отчетов и не начинаются со знака равенства (=). Дополнительные сведения о выражениях RDL см. в разделе [Выражения (построитель отчетов и службы SSRS)](../../reporting-services/report-design/expressions-report-builder-and-ssrs.md).  
  
 Формулы могут быть похожи на любую из указанных ниже:  
  
-   **Строка общей суммы**  
  
-   6+12  
  
-   **SUM**(**IF**(**Флаг обработанных товаров**, "Готово", "Не готово"))  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## Ссылки  
 Ссылка представляет собой имя поля. Это может быть существующее имя поля в пределах сущности или имя вычисляемого поля, созданное и добавленное в список полей. Ссылка сообщает построителю отчетов, где искать значения или данные, которые нужно использовать в формуле. В одной формуле можно ссылаться на поля внутри сущности контекста или на поля из других сущностей; также можно использовать значение одного поля в нескольких формулах.  
  
 При использовании ссылок обработчик отчетов применяет формулу к каждому значению в поле. Например, поле содержит итоговый годовой товарооборот за последние пять лет. Это поле содержит пять значений, каждое из которых представляет собой итоговый товарооборот за определенный год. Если ваша формула содержит ссылку на это поле, формула вычисляет новое значение, используя каждое индивидуальное значение.  
  
## Операторы  
 Операторы определяют тип вычислений, которые необходимо выполнить в формуле с использованием значений. Существует три типа операторов вычисления: арифметические операторы, операторы сравнения и текстовые операторы. Операторы обозначаются символами, например знаком «плюс» (+).  
  
 **Арифметические операторы.** Арифметические операторы используются для выполнения основных математических операций: сложения, вычитания, умножения, объединения чисел, а также для получения числовых результатов.  
  
 **Операторы сравнения.** При помощи операторов сравнения можно сравнить два значения. При сравнении двух значений с использованием этих операторов результат представляет собой логическое значение: TRUE или FALSE.  
  
 **Оператор объединения текста.** Используйте амперсанд (&), чтобы соединить или объединить одну или несколько текстовых строк для получения единого текста.  
  
##  <a name="Constants"></a> Константы  
 Константа представляет собой невычисляемое и, таким образом, неизменяемое значение. В построителе отчетов используются следующие константы: **True**, **False**и **Empty**. Эти константы используются для вычисления логических полей. Предположим, существует поле с именем «Снято с производства». Единственными допустимыми значениями для этого поля являются True, False или Empty.  
  
##  <a name="Functions"></a> Функции  
 Функции представляют собой предопределенные формулы, которые производят вычисления, используя специфические значения, называемые *аргументами*и указанные в определенном порядке. Аргументы могут представлять собой литералы, поля или комбинации тех и других. Если в формулах используются поля, имя поля представляет каждый экземпляр данного поля. Если аргумент представляет собой литеральное значение, необходимо указать, что аргумент представляет собой литеральное значение, используя определенные символы.  
  
 Функции могут использоваться для выполнения простых или сложных вычислений. Структура функции начинается с ее имени, за которым следуют открывающая скобка, аргументы данной функции, разделяемые запятыми, и закрывающая скобка.  
  
 ![Пример функции.](../../reporting-services/report-design/media/functionexample.gif "Пример функции.")  
  
 Аргументы могут быть ссылками на поле, числами, текстом и логическими значениями, например **TRUE** или **FALSE**. Аргументы могут так же быть константами, формулами или другими функциями. Вводимые аргументы должны быть допустимыми значениями для этого аргумента. К примеру, если в формуле выполняется умножение двух целых чисел, в результате не может быть получена текстовая строка.  
  
 Построитель отчетов содержит следующие девять категорий часто используемых функций.  
  
|||  
|-|-|  
|Агрегатные функции|**AVG**, **COUNT**, **COUNTDISTINCT**, **MAX**, **MIN**, **STDEV**, **STDEVP**, **SUM**, **VAR**, **VARP**|  
|Условные функции|**IF**, **IN**, **SWITCH**|  
|Функции преобразования|**INT**, **DECIMAL**, **FLOAT**, **TEXT**|  
|Функции даты и времени|**DATE**, **DATEADD**, **DATEDIFF**, **DATETIME**, **DATEONLY**, **DAY**, **DAYOFWEEK**, **DAYOFYEAR**, **HOUR**, **MINUTE**, **MONTH**, **NOW**, **QUARTER**, **SECOND**, **TIMEONLY**, **TODAY**, **WEEK**, **YEAR**|  
|Информационные функции|**GETUSERCULTURE**, **GETUSERID**|  
|Логические функции|**AND**, **NOT**, **OR**|  
|Математические функции|**MOD**, **ROUND**, **TRUNC**|  
|Операторы|Сложение (+), Деление (/), Равенство (=), Возведение в степень (^), Больше (>), Больше или равно (>=), Меньше (<), Меньше или равно (<=), Умножение (*), Противоположная величина (-), Не равно (<>), Вычитание (-)|  
|Текстовые функции|**CONCAT**, **FIND**, **LEFT**, **LENGTH**, **LOWER**, **LTRIM**, **REPLACE**, **RIGHT**, **RTRIM**, **SUBSTRING**, **UPPER**|  
  
  