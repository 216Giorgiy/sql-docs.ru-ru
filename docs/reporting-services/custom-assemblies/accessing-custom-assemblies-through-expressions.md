---
title: "Доступ к пользовательским сборкам посредством выражений | Документы Microsoft"
ms.custom: 
ms.date: 03/04/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- docset-sql-devref
- reporting-services-native
ms.tgt_pltfrm: 
ms.topic: reference
applies_to:
- SQL Server 2016 Preview
helpviewer_keywords:
- expressions [Reporting Services], custom assemblies
- static member calls
- instance member calls [Reporting Services]
- calling class members
- custom assemblies [Reporting Services], expressions
ms.assetid: 917c4d47-1a95-4f54-98b1-e8cb2165d90f
caps.latest.revision: 32
author: sabotta
ms.author: carlasab
manager: erikre
ms.translationtype: Machine Translation
ms.sourcegitcommit: 0eb007a5207ceb0b023952d5d9ef6d95986092ac
ms.openlocfilehash: 70ff488827e5289d401bf62b67a82a08ecc25f70
ms.contentlocale: ru-ru
ms.lasthandoff: 06/22/2017

---
# <a name="accessing-custom-assemblies-through-expressions"></a>Доступ к пользовательским сборкам посредством выражений
  После того как пользовательская сборка была создана, сделана доступной для конструктора отчетов или сервера отчетов, добавлена к подходящей политике безопасности, а также после того, как в определение отчета была добавлена ссылка на данную пользовательскую сборку, появится возможность доступа к членам классов сборки посредством выражений отчетов. Для ссылки в выражении на пользовательский код следует вызвать элемент класса этой сборки. Способ создания ссылки зависит от того, является ли метод статическим или основывается на экземпляре.  
  
## <a name="calling-static-members-from-a-report-definition-file"></a>Вызов статических членов из файла определения отчета  
 Статические члены принадлежат классу или типу, а не к созданному объекту. Доступ к данным членам можно получить, напрямую вызвав их из класса.  По возможности для вызова пользовательских функций в отчете следует использовать статические члены, поскольку они обладают большей производительностью. Для вызова статического члена необходимо сослаться на него как выражение в форме =*Namespace.Class.Method*.  
  
#### <a name="to-call-static-members"></a>Вызов статических членов  
  
-   Для вызова статического члена следует установить выражение равным полностью указанному имени члена, в которое включено пространство имен, имя класса и имя члена. В следующем примере вызывается **ToGBP** метод, который преобразует **StandardCost** поле значение из долларов в фунты стерлингов и отображает его в отчете:  
  
    ```  
    =CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
    ```  
  
### <a name="important-information-regarding-static-fields-and-properties"></a>Важные сведения о статических полях и свойствах  
 В данный момент все отчеты выполняются в одном и том же домене приложения. Это означает, что те отчеты, в которых присутствуют пользовательские статические данные, предоставляют доступ к этим данным другим экземплярам того же отчета. В связи с этим статические данные одного пользователя могут стать доступны всем пользователям, которые в данное время выполняют этот определенный отчет. По этой причине настоятельно рекомендуется не использовать статические поля или свойства в пользовательских сборок или в **кода** элемента; вместо этого используйте свойства или поля экземпляра в отчетах. Однако статические методы можно использовать, поскольку они не сохраняют состояния или данные.  
  
## <a name="calling-instance-members-from-a-report-definition-file"></a>Вызов членов экземпляров из файла определения отчета  
 Если в пользовательской сборке содержатся члены экземпляров, к которым нужно обращаться из определения отчета, то в отчет следует добавить имя экземпляра класса. Можно добавить имя экземпляра для класса с помощью **кода** вкладке **свойства отчета** диалогового окна. Дополнительные сведения о добавлении экземпляров классов в отчет см. в разделе [пользовательский код и ссылок на сборки в выражениях в конструкторе отчетов &#40; Службы SSRS &#41; ](../../reporting-services/report-design/custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).  
  
 Для вызова статического члена необходимо сослаться на него как выражение в форме = Code*. ИмяЭкземпляра.метод*.  
  
#### <a name="to-call-instance-members"></a>Вызов членов экземпляра  
  
-   Для вызова члена экземпляра пользовательской сборки, необходимо сослаться на **кода** ключевое слово, за которым следует имя экземпляра и метод. В следующем примере вызывается метод экземпляра **ToEUR** , преобразующий **StandardCost** поле значение из долларов в евро и отображает его в отчете:  
  
    ```  
    =Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
    ```  
  
## <a name="see-also"></a>См. также:  
 [Использование пользовательских сборок с отчетами](../../reporting-services/custom-assemblies/using-custom-assemblies-with-reports.md)  
  
  
