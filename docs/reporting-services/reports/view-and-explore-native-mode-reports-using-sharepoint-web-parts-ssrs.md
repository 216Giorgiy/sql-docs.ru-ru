---
title: Просмотр и изучение отчетов в собственном режиме с помощью веб-частей SharePoint (SSRS) | Документация Майкрософт
ms.date: 05/30/2017
ms.prod: reporting-services
ms.prod_service: reporting-services-sharepoint, reporting-services-native
ms.technology: reports
ms.topic: conceptual
ms.assetid: dee8ee42-156b-43b6-b202-02dfb9404284
author: markingmyname
ms.author: maghan
ms.openlocfilehash: 343c2d7a4bc712192ebd2989920a0114b969e45f
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47717492"
---
# <a name="view-and-explore-native-mode-reports-using-sharepoint-web-parts-ssrs"></a>Просмотр и изучение отчетов в собственном режиме с помощью веб-части SharePoint (службы SSRS)

> [!IMPORTANT]  
>  SQL Server Reporting Services больше не поддерживает использование веб-частей в собственном режиме (RSWebParts.cab) для доступа к содержимому сервера отчетов на сайте SharePoint с сервера отчетов, работающего в собственном режиме. Вместо них следует использовать [веб-часть "Средство просмотра отчетов" на сайте SharePoint](../../reporting-services/report-server-sharepoint/report-viewer-web-part-on-a-sharepoint-site.md) .  
  
 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] включено несколько веб-частей, каждая из которых предназначена для определенной версии сервера отчетов и для определенного режима развертывания.  
  
-   **Собственный режим.** Если доступ к содержимому сервера отчетов на сайте SharePoint необходимо осуществлять с помощью сервера отчетов, работающего в собственном режиме, воспользуйтесь веб-частями SharePoint 2.0 «Обозреватель отчетов» и «Средство просмотра отчетов», включенными в состав служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]. Инструкции по установке и использованию веб-частей 2.0 содержатся ниже в этом разделе.  
  
-   **Режим SharePoint.** Если необходимо получить доступ к серверу отчетов, который работает в режиме интеграции с SharePoint, используйте веб-части, которые устанавливаются надстройкой служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] для продуктов SharePoint. Дополнительные сведения о надстройке см. в разделе [Где найти надстройку службы Reporting Services для продуктов SharePoint](../../reporting-services/install-windows/where-to-find-the-reporting-services-add-in-for-sharepoint-products.md).  
  
> [!NOTE]  
>  Веб-часть средства просмотра отчетов для собственного режима (SPViewer.dwp) отличается от веб-части ReportViewer.dwp, устанавливаемой надстройкой служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] для продуктов SharePoint. Веб-части имеют различные схемы и реализации, но обе они могут быть установлены на одной ферме SharePoint. Визуально эти веб-части можно различить по следующему признаку: веб-часть средства просмотра отчетов, которая устанавливается в составе надстройки, содержит на панели инструментов меню **Действия** .  
  
 Дополнительные сведения о режимах сервера отчетов см. в разделе [Сервер отчетов служб Reporting Services](../../reporting-services/report-server-sharepoint/reporting-services-report-server.md).  
  
 В этом разделе:  
  
-   [Обозреватель отчетов и средство просмотра отчетов](#bkmk_aboutwebparts)  
  
-   [Требования для использования веб-частей](#bkmk_requirements)  
  
-   [Установка веб-частей](#bkmk_installingwebparts)  
  
-   [Добавление и настройка веб-частей](#bkmk_configurewebparts)  
  
##  <a name="bkmk_aboutwebparts"></a> Обозреватель отчетов и средство просмотра отчетов  
 Обозреватель отчетов и средство просмотра отчетов — это веб-части SharePoint 2.0, которые доступны в службах [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 2000 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] с пакетом обновления 2 (SP2) и текущих версиях.  
  
 Веб-части обеспечивают просмотр отчетов и обзор иерархии папок сервера отчетов с сайта SharePoint.  
  
 Обратите внимание, что настройка веб-частей не поддерживается. Они используются «как есть» и не могут быть ни расширены, ни изменены.  
  
-   **Обозреватель отчетов** (SPExplorer.dwp) подключается к диспетчеру отчетов на компьютере сервера отчетов. Можно просмотреть доступные отчеты на сервере отчетов и подписаться на них. Если построитель отчетов включен и пользователь имеет достаточные разрешения, построитель отчетов может быть запущен непосредственно из веб-части «Обозреватель отчетов».  
  
     Обозреватель отчетов отображает содержимое папок на странице диспетчера отчетов. Доступ к отдельным элементам и папкам в иерархии папок сервера отчетов управляется с помощью назначений ролей на сервере отчетов. При выборе отчета он открывается в новом окне браузера. Отображение отчета и его панели инструментов обеспечивается средством просмотра HTML-страниц сервера отчетов, а не веб-частью «Средство просмотра отчетов». Если необходимо настроить параметры панели инструментов, в URL-адресе необходимо указать параметры доступа к серверу отчетов. Инструкции см. в разделе [Ссылка на параметр доступа по URL-адресу](../../reporting-services/url-access-parameter-reference.md).  
  
-   **Средство просмотра отчетов** (SPViewer.dwp) отображает отчет и предоставляет панель инструментов, служащую для перемещения по страницам, поиска содержимого и экспорта отчета. Веб-часть средства просмотра отчетов можно добавить на страницу «Веб-часть», чтобы всегда отображать на ней определенный отчет, или **можно связать веб-часть с обозревателем отчетов** , что позволяет отображать отчеты, открытые с ее помощью.  
  
##  <a name="bkmk_requirements"></a> Требования для использования веб-частей  
 Ниже перечислены требования для использования веб-частей «Средство просмотра отчетов» и «Обозреватель отчетов».  
  
-   Поддерживаются следующие версии продуктов и технологий SharePoint:  
  
    -   [!INCLUDE[winSPServ](../../includes/winspserv-md.md)] 3.0 и [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[offSPServ](../../includes/offspserv-md.md)] 2007.  
  
    -   [!INCLUDE[SPF2010](../../includes/spf2010-md.md)] и [!INCLUDE[SPS2010](../../includes/sps2010-md.md)].  
  
-   Сервер отчетов в собственном режиме должен иметь версию [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 2005 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] или более позднюю.  
  
-   Сервер отчетов должен работать в собственном режиме. Веб-части обозревателя отчетов и средства просмотра отчетов **не могут** применяться для подключения к серверу отчетов, работающему в режиме интеграции с SharePoint, и просмотра отчетов на нем.  
  
-   Должен быть установлен диспетчер отчетов.  
  
 Веб-части «Обозреватель отчетов» и «Средство просмотра отчетов» распространяются с помощью CAB-файла, который включен в состав служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]. Инструкции по установке, настройке и применению этих веб-частей приведены в последующих подразделах данного раздела.  
  
##  <a name="bkmk_installingwebparts"></a> Установка веб-частей  
 Веб-части пересылаются на сервер SharePoint в виде CAB-файла. Чтобы установить веб-части, запустите из командной строки программу SharePoint Stsadm.exe, указав в качестве параметра CAB-файл. Дополнительные сведения об этой программе и развертывании веб-частей см. в документации по SharePoint.  
  
#### <a name="install-web-parts-using-powershell"></a>Установка веб-частей с помощью Powershell  
  
1.  Скопируйте файл **RSWebParts.cab** в папку на сервере SharePoint. Его можно скопировать в любую папку на сервере SharePoint, а после установки — веб-частей удалить. По умолчанию службы SQL Server 2014 Reporting Services и более ранних версий устанавливают файл RSWebParts.cab в следующую папку.  
  
    ```  
    C:\Program Files (x86)\Microsoft SQL Server\110\Tools\Reporting Services\SharePoint  
    ```  
  
2.  На компьютере, где установлен продукт SharePoint, откройте **Консоль управления SharePoint 2010** с **правами администратора**.  
  
3.  Выполните следующую команду PowerShell:  
  
    ```  
    Install-SPWebPartPack -LiteralPath "C:\Program Files (x86)\Microsoft SQL Server\110\Tools\Reporting Services\SharePoint\RSWebParts.cab" -GlobalInstall  
    ```  
  
4.  Должно появиться сообщение следующего вида, означающее, что веб-часть развернута.  
  
    > Имя               SolutionId                                             Развернуто  
  
    > ----                    ----------                                              -------\-  
  
    > rswebparts.cab    00000000-0000-0000-0000-000000000000     True  
  
     Дополнительные сведения об использовании PowerShell см. в разделе [Install-SPWebPartPack (http://technet.microsoft.com/library/ff607840.aspx)](http://technet.microsoft.com/library/ff607840.aspx).  
  
#### <a name="install-web-parts-using-stsadmexe"></a>Установка веб-частей с использованием STSADM.exe  
  
1.  Скопируйте файл **RSWebParts.cab** в ту же папку на сервере SharePoint, как описано в разделе о Powershell этого документа.  
  
2.  На компьютере, на котором установлен продукт SharePoint, откройте окно командной строки с правами администратора и перейдите в папку, в которой находится программа **Stsadm.exe** . Путь по умолчанию для [!INCLUDE[SPF2010](../../includes/spf2010-md.md)] следующий:  
  
    > C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\14\BIN.  
  
3.  Запустите программу Stsadm.exe, указав в командной строке CAB-файл следующим образом:  
  
    ```  
    STSADM.EXE -o addwppack -filename "C:\Program Files (x86)\Microsoft SQL Server\110\Tools\Reporting Services\SharePoint\RSWebParts.cab" -globalinstall  
    ```  
  
4.  Появится сообщение «Операция выполнена успешно».  
  
     Аргумент `-globalinstall` добавляет веб-части в глобальный кэш сборок (GAC). Этот шаг обязателен, если необходимо подключить веб-части.  
  
##  <a name="bkmk_configurewebparts"></a> Добавление и настройка веб-частей  
 После установки веб-частей их можно добавить на одну или несколько веб-страниц на сайте SharePoint. Для этого необходимо разрешение на создание веб-сайтов и добавление содержимого.  
  
 Следующая процедура добавляет обе веб-части на страницу, а затем устанавливает связь между обозревателем отчетов и средством просмотра отчетов, поэтому при щелчке отчета в обозревателе отчетов он открывается в средстве просмотра отчетов.  
  
#### <a name="add-report-viewer"></a>Добавление средства просмотра отчетов  
  
1.  В меню «Действия» веб-сайта выберите **Изменить страницу**.  
  
2.  В области на странице нажмите **Добавление веб-части**.  
  
3.  В диалоговом окне **Добавление веб-частей** прокрутите список до категории **Разное** .  
  
4.  Выберите **Средство просмотра отчетов**.  
  
    > [!WARNING]  
    >  Не выбирайте **Средство просмотра отчетов служб SQL Server Reporting Services** . Эта веб-часть регистрируется при установке надстройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] для продуктов SharePoint и используется для запуска сервера отчетов в режиме интеграции с SharePoint. Ее нельзя использовать для просмотра отчетов на сервере отчетов, работающем в собственном режиме.  
  
5.  Нажмите кнопку **Добавить**.  
  
6.  Пока страница находится в режиме изменения, щелкните **Изменить веб-часть** в веб-части средства просмотра отчетов.  
  
7.  В поле **URL-адрес диспетчера отчетов**введите URL-адрес экземпляра диспетчера отчетов, связанного с сервером отчетов, работающим в собственном режиме, к которому будет производиться доступ. По умолчанию URL-адрес диспетчера отчетов имеет следующий синтаксис: **http://\<имя_сервера>/reports**.  
  
8.  В поле **Путь отчета**укажите косую черту, путь до папки и имя отчета. Имя сервера и виртуальный каталог диспетчера отчетов **не указываются** . Например, чтобы открыть отчет Company Sales из папки Adventure Works, укажите путь **/Adventure Works/Company Sales**. Далее приведен еще один пример, где отчет Products находится в корневой папке сервера отчетов ( **/Products**).  
  
9. Нажмите кнопку **ОК**.  
  
#### <a name="add-report-explorer-and-connect-to-report-viewer"></a>Добавление обозревателя отчетов и установка связи со средством просмотра отчетов  
  
1.  В другой области страницы щелкните **Добавить веб-часть** и в папке «Разное» щелкните **Обозреватель отчетов** , а затем выберите **Добавить**.  
  
2.  В контекстном меню веб-части «Обозреватель отчетов» выберите пункт **Изменить веб-часть**.  
  
3.  В поле **URL-адрес диспетчера отчетов**введите URL-адрес экземпляра диспетчера отчетов, связанного с сервером отчетов, работающим в собственном режиме, к которому будет производиться доступ.  
  
4.  Можно также указать **Начальный путь**. Это папка в иерархии папок сервера отчетов. Ее указывают в том случае, если первая страница должна быть папкой, находящейся ниже в иерархии папок. Путь должен начинаться с косой черты. Указывается полный путь, начиная с корневого узла иерархии папок сервера отчетов, но не включая имя сервера и виртуальный каталог диспетчера отчетов. Например, чтобы открыть папку под названием Adventure Works, вложенную в корневой узел, укажите **/Adventure Works** .  
  
5.  Нажмите кнопку **ОК**.  
  
6.  В обозревателе отчетов откроется список элементов отчета на сервере отчетов. По умолчанию, если щелкнуть имя отчета, он открывается в новом окне. Выполните следующие действия в случае, если необходимо подключить обозреватель отчетов к средству просмотра отчетов, чтобы при щелчке имени отчета в обозревателе отчетов он отображался в средстве просмотра отчетов.  
  
    1.  В контекстном меню обозревателя отчетов выберите пункт **Соединения**.  
  
    2.  Щелкните пункт **Способ просмотра отчета**.  
  
    3.  Выберите **Средство просмотра отчетов**.  

Остались вопросы? [Посетите форум служб Reporting Services](http://go.microsoft.com/fwlink/?LinkId=620231).
