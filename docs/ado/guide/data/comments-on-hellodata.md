---
title: Комментарии к HelloData | Документы Microsoft
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: ado
ms.technology:
- drivers
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.suite: sql
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- hellodata sample application [ADO]
ms.assetid: a2831d77-7040-4b73-bbae-fe0bf78107ed
caps.latest.revision: 12
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: d04b6f886a1f1a4583830d1afdd096b445461232
ms.sourcegitcommit: bb044a48a6af9b9d8edb178dc8c8bd5658b9ff68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2018
---
# <a name="comments-on-hellodata"></a>Комментарии к HelloData
Приложения HelloData пошаговое выполнение основных операций типичного приложения ADO: начало, проверки, изменение и обновление данных. При запуске приложения, нажмите первую кнопку, **получение данных**. Будет запущен **GetData** подпрограммы.  
  
## <a name="getdata"></a>GetData  
 **GetData** помещает допустимую строку соединения в переменную уровня модуля *m_sConnStr*. Дополнительные сведения о строках соединения см. в разделе [создания строки подключения](../../../ado/guide/data/creating-a-connection-string.md).  
  
 Назначить обработчик ошибок с помощью Visual Basic **OnError** инструкции. Дополнительные сведения об обработке ошибок в ADO см. в разделе [обработка ошибок](../../../ado/guide/data/error-handling.md). Новый **подключения** объект создан и **CursorLocation** свойству **adUseClient** так, как создается HelloData  *отключен записей*. Это означает, что как только выбранных данных из источника данных, физическое соединение с источником данных разрывается, но по-прежнему можно работать с данными, которые кэшируются локально в вашей **записей** объекта.  
  
 После открытия соединения, присвойте переменной (sSQL) является строкой SQL. Затем создайте новый экземпляр **записей** объекта, `m_oRecordset1`. В следующей строке кода, откройте **записей** в существующую **подключения**, передавая `sSQL` как источник **записей**. Справка ADO при составлении определения, что строка SQL, вы были пройдены в качестве источника для **записей** представляет собой текстовое определение команды, передав **adCmdText** в последним аргументом для **Открыть набор записей** метод. Эта строка также задает **LockType** и **CursorType** связанных с **записей**.  
  
 Следующая строка кода задает **MarshalOptions** значения свойства **adMarshalModifiedOnly**. **MarshalOptions** указывает, какие записи следует маршалировать среднего уровня (или веб-сервера). Дополнительные сведения о маршалинге см. в документации COM. При использовании **adMarshalModifiedOnly** с клиентский курсор ([CursorLocation](../../../ado/reference/ado-api/cursorlocation-property-ado.md) = **adUseClient**), только те записи, которые были изменены на Клиент записываются обратно на средний уровень. Установка **MarshalOptions** для **adMarshalModifiedOnly** может повысить производительность, поскольку маршалируются меньшее число строк.  
  
 Затем отключите **записей** , установив его **ActiveConnection** значения свойства **ничего не**. Дополнительные сведения см в подразделе «Отключение и повторное подключение набор записей» раздела [обновление и сохранение данных](../../../ado/guide/data/updating-and-persisting-data.md).  
  
 Закройте подключения к источнику данных и удалите существующие **подключения** объекта. Это освобождает ресурсы, которые его использовать.  
  
 Последним шагом является установка **записей** как **DataSource** Microsoft DataGrid управления в форме таким образом, можно отобразить данные из **записей** на форма.  
  
 Нажмите вторую кнопку **проверки данных**. Эта процедура выполняется **ExamineData** подпрограммы.  
  
## <a name="examinedata"></a>ExamineData  
 ExamineData использует различные методы и свойства **записей** объекта для отображения сведений о данных в **записей**. Он выводит число записей с помощью **RecordCount** свойство. Он просматривает **записей** и выводятся на печать значения **AbsolutePosition** свойство в текстовом поле отображения в форме. Также при работе в цикле, значение **закладки** свойство для третья запись помещается в переменную типа variant *vBookmark*, для последующего использования.  
  
 Подпрограммы переходит непосредственно к третья запись, с помощью переменной закладки, сохраненную ранее. Сопоставление вызовов **WalkFields** подпрограмму, которая просматривает **поля** коллекцию **записей** и отображает сведения о каждом **поля**  в коллекции.  
  
 Наконец **ExamineData** использует **фильтра** свойство **записей** экран только записи с **CategoryId** равно 2. Результат применения этого фильтра отображается сразу в сетке отображения в форме.  
  
 Дополнительные сведения о функциональных возможностях, показанный на **ExamineData** подпрограммы, в разделе [проверки данных](../../../ado/guide/data/examining-data.md).  
  
 Затем щелкните третью кнопка **изменить данные**. Будет запущен **EditData** подпрограммы.  
  
## <a name="editdata"></a>EditData  
 При достижении цикла **EditData** подпрограммы, **записей** фильтруется по-прежнему на **CategoryId** равно 2, таким образом, только те элементы, которые удовлетворяют условиям фильтра Видимый. Он сначала просматривает **записей** и увеличивает цену каждый элемент отображается в **записей** на 10 процентов. Значение **цены** поле, изменить, задав **значение** свойства для этого поля равно новый, допустимые сумма.  
  
 Следует помнить, что **записей** отключен от источника данных. Изменения, внесенные в **EditData** выполняются только локально кэшированную копию данных. Дополнительные сведения см. в разделе [редактирование данных](../../../ado/guide/data/editing-data.md).  
  
 Изменения не будут совершаться на источнике данных до нажатия кнопки четвертый **обновление данных**. Будет запущен **UpdateData** подпрограммы.  
  
## <a name="updatedata"></a>UpdateData  
 UpdateData сначала удаляет фильтр, примененный к **записей**. Код удаляет и сбрасывает `m_oRecordset1` как **DataSource** для DataGrid привязан Microsoft в форме, чтобы нефильтрованные **записей** отображается в сетке.  
  
 Затем код проверяет, чтобы увидеть, можно ли переместить Назад **записей** с помощью **поддерживает** метод с **adMovePrevious** аргумент.  
  
 Перемещает подпрограммы первой записи с помощью **MoveFirst** метод и отображает исходные и текущие значения поля, используя **OriginalValue** и **значение** свойства **поле** объекта. Эти свойства, вместе с **UnderlyingValue** свойство (здесь не используется), рассматриваются в [обновление и сохранение данных](../../../ado/guide/data/updating-and-persisting-data.md).  
  
 Далее, новый **подключения** объект создается и используется, чтобы заново установить соединение с источником данных. Повторного подключения **записей** к источнику данных, задав для нового **подключения** как **ActiveConnection** для **записей**. Чтобы отправлять обновления на сервер, этот код вызывает **UpdateBatch** на **записей**.  
  
 Если пакетное обновление завершается успешно, переменную уровня модуля флаг `m_flgPriceUpdated`, имеет значение True. Это напомнит позже, чтобы очистить все изменения, внесенные в базу данных.  
  
 Наконец, код переход к первой записи в **записей** и отображает исходные и текущие значения. Значения совпадают после вызова **UpdateBatch**.  
  
 Подробные сведения об обновлении данных, включая что делать при данные на сервер будет заменен при вашей **набора записей** — отключен, в разделе [обновление и сохранение данных](../../../ado/guide/data/updating-and-persisting-data.md).  
  
## <a name="formunload"></a>Form_Unload  
 **Form_Unload** подпрограммы важно по следующим причинам. Во-первых поскольку это образец приложения, Form_Unload очищает изменения, внесенные в базу данных до завершения приложения. Во-вторых, в коде показано, как команда может быть выполнена напрямую из открытого **подключения** объектов с помощью **Execute** метод. Наконец он приведен пример выполнения не — возвращение строки запроса (запрос на обновление) в источнике данных.
