---
title: "Обработка транзакций | Документы Microsoft"
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: ado
ms.technology: drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- transactions [ADO]
- data updates [ADO], transaction processing
- updating data [ADO], transaction processing
- nested transactions [ADO]
ms.assetid: 74ab6706-e2dc-42cb-af77-dbc58a9cf4ce
caps.latest.revision: "12"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 55f563b145cf77dc64879801c4603bd51234b0f4
ms.sourcegitcommit: cc71f1027884462c359effb898390c8d97eaa414
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="transaction-processing"></a>Обработка транзакций
Объект *транзакции* разделяет начало и конец ряда операций доступа к данным выполняется через подключение. Зависит от возможностей источника данных транзакций **подключения** объекта также дает возможность создания и управления транзакциями. Например используя поставщик Microsoft OLE DB для SQL Server для доступа к базе данных на Microsoft SQL Server, можно создать несколько вложенных транзакций, для выполнения команд.  
  
 ADO гарантирует, что изменения в источник данных, возникающие в результате операции в транзакции успешно вместе или не полностью.  
  
 Если отменить транзакцию, или при сбое одного из своих операций, это приведет к появлению как если бы ни одна из операций в транзакции произошло. Источник данных останется, которое было до начала транзакции.  
  
 ADO предоставляет следующие методы для управления транзакциями: **BeginTrans**, **CommitTrans**, и **RollbackTrans**. Используйте эти методы с **подключения** объекта, если вы хотите сохранить или отменить ряд изменений, внесенных в источник данных как единое целое. Например для передачи денег между счетами, можно вычесть сумму из одного и добавьте величину, заданную в другую. Если либо неудаче обновления, учетные записи больше не балансировку. Эти изменения в открытой транзакции гарантирует, что все или никакие изменения проходят через.  
  
> [!NOTE]
>  Не все поставщики поддерживают транзакции. Убедитесь, что свойство, определенное поставщиком "**операции DDL**» отображается в **подключения** объекта [свойства](../../../ado/reference/ado-api/properties-collection-ado.md) коллекции, указывающее на то, что поставщик поддерживает транзакции. Если поставщик не поддерживает транзакции, вызвав один из этих методов возвращает ошибку.  
  
 После вызова метода **BeginTrans** , поставщик будет фиксировать больше не мгновенно изменения, сделанные до вызова **CommitTrans** или **RollbackTrans** до конца транзакция.  
  
 Вызов **CommitTrans** метод сохраняет изменения, внесенные в открытые транзакции в соединении и завершает транзакцию. Вызов **RollbackTrans** метод отменяет все изменения, внесенные в открытые транзакции и завершает транзакцию. Вызов любого метода, если нет открытых транзакций приводит к ошибке.  
  
 В зависимости от **подключения** объекта [атрибуты](../../../ado/reference/ado-api/attributes-property-ado.md) свойство с помощью вызова **CommitTrans** или **RollbackTrans** метод может автоматически запускает новую транзакцию. Если **атрибуты** свойству **adXactCommitRetaining**, поставщик автоматически запускает новую транзакцию после **CommitTrans** вызова. Если **атрибуты** свойству **adXactAbortRetaining**, поставщик автоматически запускает новую транзакцию после **RollbackTrans** вызова.  
  
## <a name="transaction-isolation-level"></a>Уровень изоляции транзакции  
 Используйте **IsolationLevel** свойство, чтобы задать уровень изоляции транзакции на **подключения** объекта. Параметр вступает в силу только при следующем вызове [BeginTrans](../../../ado/reference/ado-api/begintrans-committrans-and-rollbacktrans-methods-ado.md) метод. Если уровень изоляции запросов недоступен, это означает, поставщик может вернуть больше следующий уровень изоляции. Ссылаться на **IsolationLevel** свойство справочника по программированию ADO, Дополнительные сведения о допустимых значений.  
  
## <a name="nested-transactions"></a>Вложенные транзакции  
 Для поставщиков, которые поддерживают вложенные транзакции вызова **BeginTrans** метод в открытой транзакции запускает новую, вложенные транзакции. Возвращает значение, указывающее уровень вложенности: «1» возвращает значение, указывающее, был открыт транзакцией верхнего уровня (то есть транзакция не является вложенным в другой транзакции), «2» означает, что вы открыли транзакции второго уровня ( транзакция вложена в рамках транзакции верхнего уровня), и т. д. Вызов **CommitTrans** или **RollbackTrans** затрагивает только последний открытый транзакции; необходимо закрыть или откат текущей транзакции, чтобы связать все более высокого уровня транзакции.
