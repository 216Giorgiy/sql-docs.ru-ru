---
title: "Что такое курсора | Документы Майкрософт"
ms.prod: sql-non-specified
ms.technology:
- drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- cursors [ADO], about cursors
ms.assetid: 596eb4b6-c22f-4cde-b23f-172dd66c3161
caps.latest.revision: 10
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 03b7d4fe16a379e04fe25fe8fef95802aedabe1d
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="what-is-a-cursor"></a>Что такое курсора
Операции в реляционной базе данных выполняются над множеством строк. Набор строк, возвращаемый инструкцией SELECT, содержит все строки, которые удовлетворяют условиям, указанным в предложении WHERE инструкции. Такой полный набор строк, возвращаемых инструкцией, называется результирующим набором. Приложения, особенно интерактивные и сети, не всегда эффективно работают с результирующим набором как единое целое. Им нужен механизм, позволяющий обрабатывать одну строку или небольшое их число за один раз. Курсоры являются расширением результирующих наборов, которые предоставляют такой механизм.  
  
 Библиотека курсоров реализуют курсор. Библиотека курсоров — это программное обеспечение, обычно осуществляется в рамках системы базы данных или API, для доступа к данным, используемый для управления атрибутами данные, возвращенные из источника данных (результирующий набор). Эти атрибуты включают управление параллелизмом, положение в результирующем наборе количество возвращаемых строк и можно ли переместить вперед или назад (или оба варианта) с помощью результат задать (прокручивание).  
  
 Курсор отслеживает положение в результирующем наборе и позволяет выполнять несколько операций по строкам для результирующего набора с или без возврата к исходной таблице. Другими словами по существу курсоры возвращают результирующий набор, основанный на таблицах в базах данных. Курсор называется потому что она показывает текущую позицию в результирующем наборе, так же, как курсор на экране компьютера показывает текущее положение.  
  
 Очень важно ознакомиться с концепцией курсоров перед переходом к изучать особенности их использования в ADO.  
  
 Использование курсоров, вы можете:  
  
-   Укажите расположение на отдельные строки в результирующем наборе.  
  
-   Получение одной строки или блока строк, в зависимости от текущей позиции результирующего набора.  
  
-   Изменение данных в строках в текущей позиции в результирующем наборе.  
  
-   Определите разные уровни конфиденциальности для изменения данных, сделанные другими пользователями.  
  
 Например рассмотрим приложение, отображающее список продуктов, доступных для потенциальных покупателей. Покупатель прокрутку списка, чтобы просмотреть сведения о продукте и затраты и наконец выбирает продукт для покупки. Дополнительные прокрутку и выбор происходит в оставшейся части списка. Как покупатель занимается, продукты отображаются по одному, однако приложение использует прокручиваемого курсора вверх и вниз Просмотр результирующего набора.  
  
 Можно использовать курсоры в различными способами:  
  
-   Вообще без строк.  
  
-   С помощью некоторых или всех строк в одной таблице.  
  
-   Некоторые или все строки из логически объединенных таблиц.  
  
-   Как только для чтения или обновляться на уровне курсора или поля.  
  
-   Только для прямого или полностью прокрутки.  
  
-   С помощью курсора keyset, расположенной на сервере.  
  
-   Чувствительность к базовой таблице изменения, вызванные другими приложениями (например, членство, сортировки, вставки, обновления и удаления).  
  
-   Существующие на сервере или клиенте.  
  
 Только для чтения курсоры помогают пользователям просматривать результирующий набор, а также чтение и запись, что курсоры можно реализовать обновления отдельных строк. Сложные курсоры могут определяться с помощью наборы ключей, указывать обратно на базовые таблицы строк. Несмотря на то, что некоторые курсоры только для чтения в прямом направлении, другие пользователи могли переходить вперед и назад и предоставляют динамические обновления результирующего набора, на основе изменений, другие приложения, осуществляющие в базу данных.  
  
 Не все приложения должны использовать курсоры для доступа и обновления данных. Некоторые запросы просто не нужно направить строку обновлять с помощью курсора. Курсоры должен быть один из способов последнее, выберите для получения данных, и затем следует выбрать возможных наименьшее влияние курсора. При создании результирующего набора с помощью хранимой процедуры, результирующий набор не является обновляемым, использование курсора, изменить или обновить методы.  
  
## <a name="concurrency"></a>Параллелизм  
 В некоторых многопользовательских приложений очень важно для данных, отображаемых как текущие максимально конечному пользователю. Классический пример такой системы является системе бронирования авиабилетов, где много пользователей может конкурирующих за доступ к же место в данной рейса (и, таким образом, одну запись). В подобном случае разработки приложения должны обрабатывать параллельных операций в одну запись.  
  
 В других приложениях параллелизма не столь важным. В таких случаях не может быть оправдано расходов, участвующих в сохранения текущей данных в любое время.  
  
## <a name="position"></a>Положение  
 Курсор также сохраняет сведения о текущей позиции в результирующем наборе. Можно рассматривать как указатель на текущую запись, аналогично тому, как положение курсора массив индекса указывает на значение в определенном месте в массиве.  
  
## <a name="scrollability"></a>Прокручиваемость  
 Тип курсора, используемые вашим приложением, также влияет на возможность перемещаться вперед и назад по строкам в результирующем наборе; Это иногда называется прокручивание. Возможность перемещаться вперед *и* назад по результирующий набор курсора усложняет и поэтому более высокая стоимость реализации. По этой причине необходимо обратиться в курсоре эта функциональная возможность только при необходимости.
