---
title: "Операция параметризованных команд | Документы Microsoft"
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: ado
ms.technology:
- drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- data shaping [ADO], parameterized commands
- parameterized commands [ADO]
ms.assetid: 4fae0d54-83b6-4ead-99cc-bcf532daa121
caps.latest.revision: 
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: 7d826d5407aabce4baa82b0952cff6c8344944e8
ms.sourcegitcommit: acab4bcab1385d645fafe2925130f102e114f122
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/09/2018
---
# <a name="operation-of-parameterized-commands"></a>Операция параметризованных команд
При работе с большой дочерним **записей**, особенно по сравнению с размером родительского **записей**, но требуется доступ только несколько дочерних разделов, может оказаться более эффективно использовать параметризованные команды.  
  
 Объект *без параметров команда* извлекает всей родительской и дочерней **наборы записей**, добавляет столбец к родительскому элементу, а затем назначает ссылку на главе связанной дочерней для каждой родительской строке .  
  
 A *параметризованные команды* извлекает всей родительской **записей**, но извлекает только главе **записей** при обращении к главе столбца. Это различие в стратегии извлечения может обеспечить значительные преимущества в производительности.  
  
 Например можно указать следующее:  
  
```  
SHAPE {SELECT * FROM customer}   
   APPEND ({SELECT * FROM orders WHERE cust_id = ?}   
   RELATE cust_id TO PARAMETER 0)  
```  
  
 Родительскую и дочернюю таблицы имеют имя столбца в общие cust_id*.* *Команда дочерних* имеет «?» заполнитель, на который ссылается в предложении RELATE (т. е «... ПАРАМЕТР 0").  
  
> [!NOTE]
>  ПАРАМЕТР предложение относится исключительно к синтаксис команды фигуры. Он не связан с либо ADO [параметр](../../../ado/reference/ado-api/parameter-object.md) объекта или [параметры](../../../ado/reference/ado-api/parameters-collection-ado.md) коллекции.  
  
 При выполнении команды параметризованные фигуры, происходит следующее.  
  
1.  *Родительской команды* выполняется и возвращает родительский элемент **записей** из таблицы Customers.  
  
2.  Столбец добавляется к родительскому **записей**.  
  
3.  При обращении к столбец родительской строки *команда дочерних* выполняется с помощью значения customer.cust_id в качестве значения параметра.  
  
4.  Все строки в наборе строк поставщика данных, созданный на шаге 3 используются для заполнения дочерние **записей**. В этом примере это все строки в таблице Orders, в котором cust_id равен значению customer.cust_id. По умолчанию дочерние **записей**s будет кэшироваться на клиенте до все ссылки на родительский **записей** освобождаются. Чтобы изменить это поведение, установите **записей** [динамических свойств](../../../ado/reference/ado-api/ado-dynamic-property-index.md) **кэша дочерних строк** для **False**.  
  
5.  Ссылку для извлеченных дочерних строк (то есть Глава дочернего **набора записей**) помещается в столбец текущей строки родительского **набора записей**.  
  
6.  Шаги 3 – 5 повторяются при обращении к столбце главе другой строки.  
  
 **Кэша дочерних строк** динамическое свойство имеет значение **True** по умолчанию. Поведение кэширования зависит от значения параметров запроса. В запросе с одним параметром дочерние **записей** для данного параметра значение будет кэшироваться между запросами дочерний элемент с этим значением. Это демонстрируется в следующем коде:  
  
```  
SCmd = "SHAPE {select * from customer} " & _  
         "APPEND({select * from orders where cust_id = ?} " & _  
         "RELATE cust_id TO PARAMETER 0) AS chpCustOrder"  
Rst1.Open sCmd, Cnn1  
Set RstChild = Rst1("chpCustOrder").Value  
Rst1.MoveNext      ' Next cust_id passed to Param 0, & new rs fetched   
                   ' into RstChild.  
Rst1.MovePrevious  ' RstChild now holds cached rs, saving round trip.  
```  
  
 В запросе с двумя или несколькими параметрами кэшированные дочерние используется только в том случае, если значение параметра соответствует кэшированные значения.  
  
## <a name="parameterized-commands-and-complex-parent-child-relations"></a>Параметризованные команды и сложные родительского дочерние отношения  
 Помимо использования параметризованных команд для повышения производительности иерархии типа эквивалентное соединение, можно использовать параметризованные команды для поддержки более сложных родительско дочерних отношений. Например, рассмотрим базу данных прямым лиги с двумя таблицами: одно состоящее из команд (team_id, team_name), а другой — игры (дата, home_team, visiting_team).  
  
 С помощью иерархии без параметров, нет возможности для их связывания рабочих групп и игр таким образом, дочерние **набора записей** для каждой команды содержат ее полное расписание. Можно создать разделы, содержащие домашней расписание или расписание дорог, но не оба. Это, так как в предложении RELATE ограничена родительско дочерних отношений формы (pc1 = cc1) AND (pc2 = pc2). Таким образом Если команда включает «СВЯЗАНЫ team_id TO home_team, team_id TO visiting_team», получится только игр где сам воспроизведение команды. Выберите — "(team_id=home_team) или (team_id = visiting_team)», но поставщик Data Shape не поддерживает предложение OR.  
  
 Чтобы получить нужный результат, можно использовать параметризованные команды. Например:  
  
```  
SHAPE {SELECT * FROM teams}   
APPEND ({SELECT * FROM games WHERE home_team = ? OR visiting_team = ?}   
        RELATE team_id TO PARAMETER 0,   
               team_id TO PARAMETER 1)   
```  
  
 Этот пример использует большую гибкость предложения SQL WHERE, чтобы получить нужный результат.  
  
> [!NOTE]
>  Если с помощью предложения WHERE, параметры можно не использовать типы данных SQL для text, ntext и image или, будет выдана ошибка содержит следующее описание: `Invalid operator for data type`.  
  
## <a name="see-also"></a>См. также  
 [Пример формирования данных](../../../ado/guide/data/data-shaping-example.md)   
 [Грамматика формальных фигуры](../../../ado/guide/data/formal-shape-grammar.md)   
 [Общие сведения о командах формирования данных](../../../ado/guide/data/shape-commands-in-general.md)
