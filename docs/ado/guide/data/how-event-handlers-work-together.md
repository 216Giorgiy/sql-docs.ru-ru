---
title: "Как работают обработчики событий | Документы Microsoft"
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: ado
ms.technology: drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- events [ADO], about event handlers
- unpaired event handlers [ADO]
- paired event handlers [ADO]
- single event handlers [ADO]
- event handlers [ADO]
- multiple object event handlers [ADO]
ms.assetid: a86c8a02-dd69-420d-8a47-0188b339858d
caps.latest.revision: "10"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 72ca437ae2d78395632abd06169feb2b41d4fc50
ms.sourcegitcommit: cc71f1027884462c359effb898390c8d97eaa414
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="how-event-handlers-work-together"></a>Как работают обработчики событий
Если при программировании в Visual Basic, все обработчики событий для **подключения** и **записей** события должен быть реализован, независимо от того, возможность вы фактически обработать все события. Объем работы реализацию, что нужно сделать зависит от используемого языка программирования. Дополнительные сведения см. в разделе [ADO экземпляр события в языке](../../../ado/guide/data/ado-event-instantiation-by-language.md).  
  
## <a name="paired-event-handlers"></a>Обработчики событий парной  
 Каждый обработчик событий будет имеет связанный **завершить** обработчика событий. Например, в том случае, когда приложение изменяется значение поля, **WillChangeField** вызывается обработчик события. Если изменение является приемлемым, приложение оставляет **adStatus** параметр изменяется и выполнить операцию. По завершении операции **FieldChangeComplete** событие информирует приложение о завершении операции. Если она завершится успешно, **adStatus** содержит **adStatusOK**; в противном случае **adStatus** содержит **adStatusErrorsOccurred** и необходимо проверить **ошибка** объектом, чтобы определить причину ошибки.  
  
 Когда **WillChangeField** — вызывается, можно определить, что изменения не должны быть сделаны. В этом случае задайте **adStatus** для **adStatusCancel.** Операция отменяется и **FieldChangeComplete** событие получает **adStatus** значение **adStatusErrorsOccurred**. **Ошибка** объект содержит **adErrOperationCancelled** , чтобы ваш **FieldChangeComplete** обработчик знает, что операция была отменена. Тем не менее, необходимо проверить значение **adStatus** параметра перед изменением, так как задание **adStatus** для **adStatusCancel** имеет смысл, если был задан параметр Чтобы **adStatusCantDeny** при входе в процедуру.  
  
 Иногда операции могут вызывать более одного события. Например **записей** объект пару событий для **поле** изменений и **записи** изменения. Когда приложение изменяет значение **поле**, **WillChangeField** вызывается обработчик события. Если он определяет, что операция может продолжаться, **WillChangeRecord** также вызывается обработчик события. Если этот обработчик также позволяет событий продолжить, изменения и **FieldChangeComplete** и **RecordChangeComplete** обработчики событий вызываются. Порядок вызова обработчиков событий будет для конкретной операции не определен, поэтому следует избегать написания кода, который зависит от вызова обработчиков в определенной последовательности.  
  
 В экземплярах при появлении нескольких событий будет одно из событий может отменить выполняющуюся операцию. Например, когда приложение изменяет значение **поле**, оба **WillChangeField** и **WillChangeRecord** обычно называется обработчики событий. Тем не менее если операция отменена в первый обработчик событий, связанный с ним **завершить** обработчик вызывается немедленно с **adStatusOperationCancelled**. Второй обработчик никогда не вызывается. Если, однако первый обработчик событий позволяет событий продолжить, будет вызван обработчик событий. Если он отменяет операции, как **завершить** событий будет вызываться, как показано в предыдущих примерах.  
  
## <a name="unpaired-event-handlers"></a>Обработчики событий непарные  
 При условии, что передаваемый состояние событие не является **adStatusCantDeny**, можно отключить уведомления о событиях для любых событий, возвращая **adStatusUnwantedEvent** в *состояние*параметра. Например, если ваш **завершить** обработчик событий вызывается в первый раз, можно вернуть **adStatusUnwantedEvent**. Впоследствии вы получите только **будет** события. Тем не менее некоторые события можно вызвать для более чем одной из причин. В этом случае будет иметь событие *Причина* параметра. При возвращении **adStatusUnwantedEvent**, рекомендуется прекратить получение уведомлений для этого события только в том случае, если они возникают для этой конкретной причины. Другими словами вы потенциально получат уведомление для каждого из возможных причин события могут быть запущены.  
  
 Один **будет** обработчики событий можно использовать при необходимо просмотреть параметры, которые будут использоваться в операции. Можно изменить эти параметры операции или отменить операцию.  
  
 Кроме того, оставьте **завершить** включены уведомления о событии. При вызове первый обработчик событий будет возвращать **adStatusUnwantedEvent**. Впоследствии вы получите только **завершить** события.  
  
 Один **завершить** обработчики событий можно использовать для управления асинхронных операций. Каждой асинхронной операции имеет соответствующий **завершить** событий.  
  
 Например, может занять много времени для заполнения большой [записей](../../../ado/reference/ado-api/recordset-object-ado.md) объекта. Если приложение написано правильно, можно запустить `Recordset.Open(...,adAsyncExecute)` операции и продолжить работу с другими видами обработки. В конечном итоге будет уведомления, если **записей** заполняется **ExecuteComplete** событий.  
  
## <a name="single-event-handlers-and-multiple-objects"></a>Обработчики событий одного и нескольких объектов  
 Гибкость языка программирования, например Microsoft Visual C++® позволяет использовать один процесс обработчика события из нескольких объектов. Например, можно создать один **Disconnect** процесс обработчика события от нескольких **подключения** объектов. Если одно из подключений завершился, **Disconnect** вызывается обработчик события. Может определить, какое подключение вызвавшее событие, так как обработчик событий объект будет иметь значение в соответствующий **подключения** объекта.  
  
> [!NOTE]
>  Этот метод не может использоваться в Visual Basic, поскольку этот язык можно сопоставлять только один объект обработчика события.  
  
## <a name="see-also"></a>См. также:  
 [Сводка обработчик событий ADO](../../../ado/guide/data/ado-event-handler-summary.md)   
 [Создание экземпляра события ADO по языку](../../../ado/guide/data/ado-event-instantiation-by-language.md)   
 [Параметры события](../../../ado/guide/data/event-parameters.md)   
 [Типы событий](../../../ado/guide/data/types-of-events.md)
