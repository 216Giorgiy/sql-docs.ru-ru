---
title: Формирование предложение COMPUTE | Документы Microsoft
ms.prod: sql
ms.prod_service: connectivity
ms.component: ado
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.suite: sql
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- shape commands [ADO]
- compute clause [ADO]
- data shaping [ADO], COMPUTE clause
ms.assetid: 3fdfead2-b5ab-4163-9b1d-3d2143a5db8c
caps.latest.revision: 11
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 25d89db4052234482846dc752e5c0431bb517164
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="shape-compute-clause"></a>Предложение COMPUTE фигуры
Предложение COMPUTE фигуры приводит к возникновению ошибки родительского **набора записей**, столбцы которых состоят из ссылки на дочерние **набора записей**; является необязательным, содержимое которых главе, новые возможности, или вычисляемых столбцов, столбцов или результат выполнения статистические функции на дочернем **записей** или ранее фигурные **записей**; и любых столбцов с дочернего **набора записей** перечисленные в необязательное предложение.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
SHAPE child-command [AS] child-alias  
   COMPUTE child-alias [[AS] name], [appended-column-list]  
   [BY grp-field-list]  
```  
  
## <a name="description"></a>Описание  
 Существуют следующие части этого предложения.  
  
 *команда*  
 Состоит из одной из следующих:  
  
-   К запросу команды в фигурные скобки («{}»), возвращает дочерний элемент **записей** объекта. Команды для базового поставщика данных, и его синтаксис зависит от требований этого поставщика. Обычно это будет языка SQL, несмотря на то, что ADO не требует любой язык для конкретного запроса.  
  
-   Имя существующего были сформированы **записей**.  
  
-   Другой команды фигуры.  
  
-   Таблица ключевого слова, за которым следует имя таблицы в поставщике данных.  
  
 *дочерние псевдоним*  
 Псевдоним, использованные для обращения к **записей** возвращенных *дочерний command.* *Дочерних псевдоним* является обязательным в списке столбцов в предложении COMPUTE и определяет отношение между родительским и дочерним **записей** объектов.  
  
 *добавлен столбец список-*  
 Список, в котором каждый элемент определяет столбец в создан родительский элемент. Каждый элемент содержит столбец, новый столбец, вычисляемый столбец или значение, являющееся результатом агрегатной функции на дочернем **записей**.  
  
 *grp-field-list*  
 Список столбцов в родительской и дочерней **записей** объекты, которые указывает группирования строк в дочерней.  
  
 Для каждого столбца в *группу поле list,* отсутствует соответствующий столбец в дочерней и родительской **записей** объектов. Для каждой строки в родительской **записей**, *группу список полей* столбцы имеют уникальные значения и дочерние **набора записей** ссылается родительского строка состоит только из дочернего строки, *списка для полей группу* столбцы имеют одинаковые значения в строке родитель.  
  
 Если предложение BY включено дочерние **записей**строки будут сгруппированы на основе столбцов в предложении COMPUTE. Родительский **записей** будет содержать одну строку для каждой группы строк в дочерней **записей**.  
  
 Если предложение BY опущено, все дочерние **записей** рассматривается как одна группа и родительским **записей** будет содержать только одну строку. Этой строки будет ссылаться на все дочерние **записей**. Пропуск предложение BY позволяет вычислять статистические выражения «общий итог» на все дочерние **записей**.  
  
 Например:  
  
```  
SHAPE {select * from Orders} AS orders             COMPUTE orders, SUM(orders.OrderAmount) as TotalSales         
```  
  
 Независимо от способа родительского **записей** формируется (используется ВЫЧИСЛЕНИЙ или APPEND), он будет содержать столбец, используемый для связи его дочерним **записей**. При желании родительского **записей** дочерних строк также может содержать столбцы, содержащие статистические функции (SUM, MIN, MAX и т. д.). Родительский и дочерний **записей** может содержать столбцы, которые содержат выражение от строки в **набора записей**, а также пустые столбцы с new и изначально.  
  
## <a name="operation"></a>Операция  
 *Дочерних команда* выпускается для поставщика, который возвращает дочерний элемент **записей**.  
  
 Предложение COMPUTE указывает столбцы родительского **набора записей**, который может ссылаться на дочерние **набора записей**, один или несколько статистических выражений, вычисляемое выражение или новые столбцы. Если предложение BY, он определяет столбцы также добавляются к родительскому **записей**. Указывает предложение BY как строки дочерней **записей** группируются.  
  
 Например предположим, что у вас есть таблица, с именем демографических данных, который состоит из штатов, городов и заполнения поля. (Заполнение фигур в таблице приведены исключительно в качестве примера).  
  
|Состояние|Город|Заполнение|  
|-----------|----------|----------------|  
|WA|Seattle|700,000|  
|или|Medford|200,000|  
|или|Portland|400,000|  
|CA|Лос-Анджелес|800,000|  
|CA|Сан-Диего|600,000|  
|WA|Такома|500,000|  
|или|Corvallis|300,000|  
  
 Теперь выполните эту команду фигуры:  
  
```  
rst.Open  "SHAPE {select * from demographics} AS rs "  & _  
          "COMPUTE rs, SUM(rs.population) BY state", _  
           objConnection  
```  
  
 Эта команда открывает фигурные **записей** с двумя уровнями. Родительским уровнем является созданный **записей** с столбца со статистическим выражением (`SUM(rs.population)`), ссылающиеся на дочерний столбец **записей** (`rs`) и столбец для группирования дочерних **Записей** (`state`). Дочерний уровень **записей** возвращается командой запроса (`select * from demographics`).  
  
 Дочерние **записей** будет строки детализации, сгруппированных по состоянию, но в произвольном порядке, в противном случае значение. То есть группы не будут в или алфавитном порядке. Если требуется, чтобы родительский **записей** порядке, можно использовать **сортировки набора записей** метод для упорядочивания родительского **записей**.  
  
 Теперь можно переходить opened родительского **набора записей** и получить доступ к детализации дочерних **набора записей** объектов. Дополнительные сведения см. в разделе [доступ к строкам в иерархических записей](../../../ado/guide/data/accessing-rows-in-a-hierarchical-recordset.md).  
  
## <a name="resultant-parent-and-child-detail-recordsets"></a>Итоговые родительскими и дочерними наборами записей детализации  
  
### <a name="parent"></a>Parent  
  
|SUM (службы Reporting Services. Заполнение)|rs|Состояние|  
|---------------------------|--------|-----------|  
|1,300,000|Ссылка на child1|CA|  
|1,200,000|Ссылка на child2|WA|  
|1,100,000|Ссылка на child3|или|  
  
## <a name="child1"></a>Child1  
  
|Состояние|Город|Заполнение|  
|-----------|----------|----------------|  
|CA|Лос-Анджелес|800,000|  
|CA|Сан-Диего|600,000|  
  
## <a name="child2"></a>Child2  
  
|Состояние|Город|Заполнение|  
|-----------|----------|----------------|  
|WA|Seattle|700,000|  
|WA|Такома|500,000|  
  
## <a name="child3"></a>Child3  
  
|Состояние|Город|Заполнение|  
|-----------|----------|----------------|  
|или|Medford|200,000|  
|или|Portland|400,000|  
|или|Corvallis|300,000|  
  
## <a name="see-also"></a>См. также  
 [Доступ к строк в иерархических записей](../../../ado/guide/data/accessing-rows-in-a-hierarchical-recordset.md)   
 [Общие сведения о формирования данных](../../../ado/guide/data/data-shaping-overview.md)   
 [Объект field](../../../ado/reference/ado-api/field-object.md)   
 [Грамматика формальных фигуры](../../../ado/guide/data/formal-shape-grammar.md)   
 [Объект набора записей (ADO)](../../../ado/reference/ado-api/recordset-object-ado.md)   
 [Для формирования данных службы необходимых поставщиков](../../../ado/guide/data/required-providers-for-data-shaping.md)   
 [Предложение APPEND фигуры](../../../ado/guide/data/shape-append-clause.md)   
 [Команды фигуры в целом](../../../ado/guide/data/shape-commands-in-general.md)   
 [Значение свойства (ADO)](../../../ado/reference/ado-api/value-property-ado.md)   
 [Функции Visual Basic для приложений](../../../ado/guide/data/visual-basic-for-applications-functions.md)
