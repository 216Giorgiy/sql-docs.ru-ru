---
title: "Текущая запись и размер набора записей | Документы Microsoft"
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: guide
ms.technology:
- drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- record location [ADO]
- current record [ADO]
ms.assetid: e63ff331-8655-4be7-82c6-e6cd6cc9d16d
caps.latest.revision: 13
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: On Demand
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: fb50826230e46cc71106a2b17d01914eae024f47
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="current-record-and-size-of-recordset"></a>Текущая запись и размер набора записей
В этом разделе описан поиск в текущей позиции курсора в образце **записей** в [примере JScript для возвращения набора записей](../../../ado/guide/data/jscript-code-example-to-return-a-recordset.md).  
  
## <a name="current-record"></a>Текущая запись.  
 Соответствует текущей записи в наборе данных, указывает положение курсора из **записей** объекта. Когда **записей** объект возвращается из источника данных в результате вызова **Recordset.Open**, **Command.Execute**, или **Connection.Execute**  (включая **Connection.NamedCommand** и **Connection.StoredProcedure**), курсор задается для указания на первую запись. В образец набора данных текущей начальной записи — «Bob родственным органических Dried Груши» элемента.  
  
## <a name="size-of-recordset"></a>Размер набора записей  
 Чтобы узнать размер **записей** объекта, получить значение **Recordset.RecordCount** свойство. Это значение является целое число типа long, указывающее количество записей в **записей**. Если набор данных, возвращенный поставщиком OLE DB для Microsoft SQL Server, это значение представляет количество возвращаемых строк. Чтение **RecordCount** свойство для закрытого **записей** приводит к ошибке.  
  
 Если не удается определить число записей, то значение свойства-1.  
  
 Значение **RecordCount** свойства также зависит от возможностей поставщика и типом курсора. Для однонаправленного курсора значение-1. Для статического метода или набора ключей курсора, значение равно фактическое число записей, возвращаемых в **записей** объекта. Для динамического курсора значение равно -1 или фактическое число записей, в зависимости от источника данных.  
  
 Курсор, который поддерживает **Recordcount** необходимо работа труднее и, следовательно, требует большей вычислительной мощности, чем курсора не поддерживает **Recordcount**. Если необходимо узнать количество записей, с помощью другой тип курсора могут способствовать повышению производительности приложения, особенно в том случае, если приходится иметь дело с большим набором данных.  
  
 В некоторых случаях поставщик или курсор не удается определить **RecordCount** значение без получения все записи из источника данных. Чтобы обеспечить точность подсчета, вызовите **записей**. **MoveLast** метод перед вызовом метода **Recordset.RecordCount**.  
  
 Образец **записей** объект, полученный с помощью [пример кода JScript](../../../ado/guide/data/jscript-code-example-to-return-a-recordset.md) использует однонаправленного курсора, поэтому вызов **RecordCount** на этот объект всегда приводит к – 1. Если вы измените строку кода, который вызывает **записей**. **Откройте** метода, как показано в следующем примере **RecordCount** свойство будет возвращать фактическое число записей, выбранных.  
  
```  
oRs.Open sSQL, sCnStr, adOpenStatic, adLockOptimistic, adCmdText   
```  
  
 Это, поскольку статические курсоры с [поставщик Microsoft OLE DB для SQL Server](../../../ado/guide/appendixes/microsoft-ole-db-provider-for-sql-server.md) поддерживает **RecordCount**. В этом примере существует пять записей и, следовательно, **RecordCount** должно выдавать значение 5.  
  
 Этот раздел содержит следующий раздел.  
  
 [Границы набора записей](../../../ado/guide/data/boundaries-of-a-recordset.md)

