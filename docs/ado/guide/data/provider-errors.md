---
title: "Ошибки поставщика | Документы Microsoft"
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: guide
ms.technology: drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- errors collection [ADO]
- provider errors [ADO]
- event-related errors [ADO]
- errors [ADO], provider
- Error object [ADO], provider errors
ms.assetid: cc7d6ff9-2034-45c6-9d61-90b177010054
caps.latest.revision: "5"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 327869785bddfbd0d43bfff051a9b7ef6b97c8fb
ms.sourcegitcommit: 44cd5c651488b5296fb679f6d43f50d068339a27
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2017
---
# <a name="provider-errors"></a>Ошибки поставщика
В случае ошибки поставщика ошибку во время выполнения-2147467259 возвращается. При получении этой ошибки проверьте **ошибки** коллекцию активных **подключения** объекта, который будет содержать одну или несколько ошибок, описывающие, что именно произошло.  
  
## <a name="the-ado-errors-collection"></a>Коллекция ошибок ADO  
 Поскольку конкретной операции ADO может создать несколько ошибок поставщика, ADO предоставляет доступ к коллекции объектов ошибок с помощью **подключения** объекта. Эта коллекция не содержит объектов, если операция завершается успешно и содержит один или несколько **ошибка** объектов, если что-то пошло не так, и поставщик возникает одна или несколько ошибок. Проверьте каждый объект ошибки, чтобы определить точную причину ошибки.  
  
 Сразу после завершения обработки ошибок, которые произошли можно очистить коллекцию путем вызова **снимите** метод. Особенно важно для явной очистки **ошибки** коллекции перед вызовом метода **Resync**, **UpdateBatch**, или **CancelBatch**метод **набора записей** объекта, **откройте** метод на **подключения** объекта или набора **фильтра** свойство **Записей** объекта. Сняв коллекции явным образом, что может быть любой **ошибка** объектов в коллекции не, оставшихся от предыдущих операций.  
  
 Некоторые операции могут выдаваться предупреждения вместе с ошибками. Предупреждения также представлены **ошибка** объекты в **ошибки** коллекции. Когда поставщик добавляет предупреждения в коллекцию, не вызывает ошибку во время выполнения. Проверьте **число** свойство **ошибки** коллекции, чтобы определить, было произведено ли предупреждение по конкретной операции. Если число равно одно или более поздней версии **ошибка** объект был добавлен в коллекцию. Как только выяснилось, что **ошибки** коллекция содержит ошибки или предупреждения, можно выполнять итерации по коллекции и получить сведения о каждом **ошибка** содержащего его объекта. Это показано в следующем примере короткий Visual Basic:  
  
```  
' BeginErrorHandlingVB02  
Private Function DeleteCustomer(ByVal CompanyName As String) As Long  
    On Error GoTo DeleteCustomerError  
  
    rst.Find "CompanyName='" & CompanyName & "'"  
DeleteCustomerError:  
Dim objError As ADODB.Error  
Dim strError As String  
  
    If cnn.Errors.Count > 0 Then  
        For Each objError In cnn.Errors  
            strError = strError & "Error #" & objError.Number & _  
                " " & objError.Description & vbCrLf & _  
                "NativeError: " & objError.NativeError & vbCrLf & _  
                "SQLState: " & objError.SQLState & vbCrLf & _  
                "Reported by: " & objError.Source & vbCrLf & _  
                "Help file: " & objError.HelpFile & vbCrLf & _  
                "Help Context ID: " & objError.HelpContext  
        Next  
        MsgBox strError  
    End If  
End Function  
' EndErrorHandlingVB02  
```  
  
 Включает процедуру обработки ошибок **для каждого** цикл, который анализирует каждый объект в **ошибки** коллекции. В этом примере он накапливает сообщение для отображения. В работе программы, можно написать код для выполнения соответствующих задач для каждой ошибки, например закрытия всех открытия файлов и завершение работы программы в правильном режиме.  
  
## <a name="the-error-object"></a>Объект Error  
 Изучив **ошибка** объектов можно определить причину возникновения ошибки и более важно, какие приложения или какие объекта вызвал ошибку. **Ошибка** объекта имеет следующие свойства:  
  
|Имя свойства|Description|  
|-------------------|-----------------|  
|**Description**|Текстовое описание возникшей ошибки.|  
|**HelpContext HelpFile**|Ссылается на раздел справки и справки файла, содержащего описание возникшей ошибки.|  
|**NativeError**|Номер ошибки поставщика.|  
|**Номер**|Длинное целое число, представляющее номер (перечисленных в **ErrorValueEnum**) возникшей ошибки.|  
|**Source**|Указывает имя объекта или приложения, вызвавшего ошибку.|  
|**SQLState**|Пятисимвольный код ошибки, поставщик возвращает во время выполнения инструкции SQL.|  
  
 ADO **ошибка** объекта очень похож на Visual Basic, standard **Err** объекта. Его свойства описывают возникшей ошибки. В дополнение к числу ошибки можно также получить связанные следующая информация. **NativeError** свойство содержится номер ошибки, относящиеся к поставщику вы используете. В предыдущем примере поставщик указан поставщик Microsoft OLE DB для SQL Server, поэтому **NativeError** будет содержать ошибки, связанные с SQL Server. **SQLState** свойство имеет пять букв код, который описывает ошибку в инструкции SQL.  
  
## <a name="event-related-errors"></a>Ошибки, связанные с событиями  
 **Ошибка** объект также используется при возникновении ошибок, связанных с событием. Можно определить, произошла ли ошибка в процессе, который вызывает событие ADO, проверив **ошибка** объект, переданный как параметр события.  
  
 Если операция, вызывающая событие успешно, подтвердила *adStatus* обработчика событий будет присвоено *adStatusOK*. С другой стороны, если операции, вызвавшей событие был неудачным *adStatus* параметра равным *adStatusErrorsOccurred*. В этом случае *pError* будет содержать параметр **ошибка** объектом, содержащим описание ошибки.
