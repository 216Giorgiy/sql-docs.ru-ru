---
title: "Дополнительные способы перемещения в наборе записей | Документы Microsoft"
ms.prod: sql-non-specified
ms.technology:
- drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- MoveNext method [ADO]
- MoveLast method [ADO]
- MoveFirst method [ADO]
- Recordset object [ADO], moving
- MovePrevious method [ADO]
ms.assetid: 9f8cf1b2-3def-453f-a0ff-4646c5f15262
caps.latest.revision: 11
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: c3e3f666fd96a1b00d78ba364a8df062fa3f6397
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="more-ways-to-move-in-a-recordset"></a>Дополнительные способы перемещения в наборе записей
Следующие четыре метода используются для перемещения или перемещения, в **записей**: [MoveFirst, MoveLast, MoveNext и MovePrevious](../../../ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Некоторые из этих методов будут недоступны на однонаправленные курсоры).  
  
 **MoveFirst** изменяет положение текущей записи к первой записи в **записей**. **MoveLast** изменяет текущую запись позиции на последнюю запись в **записей**. Для использования **MoveFirst** или **MoveLast**, **записей** объект должен поддерживать закладки или перемещение назад курсора; в противном случае вызов метода приведет к ошибке.  
  
 **MoveNext** перемещает текущую запись поместите одну позицию вперед. Если вы работаете с последней записи, при вызове **MoveNext**, **EOF** будет присвоено **True**. **MovePrevious** Перемещение текущей позиции обратно в одном месте. Если на первой записи, при вызове **MovePrevious**, **BOF** будет присвоено **True**. Имеет смысл проверить **EOF** и **BOF** свойства при использовании этих методов и перемещение курсора обратно в допустимый положения текущей записи, если отказаться концах **записей**, как показано ниже:  
  
```  
. . .  
oRs.MoveNext  
If oRs.EOF Then oRs.MoveLast  
. . .   
```  
  
 Или, в случае использования **MovePrevious** метод:  
  
```  
. . .   
oRs.MovePrevious  
If oRs.BOF Then oRs.MoveFirst  
. . .  
```  
  
 В случаях, где **записей** отфильтровать или упорядочить и изменении текущей записи данных, также может измениться позиция. В таких случаях **MoveNext** метод работает нормально, но имейте в виду, что позиция перетаскивать записи вперед в новую позицию, не старой позиции. Например, изменение данных в текущей записи, таким образом, что запись перемещается в конец отсортированного списка **записей**, означает, что вызов **MoveNext** приводит к параметру текущей записи ADO положение после последней записи в **записей** (**EOF** = **True**).  
  
 Поведение различных методов перемещения **записей** зависит от объекта, в некоторой степени по данным в **записей**. Новые записи, добавленные **записей** , сначала добавляются в определенном порядке, определяется источником данных и может быть неявно зависимые или явно с данными в новой записи. Например, если порядок сортировки или соединения выполняется внутри запроса, который заполняет **записей**, новая запись будет вставлен в правильное место в **записей**. Если упорядочение не указано явным образом при создании **записей**, изменения в реализации источника данных могут привести к порядок возвращаемых строк для случайного изменения. В дополнение, сортировка, фильтрация и функции для изменения **записей** может повлиять на порядок и возможно будут видны какие строки в наборе записей.  
  
 Таким образом **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**, и **переместить** все зависит от других операций выполняется на том же **записей**. ADO будет всегда пытаться Ведение вашей текущей позиции, пока не будет явным образом переместить его, но в некоторых случаях промежуточных изменений трудно понять влияние последующих перемещения. Например, при вызове метода **MoveFirst** позицию первой строке отсортированное **записей** и изменить порядок сортировки в возрастающем порядке по убыванию, вы находитесь в той же строке — но теперь это последняя строка в **записей**. **MoveFirst** перейти на другую строку (новый первой строке).  
  
 Например, если средство чтения находится в определенной строке посередине **записей** и вызывать **удалить** и затем вызвать **MoveNext**, теперь расположены на запись сразу после удаленной записи. Но вызывающий **MovePrevious** запись предшествующей удалены текущей записи, поскольку удалена запись больше не учитывается в активной членство **записей**.  
  
 Особенно сложно определить семантику перемещения согласованных во всех поставщиках для методов, которые перемещаются по отношению к текущей записи — **MovePrevious**, **MoveNext**, и **переместить** — в случае изменения данных в текущей записи. Например, при работе с отсортированное фильтровать **записей**и изменение данных в текущей записи, чтобы он указывается перед другими записями, но измененные данные также больше не соответствует фильтру, не совсем понятно, где **MoveNext** операции займет у вас. Безопасный заключение происходит, относительный перемещения в пределах **записей** — опаснее, чем абсолютное перемещения (например, с помощью **MoveFirst** или **MoveLast**) при данных Изменение во время редактирования записи добавлены или удалены. Сортировка и фильтрация должны основываться на первичный ключ или идентификатор, так как этот тип значения не следует изменять.
