---
title: "Параметры события | Документы Microsoft"
ms.prod: sql-non-specified
ms.technology:
- drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Error parameter [ADO]
- Object parameter [ADO]
- Status parameter [ADO]
- events [ADO], parameters
- Reason parameter [ADO]
- event parameters [ADO]
ms.assetid: bd5c5afa-d301-4899-acda-40f98a6afa4d
caps.latest.revision: 10
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 9ae7ee638c8489795df8894be23ef80e63b26f07
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="event-parameters"></a>Параметры события
Каждый обработчик событий имеет состояние параметр, управляющий обработчик события. Для завершения событий этот параметр используется для указания на успешное или неуспешное выполнение операции, который создал событие. Наиболее полная события также имеют параметр ошибки для предоставления сведений о любой ошибки, возможно, произошло и один или несколько параметров объекта, которые ссылаются на объекты ADO, используемые для выполнения операции. Например [ExecuteComplete](../../../ado/reference/ado-api/executecomplete-event-ado.md) событий включает параметры объекта **команда**, **записей**, и **подключения** объектов связанный с событием. В следующем примере Microsoft Visual Basic®, можно увидеть командной, pRecordset и pConnection объекты, представляющие **команда**, **записей**, и **подключения** объекты, которые используются в **Execute** метод.  
  
```  
Private Sub connEvent_ExecuteComplete(ByVal RecordsAffected As Long, _  
     ByVal pError As ADODB.Error, _  
     adStatus As ADODB.EventStatusEnum, _  
     ByVal pCommand As ADODB.Command, _  
     ByVal pRecordset As ADODB.Recordset, _  
     ByVal pConnection As ADODB.Connection)  
```  
  
 За исключением **ошибка** объекта передаются события будут такими же параметрами. Это позволяет проанализировать каждое объектов, которые будут использоваться в выполняющуюся операцию и определить, следует ли использовать для завершения операции.  
  
 Некоторые обработчики событий имеют *Причина* параметр, который содержит дополнительные сведения о том, почему произошло событие. Например **WillMove** и **MoveComplete** события могут происходить из-за одним из способов навигации (**MoveNext**, **MovePrevious**и так далее) он вызван или в результате повторного запроса.  
  
## <a name="status-parameter"></a>Параметр состояния  
 При вызове процедуры обработчика событий *состояние* параметра присваивается одно из следующих значений.  
  
|Значение|Description|  
|-----------|-----------------|  
|**adStatusOK**|Передаваемый будет и события завершения. Это значение означает, что операции, которая вызвала событие успешно завершена.|  
|**adStatusErrorsOccurred**|Передаваемый события завершения. Это значение означает, что операции, которая вызвала событие неудачна или событие будет отменена операция. Проверьте *ошибка* параметр для получения дополнительных сведений.|  
|**adStatusCantDeny**|Переданный будут только к событиям. Это значение означает, что событие будет не может отменить операцию. Должна быть выполнена.|  
  
 Если вы определили в событие будет, следует продолжить операцию, оставьте *состояние* параметр без изменений. При условии, что не задан параметр status входящих **adStatusCantDeny**, однако можно отменить выполняющуюся операцию, изменив *состояние* для **adStatusCancel**. При этом имеет полные события, связанные с операцией его *состояние* равным **adStatusErrorsOccurred**. **Ошибка** объекта, переданного в событие завершения будет содержать значение **adErrOperationCancelled**.  
  
 Если вы больше не требуется для обработки события, можно установить *состояние* для **adStatusUnwantedEvent** и приложения больше не будет получать уведомление о событии. Однако следует помните, что некоторые события могут вызываться для более чем одной из причин. В этом случае необходимо указать **adStatusUnwantedEvent** для каждого из возможных причин. Например, чтобы прекратить получение уведомлений об ожидающих **RecordChange** событий, необходимо задать *состояние* параметр **adStatusUnwantedEvent** для ** adRsnAddNew**, **adRsnDelete**, **adRsnUpdate**, **adRsnUndoUpdate**, **adRsnUndoAddNew**, **adRsnUndoDelete**, и **adRsnFirstChange** как только они происходят.  
  
|Значение|Description|  
|-----------|-----------------|  
|**adStatusUnwantedEvent**|Запрос на получение дальнейшие уведомления поступать не этот обработчик событий.|  
|**adStatusCancel**|Запросить отмену операции, которые будут возникать.|  
  
## <a name="error-parameter"></a>Ошибка параметра  
 *Ошибка* параметр является ссылкой на ADO [ошибка](../../../ado/reference/ado-api/error-object.md) объекта. При *состояние* параметра равным **adStatusErrorsOccurred**, **ошибки** содержит сведения о том, почему произошел сбой операции. Если операция отменена будет событие, связанное с событием завершения, задав *состояние* параметр **adStatusCancel**, ошибка объекта всегда имеет значение ** adErrOperationCancelled**.  
  
## <a name="object-parameter"></a>Параметр объекта  
 Каждое событие получает один или несколько объектов, представляющих объекты, которые участвуют в операции. Например **ExecuteComplete** событие получает **команда** объекта, **записей** объекта и **подключения** объекта.  
  
## <a name="reason-parameter"></a>Параметр причина  
 *Причина* параметр *adReason*, Дополнительные сведения о том, почему произошло событие. События с *adReason* параметра может вызываться несколько раз, даже для той же операции по другой причине каждый раз. Например **WillChangeRecord** обработчик событий вызывается для операций, которые собираетесь выполнить или отменить вставки, удаления или изменения записи. Чтобы обработать событие, только когда он происходит по определенной причине, можно использовать *adReason* параметра для фильтрации вхождений, которые вас не интересуют. Например если требуется обрабатывать события изменения записи только в том случае, если они возникать, если запись была добавлена, можно использовать следующий вид.  
  
```  
' BeginEventExampleVB01  
Private Sub rsTest_WillChangeRecord(ByVal adReason As ADODB.EventReasonEnum, ByVal cRecords As Long, adStatus As ADODB.EventStatusEnum, ByVal pRecordset As ADODB.Recordset)  
   If adReason = adRsnAddNew Then  
       ' Process event  
       '...  
   Else  
       ' Cancel event notification for all  
       ' other possible adReason values.  
       adStatus = adStatusUnwantedEvent  
   End If  
End Sub  
' EndEventExampleVB01  
```  
  
 В этом случае уведомление может произойти, для каждого из других причин. Тем не менее он будет появляться только один раз для каждой причины. После уведомления возникла один раз для каждой причины, вы получите уведомление только для добавления новой записи.  
  
 В отличие от этого, необходимо задать *adStatus* для **adStatusUnwantedEvent** только один раз для запроса, обработчик событий без **adReason** получающей событие остановки параметр уведомления.  
  
## <a name="see-also"></a>См. также:  
 [Сводка обработчик событий ADO](../../../ado/guide/data/ado-event-handler-summary.md)   
 [Создание экземпляра события ADO по языку](../../../ado/guide/data/ado-event-instantiation-by-language.md)   
 [Как работают обработчики событий](../../../ado/guide/data/how-event-handlers-work-together.md)   
 [Типы событий](../../../ado/guide/data/types-of-events.md)
