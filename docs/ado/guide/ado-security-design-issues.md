---
title: "Проблемы проектирования безопасности ADO | Документы Microsoft"
ms.custom: H1Hack27Feb2017
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.prod: sql-non-specified
ms.technology: "“drivers”"
ms.topic: article
helpviewer_keywords:
- ADO, security
ms.assetid: 86b83a38-efdf-4831-a6d5-7e470d517d1c
caps.latest.revision: 18
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 51c7e3cf9c99bdd76ce1b84a7c387b1e6e4d2f58
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="ado-security-design-features"></a>Средства разработки безопасности ADO
В следующих разделах описаны функции проектирования безопасности в данных ActiveX объектов (ADO) 2.8 и более поздних версий. Эти изменения были внесены в ADO 2.8 для повышения безопасности. ADO 6.0, включенный в Windows DAC 6.0 в Windows Vista, функционально эквивалентен ADO 2.8, включенного в компонентах MDAC 2.8 в Windows XP и Windows Server 2003. Этот раздел содержит сведения о том, как лучше всего безопасности приложений в ADO 2.8 или более поздней версии.

> [!IMPORTANT]
>  При обновлении приложения из более ранней версии ADO, рекомендуется проверить обновленные приложения на компьютере нерабочей перед развертыванием клиентов. Таким образом можно обеспечить вам известно о проблем с совместимостью перед развертыванием обновленные приложения.

## <a name="internet-explorer-file-access-scenarios"></a>Сценариев доступа к файлам Internet Explorer
 К следующим последствиям функции, как работает ADO 2.8 и более поздних версиях при использовании в сценарий веб-страниц в Internet Explorer.

### <a name="revised-and-improved-security-warning-message-box-now-used-to-alert-users"></a>Теперь используется для информирования пользователей окно предупреждение измененный безопасности
 Для ADO 2.7 или более ранних версий сообщение об ошибке появляется при попытке выполнения кода ADO от поставщика ненадежных сценария веб-страницы:

```
This page accesses data on another domain. Do you want to allow this? To
avoid this message in Internet Explorer, you can add a secure Web site to
your Trusted Sites zone on the Security tab of the Internet Options dialog
box.
```

 Для ADO 2.8 и более поздних версий приведенное выше сообщение больше не отображается. Вместо этого в данном контексте появится следующее сообщение:

```
This Website uses a data provider that may be unsafe. If you trust the
Website, click OK, otherwise click Cancel.
```

 Приведенное выше сообщение пользователь может принять обоснованное решение, при этом знать последствия для обоих вариантов:

-   Если пользователь доверяет сайт, нажав кнопку ОК позволит весь код safe диска (все ADO методы и свойства, за исключением доступный диск API, описанные далее в этом разделе) для запуска и выполнения в окне браузера.

-   Если пользователь не доверяет сайт, нажав кнопку "Отмена" блоков кода ADO для доступа к данным из запуске и выполнении в полном объеме.

### <a name="disk-accessible-code-limited-now-to-trusted-sites"></a>Диск доступен кода, ограниченный теперь в список надежных сайтов
 В ADO 2.8, в частности ограничивают ограниченный набор API, которые может предоставить возможность чтения или записи к файлам на локальном компьютере были внесены дополнительные изменения. Ниже приведены методы API, которые были дополнительные ограничения безопасности при запуске Internet Explorer:

-   Для ADO **поток** объекта, если [LoadFromFile](../../ado/reference/ado-api/loadfromfile-method-ado.md) или [SaveToFile](../../ado/reference/ado-api/savetofile-method.md) используются методы.

-   Для ADO **записей** объекта, если параметр [Сохранить](../../ado/reference/ado-api/save-method.md) метод или [откройте](../../ado/reference/ado-api/open-method-ado-recordset.md) метода, например, когда либо **adCmdFile** задан параметр или [поставщик Microsoft OLE DB сохраняемости (MSPersist)](../../ado/guide/appendixes/microsoft-ole-db-persistence-provider-ado-service-provider.md) используется.

 Для этих ограниченные наборы функций потенциально может быть доступен для диска происходит следующее для ADO 2.8 и более поздней версии, если код, использующий эти методы, выполняются в Internet Explorer.

-   Если сайт, предоставленный код ранее была добавлена в список надежных сайтов зоны, код выполняется в браузере и предоставлен доступ к локальным файлам.

-   Если сайт не отображается в списке зоны надежных узлов, код будет заблокирован, и запрещен доступ к локальным файлам.

    > [!NOTE]
    >  В ADO 2.8 и более поздней версии пользователь не оповещения и не рекомендуется добавить узлы в список надежных сайтов зоны. Поэтому управление список надежных сайтов отвечает тех, кто для развертывания или поддержки приложений на основе веб-сайта, которым требуется доступ к локальной файловой системе.

### <a name="access-blocked-to-the-activecommand-property-on-recordset-objects"></a>Доступ к свойству ActiveCommand на объекты записей заблокирован
 При работе в Internet Explorer, ADO 2.8 блокирует доступ к [ActiveCommand](../../ado/reference/ado-api/activecommand-property-ado.md) свойств для активного **записей** объекта и возвращает ошибку. Эта ошибка возникает независимо от того, является ли источником страницы с веб-сайта, зарегистрированных в список надежных сайтов.

### <a name="changes-in-handling-for-ole-db-providers-and-integrated-security"></a>Изменения в обработке для поставщиков OLE DB и встроенной безопасности
 Во время проверки ADO 2.7 и более ранних версий для потенциальных проблем безопасности и проблем, был обнаружен следующий сценарий:

 В некоторых случаях поставщики OLE DB, которые поддерживает встроенную безопасность [DBPROP_AUTH_INTEGRATED](https://msdn.microsoft.com/library/windows/desktop/ms712973.aspx) свойство потенциально может разрешить сценарию веб-страниц для повторного использования случайного подключения к другим серверам объект соединений ADO с помощью текущие учетные данные входа пользователей. Чтобы избежать этого, ADO 2.8 и более поздних версий обрабатывать поставщики OLE DB, в зависимости от того, как была выбрана для предоставления или не указано, для использования встроенной безопасности.

 Для веб-страниц, которые загружаются из узлов, перечисленных в списке зоны надежных узлов в следующей таблице приведены декомпозиция как ADO 2.8 и более поздних версий управляет соединений ADO в каждом случае.

|Параметры IE для проверки подлинности пользователя, вход в систему|Поставщик поддерживает «Integrated Security» и UID и PWD указано (SQLOLEDB)|Поставщик не поддерживает «Integrated Security» (JOLT MSDASQL, MSPersist)|Поставщик поддерживает «Integrated Security» и ему присваивается SSPI (указано не UID и PWD)|
|------------------------------------------------|----------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
|Автоматический вход с текущим именем пользователя и паролем|Разрешить подключение|Разрешить подключение|Разрешить подключение|
|Запрашивает имя пользователя и пароль|Разрешить подключение|Сбой подключения|Сбой подключения|
|Автоматический вход только в зону интрасети|Разрешить подключение|Запрашивать у пользователей с предупреждением системы безопасности|Запрашивать у пользователей с предупреждением системы безопасности|
|Анонимный вход|Разрешить подключение|Сбой подключения|Сбой подключения|

 В случае, когда появляется предупреждение системы безопасности теперь в окне сообщения информирует пользователей:

```
This Website is using your identity to access a data source. If you trust this Website, click OK, otherwise click Cancel.
```

 Приведенное выше сообщение позволяет пользователю принять более обоснованное решение и действуйте соответствующим образом.

> [!NOTE]
>  Для ненадежных веб-сайтов (то есть узлы, не перечисленные в список надежных сайтов зоны) Если поставщик также является доверенным (как описано ранее в этом разделе), что пользователь может видеть два предупреждения системы безопасности в строку, предупреждение о поставщике unsafe и второе предупреждение Попытка использовать свою подлинность. Если пользователь нажимает кнопку ОК, чтобы первое предупреждение, выполняются параметры Internet Explorer и код ответа поведения, описанные в предыдущей таблице.

## <a name="controlling-whether-password-text-is-returned-in-ado-connection-strings"></a>Управление возвращается ли текст пароля в строке соединения ADO
 При попытке получить значение [ConnectionString](../../ado/reference/ado-api/connectionstring-property-ado.md) свойство ADO **подключения** объекта, происходят следующие события:

1.  Если соединение открыто, инициализации затем вызов поставщика OLE DB для получения строки подключения.

2.  В зависимости от настройки в поставщике OLE DB из [DBPROP_AUTH_PERSIST_SENSITIVE_AUTHINFO](https://msdn.microsoft.com/library/windows/desktop/ms714905.aspx) свойства, пароли включены вместе с другими строку подключения, который возвращается.

 Например если динамические свойства соединения ADO **Persist Security Info** задано значение **True**, пароль включен в строку подключения, возвращаемую. В противном случае, если базовый поставщик значение свойства **False** (например, с поставщиком SQLOLEDB), сведения о пароле опущен в возвращаемой строки подключения.

 При использовании сторонних разработчиков (то есть сторонних производителей) поставщики OLE DB с кодом приложения ADO, можно проверить как **DBPROP_AUTH_PERSIST_SENSITIVE_AUTHINFO** свойство реализовано для определения ли включение сведения о пароле со строками подключения ADO разрешен.

## <a name="checking-for-non-file-devices-when-loading-and-saving-recordsets-or-streams"></a>Проверка для устройств, не являющимся файлами при загрузке и сохранении потоки или наборы записей
 Для ADO 2.7 или более ранних версий, ввод вывод файлов операций например [откройте](../../ado/reference/ado-api/open-method-ado-recordset.md) и [Сохранить](../../ado/reference/ado-api/save-method.md) , были использованы для чтения и записи данных на основе файла в некоторых случаях возможным URL-адрес или имя файла для использования, отличных от дисковых указан на основе типа файла. Например LPT1, COM2, PRN. TXT, AUX может использоваться в качестве псевдонима для ввода вывода между принтеры и дополнительных устройств в системе с использованием определенных

 Для ADO 2.8 и более поздней версии эта функциональность была обновлена. Для открытия и сохранения **записей** и **поток** объекты ADO теперь выполняет проверку типов файлов, для обеспечения фактический входного или выходного устройства, заданного в URL-адрес или имя файла.

> [!NOTE]
>  Проверка типа файла как описано в этом разделе применяется только для Windows 2000 и более поздних версий. Он не применяется в ситуациях, где запущен ADO 2.8 или более поздней версии в более ранних версиях Windows, таких как Windows 98.

