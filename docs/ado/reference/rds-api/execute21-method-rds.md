---
title: Метод Execute21 (RDS) | Документы Microsoft
ms.prod: sql
ms.prod_service: connectivity
ms.component: ado
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.suite: sql
ms.tgt_pltfrm: ''
ms.topic: conceptual
apitype: COM
helpviewer_keywords:
- Execute21 method [RDS]
ms.assetid: 9f131c8d-1497-416d-8209-abb481c38f7b
caps.latest.revision: 17
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 1136e547d464f511aff92f4a6805da0262c7ed35
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="execute21-method-rds"></a>Метод Execute21 (RDS)
Выполняет запрос и создает набор записей ADO для использования в ADO 2.1.  
  
> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, серверные компоненты служб удаленных рабочих СТОЛОВ больше не включаются в операционной системе Windows (в разделе Windows 8 и [руководство по Windows Server 2012 совместимости](https://www.microsoft.com/en-us/download/details.aspx?id=27416) для получения дополнительных сведений). Клиентские компоненты служб удаленных рабочих СТОЛОВ будут удалены в будущих версиях Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие служб удаленных рабочих СТОЛОВ необходимо перенести в [службы данных WCF](http://go.microsoft.com/fwlink/?LinkId=199565).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
object.Execute21(ConnectionString As String, HandlerString As String, QueryString As String, lMarshalOptions As Long, Properties, TableId, lExecuteOptions As Long, pParameters)  
```  
  
#### <a name="parameters"></a>Параметры  
 *connectionString*  
 Строка, используемая для подключения к поставщику OLE DB, где запрос будет отправлен для выполнения. Если обработчик указана с помощью *HandlerString*, его можно изменить или заменить строку подключения.  
  
 *HandlerString*  
 Строка определяет обработчик для использования с этого выполнения. Строка состоит из двух частей. Первая часть содержит имя обработчика для использования (ProgID). Во второй части строки содержит аргументы, передаваемые обработчику. Способ интерпретации строки аргументов — конкретных обработчик. Эти две части разделяются запятой в строке первого экземпляра (несмотря на то, что аргументы строка может содержать дополнительные запятые). Аргументы являются необязательными.  
  
 *Строка запроса*  
 Команда в язык команд, поддерживаемых поставщиком OLE DB, указанные в строке подключения. Для поставщиков, основанных на SQL, он может содержать [!INCLUDE[tsql](../../../includes/tsql_md.md)] команды инструкции, но для поставщиков, отличных от SQL (например, MSDataShape) это может быть [!INCLUDE[tsql](../../../includes/tsql_md.md)] инструкция запроса.  
  
 Кроме того Если используется обработчик (настоятельно рекомендуется использовать обработчик), обработчик можно изменить или заменить указанное здесь значение. Например, обработчик обычно заменяет *QueryString* со строкой запроса из его INI-файла. По умолчанию используется файл Msdfmap.ini.  
  
 *lMarshalOptions*  
 Используется для установки параметров, возвращаемых строк или записей в маршалинга.  
  
 *TableID*  
 Вариант типа VT_BSTR, либо значение VT_EMPTY. Если это значение имеет тип VT_EMPTY, он игнорируется. Если это типа VT_BSTR записей создается с помощью **adCmdTableDirect** с помощью значения указанных здесь и *QueryString* параметр учитывается.  
  
 *lExecuteOptions*  
 Битовая маска параметров выполнения:  
  
 1 =*ReadOnly* набор записей будет открыт с помощью **adLockReadOnly**.  
  
 2 =*NoBatch* набор записей будет открыт с помощью **adLockOptimistic**.  
  
 4 =*AllParamInfoSupplied* вызывающий объект гарантирует, что предоставлены сведения о параметрах для всех параметров в *pParameters*.  
  
 8 =*GetInfo* сведения о параметрах запроса будет получен от поставщика OLE DB и возвращено в *pParameters* параметра. Запрос не выполняется и возвращается без набора записей.  
  
 16 = набора записей будет открыт с помощью GetHiddenColumns **adLockBatchOptimistic** и скрытые столбцы, которые будут включены в набор записей.  
  
 Несмотря на то что *ReadOnly*, *NoBatch* и *GetHiddenColumns* являются взаимоисключающими, это не ошибку, чтобы задать более одного из них. Если заданы несколько параметров, *GetHiddenColumns* имеет приоритет над все прочие параметры, за которым следует *ReadOnly*. Если параметры не указаны, по умолчанию набор записей открыт с помощью **adLockBatchOptimistic** скрытые столбцы, не включенные в набор записей.  
  
 *pParameters*  
 Значение типа variant, содержащий безопасный массив определений параметров. Если *GetInfo* параметр был указан в *lExecuteOptions*, этот параметр используется для возврата определения параметров, полученные от поставщика OLE DB. В противном случае этот параметр может быть пустым.  
  
## <a name="remarks"></a>Замечания  
 *HandlerString* параметр может иметь значение null. Что происходит в этом случае зависит от того, как настроен сервер служб удаленных рабочих СТОЛОВ. Обработчик строку «MSDFMAP.handler» указывает, что обработчик предоставленный корпорацией Майкрософт (Msdfmap.dll) следует использовать. Обработчик строку «MASDFMAP.handler,sample.ini» указывает, должны использоваться обработчик Msdfmap.dll и, аргумент «sample.ini» должен передаваться обработчику. Аргумент MSDFMAP.dll интерпретирует как направление использования sample.ini для проверки строк соединения и запроса.  
  
> [!NOTE]
>  **Execute21** метод — это версия [выполнить метод (RDS)](../../../ado/reference/rds-api/execute-method-rds.md). Когда нужно использовать **Execute** для обмена данными с помощью ADO 2.1, метод **Execute21** можно вместо этого вызывает метод. Возможности **Execute** метод в ADO 2.5 и более поздние версии являются подмножеством возможностей, предоставляемых для того же метода ADO 2.1.  
  
## <a name="applies-to"></a>Объект применения  
 [Объект DataFactory (RDSServer)](../../../ado/reference/rds-api/datafactory-object-rdsserver.md)


