---
title: "Объект набора записей (ADO) | Документы Microsoft"
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: ado
ms.technology: drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
apitype: COM
f1_keywords: Recordset
helpviewer_keywords: Recordset object [ADO]
ms.assetid: ede1415f-c3df-4cc5-a05b-2576b2b84b60
caps.latest.revision: "6"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Active
ms.openlocfilehash: dd263b08584b0ba13f6486e72bcf6c9f083ca896
ms.sourcegitcommit: b09bccd6dfdba55b022355e892c29cb50aadd795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2018
---
# <a name="recordset-object-ado"></a>Объект набора записей (ADO)
Представляет весь набор записей из базовой таблицы или результаты выполнения команды. В любой момент **записей** объект ссылается только на одну запись в набор, что текущая запись.  
  
## <a name="remarks"></a>Remarks  
 Вы используете **записей** объектов для работы с данными от поставщика. При использовании ADO можно манипулировать данными практически полностью с использованием **записей** объектов. Все **записей** объекты состоят из записей (строк) и полей (столбцов). В зависимости от функциональных возможностей, поддерживаемых поставщиком некоторые **записей** методов или свойств могут оказаться недоступными.  
  
 ADODB. Набор записей — это идентификатор ProgID, который должен использоваться для создания **записей** объекта. Существующие приложения, которые ссылаются на устаревшие ADOR. Идентификатор ProgID записей будут продолжать работать без повторной компиляции, но разработки новых приложений следует ссылаться ADODB. Набор записей.  
  
 Существует четыре курсор другого типа, определенные в ADO:  
  
-   **Динамический курсор** дает возможность просмотра, добавления, изменения и удаления другими пользователями; разрешает все типы перемещения через **записей** , не зависит от закладки; и позволяет закладки, если поставщик поддерживает их.  
  
-   **Курсор набора ключей** добавьте Behaves как динамический курсор, за исключением того, что он не позволяет просматривать записи другие пользователи и предотвращает доступ к записям, которые другие пользователи удаляют. Данные изменения другими пользователями по-прежнему будут отображаться. Здесь всегда поддерживает закладки и поэтому все типы перемещения по **записей**.  
  
-   **Статический курсор** предоставляет статическую копию набора записей можно использовать для поиска данных или создавать отчеты; всегда позволяет закладки, а поэтому все типы перемещения через **записей**. Дополнения, изменения или удаления других пользователей будет недоступен. Это единственный тип курсора, допускается при открытии на стороне клиента **записей** объекта.  
  
-   **Однонаправленный курсор** позволяет только просмотреть **записей**. Дополнения, изменения или удаления других пользователей будет недоступен. Это улучшает производительность в ситуациях, когда необходимо сделать только один проход по **записей**.  
  
 Задать [CursorType](../../../ado/reference/ado-api/cursortype-property-ado.md) перед открывающей **записей** выберите тип курсора или передать *CursorType* аргумент с [откройте](../../../ado/reference/ado-api/open-method-ado-recordset.md)метод. Некоторые поставщики не поддерживают все типы курсоров. Обратитесь к документации по поставщику. Если не указать тип курсора, ADO открывается однонаправленный курсор по умолчанию.  
  
 Если [CursorLocation](../../../ado/reference/ado-api/cursorlocation-property-ado.md) свойству **adUseClient** Открытие **записей**, **UnderlyingValue** свойства [Поле](../../../ado/reference/ado-api/field-object.md) объектов недоступна в возвращаемом **записей** объекта. При использовании с некоторые поставщики (например Microsoft ODBC для OLE DB в сочетании с Microsoft SQL Server), можно создать **записей** объектов независимо от ранее определенные [подключения](../../../ado/reference/ado-api/connection-object-ado.md)путем передачи строки подключения с **откройте** метод. По-прежнему создает ADO [подключения](../../../ado/reference/ado-api/connection-object-ado.md) , но не присвоить переменной объекта этого объекта. Тем не менее при открытии нескольких **записей** объектов через это подключение, необходимо явно создать и открыть **подключения** объекта; этот присваивает **подключения**объект переменной объекта. Если вы не используйте эту переменную объекта при открытии вашей **записей** объекты ADO создает новый **подключения** объекта для каждого нового **записей**, даже если передайте тот же Строка подключения.  
  
 Можно создать столько **записей** объектов при необходимости.  
  
 При открытии **записей**, текущая запись располагается на первую запись (если таковые имеются) и [BOF](../../../ado/reference/ado-api/bof-eof-properties-ado.md) и [EOF](../../../ado/reference/ado-api/bof-eof-properties-ado.md) задано значение **False**. Если нет записей **BOF** и **EOF** заданы свойства **True**.  
  
 Можно использовать [MoveFirst](../../../ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, и **MovePrevious** методов; [переместить](../../../ado/reference/ado-api/move-method-ado.md) метод; и [AbsolutePosition](../../../ado/reference/ado-api/absoluteposition-property-ado.md), [AbsolutePage](../../../ado/reference/ado-api/absolutepage-property-ado.md), и [фильтра](../../../ado/reference/ado-api/filter-property.md) свойства для изменения положения текущей записи, при условии, что поставщик поддерживает соответствующие функциональные возможности. Прямой **записей** объекты поддерживают только [MoveNext](../../../ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado.md) метод. При использовании **переместить** методы посетить каждой записи (или перечисления **записей**), можно использовать **BOF** и **EOF** свойства определить, если сдвинуты за начало или конец **записей**.  
  
 Перед использованием возможности **записей** объекта, необходимо вызвать **поддерживает** метода для объекта, чтобы убедитесь, что функциональные возможности поддерживаются или недоступны. Не следует использовать функциональные возможности при **поддерживает** метод возвращает значение false. Например, можно использовать **MovePrevious** только тогда, когда метод `Recordset.Supports(adMovePrevious)` возвращает **True**. В противном случае вы получите ошибку, так как **записей** объект был закрыт и функциональные возможности недоступным на экземпляре. Если вы заинтересованы в компонент не поддерживается, **поддерживает** будет возвращать значение false также. В этом случае следует избегать вызова соответствующего свойства или метода в **записей** объекта.  
  
 **Набор записей** объекты могут поддерживать обновление двух типов: немедленное и пакетном режиме. В немедленное обновление всех изменений данных записываются непосредственно в источнике данных при вызове метода [обновление](../../../ado/reference/ado-api/update-method.md) метод. Можно также передать массивы значений в качестве параметров с [AddNew](../../../ado/reference/ado-api/addnew-method-ado.md) и **обновление** методы и одновременно обновить несколько полей в записи.  
  
 Если поставщик поддерживает обновление пакета, что поставщик кэшировать изменения более чем одной записи и передачи их в один вызов в базу данных с [UpdateBatch](../../../ado/reference/ado-api/updatebatch-method.md) метод. Это относится к изменениям с **AddNew**, **обновление**, и [удалить](../../../ado/reference/ado-api/delete-method-ado-recordset.md) методы. После вызова метода **UpdateBatch** метод, можно использовать [состояние](../../../ado/reference/ado-api/status-property-ado-recordset.md) свойство для проверки конфликты данных для их устранения.  
  
> [!NOTE]
>  Чтобы выполнить запрос без использования [команда](../../../ado/reference/ado-api/command-object-ado.md) , передать строку запроса для **откройте** метод **набора записей** объекта. Тем не менее **команда** объекта является обязательным, если вы хотите сохранить текст команды и повторно выполните ее или использовать параметры запроса.  
  
 [Режим](../../../ado/reference/ado-api/mode-property-ado.md) регулирует разрешения на доступ.  
  
 **Поля** коллекции является членом по умолчанию **записей** объекта. В результате код следующие две инструкции эквивалентны.  
  
```  
Debug.Print objRs.Fields.Item(0)  ' Both statements print   
Debug.Print objRs(0)              '  the Value of Item(0).  
```  
  
 При **записей** объект передается в процессах, только **набора строк** преобразования значений и свойств **записей** объекта игнорируются. Во время unmarshalling, **строк** распаковано в только что созданный объект **записей** объекта, который также задает его свойства в значения по умолчанию.  
  
 **Записей** объекта безопасные для использования.  
  
 Этот раздел содержит следующий раздел.  
  
-   [Свойства объекта набора записей, методы и события](../../../ado/reference/ado-api/recordset-object-properties-methods-and-events.md)  
  
## <a name="see-also"></a>См. также  
 [Объект соединения (ADO)](../../../ado/reference/ado-api/connection-object-ado.md)   
 [Коллекция Fields (ADO)](../../../ado/reference/ado-api/fields-collection-ado.md)   
 [Коллекция свойств (ADO)](../../../ado/reference/ado-api/properties-collection-ado.md)   
 [Приложение А. Поставщики](../../../ado/guide/appendixes/appendix-a-providers.md)
