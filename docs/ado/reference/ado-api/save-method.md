---
title: "Метод Save | Документы Microsoft"
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: ado
ms.technology:
- drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
apitype: COM
f1_keywords:
- _Recordset::Save
- _Recordset::raw_Save
helpviewer_keywords:
- Save method [ADO]
ms.assetid: ed3d9678-5c28-4e61-8bb3-7dfb66d99cf5
caps.latest.revision: 
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: 3ca1aa95841be1331ad1b214b2a8b377622883d3
ms.sourcegitcommit: acab4bcab1385d645fafe2925130f102e114f122
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/09/2018
---
# <a name="save-method"></a>Save-метод
Сохраняет [записей](../../../ado/reference/ado-api/recordset-object-ado.md) в файле или [поток](../../../ado/reference/ado-api/stream-object-ado.md) объекта.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
recordset.Save Destination, PersistFormat  
```  
  
#### <a name="parameters"></a>Параметры  
 *Назначение*  
 Необязательно. A **Variant** , представляющее полный путь имя файла, где **набора записей** должен быть сохранен, или ссылка на **поток** объекта.  
  
 *PersistFormat*  
 Необязательно. Объект [PersistFormatEnum](../../../ado/reference/ado-api/persistformatenum.md) значение, указывающее формат, в котором **записей** должен быть сохранен (XML или ADTG). Значение по умолчанию — **adPersistADTG**.  
  
## <a name="remarks"></a>Remarks  
 [Метод Save](../../../ado/reference/ado-api/save-method.md) метод можно вызывать только для открытого **записей**. Используйте [метода Open (набора записей ADO)](../../../ado/reference/ado-api/open-method-ado-recordset.md) способ восстановления более поздней версии **записей** из *назначения*.  
  
 Если [свойство фильтра](../../../ado/reference/ado-api/filter-property.md) свойство действует для **записей**, то сохраняются только те строки, которые доступны в фильтре. Если **набора записей** имеет иерархическую структуру, затем текущий дочерний элемент **набора записей** и его дочерние элементы сохраняются, включая родительскую **набора записей**. Если метод Save дочернего **записей** является именем, дочерним элементом, а также все его дочерние элементы сохраняются, но не является родительским.  
  
 При первом сохранении **записей**, это необязательно для указания *назначения*. Если не указан *назначения*, будет создан новый файл с именем, равным значению свойства Source **записей**.  
  
 Пропустить *назначения* при последующем вызове **Сохранить** после первого сохранения или ошибку во время выполнения возникнет. Если впоследствии вызвать **Сохранить** с новым *назначения*, **набора записей** сохраняется в новое место назначения. Тем не менее, новое назначение и исходное расположение будет быть открытым.  
  
 **Сохранить** не закрывает **записей** или *назначения*, поэтому можно продолжать работать с **записей** и сохраните изменения. *Назначение* остается открытым до **записей** закрыт.  
  
 По причинам безопасности **Сохранить** метод допускает использование только настройки безопасности низким и пользовательский сценарий, выполняемый обозревателем Microsoft Internet Explorer.  
  
 Если **Сохранить** при асинхронном вызове метода **записей** выборки, выполнения или обновления уже выполняется операция, затем **Сохранить** ожидает, пока асинхронная операция завершена.  
  
 Записи сохраняются, начиная с первой строки **записей**. Когда **Сохранить** метод завершения, текущее положение строки перемещается в первой строке **записей**.  
  
 Для получения наилучших результатов установите [CursorLocation свойство (ADO)](../../../ado/reference/ado-api/cursorlocation-property-ado.md) свойства **adUseClient** с **Сохранить**. Если поставщик не поддерживает все функциональные возможности, необходимые для сохранения **записей** объектов, функция будет доступна службе курсора.  
  
 При **записей** сохраняется вместе с **CursorLocation** свойство **adUseServer**, возможность обновления для **записей**ограничено. Как правило только для одной таблицы обновления, вставки и удаления разрешены (зависит от функциональные возможности поставщика). [Resync метод](../../../ado/reference/ado-api/resync-method.md) также метод недоступен в этой конфигурации.  
  
> [!NOTE]
>  Сохранение **записей** с **поля** типа **adVariant**, **adIDispatch**, или **adIUnknown** — не поддерживается в ADO и может привести к непредсказуемым результатам.  
  
 Только фильтры в виде строк критериям (например OrderDate > "12/31/1999") влияет на содержимое материализованный **записей**. Фильтры, созданные с помощью массива **закладки** или с помощью значения из [FilterGroupEnum](../../../ado/reference/ado-api/filtergroupenum.md) не повлияет на содержимое из сохраненного **записей**. Эти правила применяются к **записей**s, созданных с помощью клиентских или серверных курсоров.  
  
 Поскольку *назначения* параметр может принимать любой объект, который поддерживает интерфейс OLE DB IStream, можно сохранить **записей** непосредственно в объекте отклика ASP. Дополнительные сведения см. в разделе **сценарий сохраняемости XML записей**.  
  
 Можно также сохранить **записей** в формате XML в экземпляр объекта DOM в MSXML, как показано в следующем коде Visual Basic:  
  
```  
Dim xDOM As New MSXML.DOMDocument  
Dim rsXML As New ADODB.Recordset  
Dim sSQL As String, sConn As String  
  
sSQL = "SELECT customerid, companyname, contactname FROM customers"  
sConn="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=Northwind.mdb"  
rsXML.Open sSQL, sConn  
rsXML.Save xDOM, adPersistXML   'Save Recordset directly into a DOM tree.  
...  
```  
  
> [!NOTE]
>  Два ограничения применяются при сохранении иерархические наборы записей (данные фигуры) в формате XML. Не удается сохранить в XML, если иерархическое **набора записей** содержит отложенные обновления, и не удается сохранить параметризованную иерархические **набора записей**.  
  
 Объект **записей** сохранить в XML-формате сохраняется с использованием формата UTF-8. Когда такой файл загружается в поток ADO, объект потока не будет пытаться открыть **записей** из потока, если не Charset потока является свойство соответствующее значение для формата UTF-8.  
  
## <a name="applies-to"></a>Объект применения  
  
|||  
|-|-|  
|[Объект Recordset (ADO)](../../../ado/reference/ado-api/recordset-object-ado.md)|[Объект Stream (ADO)](../../../ado/reference/ado-api/stream-object-ado.md)|  
  
## <a name="see-also"></a>См. также  
 [Сохранение и открытие примере методы (Visual Basic)](../../../ado/reference/ado-api/save-and-open-methods-example-vb.md)   
 [Сохранение и открытие примере методы (VC ++)](../../../ado/reference/ado-api/save-and-open-methods-example-vc.md)   
 [Метод Open (набора записей ADO)](../../../ado/reference/ado-api/open-method-ado-recordset.md)   
 [Метод Open (поток ADO)](../../../ado/reference/ado-api/open-method-ado-stream.md)   
 [Метод SaveToFile](../../../ado/reference/ado-api/savetofile-method.md)
