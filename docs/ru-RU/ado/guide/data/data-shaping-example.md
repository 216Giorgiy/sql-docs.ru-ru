---
title: Пример формирования данных | Документы Microsoft
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: ado
ms.technology:
- drivers
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.suite: sql
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- data shaping [ADO], about data shaping
ms.assetid: 1bfdcad4-52e1-45bc-ad21-783657ef0a44
caps.latest.revision: 13
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 991ea5c55a99aa8dbe043dd99b9703acd73172e9
ms.sourcegitcommit: 2ddc0bfb3ce2f2b160e3638f1c2c237a898263f4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="data-shaping-example"></a>Пример формирования данных
Следующие формирования команды данных демонстрируется построение иерархической **записей** из **клиентов** и **заказов** таблиц в базе данных "Борей".  
  
```  
SHAPE {SELECT CustomerID, ContactName FROM Customers}   
APPEND ({SELECT OrderID, OrderDate, CustomerID FROM Orders} AS chapOrders   
RELATE customerID TO customerID)   
```  
  
 При использовании этой команды для открытия **записей** объекта (как показано в [пример Visual Basic из формирование](../../../ado/guide/data/visual-basic-example-of-data-shaping.md)), он создает раздел (**chapOrders**) для каждой записи из **клиентов** таблицы. В этой главе состоит из подмножества **записей** , возвращенные **заказов** таблицы. **ChapOrders** глава содержит все запрашиваемые данные о заказах, размещенных конкретного клиента. В этом примере главе состоит из трех столбцов: **OrderID**, **OrderDate**, и **CustomerID**.  
  
 Первые два числа форму результирующего **записей** таковы:  
  
|CustomerID|ContactName|OrderID|OrderDate|CustomerID|  
|----------------|-----------------|-------------|---------------|----------------|  
|«ALFKI»|Мария Ander|10643<br /><br /> 10692<br /><br /> 10702<br /><br /> 10835<br /><br /> 10952<br /><br /> 11011|1997-08-25<br /><br /> 1997-10-03<br /><br /> 1997-10-13<br /><br /> 1998-01-15<br /><br /> 1998-03-16<br /><br /> 1998-04-09|«ALFKI»<br /><br /> «ALFKI»<br /><br /> «ALFKI»<br /><br /> «ALFKI»<br /><br /> «ALFKI»<br /><br /> «ALFKI»|  
|ANATR|Ana Trujillo|10308<br /><br /> 10625<br /><br /> 10759<br /><br /> 10926|1996-09-18<br /><br /> 1997-08-08<br /><br /> 1997-11-28<br /><br /> 1998-03-04|ANATR<br /><br /> ANATR<br /><br /> ANATR<br /><br /> ANATR|  
  
 В команде ФИГУРЫ APPEND используется для создания дочернего **записей** связанных с родительским **записей** (как команда поставщика возвращать сразу после ключевого слова ФИГУРЫ, рассмотренном более ранние) в предложении RELATE. Родительские и дочерние обычно имеют по крайней мере один столбец общие: значение столбца в строке родительского элемента совпадает со значением значение столбца во всех строках дочернего элемента.  
  
 Имеется второй способ использования команд формы: а именно, для создания родительской **записей** из дочернего **записей**. Записи в дочерней **записей** группируются, обычно с помощью предложение BY и одна строка добавляется к родительскому **записей** для каждой группы, полученный в дочерней. Если предложение BY опущено, дочерний **записей** будет формы в одну группу и родительским **записей** будет содержать только одну строку. Это полезно для статистической обработки «общий итог» на все дочерние **записей**.  
  
 Конструкция команда ФИГУРЫ также позволяет программно создавать формы **записей**. Затем получить доступ к компонентам **записей** программно или с помощью соответствующего визуального элемента управления. Команда фигуры выдается как любой другой текст команды ADO. Дополнительные сведения см. в разделе [фигуры в целом команды](../../../ado/guide/data/shape-commands-in-general.md).  
  
 Независимо от способа родительского **записей** — формата, он будет содержать столбец, используемый для связи его дочерним **записей**. Если требуется, родительский **записей** столбцов, содержащих статистические функции (SUM, MIN, MAX и т. д.) также может иметь дочерних строк. Родительский и дочерний **набора записей** можно составить столбцы, содержащие выражение от строки в **набора записей**, а также столбцы, новые и изначально пустой.  
  
 В этом разделе продолжается со следующим разделом.  
  
-   [Пример формирования данных (Visual Basic)](../../../ado/guide/data/visual-basic-example-of-data-shaping.md)
