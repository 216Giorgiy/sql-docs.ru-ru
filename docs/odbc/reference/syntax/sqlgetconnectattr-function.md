---
title: "Функция SQLGetConnectAttr | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: reference
ms.reviewer: 
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
apiname:
- SQLGetConnectOption
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLGetConnectAttr
helpviewer_keywords:
- SQLGetConnectAttr function [ODBC]
ms.assetid: 2cb4ffa8-19d3-4664-8c2f-6682cdcc3f33
caps.latest.revision: 32
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: fc8f754301b5b0c0d5259cd7613bacdf302a06e7
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="sqlgetconnectattr-function"></a>Функция SQLGetConnectAttr
**Соответствия**  
 Появился в версии: ODBC 3.0 нормативных требований: ISO-92  
  
 **Сводка**  
 **SQLGetConnectAttr** возвращает текущее значение атрибута соединения.  
  
> [!NOTE]  
>  Дополнительные сведения о том, что диспетчер драйверов преобразует эту функцию для при ODBC 3*.x* при работе с ODBC 2*.x* драйвера, в разделе [сопоставление замены функции для назад Совместимость приложений](../../../odbc/reference/develop-app/mapping-replacement-functions-for-backward-compatibility-of-applications.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
SQLRETURN SQLGetConnectAttr(  
     SQLHDBC        ConnectionHandle,  
     SQLINTEGER     Attribute,  
     SQLPOINTER     ValuePtr,  
     SQLINTEGER     BufferLength,  
     SQLINTEGER *   StringLengthPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *ConnectionHandle*  
 [Вход] Дескриптор соединения.  
  
 *Attribute*  
 [Вход] Атрибут.  
  
 *ValuePtr*  
 [Выход] Указатель на область памяти, в которую возвращается текущее значение атрибута, заданного с *атрибут*. Для атрибутов, целочисленный тип некоторые драйверы могут записывать только нижний 32-разрядную или 16-разрядное буфера и оставьте без изменений бит высокого порядка. Таким образом приложения должны использовать буфер SQLULEN и инициализации значения 0, перед вызовом этой функции.  
  
 Если *ValuePtr* имеет значение NULL, *StringLengthPtr* по-прежнему возвращает общее количество байтов (за исключением знака конечное значение null для символьных данных) для возврата в буфере, на который указывает  *ValuePtr*.  
  
 *BufferLength*  
 [Вход] Если *атрибута* является атрибутом, определенных для ODBC и *ValuePtr* указывает на строку символов или двоичных буфера, данный аргумент должен иметь длину \* *ValuePtr*. Если *атрибута* является атрибутом, определенных для ODBC и \* *ValuePtr* является целым числом, *BufferLength* учитывается. Если значение в  *\*ValuePtr* строка в Юникоде (при вызове **SQLGetConnectAttrW**), *BufferLength* аргумент должен быть четным числом.  
  
 Если *атрибута* является атрибутом, определяемым драйвером, приложение сможет определить природу атрибут диспетчера драйверов, задав *BufferLength* аргумент. *BufferLength* может иметь следующие значения:  
  
-   Если  *\*ValuePtr* — это указатель на строку знаков *BufferLength* имеет длину строки.  
  
-   Если  *\*ValuePtr* является указатель на буфер двоичных разрядов приложения результатом SQL_LEN_BINARY_ATTR (*длина*) макрос в *BufferLength*. В этом случае отрицательное значение в *BufferLength*.  
  
-   Если  *\*ValuePtr* — это указатель на значение, отличное от строки символов или двоичная строка *BufferLength* должно иметь значение SQL_IS_POINTER.  
  
-   Если  *\*ValuePtr* содержит тип данных фиксированной длины, *BufferLength* — SQL_IS_INTEGER или SQL_IS_UINTEGER, соответствующим образом.  
  
 *StringLengthPtr*  
 [Выход] Указатель на буфер, в который возвращается общее количество байтов (за исключением знака завершения null) для возврата в \* *ValuePtr*. Если \* *ValuePtr* является указателем null, длина не возвращается. Если значение атрибута представляет собой строку символов и число байтов, доступных для возврата превышает *BufferLength* за вычетом длины символ конечное значение null, данные в  *\*ValuePtr*усекается до *BufferLength* за вычетом длины знак завершения null и нули драйвером.  
  
## <a name="returns"></a>Возвращает  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, значение SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLGetConnectAttr** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, соответствующее значение SQLSTATE можно получить из структуры диагностики данных, вызвав **SQLGetDiagRec** с *HandleType* установленным в значение sql_handle_stmt и *обработки* из *ConnectionHandle*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые **SQLGetConnectAttr** и описание каждого из них в контексте этой функции; нотации «(DM)» предшествует описания SQLSTATE, возвращаемых диспетчером драйверов . Код возврата, связанные с каждым из значений SQLSTATE — это SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Description|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, относящиеся к драйверу. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|01004|Строка справа усечение данных|Данные, возвращаемые в \* *ValuePtr* усечена, чтобы быть *BufferLength* за вычетом длины символ конечное значение null. Длина неусеченный строковое значение возвращается в **StringLengthPtr*. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|08003|Соединение не открыто|(DM) *атрибута* указано значение, которое требуется открытое соединение.|  
|08S01|Сбой связи|Сбой в канале связи между драйвером и источника данных, к которому был подключен драйвер перед обработкой функции было завершено.|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет определенных SQLSTATE и для которого был определен SQLSTATE не зависит от реализации. Сообщение об ошибке из структуры диагностических данных с помощью аргумента *MessageText* в **SQLGetDiagField** описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйвер не удалось выделить память, который необходим для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|(DM) **SQLBrowseConnect** был вызван для *ConnectionHandle* и возвращается значение SQL_NEED_DATA. Эта функция была вызвана до **SQLBrowseConnect** возвращается SQL_SUCCESS_WITH_INFO или SQL_SUCCESS.<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**, или **SQLMoreResults** был вызван для *ConnectionHandle* и возвращается SQL_PARAM_DATA_ ЭТОТ ПАРАМЕТР ДОСТУПЕН. До получения данных для всех параметров потоковой вызове этой функции.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, поскольку базовые объекты памяти будет недоступен, возможно из-за нехватки памяти.|  
|HY090|Недопустимая длина строки или буфера|(DM)  *\*ValuePtr* является символьной строкой, а BufferLength было меньше нуля, но не равно SQL_NTS.|  
|HY092|Недопустимый атрибут идентификатор или параметра|Значение, указанное для аргумента *атрибут* не подходит для версии поддерживаются драйвером ODBC.|  
|HY114|Драйвер не поддерживает выполнение асинхронной функции уровня соединения|(DM) приложения была предпринята попытка выполнения асинхронной функции с параметр SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE драйвер, который не поддерживает операции асинхронное подключение.|  
|HY117|Соединение будет приостановлена из-за неизвестной транзакции состояния. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о состоянии приостановки см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYC00|Дополнительная возможность не реализована|Значение, указанное для аргумента *атрибут* был допустимым атрибутом соединения ODBC для используемая версия ODBC, поддерживаемых драйвером, но не поддерживается драйвером.|  
|HYT01|Время ожидания соединения истекло|Время ожидания соединения истекло раньше, чем ответил на запрос источника данных. Время ожидания задается с помощью **SQLSetConnectAttr**, sql_attr_connection_timeout не учитывается.|  
|IM001|Драйвер не поддерживает эту функцию|(DM), соответствующий драйвер *ConnectionHandle* не поддерживает функцию.|  
  
## <a name="comments"></a>Комментарии  
 Общие сведения об атрибутах соединения см. в разделе [атрибуты соединения](../../../odbc/reference/develop-app/connection-attributes.md).  
  
 Список атрибутов, которые могут быть установлены см. в разделе [SQLSetConnectAttr](../../../odbc/reference/syntax/sqlsetconnectattr-function.md). Обратите внимание, что если *атрибута* определяет атрибут, который возвращает строку, *ValuePtr* должен быть указателем на буфер для строки. Максимальная длина возвращаемой строки, включая символ завершения null, будет *BufferLength* байт.  
  
 В зависимости от атрибута, приложение не имеет для установления соединения перед вызовом **SQLGetConnectAttr**. Однако если **SQLGetConnectAttr** вызывается и указанный атрибут не имеет значения по умолчанию и не был задан во время предыдущего вызова для **SQLSetConnectAttr**, **SQLGetConnectAttr**вернет значение SQL_NO_DATA.  
  
 Если *атрибута* SQL_ATTR_ ТРАССИРОВКИ или файла ТРАССИРОВКИ SQL_ATTR_, *ConnectionHandle* не должен быть допустимым, и **SQLGetConnectAttr** не вернет значение SQL_ERROR или SQL_ INVALID_HANDLE Если *ConnectionHandle* является недопустимым. Эти атрибуты применяются для всех подключений. **SQLGetConnectAttr** вернет значение SQL_ERROR или SQL_INVALID_HANDLE, если другой аргумент является недопустимым.  
  
 Несмотря на то, что приложение может установить атрибуты инструкции с помощью **SQLSetConnectAttr**, приложение не может использовать **SQLGetConnectAttr** получить атрибут инструкции значения; он должен вызвать  **SQLGetStmtAttr** для извлечения значения атрибутов инструкции.  
  
 Атрибуты соединения SQL_ATTR_AUTO_IPD и SQL_ATTR_CONNECTION_DEAD могут быть возвращены при вызове **SQLGetConnectAttr** не удается установить с помощью вызова **SQLSetConnectAttr**.  
  
> [!NOTE]  
>  Не поддерживается асинхронный для **SQLGetConnectAttr**. При реализации **SQLGetConnectAttr**, драйвер может повысить производительность, сводя к минимуму количество попыток отправки или от сервера требуются сведения.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Возврат значения атрибута инструкции|[Функция SQLGetStmtAttr](../../../odbc/reference/syntax/sqlgetstmtattr-function.md)|  
|Присвоение атрибуту соединения|[Функция SQLSetConnectAttr](../../../odbc/reference/syntax/sqlsetconnectattr-function.md)|  
|Установка атрибута среды|[Функция SQLSetEnvAttr](../../../odbc/reference/syntax/sqlsetenvattr-function.md)|  
|С помощью атрибута инструкции|[Функция SQLSetStmtAttr](../../../odbc/reference/syntax/sqlsetstmtattr-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справочник по API-интерфейса ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)

