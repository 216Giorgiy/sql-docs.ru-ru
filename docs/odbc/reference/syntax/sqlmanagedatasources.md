---
title: SQLManageDataSources | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: article
apiname:
- SQLManageDataSources
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLManageDataSources
helpviewer_keywords:
- SQLManageDataSources [ODBC]
ms.assetid: ac6d186f-b394-406c-94c4-c6331d1ca468
caps.latest.revision: 22
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: 9d0fdf13051944c7af3c08418ac5182c9836db21
ms.sourcegitcommit: 7a6df3fd5bea9282ecdeffa94d13ea1da6def80a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="sqlmanagedatasources"></a>SQLManageDataSources
**Соответствия**  
 Появился в версии: ODBC 2.0  
  
 **Сводка**  
 **SQLManageDataSources** отображает диалоговое окно, с помощью которого пользователи можно настроить, добавлять и удалять источники данных сведений о системе.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
BOOL SQLManageDataSources(  
     HWND     hwnd);  
```  
  
## <a name="arguments"></a>Аргументы  
 *HWND*  
 [Вход] Дескриптор родительского окна.  
  
## <a name="returns"></a>Возвращает  
 **SQLManageDataSources** возвращает FALSE, если *hwnd* не является допустимым дескриптором окна. В противном случае возвращает значение TRUE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLManageDataSources** возвращает значение FALSE, связанный с ним  *\*pfErrorCode* значение можно получить путем вызова **SQLInstallerError**. В следующей таблице перечислены  *\*pfErrorCode* значения, которые могут быть возвращены **SQLInstallerError** и описание каждого из них в контексте этой функции.  
  
|*\*pfErrorCode*|Ошибка|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Установщик Общие ошибки|Произошла ошибка для которого нет ошибок определенного установщика.|  
|ODBC_ERROR_REQUEST_FAILED|*Запрос* сбой|Вызов **ConfigDSN** сбой.|  
|ODBC_ERROR_INVALID__HWND|Недопустимый дескриптор окна|*Hwnd* аргумент имеет недопустимый или NULL.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Программе установки не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="managing-data-sources"></a>Управление источниками данных  
 **SQLManageDataSources** сначала отображает **администратор источников данных ODBC** диалоговое окно, как показано на следующем рисунке.  
  
 ![Диалоговое окно администратора источника данных ODBC](../../../odbc/reference/syntax/media/ch23e.gif "CH23E")  
  
 Отображает диалоговое окно источников данных, перечисленных в сведениях о системе трех вкладках: **DSN пользователя**, **системный DSN**, и **файловый DSN**. Если пользователь дважды щелкает источника данных или выбора источника данных и нажимает **Настройка**, **SQLManageDataSources** вызовы **ConfigDSN** в программе установки библиотеки DLL с ODBC_CONFIG_ Параметр имени DSN.  
  
 Если пользователь нажимает кнопку **добавить**, **SQLManageDataSources** отображает **Создание нового источника данных** диалоговое окно, показанное на следующем рисунке.  
  
 ![Создать новый источник данных-диалоговое окно](../../../odbc/reference/syntax/media/ch23f.gif "CH23F")  
  
 Диалоговое окно отображает список установленных драйверов. Если пользователь дважды щелкает драйвера или выбирает драйвер и нажимает **ОК**, **SQLManageDataSources** вызовы **ConfigDSN** в DLL-файлов установки и передает ему параметр ODBC_ADD_DSN.  
  
 Если пользователь выбирает источник данных и выбирает **удалить**, **SQLManageDataSources** запрашивает ли пользователю необходимо удалить источник данных. Если пользователь нажимает кнопку **Да**, **SQLManageDataSources** вызовы **ConfigDSN** в DLL-файлов установки с параметром значение ODBC_REMOVE_DSN.  
  
 **Создание нового источника данных** диалоговое окно используется для добавления или удаления источника данных, системный источник данных или источника данных.  
  
## <a name="user-dsns"></a>Пользовательские имена DSN  
 Источники данных, созданные для отдельных пользователей будет вызываться пользовательских источников данных, чтобы отличать их от системных имен DSN. Сведения о системе пользовательских источников данных зарегистрированных следующим образом:  
  
 `HKEY_CURRENT_USERS`  
  
 `SOFTWARE`  
  
 `ODBC`  
  
 `Odbc.ini`  
  
## <a name="system-dsns"></a>Системный DSN  
 **Создание нового источника данных** диалогового окна можно добавить локальный компьютер или удалите один системный источник данных или задать конфигурацию для системного источника данных.  
  
 Настройка с помощью системы имени источника данных (DSN) источника данных может использоваться более чем одним пользователем на том же компьютере. Он также может использоваться службой всей системы, которая может получить доступ к источнику данных даже если пользователь не вошел в систему на компьютере.  
  
 Системный DSN регистрируется в HKEY_LOCAL_MACHINE записи сведений о системе, а не в записи HKEY_CURRENT_USER. Он не привязан к одному пользователю который входит в систему с именем конкретного пользователя и пароль, но может использоваться любым пользователем этого компьютера или с помощью автоматического развертывания службы. Системный DSN Однако связан один компьютер. Он не поддерживает возможность использования удаленных источников данных между компьютерами. Сведения о системе системных имен DSN зарегистрированных следующим образом:  
  
 ODBC Odbc.ini HKEY_LOCAL_MACHINE программного обеспечения  
  
## <a name="file-dsns"></a>Файловые источники данных  
 Файл источника данных имеет имя источника данных, как не источник данных компьютера и не зарегистрирован для любого одного пользователя или компьютера. Сведения о соединении для источника данных содержится в файле DSN с, можно скопировать на любой компьютер. Файл источника данных может быть общим, в этом случае файл DSN с находится в сети и может использоваться одновременно несколькими пользователями в сети при условии, что у пользователя есть установлены соответствующие драйверы. Файл источника данных также может быть непригоден для совместного использования, в этом случае он может использоваться только на одном компьютере.  
  
 Дополнительные сведения о файловых источников данных см. в разделе [подключение источников данных с помощью файла](../../../odbc/reference/develop-app/connecting-using-file-data-sources.md), или в разделе [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md).  
  
## <a name="managing-drivers"></a>Управление драйверами  
 При нажатии кнопки **драйверы** вкладке **администратор источников данных ODBC** диалоговом **SQLManageDataSources** отображает список драйверов ODBC, установленных в системе, а также сведения о драйверах. Дата отображается является Дата создания драйвера, как показано на следующем рисунке.  
  
 ![Вкладку администратор источников данных ODBC драйверы](../../../odbc/reference/syntax/media/ch23g.gif "ch23g")  
  
## <a name="tracing-options"></a>Параметры трассировки  
 При нажатии кнопки **трассировки** вкладке **администратор источников данных ODBC** диалоговом **SQLManageDataSources** отображает параметры трассировки, как показано в следующем на рисунке.  
  
 ![Вкладка трассировок администратор источников данных ODBC](../../../odbc/reference/syntax/media/ch23h.gif "Ch23h")  
  
 Если пользователь нажимает кнопку **запустить трассировку** и затем нажимает **ОК**, **SQLManageDataSources** включает трассировку вручную для всех приложений, запущенных на компьютере.  
  
 Если пользователь указывает имя файла трассировки в **файла журнала путь** текстовое поле, а затем нажимает **ОК**, **SQLManageDataSources** задает **TraceFile** ключевое слово в разделе [ODBC], информация о системе указанному имени.  
  
> [!IMPORTANT]  
>  Поддержка Visual Studio Analyzer был удален начиная с Windows 8 (Visual Studio Analyzer была включена только в предыдущих версиях Visual Studio.). Альтернативные способы устранения неполадок механизм используйте предложение трассировки.  
  
 При нажатии кнопки **запустить Visual Studio Analyzer** и затем нажимает **ОК**, Visual Studio Analyzer включен. Она остается включенной до **остановить Visual Studio Analyzer** нажата.  
  
 Дополнительные сведения о трассировке см. в разделе [трассировки](../../../odbc/reference/develop-app/tracing.md). Дополнительные сведения о **трассировки** и **TraceFile** ключевые слова, в разделе [ODBC подраздел](../../../odbc/reference/install/odbc-subkey.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Создание источников данных|[SQLCreateDataSource](../../../odbc/reference/syntax/sqlcreatedatasource-function.md)|
