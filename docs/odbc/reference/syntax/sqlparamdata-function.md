---
title: Функция SQLParamData | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: conceptual
apiname:
- SQLParamData
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLParamData
helpviewer_keywords:
- SQLParamData function [ODBC]
ms.assetid: 68fe010d-9539-4e5b-a260-c8d32423b1db
caps.latest.revision: 26
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 2debf8a85ad31533995613c5e06c17a6e4040d5a
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="sqlparamdata-function"></a>SQLParamData, функция
**Соответствия**  
 Появился в версии: Полное соответствие стандартам 1.0 ODBC: ISO-92  
  
 **Сводка**  
 **SQLParamData** используется совместно с **SQLPutData** для предоставления данных параметра во время выполнения инструкции, а также с **SQLGetData** для получения потоковых выходных данных параметра.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
SQLRETURN SQLParamData(  
     SQLHSTMT       StatementHandle,  
     SQLPOINTER *   ValuePtrPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *StatementHandle*  
 [Вход] Дескриптор инструкции.  
  
 *ValuePtrPtr*  
 [Выход] Указатель на буфер, в которую будет возвращен адрес *ParameterValuePtr* буфера, указанный в **SQLBindParameter** (для параметра данных) или адрес *TargetValuePtr* буфера, указанный в **SQLBindCol** (для столбца данных), как указано в поле записи дескриптора SQL_DESC_DATA_PTR.  
  
## <a name="returns"></a>Возвращает  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NEED_DATA, значение SQL_NO_DATA, SQL_STILL_EXECUTING, SQL_ERROR, SQL_INVALID_HANDLE или SQL_PARAM_DATA_AVAILABLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLParamData** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, соответствующее значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *HandleType* из SQL_ HANDLE_STMT и *обработки* из *StatementHandle*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые **SQLParamData** и описание каждого из них в контексте этой функции; нотации «(DM)» предшествует описания SQLSTATE, возвращаемых диспетчером драйверов. Код возврата, связанные с каждым из значений SQLSTATE — это SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, относящиеся к драйверу. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|07006|Нарушение атрибута ограниченного типа данных|Значение определяется *ValueType* аргумент в **SQLBindParameter** для связанных параметров не удалось преобразовать в тип данных, определяемый *ParameterType*аргумент в **SQLBindParameter**.<br /><br /> Возвращаемое значение данных для параметра, привязанный как SQL_PARAM_INPUT_OUTPUT или SQL_PARAM_OUTPUT не удалось преобразовать в тип данных, определяемый *ValueType* аргумент в **SQLBindParameter**.<br /><br /> (Если не удается преобразовать значения данных для одной или нескольких строк, но один или несколько строк, возвращенных успешно, эта функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|08S01|Сбой связи|Сбой в канале связи между драйвером и источника данных, к которому был подключен драйвер перед обработкой функции было завершено.|  
|22026|Строковые данные, несовпадение длины|Тип данных SQL_NEED_LONG_DATA_LEN в **SQLGetInfo** была «Y» и было указано меньше данных было отправлено для параметра long (тип данных был SQL_LONGVARCHAR, SQL_LONGVARBINARY или тип данных long, определяемые источником данных) с *StrLen_or_IndPtr* аргумент в **SQLBindParameter**.<br /><br /> Тип данных SQL_NEED_LONG_DATA_LEN в **SQLGetInfo** была «Y» и меньше данных был отправлен для длинного столбца (тип данных был SQL_LONGVARCHAR, SQL_LONGVARBINARY или тип данных long, определяемые источником данных), чем было указано в Длина буфера, соответствующий столбец в строке данных, которые были добавлены или обновлены с **SQLBulkOperations** или обновлено с **SQLSetPos**.|  
|40001|Сбой сериализации|Транзакции выполнен откат из-за взаимоблокировку ресурсов в другой транзакции.|  
|40003|Неизвестный завершение операторов|Сбой подключения во время выполнения этой функции и не удается определить состояние транзакции.|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет определенных SQLSTATE и для которого был определен SQLSTATE не зависит от реализации. Сообщение об ошибке, возвращенные **SQLGetDiagRec** в  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйвер не удалось выделить память, который необходим для поддержки выполнения или завершения функции.|  
|HY008|Операция отменена|Асинхронная обработка была включена для *StatementHandle*. Функция был вызван, и до выполнения, **SQLCancel** или **SQLCancelHandle** был вызван для *StatementHandle*; функция затем вызывается снова для *StatementHandle*.<br /><br /> Функция был вызван, и до выполнения, **SQLCancel** или **SQLCancelHandle** был вызван для *StatementHandle* из другого потока в многопоточные приложения.|  
|HY010|Ошибка последовательности функций|(DM) предыдущего вызова функции не был выполнен вызов **SQLExecDirect**, **SQLExecute**, **SQLBulkOperations**, или **SQLSetPos** где Возвращает код был SQL_NEED_DATA или предыдущего вызова функции был выполнен вызов **SQLPutData**.<br /><br /> Предыдущего вызова функции был выполнен вызов **SQLParamData**.<br /><br /> (DM) был вызван асинхронно выполняемой функции для дескриптора соединения, с которым связан *StatementHandle*. Выполняется при этом асинхронной функция **SQLParamData** была вызвана функция.<br /><br /> (DM) был вызван асинхронно выполняемой функции (не данный файл) для *StatementHandle* и все еще выполняется, при вызове этой функции.<br /><br /> **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations**, или **SQLSetPos** был вызван для *StatementHandle* и Возвращаемое значение SQL_NEED_DATA. **SQLCancel** был вызван перед отправкой данных для всех параметров с данными времени выполнения или столбцов.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, поскольку базовые объекты памяти будет недоступен, возможно из-за нехватки памяти.|  
|HY117|Соединение будет приостановлена из-за неизвестной транзакции состояния. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о состоянии приостановки см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYT01|Время ожидания соединения истекло|Время ожидания соединения истекло раньше, чем ответил на запрос источника данных. Время ожидания задается с помощью **SQLSetConnectAttr**, sql_attr_connection_timeout не учитывается.|  
|IM001|Драйвер не поддерживает эту функцию|(DM), соответствующий драйвер *StatementHandle* не поддерживает функцию.|  
|IM017|В режиме асинхронное уведомление отключена опроса|При использовании модели уведомление опроса отключен.|  
|IM018|**SQLCompleteAsync** не был вызван для завершения предыдущей асинхронной операции на этот дескриптор.|Если предыдущего вызова функции с дескриптором возвращает SQL_STILL_EXECUTING и уведомлений в режиме **SQLCompleteAsync** должен вызываться для этого после обработки и выполнения операции с дескриптором.|  
  
 Если **SQLParamData** вызывается при попытке отправки данных для параметра в инструкции SQL, она может возвращать любой SQLSTATE, которые могут быть возвращены, функция, вызываемая для выполнения инструкции (**SQLExecute** или **SQLExecDirect**). Если он вызывается при попытке отправки данных для столбца, обновляемых или добавлены с классом **SQLBulkOperations** или обновлением с использованием **SQLSetPos**, она может возвращать любой SQLSTATE, которые могут быть возвращены с  **SQLBulkOperations** или **SQLSetPos**.  
  
## <a name="comments"></a>Комментарии  
 **SQLParamData** может вызываться для предоставления данных во время выполнения для двух целей: данных параметра, который будет использоваться при обращении к **SQLExecute** или **SQLExecDirect**, или данные столбца, который будет использовать, когда строка обновляется или добавлен с помощью вызова **SQLBulkOperations** или обновляются с помощью вызова **SQLSetPos**. Во время выполнения **SQLParamData** возвращает приложению требуется драйвер указывает, какие данные.  
  
 Если приложение вызывает **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations**, или **SQLSetPos**, драйвер возвращает SQL_NEED_ ДАННЫЕ, если это необходимо данных во время выполнения. Затем приложение вызывает **SQLParamData** , чтобы определить, какие данные для отправки. Если драйвер требует данных параметра, драйвер возвращает в  *\*ValuePtrPtr* выходной буфер значение, которое приложение помещаются в буфер строк. Приложение может использовать это значение, чтобы определить, какой драйвер запрашивает данные параметра. Если драйвер требует данных столбца, драйвер возвращает в  *\*ValuePtrPtr* буфера адрес, который был изначально привязан столбец, как показано ниже:  
  
 *Привязан адрес* + *привязки смещение* + ((*номер строки* – 1) x *размер элемента*)  
  
 где переменные определяются, как показано в следующей таблице.  
  
|Переменная|Описание|  
|--------------|-----------------|  
|*Адрес привязки*|Адрес, указанный с *TargetValuePtr* аргумент в **SQLBindCol**.|  
|*Смещение привязки*|Значение, хранящееся по адресу, указанному атрибутом SQL_ATTR_ROW_BIND_OFFSET_PTR инструкции.|  
|*Номер строки*|От 1 номер строки в наборе строк. Для выборки одной строки, которые используются по умолчанию, — 1.|  
|*Размер элемента*|Значение атрибута инструкции SQL_ATTR_ROW_BIND_TYPE для буферов данных и длины/индикатора.|  
  
 Он также возвращает значение SQL_NEED_DATA, что является признаком к приложению, он должен вызывать **SQLPutData** для отправки данных.  
  
 Приложение вызывает **SQLPutData** столько раз, сколько необходимо для отправки данных во время выполнения данные для столбца или параметра. После отправки всех данных для столбца или параметра приложение вызывает **SQLParamData** еще раз. Если **SQLParamData** снова возвращает SQL_NEED_DATA, данные должны быть отправлены для другого параметра или столбца. Таким образом, приложение снова вызывает **SQLPutData**. Если все данные во время выполнения отправки данных для всех параметров или столбцов, затем **SQLParamData** возвращает SQL_SUCCESS или SQL_SUCCESS_WITH_INFO, значение в  *\*ValuePtrPtr* не определено, и может выполнить инструкцию SQL или **SQLBulkOperations** или **SQLSetPos** вызова могут быть обработаны.  
  
 Если **SQLParamData** данных предоставляет параметр для поиска инструкцией обновления или удаления, не влияет на все строки в источнике данных, вызов **SQLParamData** не вернет значение SQL_NO_DATA.  
  
 Дополнительные сведения о том, как данные во время выполнения параметр данных передается во время выполнения инструкции, в разделе «Передача значений параметров» в [SQLBindParameter](../../../odbc/reference/syntax/sqlbindparameter-function.md) и [отправки длинных данных](../../../odbc/reference/develop-app/sending-long-data.md). Для обновляется или добавить дополнительные сведения о данных столбца как данных во время выполнения, см. в разделе «Использование SQLSetPos» в [SQLSetPos](../../../odbc/reference/syntax/sqlsetpos-function.md), «Выполнение массового обновления с помощью закладок» в [SQLBulkOperations](../../../odbc/reference/syntax/sqlbulkoperations-function.md), и [большие объемы данных и SQLSetPos и SQLBulkOperations](../../../odbc/reference/develop-app/long-data-and-sqlsetpos-and-sqlbulkoperations.md).  
  
 **SQLParamData** можно вызвать для получения потоковых выходных параметров. Когда **SQLMoreResults**, **SQLExecute**, **SQLGetData**, или **SQLExecDirect** возвращает SQL_PARAM_DATA_AVAILABLE, вызовите **SQLParamData** для определения, какой параметр имеет значение недоступно. Дополнительные сведения о SQL_PARAM_DATA_AVAILABLE и потоковых выходных параметров см. в разделе [получение выходных параметров с помощью метода SQLGetData](../../../odbc/reference/develop-app/retrieving-output-parameters-using-sqlgetdata.md).  
  
## <a name="code-example"></a>Пример кода  
 В разделе [SQLPutData](../../../odbc/reference/syntax/sqlputdata-function.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Привязка буфер к параметру|[Функция SQLBindParameter](../../../odbc/reference/syntax/sqlbindparameter-function.md)|  
|Отмена обработки инструкции|[Функция SQLCancel](../../../odbc/reference/syntax/sqlcancel-function.md)|  
|Возвращение сведений о параметре в операторе|[Функция SQLDescribeParam](../../../odbc/reference/syntax/sqldescribeparam-function.md)|  
|Выполнение инструкции SQL|[Функция SQLExecDirect](../../../odbc/reference/syntax/sqlexecdirect-function.md)|  
|Выполнения подготовленной инструкции SQL|[Функция SQLExecute](../../../odbc/reference/syntax/sqlexecute-function.md)|  
|Отправка данных параметра во время выполнения|[Функция SQLPutData](../../../odbc/reference/syntax/sqlputdata-function.md)|  
  
## <a name="see-also"></a>См. также  
 [Справочник по API-интерфейса ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовка ODBC](../../../odbc/reference/install/odbc-header-files.md)   
 [Получение выходных параметров с помощью метода SQLGetData](../../../odbc/reference/develop-app/retrieving-output-parameters-using-sqlgetdata.md)
