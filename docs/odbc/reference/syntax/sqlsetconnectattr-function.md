---
title: "Функция SQLSetConnectAttr | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
apiname:
- SQLSetConnectAttr
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLSetConnectAttr
helpviewer_keywords:
- SQLSetConnectAttr function [ODBC]
ms.assetid: 97fc7445-5a66-4eb9-8e77-10990b5fd685
caps.latest.revision: 83
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: On Demand
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 4006d05403781ada24cf43903cd14a971366e12a
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="sqlsetconnectattr-function"></a>Функция SQLSetConnectAttr
**Соответствия**  
 Появился в версии: ODBC 3.0 нормативных требований: ISO-92  
  
 **Сводка**  
 **SQLSetConnectAttr** задает атрибуты, которые управляют аспектами подключений.  
  
> [!NOTE]  
>  Дополнительные сведения о том, что диспетчер драйверов преобразует эту функцию для при ODBC 3*.x* при работе с ODBC 2*.x* драйвера, в разделе [сопоставление замены функции для назад Совместимость приложений](../../../odbc/reference/develop-app/mapping-replacement-functions-for-backward-compatibility-of-applications.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
SQLRETURN SQLSetConnectAttr(  
     SQLHDBC       ConnectionHandle,  
     SQLINTEGER    Attribute,  
     SQLPOINTER    ValuePtr,  
     SQLINTEGER    StringLength);  
```  
  
## <a name="arguments"></a>Аргументы  
 *ConnectionHandle*  
 [Вход] Дескриптор соединения.  
  
 *Attribute*  
 [Вход] Атрибут для задания, перечисленные в «Комментарии».  
  
 *ValuePtr*  
 [Вход] Указатель на значение должны быть связаны с *атрибут*. В зависимости от значения *атрибута*, *ValuePtr* будет целое число без знака или будет указывать строку, завершающуюся значением null. Обратите внимание, что тип интеграл *атрибута* аргумент не может быть фиксированной длины, см. в разделе комментариев для детализации.  
  
 *StringLength*  
 [Вход] Если *атрибута* является атрибутом, определенных для ODBC и *ValuePtr* указывает на строку символов или двоичных буфера, данный аргумент должен иметь длину **ValuePtr*. Для символьных строковых данных этот аргумент должен содержать число байтов в строку.  
  
 Если *атрибута* является атрибутом, определенных для ODBC и *ValuePtr* является целым числом, *StringLength* учитывается.  
  
 Если *атрибута* является атрибутом, определяемым драйвером, приложение сможет определить природу атрибут диспетчера драйверов, задав *StringLength* аргумент. *StringLength* может иметь следующие значения:  
  
-   Если *ValuePtr* является указателем на строку символов, затем *StringLength* длина строки или SQL_NTS.  
  
-   Если *ValuePtr* — это указатель на двоичные буфер, то приложение помещает результат SQL_LEN_BINARY_ATTR (*длина*) макрос в *StringLength*. В этом случае отрицательное значение в *StringLength*.  
  
-   Если *ValuePtr* — это указатель на значение, отличное от строки символов или двоичная строка затем *StringLength* должно иметь значение SQL_IS_POINTER.  
  
-   Если *ValuePtr* содержит значение фиксированной длины, то *StringLength* — SQL_IS_INTEGER или SQL_IS_UINTEGER, соответствующим образом.  
  
## <a name="returns"></a>Возвращает  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, SQL_INVALID_HANDLE или SQL_STILL_EXECUTING.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLSetConnectAttr** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, соответствующее значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *HandleType* из SQL_HANDLE_DBC и *обработки* из *ConnectionHandle*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые **SQLSetConnectAttr** и описание каждого из них в контексте этой функции; нотации «(DM)» предшествует описания SQLSTATE, возвращаемых диспетчером драйверов. Код возврата, связанные с каждым из значений SQLSTATE — это SQL_ERROR, если не указано иное.  
  
 Драйвер может возвращать значение SQL_SUCCESS_WITH_INFO для предоставления сведений о результате установив соответствующий параметр.  
  
|SQLSTATE|Ошибка|Description|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, относящиеся к драйверу. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|01S02|Значение параметра изменено|Драйвер не поддерживает значение, указанное в *ValuePtr* и заменить примерно такое же значение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|08002|Имя подключения используется|*Атрибута* аргумент был SQL_ATTR_ODBC_CURSORS и драйвер уже был подключен к источнику данных.|  
|08003|Соединение не открыто|(DM) *атрибута* было указано значение, которое требуется открытое соединение, но *ConnectionHandle* не находился в подключенном состоянии.|  
|08S01|Сбой связи|Сбой в канале связи между драйвером и источника данных, к которому был подключен драйвер перед обработкой функции было завершено.|  
|24000|Недопустимое состояние курсора|*Атрибута* аргумент был SQL_ATTR_CURRENT_CATALOG, а Ожидалась результирующий набор.|  
|25000|Недопустимая операция в локальной транзакции|Подключение было в локальной транзакции при попытке прикрепить соединение распределенных транзакций (DTC) подключение установить атрибут SQL_ATTR_ENLIST_IN_DTC.<br /><br /> Соединение уже участвует в DTC.<br /><br /> Соединение прикреплено в соединения распределенной транзакции и запуска локальной транзакции, задав SQL_ATTR_AUTOCOMMIT равным SQL_AUTOCOMMIT_OFF.|  
|3D000|Недопустимое имя каталога|*Атрибута* аргумент был SQL_CURRENT_CATALOG и было указано неверное имя указанного каталога.|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет определенных SQLSTATE и для которого был определен SQLSTATE не зависит от реализации. Сообщение об ошибке, возвращенные **SQLGetDiagRec** в  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйверу не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY008|Операция отменена|Асинхронная обработка была включена для *ConnectionHandle*. **SQLSetConnectAttr** была вызвана функция и до выполнения, [функция SQLCancelHandle](../../../odbc/reference/syntax/sqlcancelhandle-function.md) был вызван для *ConnectionHandle*, а затем **SQLSetConnectAttr** функция была вызвана снова на *ConnectionHandle*.<br /><br /> Или **SQLSetConnectAttr** была вызвана функция и до выполнения, **SQLCancelHandle** был вызван для *ConnectionHandle* из другого потока в многопоточные приложения.|  
|HY009|Недопустимое использование пустого указателя|*Атрибута* аргумент определенный атрибут соединения, который требуется строковое значение, и *ValuePtr* аргумент был пустым указателем.|  
|HY010|Ошибка последовательности функций|(DM) был вызван асинхронно выполняемой функции для *StatementHandle* связанных с *ConnectionHandle* и еще выполнялась при **SQLSetConnectAttr**был вызван.<br /><br /> (DM) был вызван асинхронно выполняемой функции (не данный файл) для *ConnectionHandle* и все еще выполняется, при вызове этой функции.<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**, или **SQLMoreResults** был вызван для одного из дескрипторов инструкций, связанных с *ConnectionHandle* и возвращается SQL_PARAM_DATA_AVAILABLE. До получения данных для всех параметров потоковой вызове этой функции.<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations**, или **SQLSetPos** был вызван для *StatementHandle*  связанных с *ConnectionHandle* и возвращается значение SQL_NEED_DATA. Эта функция был вызван перед отправкой данных для всех параметров с данными времени выполнения или столбцов.<br /><br /> (DM) **SQLBrowseConnect** был вызван для *ConnectionHandle* и возвращается значение SQL_NEED_DATA. Эта функция была вызвана до **SQLBrowseConnect** возвращается SQL_SUCCESS_WITH_INFO или SQL_SUCCESS.|  
|HY011|Невозможно задать атрибут сейчас|*Атрибута* аргумент был SQL_ATTR_TXN_ISOLATION, и транзакция была открыта.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, поскольку базовые объекты памяти будет недоступен, возможно из-за нехватки памяти.|  
|HY024|Недопустимое значение атрибута|Получает указанный *атрибута* значение, недопустимое значение было указано в *ValuePtr*. (Диспетчер драйверов возвращает этот SQLSTATE только для подключения и атрибуты инструкции, которые принимают дискретного набора значений, таких как SQL_ATTR_ACCESS_MODE или атрибуту SQL_ATTR_ASYNC_ENABLE. Для всех других атрибутов соединения и инструкции, драйвер должен проверить значение, указанное в *ValuePtr*.)<br /><br /> *Атрибута* аргумент имеет SQL_ATTR_TRACEFILE или помощью настройки SQL_ATTR_TRANSLATE_LIB, и *ValuePtr* была пустая строка.|  
|HY090|Недопустимая длина строки или буфера|*(DM) \*ValuePtr* представляет собой строку символов и *StringLength* аргумент был не меньше 0 но SQL_NTS.|  
|HY092|Недопустимый атрибут идентификатор или параметра|(DM) значение, указанное для аргумента *атрибут* не подходит для версии поддерживаются драйвером ODBC.<br /><br /> (DM) значение, указанное для аргумента *атрибут* был атрибут только для чтения.|  
|HY114|Драйвер не поддерживает выполнение асинхронной функции уровня соединения|(DM) приложения была предпринята попытка выполнения асинхронной функции с параметр SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE драйвер, который не поддерживает операции асинхронное подключение.|  
|HY117|Соединение будет приостановлена из-за неизвестной транзакции состояния. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о приостановлена. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HY121|Библиотека курсоров и учетом драйвера пула, не может использоваться одновременно|Дополнительные сведения см. в разделе [Driver-Aware Connection Pooling](../../../odbc/reference/develop-app/driver-aware-connection-pooling.md).|  
|HYC00|Дополнительная возможность не реализована|Значение, указанное для аргумента *атрибута* надлежащее подключение ODBC или атрибут инструкции для используемой версии ODBC, поддерживаемых драйвером, но не поддерживается драйвером.|  
|HYT01|Время ожидания соединения истекло|Время ожидания соединения истекло раньше, чем ответил на запрос источника данных. Время ожидания задается с помощью **SQLSetConnectAttr**, sql_attr_connection_timeout не учитывается.|  
|IM001|Драйвер не поддерживает эту функцию|Драйвер (DM), связанные с *ConnectionHandle* не поддерживает функцию.|  
|IM009|Не удается загрузить трансляции (DLL)|Драйверу не удалось загрузить перевода библиотеки DLL, который указан для соединения. Ошибки могут быть возвращены только если *атрибута* — с помощью настройки SQL_ATTR_TRANSLATE_LIB.|  
|IM017|В режиме асинхронное уведомление отключена опроса|При использовании модели уведомление опроса отключен.|  
|IM018|**SQLCompleteAsync** не был вызван для завершения предыдущей асинхронной операции на этот дескриптор.|Если предыдущего вызова функции с дескриптором возвращает SQL_STILL_EXECUTING и уведомлений в режиме **SQLCompleteAsync** должен вызываться для этого после обработки и выполнения операции с дескриптором.|  
|S1118|Драйвер не поддерживает асинхронное уведомление|Задано SQL_ATTR_ASYNC_DBC_EVENT (после установки подключения), но асинхронное уведомление не поддерживается драйвером.|  
  
 Когда *атрибута* является атрибутом инструкции **SQLSetConnectAttr** может возвращать любой SQLSTATE, возвращенный **SQLSetStmtAttr**.  
  
## <a name="comments"></a>Комментарии  
 Общие сведения об атрибутах соединения см. в разделе [атрибуты соединения](../../../odbc/reference/develop-app/connection-attributes.md).  
  
 В настоящее время определены атрибуты и используемая версия ODBC, в котором они были введены отображаются в таблице ниже в данном разделе; Ожидается, что определены дополнительные атрибуты для использования различных источников данных. Диапазон атрибутов зарезервирован ODBC. Разработчики необходимо зарезервировать значения для собственных нужд конкретного драйвера из Open Group.  
  
> [!NOTE]  
>  Возможность установки атрибутов инструкции на уровне соединения путем вызова **SQLSetConnectAttr** был объявлен устаревшим в ODBC 3*.x*. ODBC 3*.x* приложения никогда не следует устанавливать атрибуты инструкции на уровне соединения. ODBC 3*.x* на уровне соединения, за исключением SQL_ATTR_METADATA_ID и атрибуту SQL_ATTR_ASYNC_ENABLE атрибуты, которые атрибуты соединения и атрибуты инструкции, а может быть невозможно задать атрибуты инструкции Задайте на уровне соединения или на уровне инструкции.  
>   
>  ODBC 3*.x* драйверы должен поддерживать эту функциональность, только если они должны работать с ODBC 2*.x* приложения, значение ODBC 2*.x* параметров инструкции на уровне соединения. Дополнительные сведения см. в разделе [SQLSetConnectOption сопоставление](../../../odbc/reference/appendixes/sqlsetconnectoption-mapping.md) в приложении G: драйвер рекомендации для обеспечения обратной совместимости.  
  
 Приложение может вызвать **SQLSetConnectAttr** в любое время с момента подключения выделяется и освобождается. Все атрибуты инструкции и соединения успешно установлены приложением для подключения сохраняется до **SQLFreeHandle** вызывается для подключения. Например, если приложение вызывает **SQLSetConnectAttr** перед подключением к источнику данных, атрибут сохраняется даже в том случае, если **SQLSetConnectAttr** завершается ошибкой в драйвере, когда приложение подключается к источник данных; Если приложение устанавливает атрибут драйвера, атрибут не будет устранена, даже если приложение соединяется с другой драйвер для подключения.  
  
 Некоторые атрибуты соединения можно задать только перед подключение установлено; другие могут устанавливаться только после установки соединения. В этой таблице перечислены эти атрибуты соединения, которые должны быть установлены до или после установки соединения. *Либо* указывает, что атрибут может быть задано до или после соединения.  
  
|Attribute|Установить до или после подключения?|  
|---------------|-------------------------------------|  
|SQL_ATTR_ACCESS_MODE|[1]|  
|SQL_ATTR_ASYNC_DBC_EVENT|Допустим любой вариант|  
|ПАРАМЕТР SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE|[4]|  
|SQL_ATTR_ASYNC_DBC_PCALLBACK|Допустим любой вариант|  
|SQL_ATTR_ASYNC_DBC_PCONTEXT|Допустим любой вариант|  
|АТРИБУТУ SQL_ATTR_ASYNC_ENABLE|[2]|  
|SQL_ATTR_AUTO_IPD|Допустим любой вариант|  
|SQL_ATTR_AUTOCOMMIT|[5]|  
|SQL_ATTR_CONNECTION_DEAD|После|  
|SQL_ATTR_CONNECTION_TIMEOUT|Допустим любой вариант|  
|SQL_ATTR_CURRENT_CATALOG|[1]|  
|SQL_ATTR_DBC_INFO_TOKEN|После|  
|SQL_ATTR_ENLIST_IN_DTC|После|  
|SQL_ATTR_LOGIN_TIMEOUT|Перед|  
|SQL_ATTR_METADATA_ID|Допустим любой вариант|  
|SQL_ATTR_ODBC_CURSORS|Перед|  
|SQL_ATTR_PACKET_SIZE|Перед|  
|SQL_ATTR_QUIET_MODE|Допустим любой вариант|  
|SQL_ATTR_TRACE|Допустим любой вариант|  
|SQL_ATTR_TRACEFILE|Допустим любой вариант|  
|ПОМОЩЬЮ НАСТРОЙКИ SQL_ATTR_TRANSLATE_LIB|После|  
|SQL_ATTR_TRANSLATE_OPTION|После|  
|SQL_ATTR_TXN_ISOLATION|[3]|  
  
 [1] SQL_ATTR_ACCESS_MODE и SQL_ATTR_CURRENT_CATALOG можно задать до или после подключения, в зависимости от драйвера. Тем не менее взаимодействующие приложения установить их перед установкой соединения, так как некоторые драйверы не поддерживают изменение этих после подключения.  
  
 [2] до появления активный оператор, необходимо задать атрибуту SQL_ATTR_ASYNC_ENABLE.  
  
 [3] SQL_ATTR_TXN_ISOLATION можно задать только в том случае, если нет открытых транзакций для соединения. Некоторые атрибуты соединения поддерживают замену примерно такое же значение, если источник данных не поддерживает значение, указанное в \* *ValuePtr*. В таких случаях драйвер возвращает SQL_SUCCESS_WITH_INFO и SQLSTATE 01S02 (значение параметра изменено). Например если *атрибута* — SQL_ATTR_PACKET_SIZE и \* *ValuePtr* превышает максимальный размер пакета, драйвер подставляет вместо максимальный размер. Чтобы определить значение, приложение вызывает **SQLGetConnectAttr**.  
  
 [4] Если параметр SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE прежде, чем при открытом соединении, диспетчер драйверов будут задается атрибут драйвера при загрузке драйвера во время вызова **SQLBrowseConnect**, **SQLConnect**, или **SQLDriverConnect**. Перед вызовом **SQLBrowseConnect**, **SQLConnect**, или **SQLDriverConnect**, диспетчер драйверов не узнать, какой драйвер для подключения к и не знаете, является ли драйвер поддерживает операции асинхронное подключение. Таким образом диспетчер драйверов всегда возвращает значение SQL_SUCCESS. Но в случае, если драйвер не поддерживает операции асинхронное подключение, вызов **SQLBrowseConnect**, **SQLConnect**, или **SQLDriverConnect** завершится ошибкой.  
  
 [5] при SQL_ATTR_AUTOCOMMIT равным FALSE, приложения должны вызывать метод SQLEndTran(SQL_ROLLBACK) любого API возвращает значение SQL_ERROR для обеспечения согласованности транзакций.  
  
 Формат данных, задайте \* *ValuePtr* буфера зависит от указанного *атрибут*. **SQLSetConnectAttr** будет принимать данные атрибут в одной из двух различных форматов: строку символом null или является целым числом. Недопустимый формат, указывается в описание атрибута. Символьные строки, на который указывает *ValuePtr* аргумент **SQLSetConnectAttr** длина *StringLength* байт.  
  
 *StringLength* аргумент учитывается, если длина определена в атрибут, как это происходит для всех атрибутов, которые появились в ODBC 2*.x* или более ранней версии.  
  
|*Attribute*|*ValuePtr* содержимое|  
|-----------------|-------------------------|  
|SQL_ATTR_ACCESS_MODE (ODBC 1.0)|Значение типа SQLUINTEGER. SQL_MODE_READ_ONLY драйвером или источником данных служит признаком того, что соединение не является обязательным для поддержки инструкций SQL, которые вызывают обновлений. Этот режим можно использовать для оптимизации стратегии блокировки, управления транзакциями или других областей в зависимости от драйвера или источник данных. Драйвер не требуется для предотвращения таких инструкций отправки на источнике данных. Поведение драйвера и источника данных, когда требуется обработать инструкций SQL, которые не только для чтения во время подключения только для чтения, определяемого реализацией. SQL_MODE_READ_WRITE значение по умолчанию.|  
|SQL_ATTR_ASYNC_DBC_EVENT (ODBC 3.8)|Указатель SQLPOINTER значение, представляющее обработчик событий.<br /><br /> Уведомление о завершении асинхронной функции включена, вызвав **SQLSetConnectAttr** SQL_ATTR_ASYNC_STMT_EVENT атрибутом и задающего дескриптор события. **Примечание:** с библиотекой курсоров не поддерживается метод уведомления. Приложение будет получать сообщение об ошибке при попытке включить библиотеку курсоров через SQLSetConnectAttr, включенный в качестве метода уведомления.|  
|ПАРАМЕТР SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE (ODBC 3.8)|Значение SQLUINTEGER, включает или отключает асинхронное выполнение выбранной функции на дескриптор соединения. Дополнительные сведения см. в разделе [асинхронное выполнение (метод опроса)](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md).<br /><br /> SQL_ASYNC_DBC_ENABLE_ON = включить асинхронную операцию для указанных функций, относящиеся к соединению.<br /><br /> SQL_ASYNC_DBC_ENABLE_OFF = Disable (по умолчанию) асинхронную операцию для указанных функций, относящиеся к соединению.<br /><br /> Установка параметр SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE всегда выполняется синхронно (то есть, он никогда не вернет значение SQL_STILL_EXECUTING).<br /><br /> Асинхронное выполнение инструкции операций включены с атрибуту SQL_ATTR_ASYNC_ENABLE.|  
|SQL_ATTR_ASYNC_DBC_PCALLBACK (ODBC 3.8)|Указатель SQLPOINTER значение, которое указывает на структуру контекста.<br /><br /> Только диспетчер драйверов можно вызвать драйвер **SQLSetStmtAttr** функции с помощью этого атрибута.|  
|SQL_ATTR_ASYNC_DBC_PCONTEXT (ODBC 3.8)|Указатель SQLPOINTER значение, которое указывает на структуру контекста.<br /><br /> Только диспетчер драйверов можно вызвать драйвер **SQLSetStmtAttr** функции с помощью этого атрибута.|  
|АТРИБУТУ SQL_ATTR_ASYNC_ENABLE (ODBC 3.0)|SQLULEN значение, указывающее, вызывается ли функции с помощью инструкции для указанного подключения выполняется асинхронно.<br /><br /> SQL_ASYNC_ENABLE_OFF = отключить поддержку уровня асинхронное выполнение подключения для операций инструкции (по умолчанию).<br /><br /> SQL_ASYNC_ENABLE_ON = включить поддержку уровня асинхронное выполнение подключения для операций инструкции.<br /><br /> Этот атрибут может принимать значение ли **SQLGetInfo** сведениями SQL_ASYNC_MODE возвращает тип SQL_AM_CONNECTION или SQL_AM_STATEMENT.|  
|SQL_ATTR_AUTO_IPD (ODBC 3.0)|Значение sqluinteger, ПРЕДНАЗНАЧЕННУЮ только для чтения, указывает ли автоматическое заполнение IPD после вызова **SQLPrepare** поддерживается:<br /><br /> SQL_TRUE = автоматическое заполнение IPD после вызова **SQLPrepare** поддерживается драйвером.<br /><br /> Значение SQL_FALSE = автоматическое заполнение IPD после вызова **SQLPrepare** не поддерживается драйвером. Серверы, которые не поддерживают подготовленные инструкции нельзя будет автоматически заполнить IPD.<br /><br /> Если для атрибута соединения SQL_ATTR_AUTO_IPD возвращается SQL_TRUE, атрибут инструкции SQL_ATTR_ENABLE_AUTO_IPD может быть присвоено выключать автоматическое заполнение IPD. Если SQL_ATTR_AUTO_IPD SQL_FALSE, SQL_ATTR_ENABLE_AUTO_IPD нельзя присвоить значение SQL_TRUE. Значение по умолчанию SQL_ATTR_ENABLE_AUTO_IPD равно значению SQL_ATTR_AUTO_IPD.<br /><br /> Этот атрибут подключения может быть возвращен **SQLGetConnectAttr** , но не может быть задано **SQLSetConnectAttr**.|  
|SQL_ATTR_AUTOCOMMIT (ODBC 1.0)|SQLUINTEGER значение, указывающее, следует ли использовать режим автоматической фиксации или ручной фиксации.<br /><br /> SQL_AUTOCOMMIT_OFF = драйвер использует режим ручной фиксации, а приложение должно явно фиксации или отката транзакции с **SQLEndTran**.<br /><br /> SQL_AUTOCOMMIT_ON = режим автоматической фиксации использует драйвер. Каждая инструкция фиксируется немедленно после его выполнения. Это значение по умолчанию. Открытых транзакций для соединения не фиксируются, когда SQL_ATTR_AUTOCOMMIT равным SQL_AUTOCOMMIT_ON, чтобы изменить режим ручной фиксации в режим автоматической фиксации.<br /><br /> Дополнительные сведения см. в разделе [режим фиксации](../../../odbc/reference/develop-app/commit-mode.md). **Важно:** некоторые источники данных удалять планы доступа и закройте курсоры для всех инструкций в соединении при каждом операторе фиксируется; режим автоматической фиксации может вызвать перезагрузку после выполнения каждой инструкции nonquery или когда курсор находится закрыт для запроса. Дополнительные сведения см. в разделе типы информации SQL_CURSOR_COMMIT_BEHAVIOR и SQL_CURSOR_ROLLBACK_BEHAVIOR в [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) и [влияние транзакций на курсоры и подготовленных инструкций](../../../odbc/reference/develop-app/effect-of-transactions-on-cursors-and-prepared-statements.md). <br /><br /> Когда пакет выполняется в режиме автоматической фиксации, возможны две вещи. Всего пакета может рассматриваться как элемент autocommitable или единице autocommitable считается каждая инструкция в пакете. Некоторые источники данных может поддерживать оба эти поведения, а также может служить способ выбрать одно из них. Это определяемые драйвером ли пакет рассматривается как единица autocommitable или ли каждая отдельная инструкция в пакете является autocommitable.|  
|SQL_ATTR_CONNECTION_DEAD<br /><br /> (ODBC 3.5)|Только для чтения SQLUINTEGER значение, указывающее состояние соединения. Если значение SQL_CD_TRUE, соединение было потеряно. Если значение SQL_CD_FALSE, подключение по-прежнему активна.|  
|SQL_ATTR_CONNECTION_TIMEOUT НЕ УЧИТЫВАЕТСЯ (ODBC 3.0)|Значение SQLUINTEGER, соответствующее количество секунд ожидания любой запрос на подключение для завершения перед возвратом к приложению. Драйвер должен возвращать SQLSTATE HYT00 (превышено время ожидания) в любое время, можно время ожидания в ситуации, не связанные с выполнения запроса или имени входа.<br /><br /> Если *ValuePtr* будет равно 0 (по умолчанию), что таймаут не используется.|  
|SQL_ATTR_CURRENT_CATALOG (ODBC 2.0)|Строка символов, содержащее имя каталога для использования источником данных. Например, в SQL Server каталога является базой данных, поэтому драйвер отправляет **используйте** *базы данных* инструкции к источнику данных, где *базы данных* задается в базе данных \* *ValuePtr*. Для одноуровневых драйвера, каталог может быть каталог, поэтому драйвер изменяет свой текущий каталог на каталог, указанный в **ValuePtr*.|  
|SQL_ATTR_DBC_INFO_TOKEN (ODBC 3.8|Указатель SQLPOINTER значение, используемое для указания обратно маркер подключения сведения в DBC обработки при [SQLRateConnection](../../../odbc/reference/syntax/sqlrateconnection-function.md)элемента (\**pRating*) параметра не равно 100.<br /><br /> SQL_ATTR_DBC_INFO_TOKEN доступно только для набора. Невозможно использовать **SQLGetConnectAttr** или **SQLGetConnectOption** для получения этого значения. Диспетчер драйверов **SQLSetConnectAttr** не будет принимать SQL_ATTR_DBC_INFO_TOKEN, поскольку приложение не задавать этот атрибут.<br /><br /> Если драйвер возвращает значение SQL_ERROR после установки SQL_ATTR_DBC_INFO_TOKEN, будет освобождена соединения получен из пула. Затем диспетчер драйверов пытается получить другое соединение из пула. В разделе [разработке пула соединений, поддерживающие драйвер ODBC](../../../odbc/reference/develop-driver/developing-connection-pool-awareness-in-an-odbc-driver.md) для получения дополнительной информации.|  
|SQL_ATTR_ENLIST_IN_DTC (ODBC 3.0)|Указатель SQLPOINTER значение, указывающее, следует ли использовать драйвер ODBC в распределенных транзакциях, координируемых с помощью службы компонентов Microsoft.<br /><br /> Передайте DTC OLE объект транзакции, описывающий транзакцию для экспорта в SQL Server, или SQL_DTC_DONE, чтобы завершить связь соединения.<br /><br /> Клиент вызывает метод координатора распределенных транзакций Microsoft (MS DTC) OLE ITransactionDispenser::BeginTransaction, чтобы начать транзакцию MS DTC и создать объект транзакции MS DTC, представляющий транзакцию. Затем приложение вызывает SQLSetConnectAttr с параметром SQL_ATTR_ENLIST_IN_DTC, чтобы связать объект транзакции с соединением ODBC. Все связанные действия базы данных будут выполняться под защитой транзакции MS DTC. Приложение вызывает SQLSetConnectAttr с параметром SQL_DTC_DONE, чтобы завершить связь соединения. Дополнительные сведения см. в документации по MS DTC.|  
|ПАРАМЕТРЕ (ODBC 1.0)|Значение SQLUINTEGER, соответствующее количество секунд ожидания входа запрос на завершение перед возвратом к приложению. Значение по умолчанию зависит от драйвера. Если *ValuePtr* равно 0, время ожидания будет отключена и попытка подключения будет ждать бесконечно долго.<br /><br /> Если заданное время ожидания превышает время ожидания максимальное входа в источник данных, драйвер заменяет это значение и возвращает SQLSTATE 01S02 (значение параметра изменено).|  
|SQL_ATTR_METADATA_ID (ODBC 3.0)|SQLUINTEGER значение, которое определяет, как обрабатываются строковые аргументы функций работы с каталогами.<br /><br /> Если SQL_TRUE, строковый аргумент функции работы с каталогами, интерпретируются как идентификаторы. Регистр не имеет значения. Для nondelimited строк драйвер удаляет пробелы и строка складывается в верхний регистр. Для строки с разделителями драйвер удаляет все начальные и конечные пробелы и принимает практически все, что между разделителями. Если один из этих аргументов имеет значение является пустым указателем, функция возвращает значение SQL_ERROR и SQLSTATE HY009 (недопустимое использование пустого указателя).<br /><br /> Если значение SQL_FALSE, что строковые аргументы функций каталога не интерпретируются как идентификаторы. Регистр имеет значение. Они могут содержать либо строку шаблона поиска или нет, в зависимости от аргумента.<br /><br /> Значение по умолчанию — SQL_FALSE.<br /><br /> *TableType* аргумент **SQLTables**, который принимает несколько значений, не зависит от этого атрибута.<br /><br /> SQL_ATTR_METADATA_ID можно также задать на уровне инструкций. (Это подключение только атрибут, который также имеет атрибут инструкции).<br /><br /> Дополнительные сведения см. в разделе [аргументов функций каталога](../../../odbc/reference/develop-app/arguments-in-catalog-functions.md).|  
|SQL_ATTR_ODBC_CURSORS (ODBC 2.0)|SQLULEN значение, указывающее, как диспетчер драйверов использует библиотеку курсоров ODBC:<br /><br /> SQL_CUR_USE_IF_NEEDED = библиотеку курсоров ODBC Driver Manager использует только в том случае, если это требуется. Если драйвер поддерживает параметр SQL_FETCH_PRIOR в **SQLFetchScroll**, диспетчер драйверов использует функции прокрутки драйвера. В противном случае он использует библиотеку курсоров ODBC.<br /><br /> SQL_CUR_USE_ODBC = The Driver Manager использует библиотеку курсоров ODBC.<br /><br /> SQL_CUR_USE_DRIVER = The Driver Manager использует возможности прокрутки драйвера. Это параметр по умолчанию.<br /><br /> Дополнительные сведения о библиотеке курсоров ODBC см. в разделе [библиотека курсоров ODBC приложение F:](../../../odbc/reference/appendixes/appendix-f-odbc-cursor-library.md). **Предупреждение:** библиотеку курсоров будут удалены в будущих версиях Windows. Избегайте использования этой возможности в новых разработках и запланируйте изменение приложений, которые сейчас ее используют. Корпорация Майкрософт рекомендует использовать функциональность курсора драйвера.|  
|SQL_ATTR_PACKET_SIZE (ODBC 2.0)|SQLUINTEGER значение, указывающее размер сетевого пакета в байтах. **Примечание:** многие источники данных не поддерживают этот параметр или только возвращаемого но не задается размер сетевого пакета. <br /><br /> Если указанный размер превышает максимальный размер пакета или меньше, чем минимальный размер пакета, драйвер заменяет это значение и возвращает SQLSTATE 01S02 (значение параметра изменено).<br /><br /> Если приложение устанавливает размер пакета после подключение уже установлено, драйвер вернет SQLSTATE HY011 (атрибут нельзя установить сейчас).|  
|SQL_ATTR_QUIET_MODE (ODBC 2.0)|Дескриптор окна (HWND).<br /><br /> Если дескриптор является указателем null, драйвер не отображает все диалоговые окна.<br /><br /> Если дескриптор не является указателем null, он должен быть дескриптор родительского окна приложения. Это значение по умолчанию. Драйвер использует этот дескриптор для отображение диалоговых окон. **Примечание:** SQL_ATTR_QUIET_MODE атрибут соединения не применяется к диалоговым окнам, отображаемого элементом **SQLDriverConnect**.|  
|SQL_ATTR_TRACE (ODBC 1.0)|Значение SQLUINTEGER, предписывая диспетчера драйверов, следует ли выполнять трассировку:<br /><br /> SQL_OPT_TRACE_OFF = трассировка off (по умолчанию)<br /><br /> SQL_OPT_TRACE_ON = трассировки на<br /><br /> Если трассировка включена, диспетчер драйверов записывает каждого вызова функции ODBC в файл трассировки. **Примечание:** когда трассировка включена, диспетчер драйверов может вернуть SQLSTATE IM013 (Ошибка файла трассировки) из любой функции. <br /><br /> Приложение указывает файл трассировки с параметром SQL_ATTR_TRACEFILE. Если файл уже существует, диспетчер драйверов добавляет в файл. В противном случае она создает файл. Если трассировка включена, и файлов трассировки не был указан, файл SQL записывает диспетчера драйверов. ВОЙДИТЕ в корневом каталоге.<br /><br /> Приложение может установить переменную **ODBCSharedTraceFlag** для включения трассировки динамически. Для всех приложений ODBC запущен в настоящее время включена трассировка. Если приложение отключает трассировку, он отключается только для этого приложения.<br /><br /> Если **трассировки** ключевое слово в сведениях о системе имеет значение 1, когда приложение вызывает **SQLAllocHandle** с *HandleType* установленным в значение sql_handle_env, трассировка включена для всех обрабатывает. Она включена только для приложения, которое вызвало **SQLAllocHandle**.<br /><br /> Вызов **SQLSetConnectAttr** с *атрибута* из SQL_ATTR_TRACE не требует *ConnectionHandle* аргумент быть допустимым и не вернет значение SQL_ERROR, если *ConnectionHandle* имеет значение NULL. Этот атрибут применяется ко всем соединениям.|  
|SQL_ATTR_TRACEFILE (ODBC 1.0)|Символом null строка, содержащая имя файла трассировки.<br /><br /> Значение по умолчанию атрибута SQL_ATTR_TRACEFILE указан с **TraceFile** ключевое слово в сведениях о системе. Дополнительные сведения см. в разделе [ODBC подраздел](../../../odbc/reference/install/odbc-subkey.md).<br /><br /> Вызов **SQLSetConnectAttr** с *атрибута* из файла ТРАССИРОВКИ SQL_ATTR_ не требует *ConnectionHandle* аргумент недействителен и не вернет значение SQL_ERROR, если *ConnectionHandle* является недопустимым. Этот атрибут применяется ко всем соединениям.|  
|ПОМОЩЬЮ НАСТРОЙКИ SQL_ATTR_TRANSLATE_LIB (ODBC 1.0)|Символом null строку, содержащую имя библиотеки, содержащих функции **трансляции SQLDriverToDataSource** и **SQLDataSourceToDriver** , драйвер обращается к для выполнения задач, таких как Перевод набора знаков. Этот параметр может быть указан, если драйвер подключен к источнику данных. Значение этого атрибута будет сохраняться по подключениям. Дополнительные сведения о преобразовании данных см. в разделе [DLL перевода](../../../odbc/reference/develop-app/translation-dlls.md) и [ссылка на функцию DLL перевода](../../../odbc/reference/syntax/translation-dll-api-reference.md).|  
|SQL_ATTR_TRANSLATE_OPTION (ODBC 1.0)|32-битовый флаг, значение, передаваемое трансляции (DLL). Этот атрибут может быть указан, если драйвер подключен к источнику данных. Сведения о преобразовании данных см. в разделе [DLL перевода](../../../odbc/reference/develop-app/translation-dlls.md).|  
|SQL_ATTR_TXN_ISOLATION (ODBC 1.0)|32-разрядное битовую маску, которая задает уровень изоляции транзакции для текущего соединения. Приложение должно вызвать **SQLEndTran** для фиксации или отката транзакции все открытые соединения, перед вызовом метода **SQLSetConnectAttr** с этим параметром.<br /><br /> Допустимые значения для *ValuePtr* можно определить путем вызова **SQLGetInfo** с *свойство* равно SQL_TXN_ISOLATION_OPTIONS.<br /><br /> Описание уровней изоляции транзакций, см. в описании типа сведения SQL_DEFAULT_TXN_ISOLATION в [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) и [уровни изоляции транзакций](../../../odbc/reference/develop-app/transaction-isolation-levels.md).|  
  
 [1] Эти функции могут вызываться асинхронно только в том случае, если дескриптор является дескриптор реализации не дескриптор приложения.  
  
## <a name="code-example"></a>Пример кода  
 В разделе [SQLConnect](../../../odbc/reference/syntax/sqlconnect-function.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Выделение дескриптора|[Функция SQLAllocHandle](../../../odbc/reference/syntax/sqlallochandle-function.md)|  
|Возврат значения атрибута соединения|[Функция SQLGetConnectAttr](../../../odbc/reference/syntax/sqlgetconnectattr-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справочник по API-интерфейса ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)

