---
title: Функция SQLRemoveDriverManager | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: conceptual
apiname:
- SQLRemoveDriverManager
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLRemoveDriverManager
helpviewer_keywords:
- SQLRemoveDriverManager function function [ODBC]
ms.assetid: 3a41511f-6603-4b81-a815-7883874023c4
caps.latest.revision: 13
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 4ba1ba5d7f84da500f3887bf1684523f5501e9b1
ms.sourcegitcommit: 2ddc0bfb3ce2f2b160e3638f1c2c237a898263f4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="sqlremovedrivermanager-function"></a>Функция SQLRemoveDriverManager
**Соответствия**  
 Впервые введенная версии версии: ODBC 3.0: не рекомендуется на пакет обновления 2 для Windows XP, Windows Server 2003 с пакетом обновления 1 и более поздних операционных системах.  
  
 **Сводка**  
 **SQLRemoveDriverManager** изменяет или удаляет сведения о внутренних компонентах ODBC из файла Odbcinst.ini запись сведений о системе.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
BOOL SQLRemoveDriverManager(  
     LPDWORD     pdwUsageCount);  
```  
  
## <a name="arguments"></a>Аргументы  
 *pdwUsageCount*  
 [Выход] Счетчик использования из диспетчера драйверов после вызова этой функции.  
  
## <a name="returns"></a>Возвращает  
 Функция возвращает значение TRUE, если он прошел успешно, FALSE в случае неудачи. Если не существует запись сведений о системе при вызове этой функцией, функция возвращает значение FALSE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLRemoveDriverManager** возвращает значение FALSE, связанный с ним  *\*pfErrorCode* значение можно получить путем вызова **SQLInstallerError**. В следующей таблице перечислены  *\*pfErrorCode* значения, которые могут быть возвращены **SQLInstallerError** и описание каждого из них в контексте этой функции.  
  
|*\*pfErrorCode*|Ошибка|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Установщик Общие ошибки|Произошла ошибка для которого нет ошибок определенного установщика.|  
|ODBC_ERROR_COMPONENT_NOT_FOUND|Компонент не найден в реестре|Программе установки не удалось удалить сведения диспетчера драйверов, поскольку не существует в реестре или не найден в реестре.|  
|ODBC_ERROR_USAGE_UPDATE_FAILED|Не удалось увеличить или уменьшить загруженность в компонент|Программа установки не удалось уменьшить значение счетчика использования диспетчера драйверов.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Программе установки не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="comments"></a>Комментарии  
 **SQLRemoveDriverManager** дополняет **SQLInstallDriverManager** функции и обновления, использование компонентов количество сведений о системе. Эта функция должна вызываться только из программы установки приложения.  
  
 **SQLRemoveDriverManager** уменьшит счетчик использования компонента ядра на 1. Если счетчик использования компонента становится равным 0, будут удалены сведения о системе запись. Запись компонент ядра находится в папке сведения о системе, под заголовком «Core ODBC»:  
  
 `HKEY_LOCAL_MACHINE`  
  
 `SOFTWARE`  
  
 `ODBC`  
  
 `Odbcinst.ini`  
  
> [!CAUTION]  
>  Приложения не должны физически удалить файлы диспетчера драйверов, когда счетчик использования компонента и счетчик использования файла достигнет нуля.  
  
 **SQLRemoveDriverManager** фактически не удалять файлы. Поддержка использования файла количество установок и вызывающая программа отвечает за удаление файлов. Диспетчер драйверов файлы должны храниться в секрете, тем не менее, будут удалены после счетчик использования компонента и счетчик использования файла равно нулю, так как эти файлы могут использоваться другими приложениями, которые не имеют увеличивается счетчик использования файла.  
  
 **SQLRemoveDriverManager** вызывается как часть процесса удаления. Основные компоненты ODBC (в том числе диспетчера драйверов, библиотека курсоров, установщик, библиотека языка, администратор, создание файлов и т. д) удаляются как единое целое. Следующие файлы не будут удалены при **SQLRemoveDriverManager** вызывается как часть процесса удаления:  
  
|||  
|-|-|  
|ODBC32DLL|ODBCCP32. БИБЛИОТЕКИ DLL|  
|ODBCCR32. БИБЛИОТЕКИ DLL|ODBC16GT. БИБЛИОТЕКИ DLL|  
|ODBCCU32. БИБЛИОТЕКИ DLL|ODBC32GT. БИБЛИОТЕКИ DLL|  
|ODBCINT. БИБЛИОТЕКИ DLL|DS16GT. БИБЛИОТЕКИ DLL|  
|ODBCTRAC. БИБЛИОТЕКИ DLL|DS32GT. БИБЛИОТЕКИ DLL|  
|MSVCRT40. БИБЛИОТЕКИ DLL|ODBCAD32. EXE-ФАЙЛА|  
|ODBCCP32. ДИАЛОГОВОГО||  
  
 **SQLRemoveDriverManager** также вызывается как часть процесса обновления. Если приложение обнаруживает, что он должен выполнить обновление, и ранее установил драйвера, драйвер следует удалить и переустановить.  
  
 **SQLRemoveDriverManager** сначала должен вызываться для уменьшения числа использования компонента. **SQLInstallDriverEx** должен быть вызван, затем, чтобы увеличить счетчик использования компонента. Программа установки необходимо заменить старый основные файлы компонента новые файлы. Счетчики использования файл остается без изменений, и других приложений, использующих более старые версии основные файлы компонента теперь будет использовать более новые версии файлов.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Установка диспетчера драйверов|[SQLInstallDriverManager](../../../odbc/reference/syntax/sqlinstalldrivermanager-function.md)|
