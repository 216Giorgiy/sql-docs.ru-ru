---
title: Функция SQLCancelHandle | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: article
f1_keywords:
- SQLCancelHandle
helpviewer_keywords:
- SQLCancelHandle function [ODBC]
ms.assetid: 16049b5b-22a7-4640-9897-c25dd0f19d21
caps.latest.revision: 22
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 3760400f23b558c27cd70a3ecd288171cbd56534
ms.sourcegitcommit: cc71f1027884462c359effb898390c8d97eaa414
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="sqlcancelhandle-function"></a>Функция SQLCancelHandle
**Соответствия**  
 Появился в версии: ODBC 3.8  
  
 Соответствие стандартам: нет  
  
 Ожидается, что большинство ODBC 3.8 (и более поздние версии) драйверов реализует эту функцию. Если драйвер отсутствует, вызов **SQLCancelHandle** с подключением обрабатывать *обработки* параметр вернет значение SQL_ERROR с SQLSTATE IM001 и сообщением "драйвер не поддерживает эту функцию '' вызов для **SQLCancelHandle** с инструкцией обрабатывать как *обработки* параметр будет сопоставлено вызов **SQLCancel** диспетчером драйверов и могут быть обработаны, если в драйвере реализованы **SQLCancel**. Приложение может использовать **SQLGetFunctions** , чтобы определить, поддерживает ли драйвер **SQLCancelHandle**.  
  
 **Сводка**  
 **SQLCancelHandle** отменяет обработку на подключение или инструкции. Диспетчер драйверов сопоставляет вызов **SQLCancelHandle** вызова **SQLCancel** при *HandleType* имеет значение SQL_HANDLE_STMT.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
SQLRETURN SQLCancelHandle(  
      SQLSMALLINT  HandleType,  
      SQLHANDLE    Handle);  
```  
  
## <a name="arguments"></a>Аргументы  
 *HandleType*  
 [Вход] Тип дескриптора на котором cacel обработки. Допустимые значения: SQL_HANDLE_DBC или значение SQL_HANDLE_STMT.  
  
 *Дескриптор*  
 [Вход] Дескриптор, в которых требуется отменить обработку.  
  
 Если *обработки* не является допустимым дескриптором типа, заданного параметром *HandleType*, **SQLCancelHandle** возвращает SQL_INVALID_HANDLE.  
  
## <a name="returns"></a>Возвращает  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, значение SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLCancelHandle** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, соответствующее значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *HandleType* из Значение SQL_HANDLE_STMT и инструкции обработки *обработки* или *HandleType* SQL_HANDLE_DBC и дескриптор соединения *обработки*.  
  
 В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые **SQLCancelHandle** и описание каждого из них в контексте этой функции; нотации «(DM)» предшествует описания SQLSTATE, возвращаемых диспетчером драйверов. Код возврата, связанные с каждым из значений SQLSTATE — это SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Description|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, относящиеся к драйверу. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет определенных SQLSTATE и для которого был определен SQLSTATE не зависит от реализации. Сообщение об ошибке, возвращенные [SQLGetDiagRec](../../../odbc/reference/syntax/sqlgetdiagrec-function.md) в аргументе  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйверу не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|Функция асинхронного выполнения, связанных с инструкции была вызвана для одного из дескрипторов инструкций, связанных с *обработки*, и *HandleType* было задано значение SQL_HANDLE_DBC. Выполняется при асинхронной функция **SQLCancelHandle** был вызван.<br /><br /> (DM) *HandleType* аргумент имеет значение SQL_HANDLE_STMT; асинхронного выполнения функция вызывается для дескриптора связанное соединение, и функция выполнялась по-прежнему при вызове этой функции.<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**, или **SQLMoreResults** был вызван для одного из дескрипторов инструкций, связанных с *обработки* и *HandleType* имеющим значение SQL_HANDLE_DBC и возвращается SQL_PARAM_DATA_AVAILABLE. До получения данных для всех параметров потоковой вызове этой функции.<br /><br /> **SQLBrowseConnect** был вызван для *ConnectionHandle*и возвращается значение SQL_NEED_DATA. Эта функция вызывался перед обзора процесс завершился.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, поскольку базовые объекты памяти будет недоступен, возможно из-за нехватки памяти.|  
|HY092|Недопустимый атрибут идентификатор или параметра|*HandleType* было задано значение SQL_HANDLE_ENV или SQL_HANDLE_DESC.|  
|HY117|Соединение будет приостановлена из-за неизвестной транзакции состояния. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о состоянии приостановки см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYT01|Время ожидания соединения истекло|Время ожидания соединения истекло раньше, чем ответил на запрос источника данных. Время ожидания задается с помощью **SQLSetConnectAttr**, sql_attr_connection_timeout не учитывается.|  
|IM001|Драйвер не поддерживает эту функцию|Драйвер (DM), связанные с *обработки* не поддерживает функцию.|  
  
 Если **SQLCancelHandle** вызывается с *HandleType* присвоено значение SQL_HANDLE_STMT, она может возвращать любой SQLSTATE, возвращаемой функцией **SQLCancel**.  
  
## <a name="comments"></a>Комментарии  
 Эта функция аналогична **SQLCancel** , но может занять дескриптор подключения или инструкции, как параметр, а не только дескриптор инструкции. Диспетчер драйверов сопоставляет вызов **SQLCancelHandle** вызова **SQLCancel** при *HandleType* имеет значение SQL_HANDLE_STMT. Это позволяет приложениям использовать **SQLCancelHandle** для отмены инструкции операции, даже если драйвер не реализует **SQLCancelHandle**.  
  
 Дополнительные сведения об отмене операции инструкции см. в разделе [SQLCancel, функция](../../../odbc/reference/syntax/sqlcancel-function.md).  
  
 Если нет операций выполняется на *обработки* вызов **SQLCancelHandle** не делает ничего.  
  
 **SQLCancelHandle** подключение дескриптор можно отменить следующие типы обработки:  
  
-   Функция, работающего асинхронно на соединение.  
  
-   Функции, работающей на дескриптор соединения в другом потоке.  
  
 Когда **SQLCancelHandle** вызывается для отмены функции работающего асинхронно в соединении, отправленная диагностические записи **SQLCancelHandle** добавляются в тех, которые возвращаются из-за операции отменено; **SQLCancelHandle** не возвращает диагностических записей, однако при отмене функции, работающей на подключение в другом потоке.  
  
 С помощью **SQLCancelHandle** отменить **SQLEndTran** может сделать соединение в приостановленном состоянии. Дополнительные сведения о состоянии приостановки. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).  
  
> [!NOTE]  
>  Дополнительные сведения об использовании **SQLCancelHandle** в приложении, которое будет развертываться в операционной системе Windows, более ранней, чем Windows 7, в разделе [Матрица совместимости](../../../odbc/reference/develop-app/compatibility-matrix.md).  
  
#### <a name="canceling-connection-related-asynchronous-processing"></a>Отмена асинхронной обработки, относящиеся к соединению  
 Если функция возвращает значение SQL_STILL_EXECUTING, приложение может вызвать **SQLCancelHandle** для отмены операции. Если запрос на отмену прошла успешно, **SQLCancelHandle** возвращает SQL_SUCCESS. Это не означает, что и первоначальная функция была отменена; Указывает, что запрос на отмену был обработан. Драйвер и источника данных определите при или операция отменена. Приложение должно продолжить вызывать и первоначальная функция, пока код возврата не SQL_STILL_EXECUTING. — Если первоначальная функция была отменена, код возврата SQL_ERROR и SQLSTATE HY008 (операция отменена). Если исходной функции завершения обработки (не было отменено), код возврата равен SQL_SUCCESS или SQL_SUCCESS_WITH_INFO, или значение SQL_ERROR и SQLSTATE, отличные от HY008 (операция отменена), если сбой исходной функции.  
  
#### <a name="canceling-functions-executing-on-another-thread"></a>Отмена функции выполнение на другой поток  
 В многопоточных приложений приложение можно отменить операцию, которая выполняется в другом потоке. Чтобы отменить операцию, приложение вызывает **SQLCancelHandle** с дескриптором, используемые функцией, но в другом потоке. Драйвера и операционной системы определяют, как операция отменена. **SQLCancelHandle** возвращают код указывает, обрабатывается ли драйвер запрос, возвращая значение SQL_SUCCESS или SQL_ERROR (диагностические данные не возвращаются). При отмене обработки на исходную функцию и первоначальная функция возвращает значение SQL_ERROR и SQLSTATE HY008 (операция отменена).  
  
 Если функция выполняется при **SQLCancelHandle** вызывается в другом потоке отменить функция возможна функция завершиться успешно и вернуть значение SQL_SUCCESS, чтобы Отмена вступило в силу. Вызов **SQLCancelHandle** имеет смысл, если операция завершена, прежде чем **SQLCancelHandle** была возможность отменить операцию.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Отмена функции работающего асинхронно на дескриптор инструкции, Отмена функцию в инструкцию, которая требует данные или Отмена функции, работающей на инструкцию в другом потоке.|[Функция SQLCancel](../../../odbc/reference/syntax/sqlcancel-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справочник по API-интерфейса ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовка ODBC](../../../odbc/reference/install/odbc-header-files.md)   
 [Асинхронное выполнение (метод опроса)](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md)
