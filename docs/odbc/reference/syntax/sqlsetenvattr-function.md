---
title: Функция SQLSetEnvAttr | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: conceptual
apiname:
- SQLSetEnvAttr
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLSetEnvAttr
helpviewer_keywords:
- SQLSetEnvAttr function [ODBC]
ms.assetid: 0343241c-4b15-4d4b-aa2b-2e8ab5215cd2
caps.latest.revision: 38
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: f0593bf413a9d3341927f8108df4e6a490efa927
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="sqlsetenvattr-function"></a>SQLSetEnvAttr, функция
**Соответствия**  
 Появился в версии: ODBC 3.0 нормативных требований: ISO-92  
  
 **Сводка**  
 **SQLSetEnvAttr** задает атрибуты, которые управляют аспектами сред.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
SQLRETURN SQLSetEnvAttr(  
     SQLHENV      EnvironmentHandle,  
     SQLINTEGER   Attribute,  
     SQLPOINTER   ValuePtr,  
     SQLINTEGER   StringLength);  
```  
  
## <a name="arguments"></a>Аргументы  
 *EnvironmentHandle*  
 [Вход] Дескриптор среды.  
  
 *Атрибут*  
 [Вход] Атрибут для задания, перечисленные в «Комментарии».  
  
 *ValuePtr*  
 [Вход] Указатель на значение должны быть связаны с *атрибут*. В зависимости от значения *атрибута*, *ValuePtr* будут 32-разрядное целочисленное значение, или выберите строку, завершающуюся значением null.  
  
 *stringLength*  
 [Вход] Если *ValuePtr* указывает на строку символов или двоичных буфера, данный аргумент должен иметь длину **ValuePtr*. Для символьных строковых данных этот аргумент должен содержать число байтов в строку.  
  
 Если *ValuePtr* является целым числом, *StringLength* учитывается.  
  
## <a name="returns"></a>Возвращает  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, значение SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLSetEnvAttr** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, соответствующее значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *HandleType* из SQL_ HANDLE_ENV и *обработки* из *EnvironmentHandle*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые **SQLSetEnvAttr** и описание каждого из них в контексте этой функции; нотации «(DM)» предшествует описания SQLSTATE, возвращаемых диспетчером драйверов. Код возврата, связанные с каждым из значений SQLSTATE — это SQL_ERROR, если не указано иное. Если драйвер не поддерживает атрибут среды, ошибки могут возвращаться только во время подключения.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, относящиеся к драйверу. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|01S02|Значение параметра изменено|Драйвер не поддерживает значение, указанное в *ValuePtr* и заменить примерно такое же значение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет определенных SQLSTATE и для которого был определен SQLSTATE не зависит от реализации. Сообщение об ошибке, возвращенные **SQLGetDiagRec** в  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйверу не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY009|Недопустимое использование пустого указателя|Аргумент атрибута определяемого среды атрибут, который требуется строковое значение, и *ValuePtr* аргумент был пустым указателем.|  
|HY010|Ошибка последовательности функций|(DM) на выделенного дескриптора соединения *EnvironmentHandle*.<br /><br /> (DM) **SQL_ATTR_ODBC_VERSION** не было задано с **SQLSetEnvAttr** и *атрибута* не равно **SQL_ATTR_ODBC_VERSION**. Не нужно задавать **SQL_ATTR_ODBC_VERSION** явным образом в том случае, если вы используете **SQLAllocHandleStd**.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, поскольку базовые объекты памяти будет недоступен, возможно из-за нехватки памяти.|  
|HY024|Недопустимое значение атрибута|Получает указанный *атрибута* значение, недопустимое значение было указано в *ValuePtr*.|  
|HY090|Недопустимая длина строки или буфера|*StringLength* аргумент был не меньше 0 но SQL_NTS.|  
|HY092|Недопустимый атрибут идентификатор или параметра|(DM) значение, указанное для аргумента *атрибут* не подходит для версии поддерживаются драйвером ODBC.|  
|HY117|Соединение будет приостановлена из-за неизвестной транзакции состояния. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о состоянии приостановки см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYC00|Дополнительная возможность не реализована|Значение, указанное для аргумента *атрибут* был допустимым атрибутом среды ODBC для используемая версия ODBC, поддерживаемых драйвером, но не поддерживается драйвером.<br /><br /> (DM) *атрибута* аргумент был SQL_ATTR_OUTPUT_NTS, и *ValuePtr* был SQL_FALSE.|  
  
## <a name="comments"></a>Комментарии  
 Приложение может вызвать **SQLSetEnvAttr** только в том случае, если ни один дескриптор соединения выделяется в среде. Все атрибуты среды успешно установлены приложением для среды сохраняется до **SQLFreeHandle** вызывается в среде. Более одного дескриптора среды может находиться одновременно в ODBC 3 *.x*.  
  
 Формат данных, заданные с помощью *ValuePtr* зависит от указанного *атрибут*. **SQLSetEnvAttr** будет принимать данные атрибут в одной из двух различных форматов: строка символов с завершающим нулем или 32-разрядное целочисленное значение. Недопустимый формат, указывается в описание атрибута.  
  
 Нет никаких атрибутов драйвера среды.  
  
 Невозможно задать атрибуты соединения с помощью вызова **SQLSetEnvAttr**. При попытке сделать это будет возвращать SQLSTATE (равным hy092) (идентификатор недопустимый атрибута или параметра).  
  
|*Атрибут*|*ValuePtr* содержимое|  
|-----------------|-------------------------|  
|SQL_ATTR_CONNECTION_POOLING (ODBC 3.8)|32-разрядное значение SQLUINTEGER, включает или отключает использование пулов соединений на уровне среды. Используются следующие значения:<br /><br /> SQL_CP_OFF = соединение пула отключено. Это значение по умолчанию.<br /><br /> SQL_CP_ONE_PER_DRIVER = один пул соединений, поддерживаемые для каждого драйвера. Каждое соединение в пуле связан один драйвер.<br /><br /> SQL_CP_ONE_PER_HENV = один пул соединений поддерживается для каждой среды. Каждое соединение в пуле связан с одной среды.<br /><br /> SQL_CP_DRIVER_AWARE = использование пула соединений функции учета драйвера, если он доступен. Если драйвер не поддерживает осведомленности пул подключений, SQL_CP_DRIVER_AWARE игнорируется и используется SQL_CP_ONE_PER_HENV. Дополнительные сведения см. в разделе [Driver-Aware Connection Pooling](../../../odbc/reference/develop-app/driver-aware-connection-pooling.md). В среде, где некоторые драйверы поддерживают и некоторые драйверы не поддерживают доступность сведений о пуле соединений SQL_CP_DRIVER_AWARE можно включить функцию осведомленности пул соединений на их поддержка драйверов, но это эквивалентно следующей настройке для SQL_CP_ONE_PER_HENV на те драйверы, которые не поддерживают функцию осведомленности пула соединений.<br /><br /> Организация пулов соединений включена, вызвав **SQLSetEnvAttr** для задания атрибута SQL_ATTR_CONNECTION_POOLING SQL_CP_ONE_PER_DRIVER или SQL_CP_ONE_PER_HENV. Необходимо выполнить этот вызов, прежде чем приложение выделяет общей среды для какое подключение пулов которого необходимо включить. Дескриптор среды в вызове **SQLSetEnvAttr** имеет значение null, что делает SQL_ATTR_CONNECTION_POOLING атрибут уровня процесса. После включения пула подключений, затем приложение выделяет неявное общей среде путем вызова **SQLAllocHandle** с *InputHandle* аргумент значение SQL_HANDLE_ENV.<br /><br /> После включения пула подключений и общей среде был выбран для приложения, SQL_ATTR_CONNECTION_POOLING невозможно сбросить для этой среды, поскольку **SQLSetEnvAttr** вызывается с null среды Дескриптор, при задании этого атрибута. Если этот атрибут задан, хотя организация пулов соединений уже включен в общей среде, атрибут влияет только общей среды, в которых выделяются впоследствии.<br /><br /> Можно также включить пул подключений в среде. Обратите внимание на следующие об организации пулов соединений среды:<br /><br /> — Включение в дескрипторе NULL пулы соединений является атрибутом уровня процесса. Впоследствии выделенных сред будет общей среде и будут наследовать настройки пула подключений уровня процесса.<br />-После выделенной среде, приложение по-прежнему можно изменить его настройки пула подключений.<br />-Если включен пул соединений среды и соединения драйвер использует драйвер Создание пулов, пул среды принимает предпочтения.<br /><br /> SQL_ATTR_CONNECTION_POOLING реализуется внутри диспетчера драйверов. Драйвер не требуется реализовывать SQL_ATTR_CONNECTION_POOLING. Этот атрибут среды можно задать ODBC 2.0 и 3.0 приложения.<br /><br /> Дополнительные сведения см. в разделе [пул соединений ODBC](../../../odbc/reference/develop-app/driver-manager-connection-pooling.md).|  
|SQL_ATTR_CP_MATCH (ODBC 3.0)|32-разрядное значение SQLUINTEGER, определяющее, как выбрать подключение из пула соединений. Когда **SQLConnect** или **SQLDriverConnect** — вызывается, диспетчер драйверов определяет какое соединение используется повторно из пула. Диспетчер драйверов предпринимается попытка подключения в параметры вызова и атрибуты соединения, установленные приложением ключевые слова и атрибуты соединения подключений в пуле. Значение этого атрибута определяет уровень точности, соответствующие условиям.<br /><br /> Чтобы задать значение этого атрибута используются следующие значения:<br /><br /> SQL_CP_STRICT_MATCH = только подключения, которые точно соответствуют параметры соединения в вызове и соединения, которые многократно используются атрибуты, заданные приложением. Это значение по умолчанию.<br /><br /> SQL_CP_RELAXED_MATCH = соединения с соответствующим можно использовать ключевые слова строки подключения. Ключевые слова должны совпадать, но не все атрибуты соединения должны совпадать.<br /><br /> Дополнительные сведения о выполнение соответствия соединения в пуле, соединение диспетчера драйверов см. в разделе [SQLConnect](../../../odbc/reference/syntax/sqlconnect-function.md). Дополнительные сведения об использовании пулов подключений см. в разделе [пул соединений ODBC](../../../odbc/reference/develop-app/driver-manager-connection-pooling.md).|  
|SQL_ATTR_ODBC_VERSION (ODBC 3.0)|32-разрядное целое число, которое определяет, видно ли некоторые функции ODBC 2 *.x* поведение или ODBC 3 *.x* поведение. Чтобы задать значение этого атрибута используются следующие значения:<br /><br /> SQL_OV_ODBC3_80 = диспетчера драйверов и поведение приложение следующие ODBC 3.8 драйвера:<br /><br /> -Ожидает ODBC 3 драйвер возвращает *x* коды для даты, времени и отметок времени.<br />-Драйвер возвращает ODBC 3. *x* коды SQLSTATE, когда **SQLError**, **SQLGetDiagField**, или **SQLGetDiagRec** вызывается.<br />- *CatalogName* аргумента в вызове **SQLTables** принимает шаблону поиска.<br />-Driver Manager поддерживает возможность расширения типа данных C. Дополнительные сведения о расширяемости тип данных C в разделе [типы данных C в ODBC](../../../odbc/reference/develop-app/c-data-types-in-odbc.md).<br /><br /> Дополнительные сведения см. в разделе [новые возможности ODBC 3.8](../../../odbc/reference/what-s-new-in-odbc-3-8.md).<br /><br /> Значение SQL_OV_ODBC3 = диспетчера драйверов и приложение драйвера ODBC в следующие 3 *.x* поведение:<br /><br /> -Возвращает драйвер и ожидает ODBC 3 *.x* коды для даты, времени и отметок времени.<br />-Драйвер возвращает ODBC 3 *.x* коды SQLSTATE, когда **SQLError**, **SQLGetDiagField**, или **SQLGetDiagRec** вызывается.<br />- *CatalogName* аргумента в вызове **SQLTables** принимает шаблону поиска.<br />-Диспетчер драйверов не поддерживает возможность расширения типа данных C.<br /><br /> SQL_OV_ODBC2 = диспетчера драйверов и приложение драйвера ODBC в следующие 2 *.x* поведение. Это особенно полезно для ODBC 2 *.x* приложения, работа с ODBC 3 *.x* драйвера.<br /><br /> -Возвращает драйвер и ожидает ODBC 2 *.x* коды для даты, времени и отметок времени.<br />-Драйвер возвращает ODBC 2 *.x* коды SQLSTATE, когда **SQLError**, **SQLGetDiagField**, или **SQLGetDiagRec** вызывается.<br />- *CatalogName* аргумента в вызове **SQLTables** не принимает шаблон поиска.<br />-Диспетчер драйверов не поддерживает возможность расширения типа данных C.<br /><br /> Приложение должно установить этот атрибут среды, перед вызовом любой функции, которая имеет аргумент SQLHENV или вызов вернет SQLSTATE HY010 (функция ошибка последовательности). Это специфические для драйвера, существует ли дополнительное поведение этих флагов окружающей среды.<br /><br /> — Дополнительные сведения см. в разделе [объявление приложения ODBC версии](../../../odbc/reference/develop-app/declaring-the-application-s-odbc-version.md) и [изменения поведения](../../../odbc/reference/develop-app/behavioral-changes.md).|  
|SQL_ATTR_OUTPUT_NTS (ODBC 3.0)|32-разрядное целое число, определяющее, как драйвер возвращает строковые данные. Если SQL_TRUE, драйвер возвращает строковые данные символом null. Если SQL_FALSE, драйвер не возвращает строковые данные символом null.<br /><br /> Этот атрибут по умолчанию равно SQL_TRUE. Вызов **SQLSetEnvAttr** задайте для него значение SQL_TRUE, возвращает значение SQL_SUCCESS. Вызов **SQLSetEnvAttr** присваивается значение SQL_FALSE возвращает значение SQL_ERROR и SQLSTATE HYC00 (дополнительная возможность не реализована).|  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Выделение дескриптора|[Функция SQLAllocHandle](../../../odbc/reference/syntax/sqlallochandle-function.md)|  
|Возврат значения атрибута среды|[Функция SQLGetEnvAttr](../../../odbc/reference/syntax/sqlgetenvattr-function.md)|  
  
## <a name="see-also"></a>См. также  
 [Справочник по API-интерфейса ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовка ODBC](../../../odbc/reference/install/odbc-header-files.md)   
 [Новые возможности ODBC 3.8](../../../odbc/reference/what-s-new-in-odbc-3-8.md)
