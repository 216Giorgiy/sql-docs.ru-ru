---
title: Обработка располагается инструкции Update и Delete | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- positioned deletes [ODBC]
- ODBC cursor library [ODBC], statement processing
- cursor library [ODBC], positioned update or delete
- positioned updates [ODBC]
- SQL statements [ODBC], cursor library
- ODBC cursor library [ODBC], positioned update or delete
- cursor library [ODBC], statement processing
ms.assetid: 2975dd97-48e6-4d0a-a9c7-40759a7d94c8
caps.latest.revision: 9
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: b61339950d43579a88c6a7ca5f90de4e254ff05f
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "32908249"
---
# <a name="processing-positioned-update-and-delete-statements"></a>Обработка располагается инструкции Update и Delete
> [!IMPORTANT]  
>  Этот компонент будет удален в будущих версиях Windows. Избегайте использования этой возможности в новых разработках и запланируйте изменение приложений, которые сейчас ее используют. Корпорация Майкрософт рекомендует использовать функциональность курсора драйвера.  
  
 Драйвер поддерживает библиотеку курсор располагается инструкции update и delete, заменив **WHERE CURRENT OF** предложение в таких инструкциях с **ГДЕ** предложение, которое перечисляет значения, хранящиеся в кэше для каждого привязанного столбца. Библиотека курсоров передает нового созданного **обновление** и **удалить** инструкций в драйвере для выполнения. Для инструкций позиционированного обновления библиотеку курсоров обновляет свой кэш от значений в буферы строк и задает соответствующие значения в массиве строк состояния для SQL_ROW_UPDATED. Для инструкций delete позиционированные он задает соответствующее значение в массиве строк состояния для SQL_ROW_DELETED.  
  
> [!CAUTION]  
>  **ГДЕ** предложение, создаваемых библиотеку курсоров для идентификации текущей строки не удается определить все строки, определить другую строку или определить более одной строки. Дополнительные сведения см. в разделе [построение инструкции поиск](../../../odbc/reference/appendixes/constructing-searched-statements.md)далее в этом приложении.  
  
 Располагается update и delete инструкции распространяются следующие ограничения:  
  
-   Располагается update и delete операторы могут использоваться только в следующих случаях: когда **ВЫБЕРИТЕ** создания результирующего набора инструкции; когда **ВЫБЕРИТЕ** инструкция не содержит соединение,  **ОБЪЕДИНЕНИЕ** предложение, или **GROUP BY** предложения; и если все столбцы, которые используется псевдоним или выражение в списке выбора не связанных с **SQLBindCol**.  
  
-   Если приложение будет подготовлено позиционированного обновления или инструкции delete, его необходимо сделать после вызова **SQLFetch** или **SQLFetchScroll**. Несмотря на то, что библиотека курсоров отправляет инструкцию драйвера для подготовки, он закрывает инструкцию и выполняет его напрямую, когда приложение вызывает **SQLExecute**.  
  
-   Если драйвер поддерживает только одну активную инструкцию, выборки библиотеки курсора до конца результат набор и затем refetches текущего набора строк из своего кэша до начала выполнения позиционированных инструкцией обновления или удаления. Если затем приложение вызывает функцию, которая возвращает метаданные в результирующем наборе (например, **SQLNumResultCols** или **SQLDescribeCol**), библиотеку курсоров возвращает сообщение об ошибке.  
  
-   Если для столбца таблицы, содержащей столбец типа timestamp, автоматически обновляются при каждом выполнении обновления выполняется позиционированного обновления или инструкции delete, все последующие позиционированного обновления или инструкций delete завершится ошибкой, если столбец отметки времени привязки. Это происходит потому, что поисковое обновление или удаление инструкцию, которая создает библиотеку курсоров не точно определяет обновляемой строки. Значение, в которой выполняется поиск инструкции для столбца отметки времени не будет соответствовать автоматически измененное значение в столбец отметки времени.
