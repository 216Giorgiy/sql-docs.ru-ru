---
title: "Использование библиотеки курсоров ODBC | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- ODBC cursor library [ODBC], using cursor library
- cursor library [ODBC], using cursor library
ms.assetid: 9653f2f8-ccfc-4220-99ef-601dc0fa641c
caps.latest.revision: 8
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: db98c1cee3b31615ee515fd197427724a39c9433
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="using-the-odbc-cursor-library"></a>Использование библиотеки курсоров ODBC
> [!IMPORTANT]  
>  Этот компонент будет удален в будущих версиях Windows. Избегайте использования этой возможности в новых разработках и запланируйте изменение приложений, которые сейчас ее используют. Корпорация Майкрософт рекомендует использовать функциональность курсора драйвера.  
  
 Чтобы использовать библиотеку курсоров ODBC приложение:  
  
1.  Вызовы **SQLSetConnectAttr** с *атрибута* из SQL_ATTR_ODBC_CURSORS, чтобы указать способ использования библиотеки курсоров с определенного соединения. Библиотека курсоров может быть всегда использоваться (SQL_CUR_USE_ODBC), никогда не используется только в том случае, если драйвер не поддерживает прокручиваемые курсоры (SQL_CUR_USE_IF_NEEDED) или (SQL_CUR_USE_DRIVER).  
  
2.  Вызовы **SQLConnect**, **SQLDriverConnect**, или **SQLBrowseConnect** для подключения к источнику данных.  
  
3.  Вызовы **SQLSetStmtAttr** для указания типа курсора (SQL_ATTR_CURSOR_TYPE), параллелизма (SQL_ATTR_CONCURRENCY) и размер набора строк (SQL_ATTR_ROW_ARRAY_SIZE). Библиотека курсоров поддерживает однонаправленные и статические курсоры. Однопроходные курсоры должны быть доступны только для чтения, когда статические курсоры могут быть доступны только для чтения, или можно использовать управление оптимистичным параллелизмом, сравнения значений.  
  
4.  Выделяет один или несколько буферов набора строк и вызовы **SQLBindCol** один или несколько раз, чтобы привязать эти буферы, чтобы привести столбцы набора.  
  
5.  Создает результирующий набор, выполнив **ВЫБЕРИТЕ** инструкции или хранимой процедуры или путем вызова функции каталога. Если приложение выполняет инструкции позиционированное обновление, должна выполняться **ВЫБЕРИТЕ для обновления** инструкции для создания результирующего набора.  
  
6.  Вызовы **SQLFetch** или **SQLFetchScroll** один или несколько раз для прокрутки результирующего набора.  
  
 Приложение может изменить значения данных в буферы строк. Чтобы обновить буферы строк с данными из кэша библиотеку курсоров, приложение вызывает **SQLFetchScroll** с *FetchOrientation* аргументу присвоено SQL_FETCH_RELATIVE и  *FetchOffset* аргумент присвоено значение 0.  
  
 Для получения данных из несвязанного столбца, приложение вызывает **SQLSetPos** для позиционирования курсора на нужную строку. Затем он вызывает **SQLGetData** для извлечения данных.  
  
 Чтобы определить количество строк, которые получены из источника данных, приложение вызывает **SQLRowCount**.

