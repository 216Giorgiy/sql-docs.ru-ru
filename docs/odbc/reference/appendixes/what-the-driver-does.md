---
title: Что делает драйвер | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- scrollable cursors [ODBC]
- cursors [ODBC], backward compatibility
- compatibility [ODBC], cursors
- backward compatibility [ODBC], cursors
- block cursors [ODBC]
ms.assetid: 75dcdea6-ff6b-4ac8-aa11-a1f9edbeb8e6
caps.latest.revision: 6
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: fa114af7390d3ac4f971c507f508d8f747e134c3
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "32914099"
---
# <a name="what-the-driver-does"></a>Что делает драйвер
В следующей таблице перечислены какие функции и инструкции атрибутов ODBC 3 *.x* для блока и Прокручиваемые курсоры следует реализовывать драйвера.  
  
|Функция или<br /><br /> атрибут инструкции|Комментарии|  
|-----------------------------------------|--------------|  
|ЗНАЧЕНИЯ SQL_ATTR_ROW_STATUS_PTR|Задает адрес массив состояния строк заполненной **SQLFetch** и **SQLFetchScroll**. Этот массив заполняется также **SQLSetPos** Если **SQLSetPos** вызывается в состоянии инструкции S6. Если **SQLSetPos** вызывается в состоянии S7 этот массив не заполняется, но массива, на который указывает *RowStatusArray* аргумент **SQLExtendedFetch** заполняется. Дополнительные сведения см. в разделе [переходы инструкции](../../../odbc/reference/appendixes/statement-transitions.md) в приложении B: ODBC состояния перехода таблицах.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Задает адрес буфера, в которой **SQLFetch** и **SQLFetchScroll** возвращают число возвращаемых строк. Если **SQLExtendedFetch** является именем, буфер не заполнен, но *RowCountPtr* аргумент указывает на число возвращаемых строк.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Задает размер набора строк, используемых **SQLFetch** и **SQLFetchScroll**.|  
|SQL_ROWSET_SIZE|Задает размер набора строк, используемых **SQLExtendedFetch**. ODBC 3 *.x* драйверы реализовать это, если для работы с ODBC 2. *x* приложения, вызывающие **SQLExtendedFetch** или **SQLSetPos**.|  
|**SQLBulkOperations**|Если ODBC 3 *.x* драйвер должен работать с ODBC 2. *x* приложений, использующих **SQLSetPos** с *операции* SQL_ADD, драйвер должен поддерживать **SQLSetPos** с  *Операция* из SQL_ADD в дополнение к **SQLBulkOperations** с *операции* из SQL_ADD.|  
|**SQLExtendedFetch**|Возвращает указанный набор строк. ODBC 3 *.x* драйверы реализовать это, если для работы с ODBC 2. *x* приложения, вызывающие **SQLExtendedFetch** или **SQLSetPos**. Ниже приведены сведения о реализации.<br /><br /> -Драйвер извлекает размер набора строк из значения атрибута SQL_ROWSET_SIZE инструкции.<br />-Драйвер извлекает адрес массив состояния строк из *RowStatusArray* аргумент, не sql_attr_row_status_ptr, которое указывает атрибут инструкции. *RowStatusArray* аргумента в вызове **SQLExtendedFetch** не должен быть указателем null. (Обратите внимание, что в ODBC 3 *.x*, sql_attr_row_status_ptr, которое указывает атрибут инструкции может быть пустой указатель.)<br />-Драйвер возвращает адрес буфера строк, загружаемых из *RowCountPtr* аргумент, не атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции.<br />-Драйвер возвращает SQLSTATE 01S01 (ошибка в строке) для указания, что произошла ошибка во время выборки строк с помощью вызова **SQLExtendedFetch**. ODBC 3 *.x* драйвер должен возвращать SQLSTATE 01S01 (ошибка в строке) только если **SQLExtendedFetch** вызывается, не при **SQLFetch** или **SQLFetchScroll** вызывается. Для сохранения обратной совместимости при SQLSTATE 01S01 возвращается (ошибка в строке) **SQLExtendedFetch**, диспетчер драйверов не упорядочивает записи состояния в очереди согласно правилам, описанным в «последовательность из состояния ошибок Записи» раздела [SQLGetDiagField](../../../odbc/reference/syntax/sqlgetdiagfield-function.md).|  
|**SQLFetch**|Возвращает следующий набор строк. Ниже приведены сведения о реализации.<br /><br /> -Драйвер извлекает размер набора строк из значения атрибута SQL_ATTR_ROW_ARRAY_SIZE инструкции.<br />-Драйвер извлекает адрес массив состояния строк из sql_attr_row_status_ptr, которое указывает атрибут инструкции.<br />-Драйвер извлекает адрес строк, загружаемых буфера из атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции.<br />-Приложения могут быть использованы смешанные вызовы между **SQLFetchScroll** и **SQLFetch**.<br />-   **SQLFetch** возвращает закладки, если привязан столбец 0.<br />-   **SQLFetch** может вызываться для возврата более одной строки.<br />-Драйвер не возвращает SQLSTATE 01S01 (ошибка в строке) для указания, что произошла ошибка во время выборки строк с помощью вызова **SQLFetch**.|  
|**SQLFetchScroll**|Возвращает указанный набор строк. Ниже приведены сведения о реализации.<br /><br /> -Драйвер извлекает размер набора строк из атрибута SQL_ATTR_ROW_ARRAY_SIZE инструкции.<br />-Драйвер извлекает адрес массив состояния строк из sql_attr_row_status_ptr, которое указывает атрибут инструкции.<br />-Драйвер извлекает адрес строк, загружаемых буфера из атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции.<br />-Приложения могут быть использованы смешанные вызовы между **SQLFetchScroll** и **SQLFetch**.<br />-Драйвер не возвращает SQLSTATE 01S01 (ошибка в строке) для указания, что произошла ошибка во время выборки строк с помощью вызова **SQLFetchScroll**.|  
|**SQLSetPos**|Выполняет различные позиционированных операций. Ниже приведены сведения о реализации.<br /><br /> -Это может вызываться в состояниях инструкции S6 или S7. Дополнительные сведения см. в разделе [переходы инструкции](../../../odbc/reference/appendixes/statement-transitions.md) в приложении B: ODBC состояния перехода таблицах.<br />-Если это вызывается в состоянии инструкции S5 или S6, драйвер получает размер набора строк из атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции и адрес массив состояния строк из sql_attr_row_status_ptr, которое указывает атрибут инструкции.<br />-Если это вызывается в состоянии инструкции S7, драйвер возвращает размер набора строк из атрибута инструкции SQL_ROWSET_SIZE и адрес массив состояния строк из *RowStatusArray* аргумент  **SQLExtendedFetch**.<br />-Драйвер возвращает SQLSTATE 01S01 (ошибка в строке) только для того, чтобы указать, что произошла ошибка во время выборки строк с помощью вызова **SQLSetPos** для выполнения операции массового при вызове функции в состоянии S7. Для сохранения обратной совместимости, если SQLSTATE 01S01 возвращается (ошибка в строке) **SQLSetPos**, диспетчер драйверов не упорядочивает записи состояния в очереди ошибок согласно правилам, описанным в «последовательность из состояния записей» раздел [SQLGetDiagField](../../../odbc/reference/syntax/sqlgetdiagfield-function.md).<br />-Если драйвер должны работать с ODBC 2. *x* приложения, вызывающие **SQLSetPos** с *операции* аргумент SQL_ADD, драйвер должен поддерживать **SQLSetPos** с  *Операция* аргумент SQL_ADD.|
