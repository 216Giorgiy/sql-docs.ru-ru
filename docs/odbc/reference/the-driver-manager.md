---
title: "Диспетчер драйверов | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: reference
ms.reviewer: 
ms.suite: sql
ms.technology: drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- driver manager [ODBC]
- ODBC architecture [ODBC], driver manager
- driver manager [ODBC], about driver manager
- ODBC driver manager [ODBC]
ms.assetid: 559e4de1-16c9-4998-94f5-6431122040cd
caps.latest.revision: "7"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 4ee227f7fab393cdf563daab2aa695cd469281ff
ms.sourcegitcommit: 7f8aebc72e7d0c8cff3990865c9f1316996a67d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2017
---
# <a name="the-driver-manager"></a>Диспетчер драйверов
*Диспетчера драйверов* — библиотека, которая управляет связью между приложениями и драйверы. Например для платформ Microsoft® Windows® диспетчера драйверов является библиотеки динамической компоновки (DLL), которые записываются корпорации Майкрософт и могут распространять пользователей распространяемого пакета SDK MDAC 2.8 с пакетом обновления 1.  
  
 Диспетчер драйверов существует главным образом для удобства авторы приложений и устраняет ряд проблем, общими для всех приложений. К ним относятся определения, какой драйвер следует загрузить на основании имени источника данных, загрузка и выгрузка драйверов и вызов функций в драйверах.  
  
 Чтобы узнать, почему во втором случае выполняется проблема, рассмотрим, что может произойти, если приложение вызвало функции в драйвере напрямую. Если приложение было скомпоновано непосредственно для драйвера, они должны были бы построения таблицы указателей на функции в нем и эти функции вызываются указателем. Использует тот же код для более чем один драйвер одновременно добавить еще один уровень сложности. Приложения следует сначала нужно задать указатель на функцию, чтобы она указывала на правильный функции в правильный драйвер и затем вызвать функцию с помощью этого указателя.  
  
 Диспетчер драйверов решает эту проблему, предоставляя единого места для вызова каждой функции. Приложение связано диспетчера драйверов и вызовы функций ODBC в диспетчер драйверов не драйвер. Приложение определяет целевой драйвер и источник данных с *дескриптора соединения*. При загрузке драйвера, диспетчер драйверов создает таблицу из указателей на функции в нем. Он использует дескриптор соединения, передаваемыми приложением, чтобы найти адрес функции в драйвере целевой и вызывает данную функцию по адресу.  
  
 В большинстве случаев диспетчера драйверов просто передает вызовы функций из приложения в соответствующий драйвер. Тем не менее, он также реализует некоторые функции (**SQLDataSources**, **SQLDrivers**, и **SQLGetFunctions**) и выполняет проверку основных ошибок. Например диспетчер драйверов проверяет маркеры не являются указатели null, что функции вызываются в правильном порядке, и что определенные аргументы функции являются допустимыми. Полное описание ошибок, проверяется с помощью диспетчера драйверов см. в справочном разделе для каждой функции и [приложение б: ODBC состояния перехода таблицы](../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md).  
  
 Окончательный важной роли диспетчера драйверов Загрузка и выгрузка драйверов. Приложение загружает и выгружает только диспетчера драйверов. Когда он хочет использовать конкретный драйвер, вызывается функция подключения (**SQLConnect**, **SQLDriverConnect**, или **SQLBrowseConnect**) диспетчера драйверов и указывает имя конкретного источника данных или драйвера, например, «Бухгалтерия» или «SQL Server». Используя это имя, диспетчер драйверов поиск источника данных для имени файла драйвера, например Sqlsrvr.dll. Затем он будет загружен драйвер (при условии, что он еще не загружен), хранится адрес каждой функции в драйвере и вызывает функцию подключения в драйвере, который инициализирует себя и подключается к источнику данных.  
  
 Когда приложение выполняется с помощью драйвера, он вызывает **SQLDisconnect** диспетчера драйверов. Диспетчер драйверов вызывает эту функцию в драйвере, отключается от источника данных. Тем не менее диспетчер драйверов сохраняет драйвер в памяти в случае, если приложение подключается к нему. Только в том случае, когда приложение освобождает соединение, драйвер использует или использует соединение для другого драйвера, а другие соединения не использовать драйвер выгружается драйвер. Полное описание роли диспетчера драйверов в Загрузка и выгрузка драйверов см. в разделе [роли диспетчера драйверов в процесс подключения](../../odbc/reference/develop-app/driver-manager-s-role-in-the-connection-process.md).
