---
title: Динамический SQL | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- SQL [ODBC], embedded SQL
- SQL statements [ODBC], dynamic SQL
- SQL statements [ODBC], embedded SQL
- dynamic SQL [ODBC]
- SQL [ODBC], dynamic SQL
- embedded SQL [ODBC]
ms.assetid: 0bfb9ab7-9c15-4433-93bc-bad8b6c9d287
caps.latest.revision: 5
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: On Demand
ms.openlocfilehash: d0dab9c38b5fe567664455462f0d229a8235ba99
ms.sourcegitcommit: 7a6df3fd5bea9282ecdeffa94d13ea1da6def80a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="dynamic-sql"></a>Динамические инструкции SQL
Несмотря на то, что статический SQL работает также во многих случаях, имеется класс приложений, в которых доступ к данным не удается определить заранее. Например предположим, что электронной таблицы позволяет пользователю ввести запрос, который электронную таблицу отправляет СУБД для получения данных. Содержимое этого запроса очевидно, что не может быть известен программисту при записи электронными таблицами.  
  
 Чтобы решить эту проблему, электронной таблицы используется форма embedded SQL, называемого динамического SQL. В отличие от статических инструкций SQL, которые жестко запрограммированы в программе, динамических инструкций SQL можно выполнять построение во время выполнения и помещен в строковой переменной узла. Они отправляются на СУБД для обработки. Поскольку СУБД необходимо создать план доступа во время выполнения для динамических инструкций SQL, динамического SQL обычно медленнее, чем статические SQL. При компиляции программы, содержащий динамических инструкций SQL, динамических инструкций SQL, не удаляются из программы, как в статических SQL. Вместо этого они заменяются вызов функции, который передает инструкцию в СУБД; обычно обрабатываются статическими инструкциями SQL в одной программе.  
  
 Самый простой способ выполнения динамических инструкций SQL — с помощью НЕМЕДЛЕННОЕ выполнение инструкции. Эта инструкция передает СУБД для компиляции и выполнения инструкции SQL.  
  
 Один НЕМЕДЛЕННОЕ выполнение инструкции заключается в том, что СУБД должны проходить через каждый из пяти шагов обработки инструкции SQL каждый раз, когда выполняется инструкция. Нагрузка, вызванная этот процесс может быть значительно, если многие операторы выполняются динамически и затратные похожи этих инструкций. Эту проблему можно решить, динамического SQL предоставляет оптимизированной форме выполнения называется подготовленное выполнение, который использует следующие действия:  
  
1.  Программа создает инструкцию SQL в буфере, так же, как для НЕМЕДЛЕННОГО ВЫПОЛНЕНИЯ инструкции. Вместо хост-переменных знак вопроса (?) можно подставлять константа в любом месте текста инструкции, чтобы показать позже указано значение константы. Вопросительный знак вызывается как маркер параметра.  
  
2.  Программа передает инструкции SQL в СУБД с инструкции PREPARE, какие запросы, что СУБД синтаксического анализа, проверки и оптимизировать инструкцию и создать выполнения спланировать. Затем программа использует инструкцию EXECUTE (не НЕМЕДЛЕННОЕ выполнение инструкции) для выполнения инструкции PREPARE позднее. Он передает значения параметров для инструкции через специальную структуру данных называется область данных SQL или sqlda, то номер.  
  
3.  Программа может использовать инструкцию EXECUTE, предоставляя различные значения параметра каждый раз, когда выполняется динамической инструкции.  
  
 Подготовленное выполнение по-прежнему не является таким же, как статический SQL. В статических SQL первые четыре шага обработки инструкции SQL выполняются во время компиляции. В подготовленное выполнение эти действия по-прежнему выполняются во время выполнения, но они выполняются только один раз; выполнение плана происходит только во время вызова EXECUTE. Это позволяет исключить некоторые недостатки производительности, присущие архитектуре динамического SQL. Следующий рисунок показывает различия между статическим SQL, динамического SQL и немедленное выполнение и динамического SQL и подготовленное выполнение.
