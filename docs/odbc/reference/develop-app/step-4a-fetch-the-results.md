---
title: 'Шаг 4а: получить результаты | Документация Майкрософт'
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- application process [ODBC], fetching results
- fetches [ODBC], fetching results
ms.assetid: 77d30142-c774-473c-96fb-b364bb92ac60
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: cad33f1ccf798a08ef1f11667e59b4d5fb4888d8
ms.sourcegitcommit: 61381ef939415fe019285def9450d7583df1fed0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2018
ms.locfileid: "47730652"
---
# <a name="step-4a-fetch-the-results"></a>Шаг 4а. Выборка результатов
Далее необходимо получить результаты, как показано на следующем рисунке.  
  
 ![Выборка результатов в приложении ODBC](../../../odbc/reference/develop-app/media/pr14.gif "pr14")  
  
 Если инструкцией, выполненной в «Шаг 3: Создание и выполнение инструкции SQL», была **ВЫБЕРИТЕ** инструкция или функция каталога, приложение сначала вызывает **SQLNumResultCols** для определения числа столбцов в результирующем наборе. Этот шаг необязателен, если приложение уже знает номер результат задания столбцов, например, если инструкция SQL жестко задано в вертикальной или пользовательские приложения.  
  
 Затем приложение извлекает имя, тип данных, точность и масштаб каждого столбца результирующего набора с **SQLDescribeCol**. Опять же это не является обязательным для приложений, таких как по вертикали и пользовательских приложений, которые уже есть эти сведения. Приложение передает эту информацию, чтобы **SQLBindCol**, который связан с переменной к столбцу в результирующем наборе.  
  
 Теперь приложение вызывает **SQLFetch** получить первую строку данных и поместить данные из этой строки в переменные, привязанные с **SQLBindCol**. Есть ли все данные большой длины строки, затем он вызывает **SQLGetData** для получения данных. Приложение продолжает вызывать **SQLFetch** и **SQLGetData** для получения дополнительных данных. После завершения его выборка данных, он вызывает **SQLCloseCursor** для закрытия курсора.  
  
 Полное описание получения результатов, см. в разделе [извлечение результатов (базовые)](../../../odbc/reference/develop-app/retrieving-results-basic.md) и [извлечение результатов (Дополнительно)](../../../odbc/reference/develop-app/retrieving-results-advanced.md).  
  
 Теперь приложение возвращается к «Шаг 3: Создание и выполнение инструкции SQL» для выполнения другой инструкции в одной и той же транзакции; или переход к «Шаг 5: фиксации транзакции» для фиксации или отката транзакции.
