---
title: "Выборка строки данных | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- SQLFetch function [ODBC], fetching a row of data
- cursors [ODBC], fetching rows
- result sets [ODBC], fetching
- fetches [ODBC], row of data
ms.assetid: 16d4a380-0d83-456b-aeee-f10738944e86
caps.latest.revision: 5
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 142c9a2c95900e5b3776f96d86a145defc447512
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="fetching-a-row-of-data"></a>Выборка строки данных
Чтобы получить строки данных, приложение вызывает **SQLFetch**. **SQLFetch** может вызываться с помощью любого типа курсора, но только курсор перемещается в набор строк в направлении только вперед. **SQLFetch** перемещает курсор на следующую строку и возвращает данные для всех столбцов, связанные с обращениями к **SQLBindCol**. Когда курсор достигает конца результат задано, **SQLFetch** не вернет значение SQL_NO_DATA. Примеры вызова **SQLFetch**, в разделе [с помощью SQLBindCol](../../../odbc/reference/develop-app/using-sqlbindcol.md).  
  
 Как именно **SQLFetch** реализуется драйвером, но общий шаблоном является драйвер для получения данных для любой присоединенные столбцы из источника данных, преобразуйте ее в соответствии с типами связанные переменные и поместите преобразованные данные в этих переменных. Если драйвер не может преобразовать все данные **SQLFetch** возвращает сообщение об ошибке. Приложение может продолжить извлечение строк, но данные для текущей строки будут потеряны. Что происходит с данными для несвязанных столбцов зависит от драйвера, но большинство драйверов извлечения и отменить изменения либо никогда не получить его вообще.  
  
 Драйвер также устанавливает значения буферов длины и индикатора, которые были связаны. Если значение столбца равно NULL, драйвер задает соответствующий буфер длины/индикатора на SQL_NULL_DATA. Если значение не равно NULL, драйвер задает буфер длины/индикатора байтовая длина данных после преобразования. Если длина не удается определить, что иногда бывает в длинных данных, извлеченных методом более одного вызова функции, драйвер задает буфер длины/индикатора SQL_NO_TOTAL. Для типов данных фиксированной длины, такие как Integer и структуры даты байтовая длина — это размер типа данных.  
  
 Для данных переменной длины, например символьных и двоичных данных драйвер проверяет байтовая длина преобразованных данных от байтовая длина буфера, привязанное к столбцу; Длина буфера задается в *BufferLength* аргумент в **SQLBindCol**. Если байтовая длина преобразованных данных больше, чем длина буфера байт, драйвер производит усечение данных, чтобы уместиться в буфере, возвращает неусеченный длины в буфер длины/индикатора, возвращает значение SQL_SUCCESS_WITH_INFO куда помещается SQLSTATE 01004 (данные сокращенные) диагностики. Единственное исключение — Если закладка переменной длины усекается при возврате **SQLFetch**, который возвращает SQLSTATE 22001 (строковые данные, усечение справа).  
  
 Данные фиксированной длины никогда не усекается, поскольку драйвер предполагает, что размер буфера привязанного является размер типа данных. Усечение данных в большей степени становится редко, так как приложение обычно связывает буфер недостаточно велик для хранения значения типа данных; он определяет размер, необходимый в метаданных. Тем не менее приложение может явно привязывать буфер, который будет указан слишком мал. Например его получения и отображения первым 20 символам описание части или первые 100 символов столбца длинный текст.  
  
 Символьные данные должны быть символом null, драйвер перед возвратом к приложению, даже если он был усечен. Знак завершения null не включается в возвращаемый байт, но требует пространства в буфере, связанных. Например предположим, приложение использует строки, состоящие из символьных данных в кодировке ASCII, драйвер содержит 50 символов для возврата данных и приложения буфера не 25 байт. В буфере приложения драйвер возвращает первые 24 символов, за которым следует символ завершения null. В буфер длины/индикатора возвращается число 50 байт.  
  
 Приложение можно ограничить количество строк в результирующем наборе, задав атрибут SQL_ATTR_MAX_ROWS инструкции перед выполнением инструкции, который создает результат. Например в режиме предварительного просмотра в приложение, используемое для настройки форматирования отчетов требует достаточно данных для отображения первой страницы отчета. Путем ограничения размера результирующего набора, такая возможность может выполняться быстрее. Этот атрибут инструкции предназначены для сокращения сетевого трафика и могут поддерживаться не все драйверы.

