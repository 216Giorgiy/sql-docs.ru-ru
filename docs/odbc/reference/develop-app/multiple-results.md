---
title: "Несколько результатов | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: reference
ms.reviewer: 
ms.suite: sql
ms.technology: drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- SQLMoreResults function [ODBC], multiple results
- row counts [ODBC]
- multiple results [ODBC]
- result sets [ODBC], multiple results
- SQLGetInfo function [ODBC], multiple results
ms.assetid: a3c32e4b-8fe7-4a33-ae39-ae664001f315
caps.latest.revision: "5"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: c6e9f4cb753a7849e87c8b4725e7e0fad0e953ca
ms.sourcegitcommit: 7f8aebc72e7d0c8cff3990865c9f1316996a67d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2017
---
# <a name="multiple-results"></a>Несколько результатов
Объект *результат* что-нибудь возвращается источником данных после выполнения инструкции. ODBC имеет два типа результатов: результирующие наборы и количества строк. *Счетчики строк* , количество строк, с помощью инструкции update, delete или insert инструкции. Разделы, описанные в [пакеты инструкций SQL](../../../odbc/reference/develop-app/batches-of-sql-statements.md), можно создать несколько результатов.  
  
 В следующей таблице перечислены **SQLGetInfo** параметры приложения, чтобы определить, является ли источник данных возвращает несколько результатов для каждого типа пакета. В частности источник данных может возвращать количество строк в один для всего пакета инструкций или количество отдельных строк для каждой инструкции в пакете. В случае результирующий набор генерации выполненной инструкции с массивом параметров источник данных может возвращать один результирующий набор для всех наборов параметров или отдельные результирующие наборы для каждого набора параметров.  
  
|Тип пакета|Количество строк|Результирующие наборы|  
|----------------|----------------|-----------------|  
|Явные пакета|SQL_BATCH_ROW_COUNT []|--[b].|  
|Процедура|SQL_BATCH_ROW_COUNT []|--[b].|  
|Массивы параметров|SQL_PARAM_ARRAYS_ROW_COUNTS|SQL_PARAM_ARRAYS_SELECTS|  
  
 [] строки генерации число инструкций в пакете может поддерживаться, но возвращает количество строк, не поддерживается. Параметр SQL_BATCH_SUPPORT в **SQLGetInfo** указывает ли разрешены инструкции генерации число строк в пакетах; параметр SQL_BATCH_ROW_COUNTS указывает, возвращаются ли эти счетчики строк в приложение.  
  
 [b] явную пакеты и процедуры всегда возвращают несколько результирующих наборов, если они включают в себя несколько инструкций set формирования результата.  
  
> [!NOTE]  
>  Параметр SQL_MULT_RESULT_SETS, представленные в ODBC 1.0 только общие сведения о возвращение несколько результирующих наборов. В частности он имеет значение «Y» для SQL_BATCH_SUPPORT возвращаются биты SQL_BS_SELECT_EXPLICIT или SQL_BS_SELECT_PROC или SQL_PAS_BATCH возвращается для SQL_PARAM_ARRAYS_SELECT.  
  
 Для обработки нескольких результатов, приложение вызывает **SQLMoreResults**. Эта функция отменяет текущий результат и делает следующий результат доступным. Если доступных результатов больше нет, возвращается значение SQL_NO_DATA. Например предположим, что следующие операторы выполняются как пакет:  
  
```  
SELECT * FROM Parts WHERE Price > 100.00;  
UPDATE Parts SET Price = 0.9 * Price WHERE Price > 100.00  
```  
  
 После выполнения этих инструкций, приложение извлекает строки из результирующего набора, созданные **ВЫБЕРИТЕ** инструкции. Если он выполняется извлечение строк, он вызывает **SQLMoreResults** для предоставления число частей, которые были repriced. При необходимости **SQLMoreResults** отменяет строками строк и закрывает курсор. Затем приложение вызывает **SQLRowCount** для определения того, как многие элементы были repriced по **обновление** инструкции.  
  
 Он зависит от драйвера ли инструкция весь пакет выполняется перед доступны все результаты. В некоторых реализациях это условие выполняется; в других вызов **SQLMoreResults** вызывает выполнение следующей инструкции в пакете.  
  
 В случае сбоя одного из инструкций в пакете **SQLMoreResults** вернет значение SQL_ERROR или SQL_SUCCESS_WITH_INFO. Если пакет был прерван при выполнении инструкции возникла ошибка или сбой инструкция была последней инструкцией в пакете, **SQLMoreResults** вернет значение SQL_ERROR. Если пакет не был прерван при выполнении инструкции возникла ошибка и неудачных инструкция была последней инструкцией в пакете, **SQLMoreResults** будет возвращено значение SQL_SUCCESS_WITH_INFO. SQL_SUCCESS_WITH_INFO указывает, по крайней мере один результирующий набор, или по количеству был создан и пакет не был прерван.
