---
title: "Когда следует использовать процедуры | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: reference
ms.reviewer: 
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
caps.latest.revision: 6
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: a7bae5e984d66d8b71a9e4b84708f3ea126c1e0b
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="when-to-use-procedures"></a>Когда следует использовать процедуры
Существует ряд преимуществ использования процедур, все исходя из того, что с помощью процедур перемещает инструкции SQL из приложения к источнику данных. В приложении остается вызова процедуры с возможностью взаимодействия. Эти преимущества:  
  
-   **Производительность** процедуры обычно является самым быстрым способом выполнения инструкций SQL. Как и на выполнение подготовленной, инструкция компилируется и выполняется в два действия. В отличие от подготовленное выполнение процедуры выполняются только во время выполнения. Они не будут скомпилированы в другое время.  
  
-   **Бизнес-правила** A *бизнес-правило* правило о том, как в которой работает компания. Например только пользователь с заголовком менеджера по продажам может допускается добавление новых заказов на продажу. Размещение этих правил в процедурах позволяет отдельных компаний для настройки вертикальной приложений, перезаписывая процедуры, вызванные приложением без необходимости менять код приложения. Например, приложение для регистрации заказов может вызывать процедуру **InsertOrder** с фиксированным числом параметров; того, как **InsertOrder** реализуется может изменяться от компании к компании.  
  
-   **Replaceability** тесно связана с помещение бизнес-правила в процедуры заключается в том, что процедуры можно заменить без повторной компиляции приложения. Если бизнес-правило изменяются после купила и установить приложение компании, компании можно изменить процедуры, содержащей это правило. С точки зрения приложения ничего не изменилось; он по-прежнему вызывает определенной процедуры для выполнения конкретной задачи.  
  
-   **СУБД SQL** процедуры предоставляют способ для приложений для использования СУБД SQL и по-прежнему оставаться с возможностью взаимодействия. Например процедуру на СУБД, поддерживающий инструкций управления потоком в SQL может отслеживать и устранять ошибки, во время процедуры в СУБД, которая не поддерживает инструкции управления потоком, может просто вернуть ошибку.  
  
-   **Процедуры сохранятся транзакции** в некоторых источниках данных планы доступ для всех подготовленных инструкций в соединении, удаляются при фиксации или отката транзакции. Поместив инструкций SQL в процедуры, которые постоянно хранятся в источнике данных, операторы выходят за рамки транзакции. Следует ли процедуры выжить в подготовленной частично подготовлена, или НЕПОДГОТОВЛЕННОМ состоянии зависит от СУБД.  
  
-   **Разделите разработки** процедуры может быть разработан отдельно от остальной части приложения. В больших организациях это может обеспечить способ дальнейшей воспользоваться навыки специализированной программистов. Другими словами разработчики приложений пишут код пользовательского интерфейса и базы данных имеется возможность создавать процедуры.  
  
 Процедуры обычно используются вертикальные и пользовательских приложений. Эти приложения, как правило, для выполнения основных задач и существует возможность вызовов процедур жестко закодировать в них. Например, приложение для регистрации заказов может вызывать процедуры **InsertOrder**, **DeleteOrder**, **UpdateOrder**, и **GetOrders** .  
  
 Практически не существует причин для вызова процедуры из универсальных приложений. Процедуры обычно создаются для выполнения задачи в контексте конкретного приложения и поэтому иметь use универсальных приложений. Например, электронной таблицы имеет нет необходимости вызывать **InsertOrder** упомянутой выше процедуры. Кроме того универсальные приложения не следует создавать процедуры во время выполнения, рассчитывая предоставление более быстрого выполнения инструкции; не только вероятнее всего этом медленнее, чем подготовленных или прямого выполнения, также требуется инструкций SQL, зависящие от СУБД.  
  
 Исключением является сред разработки приложений, что часто позволяют программистам создавать инструкции SQL, выполняемых процедур и может позволяют программистам тестирование процедур. Такой вызов среды **SQLProcedures** в список доступных процедур и **SQLProcedureColumns** Чтобы вывести список входных данных, ввода вывода и выходные параметры, процедура возвращать значение и столбцы никаких результирующих наборов, созданных процедурой. Однако такие процедуры должны разрабатываться заранее для каждого источника данных; в этом случае требуется инструкций SQL, зависящие от СУБД.  
  
 Существует три основных недостатки использования процедур. Первый — что процедуры записи и компиляции для каждой СУБД, с которой приложение будет запущена. Хотя это не проблема для пользовательских приложений, он может значительно увеличить разработки и обслуживания времени для вертикальной приложений может работать с несколькими СУБД.  
  
 Второй недостаток заключается в том, большинства СУБД не поддерживают процедуры. Опять же это скорее всего, проблемы для вертикальной приложения, предназначенные для запуска с количеством СУБД. Чтобы определить, поддерживается ли процедуры, приложение вызывает **SQLGetInfo** с параметром SQL_PROCEDURES.  
  
 В третьем недостаток обычно применяется в средах разработки приложения, состоит в ODBC не определяет стандартные грамматики для создания процедур. То есть несмотря на то, что приложения могут вызывать процедуры interoperably, они не могут создавать их interoperably.

