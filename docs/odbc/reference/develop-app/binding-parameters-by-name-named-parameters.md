---
title: "Привязка параметров по имени (именованные параметры) | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: reference
ms.reviewer: 
ms.suite: sql
ms.technology: drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- named parameters [ODBC]
- binding parameters by name [ODBC]
ms.assetid: e2c3da5a-6c10-4dd5-acf9-e951eea71a6b
caps.latest.revision: "7"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 54298b1c08235452f5717888754569d55442a47a
ms.sourcegitcommit: 7f8aebc72e7d0c8cff3990865c9f1316996a67d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2017
---
# <a name="binding-parameters-by-name-named-parameters"></a>Привязка параметров по имени (именованные параметры)
Некоторые СУБД позволяют приложению задать параметры для хранимой процедуры по имени, а не по позиции в вызове процедуры. Такие параметры называются *именованных параметров*. ODBC поддерживает использование именованных параметров. В ODBC именованные параметры используются только в вызовах хранимых процедур и не может использоваться в других инструкциях SQL.  
  
 Драйвер проверяет значение поля SQL_DESC_UNNAMED IPD для определения параметров, используются ли с именем. Если SQL_DESC_UNNAMED не равно SQL_UNNAMED, драйвер использует имя в поле SQL_DESC_NAME IPD для идентификации параметра. Чтобы привязать параметр, приложение может вызвать **SQLBindParameter** чтобы указать сведения о параметрах, а затем вызывать **SQLSetDescField** для поля SQL_DESC_NAME IPD установите. Если используются именованные параметры, порядок параметров в вызове процедуры не имеет значения, и номер записи этого параметра игнорируется.  
  
 Разница между неименованные и именованные параметры заключается в связь между номер записи дескриптора и номер параметра в процедуре. При использовании неименованные параметры, к первому маркеру параметра относится к первой записи в дескриптор параметра, который в свою очередь относится к первому параметру (в порядке создания) при вызове процедуры. Если используются именованные параметры, к первому маркеру параметра по-прежнему связанные с первой записи дескриптор параметра, но связь между номер записи дескриптора и номер параметра в процедуре больше не существует. Именованные параметры не используйте сопоставление номер записи дескриптор для позиции параметра процедуры; Вместо этого имя записи дескриптора сопоставляется имени параметра процедуры.  
  
> [!NOTE]  
>  Если включено автоматическое заполнение IPD, драйвер будет заполнять дескриптора таким образом, что порядок записей дескриптор будет соответствовать порядку параметров в определении процедуры даже если используются именованные параметры.  
  
 Если именованный параметр используется, все параметры должны быть именованные параметры. Если для какого-либо параметра не является именованным параметром, ни один из параметров ЦС быть именованные параметры. Если существуют как именованные параметры и неименованные параметры, поведение будет зависящих от драйвера.  
  
 В качестве примера именованных параметров Предположим, что SQL Server, хранимая процедура определена следующим образом:  
  
```  
CREATE PROCEDURE test @title_id int = 1, @quote char(30) AS <blah>  
```  
  
 В этой процедуре, первый параметр @title_id, имеет значение по умолчанию 1. Приложение может использовать следующий код для вызова этой процедуры, таким образом, что он указывает только один динамический параметр. Этот параметр представляет собой именованный параметр с именем «@quote».  
  
```  
// Prepare the procedure invocation statement.  
SQLPrepare(hstmt, "{call test(?)}", SQL_NTS);  
  
// Populate record 1 of ipd.  
SQLBindParameter(hstmt, 1, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_CHAR,  
                  30, 0, szQuote, 0, &cbValue);  
  
// Get ipd handle and set the SQL_DESC_NAMED and SQL_DESC_UNNAMED fields  
// for record #1.  
SQLGetStmtAttr(hstmt, SQL_ATTR_IMP_PARAM_DESC, &hIpd, 0, 0);  
SQLSetDescField(hIpd, 1, SQL_DESC_NAME, "@quote", SQL_NTS);  
  
// Assuming that szQuote has been appropriately initialized,  
// execute.  
SQLExecute(hstmt);  
```
