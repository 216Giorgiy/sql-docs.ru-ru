---
title: Атрибуты SQLSTATE | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- diagnostic information [ODBC], sqlstates
- SQLSTATE [ODBC]
ms.assetid: f29fff2e-3d09-4a8c-a2f9-2059062cbebf
caps.latest.revision: 6
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 9408522a47b442e3001e09cdca2d636063f73fb5
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "32913069"
---
# <a name="sqlstates"></a>атрибуты SQLSTATE
Атрибуты SQLSTATE приводятся подробные сведения о причине предупреждения или ошибки. Атрибуты SQLSTATE, в данном руководстве основаны на были найдены в спецификации ISO/IEF CLI, несмотря на то, что эти атрибуты SQLSTATE, начинающиеся с помощью мгновенных сообщений характерные для ODBC.  
  
 В отличие от коды возврата SQLSTATE в данном руководстве приведены рекомендации и драйверы не требуются, чтобы вернуть их. Таким образом пока драйверы должен возвращать правильную SQLSTATE для любой ошибки или предупреждения, которые они поддерживают обнаружение, приложениям не следует рассчитывать на всегда происходит. В этом случае есть две причины:  
  
-   **Неполнотой данных** несмотря на то, что это руководство содержит большое количество ошибок, предупреждений и причин возникновения этих ошибок и предупреждений, не завершена и, вероятно, никогда не будет; драйвер просто разных реализациях слишком сильно. Любого конкретного драйвера, скорее всего, не будут возвращать все атрибуты SQLSTATE перечисленных в данном руководстве и может возвращать SQLSTATE, не перечисленных в данном руководстве.  
  
-   **Сложность** некоторые базы данных ядер — особенно реляционной СУБД, возвращают буквально тысячи ошибок и предупреждений. Драйверы для таких модулей вряд ли сопоставить всех этих ошибок и предупреждений из-за усилия SQLSTATE участвуют, inexactness сопоставлений, большой размер результирующего кода и низкое значение результирующий код, возвращающий часто программирование ошибки, которые никогда не должны быть обнаружены во время выполнения. Таким образом драйверы должны сопоставляться как многие ошибки и предупреждения как кажется разумным и убедитесь, что для сопоставления этих ошибок и предупреждений на какие логике приложения может быть основан, например SQLSTATE 01004 (данных).  
  
 Так как SQLSTATE надежно не возвращаются, большинство приложений просто отображают их пользователю вместе с их связанных диагностическое сообщение, который предназначен для данной конкретной ошибке или предупреждения, возникшего часто и машинный код ошибки. Поскольку приложения не может быть основан логику программирования на большинстве SQLSTATE все равно нет редко потери функциональности в выполнении этого действия. Например, предположим, что **SQLExecDirect** возвращает сообщение SQLSTATE 42000 (синтаксическая ошибка или нарушение доступа). Если инструкции SQL, вызвавшей эту ошибку жестко, или созданного приложением, это ошибка программирования и код необходимо исправить. Если инструкции SQL, введенные пользователем, это является ошибкой пользователя, и приложение выполнит все, что возможно путем информирования пользователя о проблеме.  
  
 Когда приложений создать логику программирования на SQLSTATE, они должно быть подготовлено для SQLSTATE не должны быть возвращены или другой SQLSTATE возвращается. Точно которой SQLSTATE возвращаются надежно может основываться только на взаимодействие с многочисленные драйверами. Тем не менее правило является SQLSTATE ошибок, возникших в драйвере или диспетчера драйверов, в отличие от источника данных, скорее всего, должны быть возвращены надежно. Например, большинство драйверов, возможно, возвращать SQLSTATE HYC00 (не реализованы дополнительные функции), пока меньше драйверы, скорее всего, возвращают SQLSTATE 42021 (столбец уже существует).  
  
 Следующие атрибуты SQLSTATE указывают во время выполнения ошибки или предупреждения, которые хорошо подходят в качестве основы программной логики. Однако нет гарантии, что все драйверы вернуть их.  
  
-   01004 (данных)  
  
-   01S02 (значение параметра изменено)  
  
-   HY008 (операция отменена)  
  
-   HYC00 (дополнительная возможность не реализована)  
  
-   HYT00 (превышено время ожидания)  
  
 SQLSTATE HYC00 (дополнительная возможность не реализована) особенно важен, так как он является единственным способом, в котором приложение может определить, поддерживает ли драйвер конкретного атрибута инструкции или соединения.  
  
 Полный список SQLSTATE какие функции и возвращают их в разделе [коды ошибок ODBC приложение A:](../../../odbc/reference/appendixes/appendix-a-odbc-error-codes.md). Подробное описание условий, при которых каждая функция может возвращать определенный SQLSTATE см. в этой функции.
