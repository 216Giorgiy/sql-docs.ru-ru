---
title: Драйверы Юникода | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- Unicode [ODBC], drivers
- Unicode [ODBC], functions
- functions [ODBC], Unicode functions
ms.assetid: 3b4742d5-74fb-4aff-aa21-d83a0064d73d
caps.latest.revision: 6
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 26e96eaf558b82c780cba9f74c6f8636a7ab7ac7
ms.sourcegitcommit: 2ddc0bfb3ce2f2b160e3638f1c2c237a898263f4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="unicode-drivers"></a>Драйверы Юникода
Следует ли драйвер драйвер Юникода или драйвера ANSI полностью зависит от природы источника данных. Если источник данных поддерживает данные в Юникоде, драйвер должно быть драйвер Юникода. Если источник данных поддерживает только данных ANSI, драйвер должны оставаться драйвер с ANSI.  
  
 Драйвер Юникода необходимо экспортировать **SQLConnectW** распознается как драйвер Юникода диспетчером драйверов.  
  
 Драйвер Юникода необходимо принять функции Юникода (с помощью суффикса *W*) и хранения данных в Юникоде. Можно также принять функции ANSI, но не требуется. (Диспетчер драйверов не проходит вызова функции ANSI с *A* суффикс драйвер, но преобразует его в символ ANSI вызов без суффикса и затем передает функции его к драйверу.)  
  
 Драйвер Юникода необходима возможность возвращать результирующие наборы в Юникоде или ANSI, в зависимости от привязки для приложения. Если приложение связывает SQL_C_CHAR, драйвер Юникод следует преобразовать SQL_CHAR данных SQL_WCHAR. Диспетчер драйверов назначит SQL_C_WCHAR SQL_C_CHAR для драйверов ANSI, но отсутствует сопоставление для драйверов Юникода.  
  
> [!NOTE]  
>  При определении типа драйверов, диспетчер драйверов вызывает **SQLSetConnectAttr** и присвойте атрибуту SQL_ATTR_ANSI_APP во время соединения. Если приложение использует API-интерфейсы ANSI, SQL_ATTR_ANSI_APP будет присвоено SQL_AA_TRUE и при использовании Юникода, он будет присвоено значение SQL_AA_FALSE. Этот атрибут используется, чтобы драйвер может работать иначе в зависимости от типа приложения. Атрибут не может задавать приложением напрямую, а не поддерживается **SQLGetConnectAttr**. Если драйвер видно, аналогичное поведение для ANSI и Юникод приложений, она возвращает значение SQL_ERROR для этого атрибута. Если драйвер возвращает SQL_SUCCESS, диспетчер драйверов будет разделить соединения ANSI или Юникод, при использовании пула соединений.
