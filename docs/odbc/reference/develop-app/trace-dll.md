---
title: "Трассировка DLL | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: reference
ms.reviewer: 
ms.suite: sql
ms.technology: drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- trace DLLs [ODBC]
- tracing options [ODBC], trace DLLs
ms.assetid: 5ab99bd3-cdc3-4e2c-8827-932d1fcb6e00
caps.latest.revision: "8"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 2b58f344839a0f8e74fa46c5e788b7835d3eadc2
ms.sourcegitcommit: 7f8aebc72e7d0c8cff3990865c9f1316996a67d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2017
---
# <a name="trace-dll"></a>Библиотека трассировки
Библиотеки DLL, которая выполняет трассировку является одним из основных компонентов ODBC. Трассировки DLL в настоящее время предоставляется в качестве образца библиотеки DLL в компоненте ODBC пакета SDK Windows, а также было ранее включено Microsoft данных Access Components (MDAC) SDK. Таким образом записи реестра, интерфейса и образец кода для трассировки DLL доступны. Эта библиотека DLL может быть заменен библиотекой DLL, созданные пользователем с ODBC или стороннего поставщика трассировки. Пользовательские трассировку DLL следует присвоить имя, отличное от исходной трассировки образец библиотеки DLL. DLL-библиотеки трассировки должны быть установлены в системном каталоге, или будет невозможно загрузить. Строки подключения не передаются Библиотека трассировки диспетчером драйверов.  
  
 Библиотека трассировки выполняет трассировку входных аргументов, выходные аргументы, аргументы для отложенного, коды возврата и SQLSTATE. Если трассировка включена, диспетчер драйверов вызывает Библиотека трассировки в двух точках: один раз при вхождении в функцию (перед проверкой аргумент) и снова только до выполнения возврата функцией.  
  
 Когда приложение вызывает функцию, диспетчер драйверов вызывает функцию трассировки в трассировке DLL до вызова функции в драйвере или обработки сам вызов. Каждая функция ODBC имеет соответствующую функцию трассировки (с префиксом *трассировки*), идентичный функции ODBC, за исключением имени. При вызове функции трассировки, Библиотека трассировки захватывает входные аргументы и возвращает код возврата. Поскольку Библиотека трассировки вызывается перед диспетчера драйверов проверяет аргументы, недопустимая функция вызывает отслеживаются, поэтому записываются ошибки состояния перехода и недопустимые аргументы.  
  
 После вызова функции трассировки в трассировке DLL, диспетчер драйверов вызывает функцию ODBC в драйвере. Затем он вызывает **TraceReturn** в трассировке DLL. Эта функция принимает два аргумента: значение, возвращаемое Библиотека трассировки для функции трассировки и код возврата, возвращаемых драйвером для диспетчера драйверов для функции ODBC (или значения, возвращаемого диспетчером драйверов сам при его обработке функции). Функция использует значение, возвращаемое для функции трассировки для управления значениями записанного входного аргумента. Он пишет код, возвращаемые для функции ODBC в файл журнала (или динамически, отображает его, если с поддержкой). Он разыменовывает указатели аргументов выходных данных и журналов значения выходных аргументов.
