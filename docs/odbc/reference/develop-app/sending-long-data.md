---
title: Отправка данных Long | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- long data [ODBC]
- sending long data [ODBC]
ms.assetid: ea989084-a8e6-4737-892e-9ec99dd49caf
caps.latest.revision: 5
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: e3dd5ec4edf58bb29772ca565109e5d9c79a3304
ms.sourcegitcommit: 7a6df3fd5bea9282ecdeffa94d13ea1da6def80a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="sending-long-data"></a>Отправка данных Long
Определение СУБД *длинных данных* как любой символьных или двоичных данных через определенный размер, например 254 символов. Не может быть невозможно сохранить весь элемент больших объемов данных в памяти, например когда этот элемент представляет собой длинный текст документа или точечный рисунок. Поскольку такие данные не могут храниться в одиночный буфер, источник данных отправляет его драйвер в частях с **SQLPutData** при выполнении инструкции. Параметры, для которых данные передаются во время выполнения, называются *параметров данных времени выполнения*.  
  
> [!NOTE]  
>  Приложение может фактически отправить любого типа данных во время выполнения с помощью **SQLPutData**, несмотря на то, что в частях могут отправляться только символьных и двоичных данных. Тем не менее, если данные помещаются в один буфер, обычно есть причин использовать **SQLPutData**. Гораздо проще привязать буфер и разрешить драйверу извлечения данных из буфера.  
  
 Для отправки данных во время выполнения, приложение выполняет следующие действия:  
  
1.  Передает 32-разрядное значение, которое идентифицирует параметр в *ParameterValuePtr* аргумент в **SQLBindParameter** вместо передачи адрес буфера. Это значение не анализируется с помощью драйвера. Он будет возвращаться в более поздней версии, приложение, это означает, что-то в приложение. Например он может быть номер параметра или дескриптор файла, содержащего данные.  
  
2.  Передает адрес буфер длины/индикатора в *StrLen_or_IndPtr* аргумент **SQLBindParameter**.  
  
3.  Сохраняет значение SQL_DATA_AT_EXEC, ни результатом SQL_LEN_DATA_AT_EXEC (*длина*) макрос в буфер длины/индикатора. Оба эти значения определяют драйвер, который будет отправлен данных для параметра с **SQLPutData**. SQL_LEN_DATA_AT_EXEC (*длина*) используется при отправке данных long в источник данных, необходимо знать, сколько байтов больших объемов данных, которые будут отправлены, чтобы его можно заранее выделите место. Чтобы определить, когда это значение необходимо для источника данных, приложение вызывает **SQLGetInfo** с параметром SQL_NEED_LONG_DATA_LEN. Все драйверы должны поддерживать этот макрос; Если источник данных не требует байтовая длина, драйвер может пропустить.  
  
4.  Вызовы **SQLExecute** или **SQLExecDirect**. Драйвер обнаруживает, что буфер длины/индикатора содержит значение значение SQL_DATA_AT_EXEC, ни результатом SQL_LEN_DATA_AT_EXEC (*длина*) макрос и возвращает SQL_NEED_DATA как возвращаемое значение функции.  
  
5.  Вызовы **SQLParamData** в ответ на SQL_NEED_DATA возвращаемое значение. Если данные большой длины должен быть отправлен, **SQLParamData** возвращает SQL_NEED_DATA. В буфере, на который указывает *ValuePtrPtr* аргумент, драйвер возвращает значение, определяющее параметр данных во время выполнения. Если имеется более одного параметра данных во время выполнения, приложение должно использовать это значение, чтобы определить, какой параметр для отправки данных; драйвер не требуется для запроса данных для параметров данных времени выполнения в любом порядке.  
  
6.  Вызовы **SQLPutData** для отправки данных параметра в драйвере. Если данные не помещаются в один буфер, как это часто бывает в случае с длинных данных, приложение вызывает **SQLPutData** несколько раз, чтобы отправить данные в частях; возлагается драйвер и источник данных собрать данные. Если приложение передает данные в строку, завершающуюся значением null, драйвер или источник данных необходимо удалить символ завершения null как часть процесса сборки.  
  
7.  Вызовы **SQLParamData** еще раз, чтобы указать, что он отправил всех данных для параметра. Если все параметры данных во время выполнения, для которых не были отправлены данные, драйвер возвращает SQL_NEED_DATA и значение, определяющее следующего параметра; приложение возвращается к шагу 6. Если отправки данных для всех параметров данных во время выполнения при выполнении инструкции. **SQLParamData** возвращает SQL_SUCCESS или SQL_SUCCESS_WITH_INFO и может вернуть любое возвращаемое значение или диагностики, **SQLExecute** или **SQLExecDirect** может возвращать.  
  
 После **SQLExecute** или **SQLExecDirect** возвращает SQL_NEED_DATA и перед данных полностью отправлен для последнего параметра данных времени выполнения, инструкция находится в состоянии необходимые данные. Хотя инструкция находится в состоянии требуются данные, приложение может вызвать только **SQLPutData**, **SQLParamData**, **SQLCancel**, **SQLGetDiagField**, или **SQLGetDiagRec**; все остальные функции возвращают SQLSTATE HY010 (функция ошибка последовательности). Вызов **SQLCancel** отменяет выполнение инструкции и возвращает его предыдущее состояние. Дополнительные сведения см. в разделе [приложение б: ODBC состояния перехода таблицы](../../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md).  
  
 Пример отправки данных во время выполнения см. в разделе [SQLPutData](../../../odbc/reference/syntax/sqlputdata-function.md) описание функции.
