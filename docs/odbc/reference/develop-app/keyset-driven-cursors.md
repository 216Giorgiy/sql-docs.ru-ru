---
title: "Управляемые набором ключей курсоры | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- keyset-driven cursors [ODBC]
- cursors [ODBC], key-set driven
ms.assetid: 01769f43-1d9c-4685-84fa-15a6465335e9
caps.latest.revision: 5
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 7cbd7ca159b09ee1482139ef76bfff48115a62bd
ms.contentlocale: ru-ru
ms.lasthandoff: 09/09/2017

---
# <a name="keyset-driven-cursors"></a>Управляемые набором ключей курсоры
Курсор, управляемый набором ключей находится в диапазоне от статического и динамического курсора в ее способности обнаруживать изменения. Как статический курсор он не всегда обнаруживает изменения в членство и порядок результирующего набора. Как динамический курсор обнаруживать изменения значений строк в результирующем наборе (в зависимости от уровня изоляции транзакции, задаваемое при помощи атрибута SQL_ATTR_TXN_ISOLATION соединения).  
  
 При открытии курсора, управляемого набором ключей, она сохраняет ключи для всего результирующего набора. в этом случае устраняются очевидной членство и порядок результирующего набора. Как курсор прокрутку результирующего набора, он использует ключи в этом *ключей* для получения текущего значения данных для каждой строки. Например предположим, курсор, управляемый набором ключей извлекает строки и другое приложение, а затем обновляет этой строки. Если курсор refetches строки, значения, которые видит будут новых, поскольку он refetched строки, используя свой ключ. По этой причине управляемые набором ключей курсоры всегда может обнаружить изменения, внесенные программой сами и другие.  
  
 Когда курсор пытается извлечь строку, которая была удалена, эта строка отображается как «дыры» в результирующем наборе: существует ключ для строк в наборе ключей, но больше не существует строка в результирующем наборе. Если обновляются значения ключа в строку, строка считается удалению, а затем вставлены, поэтому такие строки также отображаются как отверстия в результирующем наборе. Хотя курсоры всегда может обнаружить строки, удаленные другим пользователям, его можно удалить ключи для строк, он удаляет себя из набора ключей. Управляемые набором ключей курсоры, которые этого не может определить свои собственные операции удаления. Ли определенный курсоры обнаруживает свои собственные операции удаления указывается параметр SQL_STATIC_SENSITIVITY в **SQLGetInfo**.  
  
 Строки, вставленные другими пользователями никогда не являются видимыми для курсора, управляемого набором ключей, поскольку ключи для этих строк не существует в наборе ключей. Однако курсоры при необходимости можно добавить ключи для строк, он располагается в наборе ключей. Управляемые набором ключей курсоры, которые можно определить собственные операции вставки. Ли определенный курсоры обнаруживает свои собственные операции вставки передается через параметр SQL_STATIC_SENSITIVITY в **SQLGetInfo**.  
  
 Массив состояния строк, заданного атрибутом sql_attr_row_status_ptr, которое указывает оператор может содержать SQL_ROW_SUCCESS, SQL_ROW_SUCCESS_WITH_INFO или SQL_ROW_ERROR для любой строки. Возвращает SQL_ROW_UPDATED, SQL_ROW_DELETED или SQL_ROW_ADDED для строк, которые он определяет как обновленные, удалены или вставлены.  
  
 Управляемые набором ключей курсоры обычно реализуются путем создания временной таблицы, содержащий ключи для каждой строки в результирующем наборе. Поскольку курсор необходимо также определить, выполнялось ли обновление строк, эта таблица обычно содержит столбец с сведений об управлении версиями строк.  
  
 Для прокрутки на исходном результирующем наборе курсора, управляемого набором ключей открывает статический курсор над временной таблицы. Для получения строки в исходном результирующем наборе, курсор сначала извлекает соответствующий ключ из временной таблицы, а затем получает текущие значения строки. При использовании блочных курсоров курсор должен получить несколько ключей и строк.

