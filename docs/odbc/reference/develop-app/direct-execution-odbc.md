---
title: Прямое выполнение ODBC | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.suite: sql
ms.technology: connectivity
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], direct execution
- direct execution [ODBC]
- SQL statements [ODBC], executing
ms.assetid: dd00a535-b136-494f-913b-410838e3de7e
caps.latest.revision: 6
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: e506f856fff84065b0026e3e3629a4299d14dae2
ms.sourcegitcommit: 1740f3090b168c0e809611a7aa6fd514075616bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "32912039"
---
# <a name="direct-execution-odbc"></a>Прямое выполнение ODBC
Самый простой способ выполнения инструкции является непосредственное выполнение. Когда инструкция подается на выполнение, источника данных компилирует его в плане доступа, а затем выполняет этот план доступа.  
  
 Прямое выполнение часто используемые универсальные приложения, которые создают и выполняют инструкции во время выполнения. Например следующий код создает инструкцию SQL и выполняет его один раз:  
  
```  
SQLCHAR *SQLStatement;  
  
// Build an SQL statement.  
BuildStatement(SQLStatement);  
  
// Execute the statement.  
SQLExecDirect(hstmt, SQLStatement, SQL_NTS);  
```  
  
 Прямое выполнение лучше всего подходит для инструкций, которые будут выполняться только один раз. Его основной недостаток заключается в том, что синтаксический анализ инструкции SQL, каждый раз при выполнении. Кроме того приложение не может получить сведения о результирующем наборе, созданного с помощью инструкции (если таковые имеются) до после выполнения инструкции; Это можно сделать, если инструкция подготовлена и выполнена в двух отдельных этапов.  
  
 Для выполнения инструкции непосредственно, приложение выполняет следующие действия:  
  
1.  Задает значения всех параметров. Дополнительные сведения см. в разделе [параметров инструкции](../../../odbc/reference/develop-app/statement-parameters.md)далее в этом разделе.  
  
2.  Вызовы **SQLExecDirect** , передавая ей строку, содержащую инструкцию SQL.  
  
3.  Когда **SQLExecDirect** вызывается драйвер:  
  
    -   Изменяет инструкцию SQL для использования источника данных грамматику SQL без синтаксический анализ инструкции. Сюда входят, заменив escape-последовательности, рассматриваемые в [Escape-последовательности ODBC](../../../odbc/reference/develop-app/escape-sequences-in-odbc.md). Приложение может получить измененные формы инструкции SQL, вызвав **SQLNativeSql**. Если значение атрибута инструкции SQL_ATTR_NOSCAN escape-последовательности не заменяются.  
  
    -   Получает текущие значения параметров и преобразует их при необходимости. Дополнительные сведения см. в разделе [параметров инструкции](../../../odbc/reference/develop-app/statement-parameters.md)далее в этом разделе.  
  
    -   Отправляет инструкции и значения параметров, преобразованных в источник данных для выполнения.  
  
    -   Возвращает все ошибки. Сюда входят виртуализации или состояние диагностики, как SQLSTATE 24000 (недопустимое состояние курсора), синтаксические ошибки, такие как SQLSTATE 42000 (синтаксическая ошибка или нарушение доступа) и семантические ошибки, такие как SQLSTATE 42S02 (базовая таблица или представление не найдены).
