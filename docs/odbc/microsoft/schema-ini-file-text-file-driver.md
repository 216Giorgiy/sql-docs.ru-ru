---
title: Файл Schema.ini (драйвера текстового файла) | Документы Microsoft
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- schema.ini file [ODBC]
- text file driver [ODBC], schema.ini file
ms.assetid: 0c4625c4-c730-4984-b430-9051b7bc0451
caps.latest.revision: 7
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 223cf530d4015988db64a7522aaead3c49e0f87f
ms.sourcegitcommit: 2ddc0bfb3ce2f2b160e3638f1c2c237a898263f4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="schemaini-file-text-file-driver"></a>Файл Schema.ini (драйвера текстового файла)
При использовании драйвера текстового формата текстового файла определяется с помощью файла сведений схемы. Файл сведений схемы всегда с именем Schema.ini и всегда остается в том же каталоге, в качестве источника текстовых данных. Файл сведений схемы предоставляет IISAM сведениями об общий формат файла, имя столбца и сведения о типе данных и несколько других характеристик данных. Файл Schema.ini всегда является обязательным для доступа к данным фиксированной длины. Файл Schema.ini следует использовать, если текст таблица содержит даты и времени, денежных единиц или десятичные данные или в любое время, что требуется больший контроль над обработки данных в таблице.  
  
> [!NOTE]  
>  Text ISAM будут получены исходные значения из реестра, а не из Schema.ini. Один и тот же формат файлов по умолчанию применяется для всех новых таблиц данных в текст. Все файлы, созданные с помощью инструкции CREATE TABLE наследуют эти же по умолчанию формат значения, которые устанавливаются путем выбора значения формата файла в **Определение текстового формата** диалоговое окно с \<по умолчанию > выбранным в  **Таблицы** списка. Если значения в реестре отличаются от значений в Schema.ini, значения в реестре перезаписываются значениями из Schema.ini.  
  
## <a name="understanding-schemaini-files"></a>Основные сведения о файлах Schema.ini  
 Файлы Schema.ini предоставляют сведения о схеме о записях в текстовом файле. Каждая запись Schema.ini указывает один из пяти характеристикам таблиц:  
  
-   Имя текстового файла  
  
-   Формат файла  
  
-   Имена полей, ширины и типов  
  
-   Набор символов  
  
-   Преобразование типов данных  
  
 В следующих разделах рассматриваются эти характеристики.  
  
## <a name="specifying-the-file-name"></a>Указание имени файла  
 Первая запись в файл Schema.ini всегда представляет имя исходного файла текста, заключенных в квадратные скобки. Запись для файла Sample.txt показано в следующем примере:  
  
```  
[Sample.txt]  
```  
  
## <a name="specifying-the-file-format"></a>Указание формата файла  
 **Формат** параметр в Schema.ini указывает формат текстового файла. Text IISAM может читать формат автоматически из файлов наиболее символами. Можно использовать любой символ в качестве разделителя в файле, за исключением двойных кавычек ("«). **Формата** в Schema.ini переопределяют настройки в реестре Windows, путем файла. В следующей таблице перечислены допустимые значения для **формат** параметр.  
  
|Описатель формата|Формат таблицы|Инструкции Schema.ini Format|  
|----------------------|------------------|---------------------------------|  
|**С разделителями табуляции**|Поля в файле разделены знаками табуляции.|Формат = TabDelimited|  
|**Разделители CSV**|Поля в файле разделяются запятыми (CSV-значений).|Формат = CSVDelimited|  
|**Настраиваемый с разделителями**|Поля в файле разделяются на любой символ, выбранный для ввода в диалоговом окне. Все, кроме указанных в двойные кавычки ("") разрешены, включая пустые.|Формат = с разделителями (*символьными*)<br /><br /> -или-<br /><br /> Разделитель не указано предложение WITH:<br /><br /> Формат с разделителями () =|  
|**Фиксированная длина**|Поля в файле имеют фиксированную длину.|Формат = FixedLength|  
  
## <a name="specifying-the-fields"></a>Задание полей  
 Имена полей можно указать в файле текста с символами двумя способами:  
  
-   Указать имена полей в первой строке таблицы и задать **ColNameHeader** для **значение True.**  
  
-   Укажите каждый столбец по номеру и назначить столбец имя и тип данных.  
  
 Необходимо указать каждый столбец по номеру и указать имя столбца, тип данных и ширины, фиксированной длины файлов.  
  
> [!NOTE]  
>  **ColNameHeader** параметр в переопределениях Schema.ini **FirstRowHasNames** в реестре Windows, путем файла.  
  
 Можно также определить типы данных полей. Используйте **MaxScanRows** параметр, чтобы указать, сколько строк должны проверяться при определении типов столбцов. Если задать **MaxScanRows** 0, проверяется весь файл. **MaxScanRows** в Schema.ini переопределяют настройки в реестре Windows, путем файла.  
  
 Параметр указывает, что Microsoft Jet данные в первой строке таблицы следует использовать, чтобы определить имена полей и следует изучить весь файл, чтобы определить данные типов, используемых:  
  
```  
ColNameHeader=True  
MaxScanRows=0  
```  
  
 Следующей записи определяет поля в таблице с помощью номер столбца (**Col *** n*) параметр, который является необязательным для файлов, разделенных символом и требуется для файлов с фиксированной длиной. В примере Schema.ini записи для двух полей, текстового поля — CustomerNumber 10 символов и текстовое поле CustomerName 30 символов:  
  
```  
Col1=CustomerNumber Text Width 10  
Col2=CustomerName Text Width 30  
```  
  
 Синтаксис **Col *** n* является:  
  
```  
  
n=ColumnNametype [#]  
```  
  
## <a name="remarks"></a>Замечания  
 В следующей таблице описаны каждой части **Col *** n* входа.  
  
|Параметр|Описание|  
|---------------|-----------------|  
|*ColumnName*|Имя текстового столбца. Если имя столбца содержит пробелы, его необходимо заключить в двойные кавычки.|  
|*type*|Существуют следующие типы данных.<br /><br /> **Типы данных Microsoft Jet**<br /><br /> bit<br /><br /> Byte<br /><br /> Short<br /><br /> Long<br /><br /> Измерение валют<br /><br /> Один<br /><br /> Double<br /><br /> DateTime<br /><br /> Текст<br /><br /> MEMO<br /><br /> **Типы данных ODBC** Char (то же, как текст)<br /><br /> Число с плавающей запятой (аналогично Double)<br /><br /> Целое число (то же, как Short)<br /><br /> LongChar (то же, как Memo)<br /><br /> Дата *формат даты*|  
|**Ширина**|Значение символьной строки `Width`. Указывает, что следующее число обозначает ширину столбца (необязательно для файлов, разделенных символом, требуется для файлов с фиксированной длины).|  
|*#*|Целочисленное значение, которое определяет ширину столбца (обязательно, если **ширина** указан).|  
  
## <a name="selecting-a-character-set"></a>При выборе кодировки  
 Можно выбрать из двух наборов символов: ANSI и OEM. **CharacterSet** в Schema.ini переопределяют настройки в реестре Windows, путем файла. Ниже приведен пример записи Schema.ini, которая задает кодировку ANSI.  
  
```  
CharacterSet=ANSI  
```  
  
## <a name="specifying-data-type-formats-and-conversions"></a>Указание форматов данных тип и преобразования  
 Файл Schema.ini содержит несколько параметров, которые можно использовать, чтобы указать, как преобразовать или отображения данных. В следующей таблице перечислены эти параметры.  
  
|Параметр|Описание|  
|------------|-----------------|  
|**DateTimeFormat**|Можно задать в строке формата, указывающее дату и время. Этот элемент следует указывать, если все поля даты и времени в импорта и экспорта должны иметь тот же формат. Все форматы Microsoft Jet, за исключением утра и после полудня поддерживаются. В случае строка формата не используются параметры изображения и времени краткий формат даты панели управления Windows.|  
|**DecimalSymbol**|Можно задать любой знак, используемый для разделения целой и дробной части числа.|  
|**NumberDigits**|Указывает число десятичных знаков в дробной части числа.|  
|**NumberLeadingZeros**|Указывает, содержат ли десятичное значение меньше 1 и больше -1 начальные нули; Это значение может быть либо False (без предшествующих нулей) или True.|  
|**Качестве**|Указывает символ валюты, который может использоваться для значений денежных сумм в текстовом файле. Например, знак доллара ($) и интеллектуальный анализ данных.|  
|**CurrencyPosFormat**|Можно задать одно из следующих значений:<br /><br /> -Currency символьный префикс без пробела (1)<br />-Суффикс символ валюты без пробела (1$)<br />-Currency символьный префикс с одним пробелом (1)<br />-Суффикс символ валюты с одним пробелом (1 $)|  
|**CurrencyDigits**|Указывает количество цифр дробной части денежной суммы.|  
|**CurrencyNegFormat**|Может использоваться одно из следующих значений:<br /><br /> -   ($1)<br />-   –$1<br />-   $–1<br />-   $1–<br />-   (1$)<br />-   –1$<br />-   1–$<br />-   1$–<br />-   –1 $<br />-   –$ 1<br />-   1 $–<br />-   $ 1–<br />-   $ –1<br />-   1– $<br />-   ($ 1)<br />-   (1 $)<br /><br /> В этом примере показано знак доллара, но должно заменить его соответствующим **качестве** значение в самой программы.|  
|**CurrencyThousandSymbol**|Указывает символ одного символа, который может использоваться для разделения денежных значений в текстовом файле тысяч.|  
|**CurrencyDecimalSymbol**|Можно задать любой знак, используемый для разделения целой и дробной части денежной суммы.|  
  
> [!NOTE]  
>  Если запись не указан, используется значение по умолчанию в панели управления Windows.
