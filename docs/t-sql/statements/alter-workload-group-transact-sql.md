---
title: "ALTER WORKLOAD GROUP (Transact-SQL) | Документы Microsoft"
ms.custom: 
ms.date: 01/19/2016
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- database-engine
ms.tgt_pltfrm: 
ms.topic: language-reference
f1_keywords:
- ALTER_WORKLOAD_GROUP_TSQL
- ALTER WORKLOAD GROUP
dev_langs:
- TSQL
helpviewer_keywords:
- ALTER WORKLOAD GROUP statement
ms.assetid: 957addce-feb0-4e54-893e-5faca3cd184c
caps.latest.revision: 56
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: 876522142756bca05416a1afff3cf10467f4c7f1
ms.openlocfilehash: e5a5d5650311115edc52866abdd167700438cc1f
ms.contentlocale: ru-ru
ms.lasthandoff: 09/01/2017

---
# <a name="alter-workload-group-transact-sql"></a>ALTER WORKLOAD GROUP (Transact-SQL)
[!INCLUDE[tsql-appliesto-ss2008-xxxx-xxxx-xxx_md](../../includes/tsql-appliesto-ss2008-xxxx-xxxx-xxx-md.md)]

  Изменяет существующую конфигурацию группы рабочей нагрузки регулятора ресурсов и при необходимости назначает ее для пула ресурсов регулятора ресурсов.  
  
 ![Значок ссылки на раздел](../../database-engine/configure-windows/media/topic-link.gif "значок ссылки на раздел") [синтаксические обозначения Transact-SQL](../../t-sql/language-elements/transact-sql-syntax-conventions-transact-sql.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
ALTER WORKLOAD GROUP { group_name | "default" }  
[ WITH  
    ([ IMPORTANCE = { LOW | MEDIUM | HIGH } ]  
      [ [ , ] REQUEST_MAX_MEMORY_GRANT_PERCENT = value ]  
      [ [ , ] REQUEST_MAX_CPU_TIME_SEC = value ]  
      [ [ , ] REQUEST_MEMORY_GRANT_TIMEOUT_SEC = value ]   
      [ [ , ] MAX_DOP = value ]  
      [ [ , ] GROUP_MAX_REQUESTS = value ] )  
 ]  
[ USING { pool_name | "default" } ]  
[ ; ]  
```  
  
## <a name="arguments"></a>Аргументы  
 *имя_группы* | «**по умолчанию**»  
 Имя существующей, определяемой пользователем или заданной по умолчанию группы рабочей нагрузки регулятора ресурсов.  
  
> [!NOTE]  
>  При установке [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] регулятор ресурсов создает внутренние группы и группы «по умолчанию».  
  
 Параметр "default" должен заключаться в кавычки ("") или квадратные скобки ([]), если используется с инструкцией ALTER WORKLOAD GROUP (во избежание конфликта с системным зарезервированным словом DEFAULT). Дополнительные сведения см. в разделе [Database Identifiers](../../relational-databases/databases/database-identifiers.md).  
  
> [!NOTE]  
>  В стандартных группах рабочей нагрузки и пулах ресурсов используются имена со строчными буквами, такие как «default». Это необходимо учитывать при работе с серверами, где параметры сортировки учитывают регистр символов. Серверы, параметры сортировки которых не учитывают регистр (например, SQL_Latin1_General_CP1_CI_AS), будут рассматривать строки «default» и «Default» как одинаковые.  
  
 IMPORTANCE = { LOW | MEDIUM | HIGH }  
 Указывает относительную важность запроса в группе рабочей нагрузки. Важность принимает одно из следующих значений:  
  
-   LOW  
  
-   MEDIUM (по умолчанию);  
  
-   HIGH.  
  
> [!NOTE]  
>  Внутри системы каждое значение важности хранится в виде числа, используемого для вычислений.  
  
 Значение IMPORTANCE локально для пула ресурсов; группы рабочей нагрузки разной важности внутри одного пула ресурсов влияют друг на друга, но не влияют на рабочие группы в других пулов ресурсов.  
  
 REQUEST_MAX_MEMORY_GRANT_PERCENT =*значение*  
 Указывает максимальное количество памяти, которое может понадобиться одному запросу из пула. Это процентное соотношение относительно к размеру пула ресурсов, указанного в MAX_MEMORY_PERCENT.  
  
> [!NOTE]  
>  Указанное значение ссылается только на доступную для выполнения запроса память.  
  
 *значение* должно быть 0 или положительным целым числом. Допустимые значения для *значение* — от 0 до 100. Значение по умолчанию для *значение* — 25.  
  
 Следует отметить следующее.  
  
-   Установка *значение* 0 запрещает запросы с операциями SORT и HASH JOIN в группах рабочей нагрузки, определяемых пользователем.  
  
-   Не рекомендуется использовать значение *значение* более 70, так как серверу не удается выделить достаточно памяти, если выполняются другие параллельные запросы. Со временем это может привести к ошибке 8645 (истечение времени ожидания запроса).  
  
> [!NOTE]  
>  Если требования к памяти запроса превышают ограничение, заданное этим параметром, сервер выполняет следующие действия.  
>   
>  Для определяемых пользователем групп рабочей нагрузки сервер пытается снизить степень параллелизма для запроса, пока требования к памяти не снизятся до ограничения, либо пока степень параллелизма не станет равной 1. Если в этом случае требования к запросам памяти по-прежнему превышают ограничение, возникает ошибка 8657.  
>   
>  Для внутренних групп рабочей нагрузки и группы по умолчанию сервер разрешает запросу получить необходимый объем памяти.  
>   
>  Учтите, что в обоих случаях может возникнуть ошибка 8645 (истечение времени ожидания), если на сервере недостаточно физической памяти.  
  
 REQUEST_MAX_CPU_TIME_SEC =*значение*  
 Указывает максимальное количество времени ЦП в секундах, которое может использоваться запросом. *значение* должно быть 0 или положительным целым числом. Значение по умолчанию для *значение* равно 0, что означает неограниченное время.  
  
> [!NOTE]  
>  По истечении лимита времени регулятор ресурсов не прекращает выполнение запроса. Однако будет сформировано событие. Дополнительные сведения см. в разделе [класс событий превышает пороговое значение ЦП](../../relational-databases/event-classes/cpu-threshold-exceeded-event-class.md).  
  
 REQUEST_MEMORY_GRANT_TIMEOUT_SEC =*значение*  
 Задает максимальное время (в секундах), которое запрос может ожидать предоставления памяти (памяти рабочего буфера).  
  
> [!NOTE]  
>  При истечении времени ожидания предоставления памяти запрос не всегда завершается ошибкой. Запрос завершится ошибкой только в случае, если одновременно запущено слишком много запросов. В остальных случаях запрос может получить лишь минимальный объем памяти, что приведет к снижению его производительности.  
  
 *значение* должно быть положительным целым числом. Значение по умолчанию для *значение*, 0, использует внутренние вычисления, основанные на затратах запроса для определения максимального времени.  
  
 MAX_DOP =*значение*  
 Указывает максимальную степень параллелизма (DOP) для параллельных запросов. *значение* должно быть 0 или положительное целое число 1 до 255. Когда *значение* равно 0, то сервер выбирает максимальную степень параллелизма. Это значение по умолчанию, которое рекомендуется использовать.  
  
> [!NOTE]  
>  Фактическое значение, задаваемое компонентом [!INCLUDE[ssDE](../../includes/ssde-md.md)] для MAX_DOP может быть меньше указанного значения. Конечное значение определяется по формуле min (255, *количество ЦП)*.  
  
> [!CAUTION]  
>  Изменение MAX_DOP может неблагоприятно сказаться на производительности сервера. Если необходимо изменить MAX_DOP, то рекомендуется задать для него значение, меньшее или равное максимальному количеству планировщиков оборудования, имеющихся на одном узле NUMA. Рекомендуется не устанавливать для MAX_DOP значение больше 8.  
  
 MAX_DOP обрабатывается следующим образом.  
  
-   Использование MAX_DOP в качестве указания запроса эффективно до тех пор, пока его значение не превышает значения MAX_DOP группы рабочей нагрузки.  
  
-   MAX_DOP в качестве указания запроса всегда переопределяет вызов хранимой процедуры sp_configure 'max degree of parallelism'.  
  
-   Группа рабочей нагрузки MAX_DOP переопределяет вызов хранимой процедуры sp_configure 'max degree of parallelism'.  
  
-   Если запрос помечен как последовательный (MAX_DOP = 1) на стадии компиляции, изменить его статус на параллельный на стадии выполнения невозможно, независимо от параметров группы рабочей нагрузки или хранимой процедуры sp_configure.  
  
 После того как DOP настроен, он может быть только снижен при нехватке доступной памяти. Перенастройка группы рабочей нагрузки невидима при ожидании в очереди на предоставление памяти.  
  
 GROUP_MAX_REQUESTS =*значение*  
 Указывает максимальное число одновременных запросов, разрешенных для выполнения в группе рабочей нагрузки. *значение* должно быть 0 или положительным целым числом. Значение по умолчанию для *значение*(0) означает отсутствие ограничений. Если достигнуто максимальное количество параллельных запросов, пользователь из этой группы сможет войти в систему, но переводится в состоянии ожидания до тех пор, пока количество параллельных запросов не станет меньше указанного значения.  
  
 С помощью { *pool_name* | «**по умолчанию**"}  
 Связывает группу рабочей нагрузки с пулом ресурсов, определяемых пользователем, определяется *pool_name*, который помещается в группу рабочей нагрузки в пуле ресурсов. Если *pool_name* не указан или если не используется аргумент USING, группа рабочей нагрузки помещается в стандартный пул регулятора ресурсов по умолчанию.  
  
 Параметр "default" должен заключаться в кавычки ("") или квадратные скобки ([]), если используется с инструкцией ALTER WORKLOAD GROUP (во избежание конфликта с системным зарезервированным словом DEFAULT). Дополнительные сведения см. в разделе [Database Identifiers](../../relational-databases/databases/database-identifiers.md).  
  
> [!NOTE]  
>  В параметре "default" учитывается регистр.  
  
## <a name="remarks"></a>Замечания  
 Использование инструкции ALTER WORKLOAD GROUP допустимо для группы по умолчанию.  
  
 Изменения конфигурации группы рабочей нагрузки не вступают в силу до тех пор, пока не будет выполнена инструкция ALTER RESOURCE GOVERNOR RECONFIGURE. При изменении плана влияет на параметр, новые параметры только вступят в силу в ранее кэшированных планов после выполнения инструкции DBCC FREEPROCCACHE (*pool_name*), где *pool_name* имя ресурса Пул ресурсов регулятора, на котором группа рабочей нагрузки связана с.  
  
-   Если необходимо изменить MAX_DOP значение 1, выполнение инструкции DBCC FREEPROCCACHE не требуется, так как параллельные планы можно запустить в последовательном режиме. Тем не менее он может оказаться сравнимой план, созданный как последовательного плана.  
  
-   При изменении MAX_DOP с 1 на 0 или значение больше 1, выполнение инструкции DBCC FREEPROCCACHE не требуется. Однако последовательных планов не может выполняться параллельно, поэтому Очистка кэша соответствующих позволит новые планы для потенциально могут компилироваться с помощью параллелизма.  
  
> [!CAUTION]  
>  Очистка кэшированных планов из пула ресурсов, который связан с более чем одной группы рабочей нагрузки будет влиять на все группы рабочей нагрузки с пулом ресурсов, определяемых пользователем, определяется *pool_name*.  
  
 При выполнении инструкций DDL рекомендуется иметь представление о состояниях регулятора ресурсов. Дополнительные сведения см. в разделе [регулятора ресурсов](../../relational-databases/resource-governor/resource-governor.md).  
  
 REQUEST_MEMORY_GRANT_PERCENT: В [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], разрешено создание индексов для использования большего объема памяти рабочей области, чем было указано изначально для повышения производительности. Эта специальная обработка поддерживается регулятором ресурсов в более поздних версиях, однако изначально предоставленная память и любая дополнительная выделенная память ограничены настройками группы рабочей нагрузки и пула ресурсов.  
  
 **Создание индекса для секционированной таблицы**  
  
 Объем памяти, затрачиваемой на создание индекса в невыровненной секционированной таблице, пропорционален количеству секций, охватываемых индексом.  Если общий объем необходимой памяти превышает предел на запрос (REQUEST_MAX_MEMORY_GRANT_PERCENT), устанавливаемый регулятором ресурсов для группы рабочей нагрузки, создание такого индекса может завершиться ошибкой. Настройки группы рабочей нагрузки по умолчанию позволяют запросу превосходить установленный для запросов лимит памяти, нужной при запуске (для совместимости с версией [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]). Поэтому пользователь может запустить тот же процесс создания индекса в группе рабочей нагрузки по умолчанию, если в пуле ресурсов по умолчанию достаточно памяти, настроенной для выполнения такого запроса.  
  
## <a name="permissions"></a>Permissions  
 Необходимо разрешение CONTROL SERVER.  
  
## <a name="examples"></a>Примеры  
 В следующем примере демонстрируется, как изменить важность запросов в группе по умолчанию с `MEDIUM` на `LOW`.  
  
```  
ALTER WORKLOAD GROUP "default"  
WITH (IMPORTANCE = LOW);  
GO  
ALTER RESOURCE GOVERNOR RECONFIGURE;  
GO  
```  
  
 В следующем примере демонстрируется, как переместить группу рабочей нагрузки из пула, где она расположена, в пул по умолчанию.  
  
```  
ALTER WORKLOAD GROUP adHoc  
USING [default];  
GO  
ALTER RESOURCE GOVERNOR RECONFIGURE;  
GO  
```  
  
## <a name="see-also"></a>См. также:  
 [Регулятор ресурсов](../../relational-databases/resource-governor/resource-governor.md)   
 [CREATE WORKLOAD GROUP (Transact-SQL)](../../t-sql/statements/create-workload-group-transact-sql.md)   
 [DROP WORKLOAD GROUP (Transact-SQL)](../../t-sql/statements/drop-workload-group-transact-sql.md)   
 [CREATE RESOURCE POOL (Transact-SQL)](../../t-sql/statements/create-resource-pool-transact-sql.md)   
 [ALTER RESOURCE POOL (Transact-SQL)](../../t-sql/statements/alter-resource-pool-transact-sql.md)   
 [DROP RESOURCE POOL (Transact-SQL)](../../t-sql/statements/drop-resource-pool-transact-sql.md)   
 [ALTER RESOURCE GOVERNOR (Transact-SQL)](../../t-sql/statements/alter-resource-governor-transact-sql.md)  
  
  

