---
title: "column_constraint (Transact-SQL) | Документы Microsoft"
ms.custom: 
ms.date: 05/05/2017
ms.prod: sql-non-specified
ms.prod_service: database-engine, sql-database
ms.service: 
ms.component: t-sql|statements
ms.reviewer: 
ms.suite: sql
ms.technology: database-engine
ms.tgt_pltfrm: 
ms.topic: language-reference
f1_keywords:
- column_constraint
- column_constraint_TSQL
dev_langs: TSQL
helpviewer_keywords:
- ALTER TABLE statement
- constraints [SQL Server], properties
- constraints [SQL Server], definitions
- column_constraint
ms.assetid: 8119b7c7-e93b-4de5-8f71-c3b7c70b993c
caps.latest.revision: "54"
author: edmacauley
ms.author: edmaca
manager: craigg
ms.workload: On Demand
ms.openlocfilehash: 8530f45f71d231783083b061f1c6e0095770ea53
ms.sourcegitcommit: 45e4efb7aa828578fe9eb7743a1a3526da719555
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="alter-table-columnconstraint-transact-sql"></a>Column_constraint ALTER TABLE (Transact-SQL)
[!INCLUDE[tsql-appliesto-ss2008-asdb-xxxx-xxx-md](../../includes/tsql-appliesto-ss2008-asdb-xxxx-xxx-md.md)]

  Указывает свойства ограничения PRIMARY KEY, FOREIGN KEY, UNIQUE или CHECK, являющегося частью определения нового столбца, добавляемого в таблицу с помощью [ALTER TABLE](../../t-sql/statements/alter-table-transact-sql.md).  
  
 ![Значок ссылки на раздел](../../database-engine/configure-windows/media/topic-link.gif "Значок ссылки на раздел") [Синтаксические обозначения в Transact-SQL](../../t-sql/language-elements/transact-sql-syntax-conventions-transact-sql.md)  
  
## <a name="syntax"></a>Синтаксис  
  
```  
[ CONSTRAINT constraint_name ]   
{   
    [ NULL | NOT NULL ]   
    { PRIMARY KEY | UNIQUE }   
        [ CLUSTERED | NONCLUSTERED ]   
        [ WITH FILLFACTOR = fillfactor ]   
        [ WITH ( index_option [, ...n ] ) ]  
        [ ON { partition_scheme_name (partition_column_name)   
            | filegroup | "default" } ]   
    | [ FOREIGN KEY ]   
        REFERENCES [ schema_name . ] referenced_table_name   
            [ ( ref_column ) ]   
        [ ON DELETE { NO ACTION | CASCADE | SET NULL | SET DEFAULT } ]   
        [ ON UPDATE { NO ACTION | CASCADE | SET NULL | SET DEFAULT } ]   
        [ NOT FOR REPLICATION ]   
    | CHECK [ NOT FOR REPLICATION ] ( logical_expression )  
}  
```  
  
## <a name="arguments"></a>Аргументы  
 CONSTRAINT  
 Указывает начало определения для ограничения PRIMARY KEY, UNIQUE, FOREIGN KEY или CHECK.  
  
 *constraint_name*  
 Имя ограничения. Имена ограничений должны подчиняться правилам для [идентификаторы](../../relational-databases/databases/database-identifiers.md), за исключением того, что имя не может начинаться со знака номера (#). Если *constraint_name* — не указано имя, формируемое системой назначается ограничение.  
  
 NULL | NOT NULL  
 Указывает, может ли столбец принимать значения NULL. Столбцы, которые не принимают значения NULL, могут быть добавлены, только если указаны значения по умолчанию. Если в новом столбце допускаются значения NULL и не указано значение по умолчанию, то новый столбец будет содержать NULL в каждой строке таблицы. Если новый столбец принимает значения NULL и вместе с новым столбцом добавлено определение по умолчанию, то с помощью параметра WITH VALUES можно сохранить значения по умолчанию в новом столбце для каждой существующей строки таблицы.  
  
 Если новый столбец не принимает значений NULL, то определение DEFAULT должно быть добавлено вместе с новым столбцом. Новый столбец автоматически заполняется значением по умолчанию в каждой существующей строке.  
  
 Если для добавления столбца необходимы физические изменения в строках данных таблицы, например при добавлении значений DEFAULT в каждую строку, то блокировки в таблице удерживаются в течение всего времени выполнения инструкции ALTER TABLE. Это отражается на возможности изменять содержимое таблицы во время действия блокировки. Однако добавление столбца, допускающего значение NULL, если для нее не указано значение по умолчанию, — это операция, использующая только метаданные и не требующая блокировок.  
  
 При использовании инструкций CREATE TABLE или ALTER TABLE параметры базы данных и сеанса влияют и, возможно, отменяют возможность типа данных, который используется в переопределении столбца, содержать значения NULL. Рекомендуется всегда явно определять невычисляемые столбцы как NULL или NOT NULL или, если используется определяемый пользователем тип данных, допустимость столбца принимать значение NULL, по умолчанию, для этого типа данных. Дополнительные сведения см. в разделе [CREATE TABLE (Transact-SQL)](../../t-sql/statements/create-table-transact-sql.md).  
  
 PRIMARY KEY  
 Ограничение, выполняющее принудительную проверку целостности сущностей для указанного столбца или столбцов при использовании уникального индекса. Для каждой таблицы может быть создано только одно ограничение PRIMARY KEY.  
  
 UNIQUE  
 Ограничение, обеспечивающее целостность сущностей для указанного столбца или столбцов при использовании уникального индекса.  
  
 CLUSTERED | NONCLUSTERED  
 Указывает, что для ограничения PRIMARY KEY или UNIQUE создается кластеризованный или некластеризованный индекс. По умолчанию ограничения PRIMARY KEY имеют значение CLUSTERED. По умолчанию ограничения UNIQUE имеют значение NONCLUSTERED.  
  
 Если кластеризованное ограничение или индекс уже созданы в таблице, значение CLUSTERED не может быть задано. Если кластеризованное ограничение или индекс уже существует в таблице, ограничения PRIMARY KEY по умолчанию имеют значение NONCLUSTERED.  
  
 Столбцы, имеющие **ntext**, **текст**, **varchar(max)**, **nvarchar(max)**, **varbinary(max)**, **xml**, или **изображение** типов данных не может быть указаны как столбцы для индекса.  
  
 С коэффициентом ЗАПОЛНЕНИЯ  **=**  *fillfactor*  
 Указывает, насколько полно компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] должен заполнять каждую страницу индекса, используемую для хранения индексных данных. Значения коэффициента заполнения, определяемый пользователем может быть от 1 до 100. Если значение не задано, по умолчанию принимается значение 0.  
  
> [!IMPORTANT]  
>  Документации с FILLFACTOR = *fillfactor* освобождает как единственного параметра индекса, который применяется к ограничениям PRIMARY KEY или UNIQUE, сохраняется для обеспечения обратной совместимости, но не документируется таким образом в будущем. Другие параметры индекса можно указать в [index_option](../../t-sql/statements/alter-table-index-option-transact-sql.md) предложением инструкции ALTER TABLE.  
  
 ON { *partition_scheme_name***(***partition_column_name***)** | *файловой группы*  |  **»**по умолчанию**»** }  
 **Область применения**: начиная с [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] до [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].  
  
 Указывает место хранения индекса, созданного для ограничения. Если *partition_scheme_name* указан, индекс секционируется и секции сопоставляются с файловыми группами, которые задаются параметром *partition_scheme_name*. Если *файловой группы* указан, индекс создается в именованной файловой группе. Если **»**по умолчанию**»** указан или если ON не определен вообще, индекс создается в той же файловой группе, что и таблица. Если при добавлении кластеризованного индекса для ограничений PRIMARY KEY или UNIQUE указано предложение ON, то вся таблица перемещается в указанную файловую группу в момент создания этого индекса.  
  
 В этом контексте default не является ключевым словом. Он представляет собой идентификатор файловой группы по умолчанию и должен иметь разделители, как в выражениях ON **»**по умолчанию**»** или ON **[**по умолчанию**]**. Если **»**по умолчанию**»** указан, параметр QUOTED_IDENTIFIER должен иметь значение ON для текущего сеанса. Это параметр по умолчанию. Дополнительные сведения см. в разделе [SET QUOTED_IDENTIFIER (Transact-SQL)](../../t-sql/statements/set-quoted-identifier-transact-sql.md).  
  
 FOREIGN KEY REFERENCES  
 Ограничение, обеспечивающее ссылочную целостность данных в столбце. Ограничения FOREIGN KEY требуют, чтобы любое значение в столбце обязательно существовало в указанном столбце ссылочной таблицы.  
  
 *schema_name*  
 Имя схемы, к которой принадлежит таблица со ссылкой от ограничения FOREIGN KEY.  
  
 *referenced_table_name*  
 Таблица, на которую ссылается ограничение FOREIGN KEY.  
  
 *ref_column*  
 Столбец в скобках, на который ссылается новое ограничение FOREIGN KEY.  
  
 ON DELETE { **ВМЕШАТЕЛЬСТВО** | CASCADE | SET NULL | SET DEFAULT}  
 Указывает, какое действие производится над строками изменяемой таблицы, если эти строки имеют ссылочную связь, и строка, на которую имеется ссылка, удаляется из родительской таблицы. Параметр по умолчанию — NO ACTION.  
  
 NO ACTION  
 Компонент [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] формирует ошибку, и выполняется откат операции удаления строки из родительской таблицы.  
  
 CASCADE  
 Если из родительской таблицы удаляется строка, соответствующие ей строки удаляются и из ссылающейся таблицы.  
  
 SET NULL  
 Все значения, составляющие внешний ключ, при удалении соответствующей строки родительской таблицы устанавливаются в значение NULL. Для выполнения этого ограничения внешние ключевые столбцы должны допускать значения NULL.  
  
 SET DEFAULT  
 Все значения, содержащие внешний ключ, при удалении соответствующей строки родительской таблицы устанавливаются в значения по умолчанию. Для выполнения этого ограничения все внешние ключевые столбцы должны иметь определения по умолчанию. Если столбец допускает значения NULL и значение по умолчанию явно не определено, значением столбца по умолчанию становится NULL.  
  
 Не следует использовать параметр CASCADE, если таблица будет включена в публикацию слиянием, в которой используются логические записи. Дополнительные сведения о логических записях см. в статье [Группирование изменений в связанных строках с помощью логических записей](../../relational-databases/replication/merge/group-changes-to-related-rows-with-logical-records.md).  
  
 Действие ON DELETE CASCADE не может быть определено, если в изменяемой таблице уже существует триггер INSTEAD OF для условия ON DELETE.  
  
 Например, в [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] базы данных, **ProductVendor** таблица имеет ссылочную связь с **поставщика** таблицы. **ProductVendor.VendorID** ссылок на внешние ключи **Vendor.VendorID** первичного ключа.  
  
 Если при выполнении инструкции DELETE для строки в **поставщика** указано действие ON DELETE CASCADE и таблицы для **ProductVendor.VendorID**, [!INCLUDE[ssDE](../../includes/ssde-md.md)] проверяет наличие одного или нескольких зависимых строк в **ProductVendor** таблицы. Если они существуют, зависимые строки в **ProductVendor** таблица будет удалена, кроме строки в **поставщика** таблицы.  
  
 И наоборот, если указано NO ACTION [!INCLUDE[ssDE](../../includes/ssde-md.md)] вызывает ошибку и откатывает действие delete по **поставщика** строк при наличии хотя бы одна строка в **ProductVendor** таблице, ссылающейся на него.  
  
 ПРИ ОБНОВЛЕНИИ { **ВМЕШАТЕЛЬСТВО** | CASCADE | SET NULL | SET DEFAULT}  
 Указывает, какое действие совершается над строками в изменяемой таблице, когда эти строки имеют ссылочную связь и строка родительской таблицы, на которую указывает ссылка, обновляется. Параметр по умолчанию — NO ACTION.  
  
 NO ACTION  
 Компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] возвращает ошибку, а обновление строки родительской таблицы откатывается.  
  
 CASCADE  
 Соответствующие строки обновляются в ссылающейся таблице, если эта строка обновляется в родительской таблице.  
  
 SET NULL  
 Всем значениям, составляющим внешний ключ, присваивается значение NULL, когда обновляется соответствующая строка в родительской таблице. Для выполнения этого ограничения внешние ключевые столбцы должны допускать значения NULL.  
  
 SET DEFAULT  
 Всем значениям, составляющим внешний ключ, присваивается их значение по умолчанию, когда обновляется соответствующая строка в родительской таблице. Для выполнения этого ограничения все внешние ключевые столбцы должны иметь определения по умолчанию. Если столбец допускает значения NULL и значение по умолчанию явно не определено, значением столбца по умолчанию становится NULL.  
  
 Не следует использовать параметр CASCADE, если таблица будет включена в публикацию слиянием, в которой используются логические записи. Дополнительные сведения о логических записях см. в статье [Группирование изменений в связанных строках с помощью логических записей](../../relational-databases/replication/merge/group-changes-to-related-rows-with-logical-records.md).  
  
 Действия ON UPDATE CASCADE, SET NULL и SET DEFAULT не могут быть определены, если в изменяемой таблице уже существует триггер INSTEAD OF для условия ON UPDATE.  
  
 Например, в [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] базы данных, **ProductVendor** таблица имеет ссылочную связь с **поставщика** таблицы. **ProductVendor.VendorID** ссылок на внешние ключи **Vendor.VendorID** первичного ключа.  
  
 Если при выполнении инструкции UPDATE для строки в **поставщика** таблицы и действие ON UPDATE CASCADE задан для **ProductVendor.VendorID**, [!INCLUDE[ssDE](../../includes/ssde-md.md)] проверяет наличие одного или нескольких зависимых строк в **ProductVendor** таблицы. Если они существуют, зависимые строки в **ProductVendor** таблица будет обновлена, кроме строки в **поставщика** таблицы.  
  
 И наоборот, если указано NO ACTION [!INCLUDE[ssDE](../../includes/ssde-md.md)] вызывает ошибку и откатывает операцию обновления **поставщика** строк при наличии хотя бы одна строка в **ProductVendor** таблице, ссылающейся на него.  
  
 NOT FOR REPLICATION  
 **Область применения**: начиная с [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] до [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].  
  
 Может быть определено для ограничений FOREIGN KEY и CHECK. Если ограничение сопровождается этим предложением, оно не выполняется, когда агенты репликации выполняют операции вставки, обновления или удаления.  
  
 CHECK  
 Ограничение, обеспечивающее целостность домена путем ограничения возможных значений, которые могут быть введены в столбец или столбцы.  
  
 *Logical_Expression*  
 Логическое выражение, используемое в ограничении CHECK и возвращающее значения TRUE или FALSE. *Logical_Expression* используется в ограничениях CHECK не могут ссылаться на другую таблицу но может ссылаться на другие столбцы в той же таблицы в той же строке. Выражение не может ссылаться на псевдоним типа данных.  
  
## <a name="remarks"></a>Замечания  
 При добавлении новых ограничений FOREIGN KEY или CHECK все существующие данные проверяются на соответствие ограничениям, если не указан параметр WITH NOCHECK. В том случае, если обнаруживаются нарушения, выполнение ALTER TABLE завершается с ошибкой. При добавлении к существующему столбцу ограничений PRIMARY KEY или UNIQUE все данные в столбце должны быть уникальны. Если будут обнаружены повторяющиеся значения, ALTER TABLE завершится неудачно. При добавлении ограничения PRIMARY KEY или UNIQUE наличие параметра WITH NOCHECK не имеет значения.  
  
 Каждое ограничение PRIMARY KEY и UNIQUE создает индекс. Число ограничений UNIQUE и PRIMARY KEY не может вызвать превышение предельного количества индексов в таблице (999 некластеризованных и 1 кластеризованный). Ограничения внешнего ключа не вызывают автоматического создания индекса. Однако столбцы внешних ключей часто используются в критериях соединения запросов посредством сопоставления столбца или столбцов из ограничения внешнего ключа одной таблицы со столбцом или столбцами первичного или уникального ключей в другой таблице. Индекс по столбцам таблицы внешнего ключа позволяет компоненту [!INCLUDE[ssDE](../../includes/ssde-md.md)] быстро находить связанные данные в таблице внешних ключей.  
  
## <a name="examples"></a>Примеры  
 Примеры см. в разделе [ALTER TABLE &#40; Transact-SQL &#41; ](../../t-sql/statements/alter-table-transact-sql.md).  
  
## <a name="see-also"></a>См. также:  
 [ALTER TABLE (Transact-SQL)](../../t-sql/statements/alter-table-transact-sql.md)   
 [column_definition (Transact-SQL)](../../t-sql/statements/alter-table-column-definition-transact-sql.md)  
  
  
